(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function Ih(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Aw(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var Mf={exports:{}},Jo={},Bf={exports:{}},dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zm;function Cw(){if(zm)return dt;zm=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function v(K){return K===null||typeof K!="object"?null:(K=g&&K[g]||K["@@iterator"],typeof K=="function"?K:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function S(K,N,X){this.props=K,this.context=N,this.refs=_,this.updater=X||y}S.prototype.isReactComponent={},S.prototype.setState=function(K,N){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,N,"setState")},S.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function A(){}A.prototype=S.prototype;function C(K,N,X){this.props=K,this.context=N,this.refs=_,this.updater=X||y}var T=C.prototype=new A;T.constructor=C,b(T,S.prototype),T.isPureReactComponent=!0;var P=Array.isArray,z=Object.prototype.hasOwnProperty,G={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function V(K,N,X){var W,B={},J=null,be=null;if(N!=null)for(W in N.ref!==void 0&&(be=N.ref),N.key!==void 0&&(J=""+N.key),N)z.call(N,W)&&!L.hasOwnProperty(W)&&(B[W]=N[W]);var ie=arguments.length-2;if(ie===1)B.children=X;else if(1<ie){for(var ne=Array(ie),se=0;se<ie;se++)ne[se]=arguments[se+2];B.children=ne}if(K&&K.defaultProps)for(W in ie=K.defaultProps,ie)B[W]===void 0&&(B[W]=ie[W]);return{$$typeof:r,type:K,key:J,ref:be,props:B,_owner:G.current}}function q(K,N){return{$$typeof:r,type:K.type,key:N,ref:K.ref,props:K.props,_owner:K._owner}}function O(K){return typeof K=="object"&&K!==null&&K.$$typeof===r}function ee(K){var N={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(X){return N[X]})}var D=/\/+/g;function te(K,N){return typeof K=="object"&&K!==null&&K.key!=null?ee(""+K.key):N.toString(36)}function ve(K,N,X,W,B){var J=typeof K;(J==="undefined"||J==="boolean")&&(K=null);var be=!1;if(K===null)be=!0;else switch(J){case"string":case"number":be=!0;break;case"object":switch(K.$$typeof){case r:case e:be=!0}}if(be)return be=K,B=B(be),K=W===""?"."+te(be,0):W,P(B)?(X="",K!=null&&(X=K.replace(D,"$&/")+"/"),ve(B,N,X,"",function(se){return se})):B!=null&&(O(B)&&(B=q(B,X+(!B.key||be&&be.key===B.key?"":(""+B.key).replace(D,"$&/")+"/")+K)),N.push(B)),1;if(be=0,W=W===""?".":W+":",P(K))for(var ie=0;ie<K.length;ie++){J=K[ie];var ne=W+te(J,ie);be+=ve(J,N,X,ne,B)}else if(ne=v(K),typeof ne=="function")for(K=ne.call(K),ie=0;!(J=K.next()).done;)J=J.value,ne=W+te(J,ie++),be+=ve(J,N,X,ne,B);else if(J==="object")throw N=String(K),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return be}function ye(K,N,X){if(K==null)return K;var W=[],B=0;return ve(K,W,"","",function(J){return N.call(X,J,B++)}),W}function Oe(K){if(K._status===-1){var N=K._result;N=N(),N.then(function(X){(K._status===0||K._status===-1)&&(K._status=1,K._result=X)},function(X){(K._status===0||K._status===-1)&&(K._status=2,K._result=X)}),K._status===-1&&(K._status=0,K._result=N)}if(K._status===1)return K._result.default;throw K._result}var je={current:null},fe={transition:null},xe={ReactCurrentDispatcher:je,ReactCurrentBatchConfig:fe,ReactCurrentOwner:G};function me(){throw Error("act(...) is not supported in production builds of React.")}return dt.Children={map:ye,forEach:function(K,N,X){ye(K,function(){N.apply(this,arguments)},X)},count:function(K){var N=0;return ye(K,function(){N++}),N},toArray:function(K){return ye(K,function(N){return N})||[]},only:function(K){if(!O(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},dt.Component=S,dt.Fragment=t,dt.Profiler=i,dt.PureComponent=C,dt.StrictMode=n,dt.Suspense=d,dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xe,dt.act=me,dt.cloneElement=function(K,N,X){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var W=b({},K.props),B=K.key,J=K.ref,be=K._owner;if(N!=null){if(N.ref!==void 0&&(J=N.ref,be=G.current),N.key!==void 0&&(B=""+N.key),K.type&&K.type.defaultProps)var ie=K.type.defaultProps;for(ne in N)z.call(N,ne)&&!L.hasOwnProperty(ne)&&(W[ne]=N[ne]===void 0&&ie!==void 0?ie[ne]:N[ne])}var ne=arguments.length-2;if(ne===1)W.children=X;else if(1<ne){ie=Array(ne);for(var se=0;se<ne;se++)ie[se]=arguments[se+2];W.children=ie}return{$$typeof:r,type:K.type,key:B,ref:J,props:W,_owner:be}},dt.createContext=function(K){return K={$$typeof:o,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:a,_context:K},K.Consumer=K},dt.createElement=V,dt.createFactory=function(K){var N=V.bind(null,K);return N.type=K,N},dt.createRef=function(){return{current:null}},dt.forwardRef=function(K){return{$$typeof:c,render:K}},dt.isValidElement=O,dt.lazy=function(K){return{$$typeof:p,_payload:{_status:-1,_result:K},_init:Oe}},dt.memo=function(K,N){return{$$typeof:f,type:K,compare:N===void 0?null:N}},dt.startTransition=function(K){var N=fe.transition;fe.transition={};try{K()}finally{fe.transition=N}},dt.unstable_act=me,dt.useCallback=function(K,N){return je.current.useCallback(K,N)},dt.useContext=function(K){return je.current.useContext(K)},dt.useDebugValue=function(){},dt.useDeferredValue=function(K){return je.current.useDeferredValue(K)},dt.useEffect=function(K,N){return je.current.useEffect(K,N)},dt.useId=function(){return je.current.useId()},dt.useImperativeHandle=function(K,N,X){return je.current.useImperativeHandle(K,N,X)},dt.useInsertionEffect=function(K,N){return je.current.useInsertionEffect(K,N)},dt.useLayoutEffect=function(K,N){return je.current.useLayoutEffect(K,N)},dt.useMemo=function(K,N){return je.current.useMemo(K,N)},dt.useReducer=function(K,N,X){return je.current.useReducer(K,N,X)},dt.useRef=function(K){return je.current.useRef(K)},dt.useState=function(K){return je.current.useState(K)},dt.useSyncExternalStore=function(K,N,X){return je.current.useSyncExternalStore(K,N,X)},dt.useTransition=function(){return je.current.useTransition()},dt.version="18.3.1",dt}var $m;function Lh(){return $m||($m=1,Bf.exports=Cw()),Bf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wm;function Nw(){if(Wm)return Jo;Wm=1;var r=Lh(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(c,d,f){var p,g={},v=null,y=null;f!==void 0&&(v=""+f),d.key!==void 0&&(v=""+d.key),d.ref!==void 0&&(y=d.ref);for(p in d)n.call(d,p)&&!a.hasOwnProperty(p)&&(g[p]=d[p]);if(c&&c.defaultProps)for(p in d=c.defaultProps,d)g[p]===void 0&&(g[p]=d[p]);return{$$typeof:e,type:c,key:v,ref:y,props:g,_owner:i.current}}return Jo.Fragment=t,Jo.jsx=o,Jo.jsxs=o,Jo}var Hm;function Fw(){return Hm||(Hm=1,Mf.exports=Nw()),Mf.exports}var h=Fw(),re=Lh();const p1=Ih(re);var Gc={},Uf={exports:{}},Yr={},zf={exports:{}},$f={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vm;function jw(){return Vm||(Vm=1,(function(r){function e(fe,xe){var me=fe.length;fe.push(xe);e:for(;0<me;){var K=me-1>>>1,N=fe[K];if(0<i(N,xe))fe[K]=xe,fe[me]=N,me=K;else break e}}function t(fe){return fe.length===0?null:fe[0]}function n(fe){if(fe.length===0)return null;var xe=fe[0],me=fe.pop();if(me!==xe){fe[0]=me;e:for(var K=0,N=fe.length,X=N>>>1;K<X;){var W=2*(K+1)-1,B=fe[W],J=W+1,be=fe[J];if(0>i(B,me))J<N&&0>i(be,B)?(fe[K]=be,fe[J]=me,K=J):(fe[K]=B,fe[W]=me,K=W);else if(J<N&&0>i(be,me))fe[K]=be,fe[J]=me,K=J;else break e}}return xe}function i(fe,xe){var me=fe.sortIndex-xe.sortIndex;return me!==0?me:fe.id-xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();r.unstable_now=function(){return o.now()-c}}var d=[],f=[],p=1,g=null,v=3,y=!1,b=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(fe){for(var xe=t(f);xe!==null;){if(xe.callback===null)n(f);else if(xe.startTime<=fe)n(f),xe.sortIndex=xe.expirationTime,e(d,xe);else break;xe=t(f)}}function P(fe){if(_=!1,T(fe),!b)if(t(d)!==null)b=!0,Oe(z);else{var xe=t(f);xe!==null&&je(P,xe.startTime-fe)}}function z(fe,xe){b=!1,_&&(_=!1,A(V),V=-1),y=!0;var me=v;try{for(T(xe),g=t(d);g!==null&&(!(g.expirationTime>xe)||fe&&!ee());){var K=g.callback;if(typeof K=="function"){g.callback=null,v=g.priorityLevel;var N=K(g.expirationTime<=xe);xe=r.unstable_now(),typeof N=="function"?g.callback=N:g===t(d)&&n(d),T(xe)}else n(d);g=t(d)}if(g!==null)var X=!0;else{var W=t(f);W!==null&&je(P,W.startTime-xe),X=!1}return X}finally{g=null,v=me,y=!1}}var G=!1,L=null,V=-1,q=5,O=-1;function ee(){return!(r.unstable_now()-O<q)}function D(){if(L!==null){var fe=r.unstable_now();O=fe;var xe=!0;try{xe=L(!0,fe)}finally{xe?te():(G=!1,L=null)}}else G=!1}var te;if(typeof C=="function")te=function(){C(D)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,ye=ve.port2;ve.port1.onmessage=D,te=function(){ye.postMessage(null)}}else te=function(){S(D,0)};function Oe(fe){L=fe,G||(G=!0,te())}function je(fe,xe){V=S(function(){fe(r.unstable_now())},xe)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(fe){fe.callback=null},r.unstable_continueExecution=function(){b||y||(b=!0,Oe(z))},r.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<fe?Math.floor(1e3/fe):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(fe){switch(v){case 1:case 2:case 3:var xe=3;break;default:xe=v}var me=v;v=xe;try{return fe()}finally{v=me}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(fe,xe){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var me=v;v=fe;try{return xe()}finally{v=me}},r.unstable_scheduleCallback=function(fe,xe,me){var K=r.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?K+me:K):me=K,fe){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=me+N,fe={id:p++,callback:xe,priorityLevel:fe,startTime:me,expirationTime:N,sortIndex:-1},me>K?(fe.sortIndex=me,e(f,fe),t(d)===null&&fe===t(f)&&(_?(A(V),V=-1):_=!0,je(P,me-K))):(fe.sortIndex=N,e(d,fe),b||y||(b=!0,Oe(z))),fe},r.unstable_shouldYield=ee,r.unstable_wrapCallback=function(fe){var xe=v;return function(){var me=v;v=xe;try{return fe.apply(this,arguments)}finally{v=me}}}})($f)),$f}var Gm;function Dw(){return Gm||(Gm=1,zf.exports=jw()),zf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Km;function Ow(){if(Km)return Yr;Km=1;var r=Lh(),e=Dw();function t(s){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(s,l){o(s,l),o(s+"Capture",l)}function o(s,l){for(i[s]=l,s=0;s<l.length;s++)n.add(l[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function v(s){return d.call(g,s)?!0:d.call(p,s)?!1:f.test(s)?g[s]=!0:(p[s]=!0,!1)}function y(s,l,u,m){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function b(s,l,u,m){if(l===null||typeof l>"u"||y(s,l,u,m))return!0;if(m)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function _(s,l,u,m,x,w,E){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=x,this.mustUseProperty=u,this.propertyName=s,this.type=l,this.sanitizeURL=w,this.removeEmptyString=E}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){S[s]=new _(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var l=s[0];S[l]=new _(l,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){S[s]=new _(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){S[s]=new _(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){S[s]=new _(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){S[s]=new _(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){S[s]=new _(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){S[s]=new _(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){S[s]=new _(s,5,!1,s.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function C(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var l=s.replace(A,C);S[l]=new _(l,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var l=s.replace(A,C);S[l]=new _(l,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var l=s.replace(A,C);S[l]=new _(l,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){S[s]=new _(s,1,!1,s.toLowerCase(),null,!1,!1)}),S.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){S[s]=new _(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,l,u,m){var x=S.hasOwnProperty(l)?S[l]:null;(x!==null?x.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(b(l,u,x,m)&&(u=null),m||x===null?v(l)&&(u===null?s.removeAttribute(l):s.setAttribute(l,""+u)):x.mustUseProperty?s[x.propertyName]=u===null?x.type===3?!1:"":u:(l=x.attributeName,m=x.attributeNamespace,u===null?s.removeAttribute(l):(x=x.type,u=x===3||x===4&&u===!0?"":""+u,m?s.setAttributeNS(m,l,u):s.setAttribute(l,u))))}var P=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,z=Symbol.for("react.element"),G=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),ee=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),ye=Symbol.for("react.memo"),Oe=Symbol.for("react.lazy"),je=Symbol.for("react.offscreen"),fe=Symbol.iterator;function xe(s){return s===null||typeof s!="object"?null:(s=fe&&s[fe]||s["@@iterator"],typeof s=="function"?s:null)}var me=Object.assign,K;function N(s){if(K===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);K=l&&l[1]||""}return`
`+K+s}var X=!1;function W(s,l){if(!s||X)return"";X=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ge){var m=ge}Reflect.construct(s,[],l)}else{try{l.call()}catch(ge){m=ge}s.call(l.prototype)}else{try{throw Error()}catch(ge){m=ge}s()}}catch(ge){if(ge&&m&&typeof ge.stack=="string"){for(var x=ge.stack.split(`
`),w=m.stack.split(`
`),E=x.length-1,U=w.length-1;1<=E&&0<=U&&x[E]!==w[U];)U--;for(;1<=E&&0<=U;E--,U--)if(x[E]!==w[U]){if(E!==1||U!==1)do if(E--,U--,0>U||x[E]!==w[U]){var Y=`
`+x[E].replace(" at new "," at ");return s.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",s.displayName)),Y}while(1<=E&&0<=U);break}}}finally{X=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?N(s):""}function B(s){switch(s.tag){case 5:return N(s.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return s=W(s.type,!1),s;case 11:return s=W(s.type.render,!1),s;case 1:return s=W(s.type,!0),s;default:return""}}function J(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case L:return"Fragment";case G:return"Portal";case q:return"Profiler";case V:return"StrictMode";case te:return"Suspense";case ve:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case ee:return(s.displayName||"Context")+".Consumer";case O:return(s._context.displayName||"Context")+".Provider";case D:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ye:return l=s.displayName||null,l!==null?l:J(s.type)||"Memo";case Oe:l=s._payload,s=s._init;try{return J(s(l))}catch{}}return null}function be(s){var l=s.type;switch(s.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=l.render,s=s.displayName||s.name||"",l.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return J(l);case 8:return l===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ie(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ne(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function se(s){var l=ne(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),m=""+s[l];if(!s.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var x=u.get,w=u.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(E){m=""+E,w.call(this,E)}}),Object.defineProperty(s,l,{enumerable:u.enumerable}),{getValue:function(){return m},setValue:function(E){m=""+E},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Z(s){s._valueTracker||(s._valueTracker=se(s))}function pe(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var u=l.getValue(),m="";return s&&(m=ne(s)?s.checked?"true":"false":s.value),s=m,s!==u?(l.setValue(s),!0):!1}function Ce(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Fe(s,l){var u=l.checked;return me({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function We(s,l){var u=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;u=ie(l.value!=null?l.value:u),s._wrapperState={initialChecked:m,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function Be(s,l){l=l.checked,l!=null&&T(s,"checked",l,!1)}function ke(s,l){Be(s,l);var u=ie(l.value),m=l.type;if(u!=null)m==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}l.hasOwnProperty("value")?Bt(s,l.type,u):l.hasOwnProperty("defaultValue")&&Bt(s,l.type,ie(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(s.defaultChecked=!!l.defaultChecked)}function jt(s,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+s._wrapperState.initialValue,u||l===s.value||(s.value=l),s.defaultValue=l}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function Bt(s,l,u){(l!=="number"||Ce(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var Ht=Array.isArray;function gt(s,l,u,m){if(s=s.options,l){l={};for(var x=0;x<u.length;x++)l["$"+u[x]]=!0;for(u=0;u<s.length;u++)x=l.hasOwnProperty("$"+s[u].value),s[u].selected!==x&&(s[u].selected=x),x&&m&&(s[u].defaultSelected=!0)}else{for(u=""+ie(u),l=null,x=0;x<s.length;x++){if(s[x].value===u){s[x].selected=!0,m&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function qt(s,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return me({},l,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Mr(s,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(t(92));if(Ht(u)){if(1<u.length)throw Error(t(93));u=u[0]}l=u}l==null&&(l=""),u=l}s._wrapperState={initialValue:ie(u)}}function et(s,l){var u=ie(l.value),m=ie(l.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),l.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),m!=null&&(s.defaultValue=""+m)}function at(s){var l=s.textContent;l===s._wrapperState.initialValue&&l!==""&&l!==null&&(s.value=l)}function _t(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nn(s,l){return s==null||s==="http://www.w3.org/1999/xhtml"?_t(l):s==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var fr,sa=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,m,x){MSApp.execUnsafeLocalFunction(function(){return s(l,u,m,x)})}:s})(function(s,l){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=l;else{for(fr=fr||document.createElement("div"),fr.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=fr.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;l.firstChild;)s.appendChild(l.firstChild)}});function Nr(s,l){if(l){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=l;return}}s.textContent=l}var xn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},go=["Webkit","ms","Moz","O"];Object.keys(xn).forEach(function(s){go.forEach(function(l){l=l+s.charAt(0).toUpperCase()+s.substring(1),xn[l]=xn[s]})});function aa(s,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||xn.hasOwnProperty(s)&&xn[s]?(""+l).trim():l+"px"}function oa(s,l){s=s.style;for(var u in l)if(l.hasOwnProperty(u)){var m=u.indexOf("--")===0,x=aa(u,l[u],m);u==="float"&&(u="cssFloat"),m?s.setProperty(u,x):s[u]=x}}var xo=me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bi(s,l){if(l){if(xo[s]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function Es(s,l){if(s.indexOf("-")===-1)return typeof l.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ui=null;function On(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var zi=null,vn=null,Pn=null;function ei(s){if(s=Io(s)){if(typeof zi!="function")throw Error(t(280));var l=s.stateNode;l&&(l=oc(l),zi(s.stateNode,s.type,l))}}function Rn(s){vn?Pn?Pn.push(s):Pn=[s]:vn=s}function la(){if(vn){var s=vn,l=Pn;if(Pn=vn=null,ei(s),l)for(s=0;s<l.length;s++)ei(l[s])}}function ca(s,l){return s(l)}function ua(){}var In=!1;function Ln(s,l,u){if(In)return s(l,u);In=!0;try{return ca(s,l,u)}finally{In=!1,(vn!==null||Pn!==null)&&(ua(),la())}}function yn(s,l){var u=s.stateNode;if(u===null)return null;var m=oc(u);if(m===null)return null;u=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,l,typeof u));return u}var Mn=!1;if(c)try{var Fr={};Object.defineProperty(Fr,"passive",{get:function(){Mn=!0}}),window.addEventListener("test",Fr,Fr),window.removeEventListener("test",Fr,Fr)}catch{Mn=!1}function Bn(s,l,u,m,x,w,E,U,Y){var ge=Array.prototype.slice.call(arguments,3);try{l.apply(u,ge)}catch(Ne){this.onError(Ne)}}var ti=!1,$i=null,k=!1,R=null,F={onError:function(s){ti=!0,$i=s}};function j(s,l,u,m,x,w,E,U,Y){ti=!1,$i=null,Bn.apply(F,arguments)}function I(s,l,u,m,x,w,E,U,Y){if(j.apply(this,arguments),ti){if(ti){var ge=$i;ti=!1,$i=null}else throw Error(t(198));k||(k=!0,R=ge)}}function M(s){var l=s,u=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(u=l.return),s=l.return;while(s)}return l.tag===3?u:null}function ce(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function we(s){if(M(s)!==s)throw Error(t(188))}function oe(s){var l=s.alternate;if(!l){if(l=M(s),l===null)throw Error(t(188));return l!==s?null:s}for(var u=s,m=l;;){var x=u.return;if(x===null)break;var w=x.alternate;if(w===null){if(m=x.return,m!==null){u=m;continue}break}if(x.child===w.child){for(w=x.child;w;){if(w===u)return we(x),s;if(w===m)return we(x),l;w=w.sibling}throw Error(t(188))}if(u.return!==m.return)u=x,m=w;else{for(var E=!1,U=x.child;U;){if(U===u){E=!0,u=x,m=w;break}if(U===m){E=!0,m=x,u=w;break}U=U.sibling}if(!E){for(U=w.child;U;){if(U===u){E=!0,u=w,m=x;break}if(U===m){E=!0,m=w,u=x;break}U=U.sibling}if(!E)throw Error(t(189))}}if(u.alternate!==m)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:l}function de(s){return s=oe(s),s!==null?he(s):null}function he(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var l=he(s);if(l!==null)return l;s=s.sibling}return null}var De=e.unstable_scheduleCallback,Ue=e.unstable_cancelCallback,He=e.unstable_shouldYield,Ie=e.unstable_requestPaint,Re=e.unstable_now,rt=e.unstable_getCurrentPriorityLevel,bt=e.unstable_ImmediatePriority,Nt=e.unstable_UserBlockingPriority,Ut=e.unstable_NormalPriority,mi=e.unstable_LowPriority,ri=e.unstable_IdlePriority,H=null,le=null;function Ee(s){if(le&&typeof le.onCommitFiberRoot=="function")try{le.onCommitFiberRoot(H,s,void 0,(s.current.flags&128)===128)}catch{}}var Se=Math.clz32?Math.clz32:ut,Ve=Math.log,tt=Math.LN2;function ut(s){return s>>>=0,s===0?32:31-(Ve(s)/tt|0)|0}var it=64,st=4194304;function pt(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Xt(s,l){var u=s.pendingLanes;if(u===0)return 0;var m=0,x=s.suspendedLanes,w=s.pingedLanes,E=u&268435455;if(E!==0){var U=E&~x;U!==0?m=pt(U):(w&=E,w!==0&&(m=pt(w)))}else E=u&~x,E!==0?m=pt(E):w!==0&&(m=pt(w));if(m===0)return 0;if(l!==0&&l!==m&&(l&x)===0&&(x=m&-m,w=l&-l,x>=w||x===16&&(w&4194240)!==0))return l;if((m&4)!==0&&(m|=u&16),l=s.entangledLanes,l!==0)for(s=s.entanglements,l&=m;0<l;)u=31-Se(l),x=1<<u,m|=s[u],l&=~x;return m}function Yt(s,l){switch(s){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _n(s,l){for(var u=s.suspendedLanes,m=s.pingedLanes,x=s.expirationTimes,w=s.pendingLanes;0<w;){var E=31-Se(w),U=1<<E,Y=x[E];Y===-1?((U&u)===0||(U&m)!==0)&&(x[E]=Yt(U,l)):Y<=l&&(s.expiredLanes|=U),w&=~U}}function ht(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Je(){var s=it;return it<<=1,(it&4194240)===0&&(it=64),s}function ir(s){for(var l=[],u=0;31>u;u++)l.push(s);return l}function gi(s,l,u){s.pendingLanes|=l,l!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,l=31-Se(l),s[l]=u}function da(s,l){var u=s.pendingLanes&~l;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=l,s.mutableReadLanes&=l,s.entangledLanes&=l,l=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<u;){var x=31-Se(u),w=1<<x;l[x]=0,m[x]=-1,s[x]=-1,u&=~w}}function sr(s,l){var u=s.entangledLanes|=l;for(s=s.entanglements;u;){var m=31-Se(u),x=1<<m;x&l|s[m]&l&&(s[m]|=l),u&=~x}}var lt=0;function vo(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var fa,xi,Wi,ha,yo,ld=!1,Gl=[],Hi=null,Vi=null,Gi=null,_o=new Map,wo=new Map,Ki=[],Xy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function E0(s,l){switch(s){case"focusin":case"focusout":Hi=null;break;case"dragenter":case"dragleave":Vi=null;break;case"mouseover":case"mouseout":Gi=null;break;case"pointerover":case"pointerout":_o.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":wo.delete(l.pointerId)}}function bo(s,l,u,m,x,w){return s===null||s.nativeEvent!==w?(s={blockedOn:l,domEventName:u,eventSystemFlags:m,nativeEvent:w,targetContainers:[x]},l!==null&&(l=Io(l),l!==null&&xi(l)),s):(s.eventSystemFlags|=m,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function Yy(s,l,u,m,x){switch(l){case"focusin":return Hi=bo(Hi,s,l,u,m,x),!0;case"dragenter":return Vi=bo(Vi,s,l,u,m,x),!0;case"mouseover":return Gi=bo(Gi,s,l,u,m,x),!0;case"pointerover":var w=x.pointerId;return _o.set(w,bo(_o.get(w)||null,s,l,u,m,x)),!0;case"gotpointercapture":return w=x.pointerId,wo.set(w,bo(wo.get(w)||null,s,l,u,m,x)),!0}return!1}function k0(s){var l=ks(s.target);if(l!==null){var u=M(l);if(u!==null){if(l=u.tag,l===13){if(l=ce(u),l!==null){s.blockedOn=l,yo(s.priority,function(){Wi(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Kl(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var u=ud(s.domEventName,s.eventSystemFlags,l[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var m=new u.constructor(u.type,u);Ui=m,u.target.dispatchEvent(m),Ui=null}else return l=Io(u),l!==null&&xi(l),s.blockedOn=u,!1;l.shift()}return!0}function T0(s,l,u){Kl(s)&&u.delete(l)}function Jy(){ld=!1,Hi!==null&&Kl(Hi)&&(Hi=null),Vi!==null&&Kl(Vi)&&(Vi=null),Gi!==null&&Kl(Gi)&&(Gi=null),_o.forEach(T0),wo.forEach(T0)}function So(s,l){s.blockedOn===l&&(s.blockedOn=null,ld||(ld=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Jy)))}function Eo(s){function l(x){return So(x,s)}if(0<Gl.length){So(Gl[0],s);for(var u=1;u<Gl.length;u++){var m=Gl[u];m.blockedOn===s&&(m.blockedOn=null)}}for(Hi!==null&&So(Hi,s),Vi!==null&&So(Vi,s),Gi!==null&&So(Gi,s),_o.forEach(l),wo.forEach(l),u=0;u<Ki.length;u++)m=Ki[u],m.blockedOn===s&&(m.blockedOn=null);for(;0<Ki.length&&(u=Ki[0],u.blockedOn===null);)k0(u),u.blockedOn===null&&Ki.shift()}var pa=P.ReactCurrentBatchConfig,ql=!0;function Qy(s,l,u,m){var x=lt,w=pa.transition;pa.transition=null;try{lt=1,cd(s,l,u,m)}finally{lt=x,pa.transition=w}}function Zy(s,l,u,m){var x=lt,w=pa.transition;pa.transition=null;try{lt=4,cd(s,l,u,m)}finally{lt=x,pa.transition=w}}function cd(s,l,u,m){if(ql){var x=ud(s,l,u,m);if(x===null)Ad(s,l,m,Xl,u),E0(s,m);else if(Yy(x,s,l,u,m))m.stopPropagation();else if(E0(s,m),l&4&&-1<Xy.indexOf(s)){for(;x!==null;){var w=Io(x);if(w!==null&&fa(w),w=ud(s,l,u,m),w===null&&Ad(s,l,m,Xl,u),w===x)break;x=w}x!==null&&m.stopPropagation()}else Ad(s,l,m,null,u)}}var Xl=null;function ud(s,l,u,m){if(Xl=null,s=On(m),s=ks(s),s!==null)if(l=M(s),l===null)s=null;else if(u=l.tag,u===13){if(s=ce(l),s!==null)return s;s=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null);return Xl=s,null}function A0(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rt()){case bt:return 1;case Nt:return 4;case Ut:case mi:return 16;case ri:return 536870912;default:return 16}default:return 16}}var qi=null,dd=null,Yl=null;function C0(){if(Yl)return Yl;var s,l=dd,u=l.length,m,x="value"in qi?qi.value:qi.textContent,w=x.length;for(s=0;s<u&&l[s]===x[s];s++);var E=u-s;for(m=1;m<=E&&l[u-m]===x[w-m];m++);return Yl=x.slice(s,1<m?1-m:void 0)}function Jl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Ql(){return!0}function N0(){return!1}function sn(s){function l(u,m,x,w,E){this._reactName=u,this._targetInst=x,this.type=m,this.nativeEvent=w,this.target=E,this.currentTarget=null;for(var U in s)s.hasOwnProperty(U)&&(u=s[U],this[U]=u?u(w):w[U]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ql:N0,this.isPropagationStopped=N0,this}return me(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ql)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ql)},persist:function(){},isPersistent:Ql}),l}var ma={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fd=sn(ma),ko=me({},ma,{view:0,detail:0}),e_=sn(ko),hd,pd,To,Zl=me({},ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==To&&(To&&s.type==="mousemove"?(hd=s.screenX-To.screenX,pd=s.screenY-To.screenY):pd=hd=0,To=s),hd)},movementY:function(s){return"movementY"in s?s.movementY:pd}}),F0=sn(Zl),t_=me({},Zl,{dataTransfer:0}),r_=sn(t_),n_=me({},ko,{relatedTarget:0}),md=sn(n_),i_=me({},ma,{animationName:0,elapsedTime:0,pseudoElement:0}),s_=sn(i_),a_=me({},ma,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),o_=sn(a_),l_=me({},ma,{data:0}),j0=sn(l_),c_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},u_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},d_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function f_(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=d_[s])?!!l[s]:!1}function gd(){return f_}var h_=me({},ko,{key:function(s){if(s.key){var l=c_[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Jl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?u_[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gd,charCode:function(s){return s.type==="keypress"?Jl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Jl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),p_=sn(h_),m_=me({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D0=sn(m_),g_=me({},ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gd}),x_=sn(g_),v_=me({},ma,{propertyName:0,elapsedTime:0,pseudoElement:0}),y_=sn(v_),__=me({},Zl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),w_=sn(__),b_=[9,13,27,32],xd=c&&"CompositionEvent"in window,Ao=null;c&&"documentMode"in document&&(Ao=document.documentMode);var S_=c&&"TextEvent"in window&&!Ao,O0=c&&(!xd||Ao&&8<Ao&&11>=Ao),P0=" ",R0=!1;function I0(s,l){switch(s){case"keyup":return b_.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function L0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ga=!1;function E_(s,l){switch(s){case"compositionend":return L0(l);case"keypress":return l.which!==32?null:(R0=!0,P0);case"textInput":return s=l.data,s===P0&&R0?null:s;default:return null}}function k_(s,l){if(ga)return s==="compositionend"||!xd&&I0(s,l)?(s=C0(),Yl=dd=qi=null,ga=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return O0&&l.locale!=="ko"?null:l.data;default:return null}}var T_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function M0(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!T_[s.type]:l==="textarea"}function B0(s,l,u,m){Rn(m),l=ic(l,"onChange"),0<l.length&&(u=new fd("onChange","change",null,u,m),s.push({event:u,listeners:l}))}var Co=null,No=null;function A_(s){np(s,0)}function ec(s){var l=wa(s);if(pe(l))return s}function C_(s,l){if(s==="change")return l}var U0=!1;if(c){var vd;if(c){var yd="oninput"in document;if(!yd){var z0=document.createElement("div");z0.setAttribute("oninput","return;"),yd=typeof z0.oninput=="function"}vd=yd}else vd=!1;U0=vd&&(!document.documentMode||9<document.documentMode)}function $0(){Co&&(Co.detachEvent("onpropertychange",W0),No=Co=null)}function W0(s){if(s.propertyName==="value"&&ec(No)){var l=[];B0(l,No,s,On(s)),Ln(A_,l)}}function N_(s,l,u){s==="focusin"?($0(),Co=l,No=u,Co.attachEvent("onpropertychange",W0)):s==="focusout"&&$0()}function F_(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return ec(No)}function j_(s,l){if(s==="click")return ec(l)}function D_(s,l){if(s==="input"||s==="change")return ec(l)}function O_(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Un=typeof Object.is=="function"?Object.is:O_;function Fo(s,l){if(Un(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var u=Object.keys(s),m=Object.keys(l);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var x=u[m];if(!d.call(l,x)||!Un(s[x],l[x]))return!1}return!0}function H0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function V0(s,l){var u=H0(s);s=0;for(var m;u;){if(u.nodeType===3){if(m=s+u.textContent.length,s<=l&&m>=l)return{node:u,offset:l-s};s=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=H0(u)}}function G0(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?G0(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function K0(){for(var s=window,l=Ce();l instanceof s.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)s=l.contentWindow;else break;l=Ce(s.document)}return l}function _d(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}function P_(s){var l=K0(),u=s.focusedElem,m=s.selectionRange;if(l!==u&&u&&u.ownerDocument&&G0(u.ownerDocument.documentElement,u)){if(m!==null&&_d(u)){if(l=m.start,s=m.end,s===void 0&&(s=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(s,u.value.length);else if(s=(l=u.ownerDocument||document)&&l.defaultView||window,s.getSelection){s=s.getSelection();var x=u.textContent.length,w=Math.min(m.start,x);m=m.end===void 0?w:Math.min(m.end,x),!s.extend&&w>m&&(x=m,m=w,w=x),x=V0(u,w);var E=V0(u,m);x&&E&&(s.rangeCount!==1||s.anchorNode!==x.node||s.anchorOffset!==x.offset||s.focusNode!==E.node||s.focusOffset!==E.offset)&&(l=l.createRange(),l.setStart(x.node,x.offset),s.removeAllRanges(),w>m?(s.addRange(l),s.extend(E.node,E.offset)):(l.setEnd(E.node,E.offset),s.addRange(l)))}}for(l=[],s=u;s=s.parentNode;)s.nodeType===1&&l.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)s=l[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var R_=c&&"documentMode"in document&&11>=document.documentMode,xa=null,wd=null,jo=null,bd=!1;function q0(s,l,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;bd||xa==null||xa!==Ce(m)||(m=xa,"selectionStart"in m&&_d(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),jo&&Fo(jo,m)||(jo=m,m=ic(wd,"onSelect"),0<m.length&&(l=new fd("onSelect","select",null,l,u),s.push({event:l,listeners:m}),l.target=xa)))}function tc(s,l){var u={};return u[s.toLowerCase()]=l.toLowerCase(),u["Webkit"+s]="webkit"+l,u["Moz"+s]="moz"+l,u}var va={animationend:tc("Animation","AnimationEnd"),animationiteration:tc("Animation","AnimationIteration"),animationstart:tc("Animation","AnimationStart"),transitionend:tc("Transition","TransitionEnd")},Sd={},X0={};c&&(X0=document.createElement("div").style,"AnimationEvent"in window||(delete va.animationend.animation,delete va.animationiteration.animation,delete va.animationstart.animation),"TransitionEvent"in window||delete va.transitionend.transition);function rc(s){if(Sd[s])return Sd[s];if(!va[s])return s;var l=va[s],u;for(u in l)if(l.hasOwnProperty(u)&&u in X0)return Sd[s]=l[u];return s}var Y0=rc("animationend"),J0=rc("animationiteration"),Q0=rc("animationstart"),Z0=rc("transitionend"),ep=new Map,tp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xi(s,l){ep.set(s,l),a(l,[s])}for(var Ed=0;Ed<tp.length;Ed++){var kd=tp[Ed],I_=kd.toLowerCase(),L_=kd[0].toUpperCase()+kd.slice(1);Xi(I_,"on"+L_)}Xi(Y0,"onAnimationEnd"),Xi(J0,"onAnimationIteration"),Xi(Q0,"onAnimationStart"),Xi("dblclick","onDoubleClick"),Xi("focusin","onFocus"),Xi("focusout","onBlur"),Xi(Z0,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Do="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Do));function rp(s,l,u){var m=s.type||"unknown-event";s.currentTarget=u,I(m,l,void 0,s),s.currentTarget=null}function np(s,l){l=(l&4)!==0;for(var u=0;u<s.length;u++){var m=s[u],x=m.event;m=m.listeners;e:{var w=void 0;if(l)for(var E=m.length-1;0<=E;E--){var U=m[E],Y=U.instance,ge=U.currentTarget;if(U=U.listener,Y!==w&&x.isPropagationStopped())break e;rp(x,U,ge),w=Y}else for(E=0;E<m.length;E++){if(U=m[E],Y=U.instance,ge=U.currentTarget,U=U.listener,Y!==w&&x.isPropagationStopped())break e;rp(x,U,ge),w=Y}}}if(k)throw s=R,k=!1,R=null,s}function Pt(s,l){var u=l[Od];u===void 0&&(u=l[Od]=new Set);var m=s+"__bubble";u.has(m)||(ip(l,s,2,!1),u.add(m))}function Td(s,l,u){var m=0;l&&(m|=4),ip(u,s,m,l)}var nc="_reactListening"+Math.random().toString(36).slice(2);function Oo(s){if(!s[nc]){s[nc]=!0,n.forEach(function(u){u!=="selectionchange"&&(M_.has(u)||Td(u,!1,s),Td(u,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[nc]||(l[nc]=!0,Td("selectionchange",!1,l))}}function ip(s,l,u,m){switch(A0(l)){case 1:var x=Qy;break;case 4:x=Zy;break;default:x=cd}u=x.bind(null,l,u,s),x=void 0,!Mn||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),m?x!==void 0?s.addEventListener(l,u,{capture:!0,passive:x}):s.addEventListener(l,u,!0):x!==void 0?s.addEventListener(l,u,{passive:x}):s.addEventListener(l,u,!1)}function Ad(s,l,u,m,x){var w=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var E=m.tag;if(E===3||E===4){var U=m.stateNode.containerInfo;if(U===x||U.nodeType===8&&U.parentNode===x)break;if(E===4)for(E=m.return;E!==null;){var Y=E.tag;if((Y===3||Y===4)&&(Y=E.stateNode.containerInfo,Y===x||Y.nodeType===8&&Y.parentNode===x))return;E=E.return}for(;U!==null;){if(E=ks(U),E===null)return;if(Y=E.tag,Y===5||Y===6){m=w=E;continue e}U=U.parentNode}}m=m.return}Ln(function(){var ge=w,Ne=On(u),Pe=[];e:{var Ae=ep.get(s);if(Ae!==void 0){var Ge=fd,qe=s;switch(s){case"keypress":if(Jl(u)===0)break e;case"keydown":case"keyup":Ge=p_;break;case"focusin":qe="focus",Ge=md;break;case"focusout":qe="blur",Ge=md;break;case"beforeblur":case"afterblur":Ge=md;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=F0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=r_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=x_;break;case Y0:case J0:case Q0:Ge=s_;break;case Z0:Ge=y_;break;case"scroll":Ge=e_;break;case"wheel":Ge=w_;break;case"copy":case"cut":case"paste":Ge=o_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=D0}var Xe=(l&4)!==0,Jt=!Xe&&s==="scroll",ae=Xe?Ae!==null?Ae+"Capture":null:Ae;Xe=[];for(var Q=ge,ue;Q!==null;){ue=Q;var Le=ue.stateNode;if(ue.tag===5&&Le!==null&&(ue=Le,ae!==null&&(Le=yn(Q,ae),Le!=null&&Xe.push(Po(Q,Le,ue)))),Jt)break;Q=Q.return}0<Xe.length&&(Ae=new Ge(Ae,qe,null,u,Ne),Pe.push({event:Ae,listeners:Xe}))}}if((l&7)===0){e:{if(Ae=s==="mouseover"||s==="pointerover",Ge=s==="mouseout"||s==="pointerout",Ae&&u!==Ui&&(qe=u.relatedTarget||u.fromElement)&&(ks(qe)||qe[vi]))break e;if((Ge||Ae)&&(Ae=Ne.window===Ne?Ne:(Ae=Ne.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,Ge?(qe=u.relatedTarget||u.toElement,Ge=ge,qe=qe?ks(qe):null,qe!==null&&(Jt=M(qe),qe!==Jt||qe.tag!==5&&qe.tag!==6)&&(qe=null)):(Ge=null,qe=ge),Ge!==qe)){if(Xe=F0,Le="onMouseLeave",ae="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(Xe=D0,Le="onPointerLeave",ae="onPointerEnter",Q="pointer"),Jt=Ge==null?Ae:wa(Ge),ue=qe==null?Ae:wa(qe),Ae=new Xe(Le,Q+"leave",Ge,u,Ne),Ae.target=Jt,Ae.relatedTarget=ue,Le=null,ks(Ne)===ge&&(Xe=new Xe(ae,Q+"enter",qe,u,Ne),Xe.target=ue,Xe.relatedTarget=Jt,Le=Xe),Jt=Le,Ge&&qe)t:{for(Xe=Ge,ae=qe,Q=0,ue=Xe;ue;ue=ya(ue))Q++;for(ue=0,Le=ae;Le;Le=ya(Le))ue++;for(;0<Q-ue;)Xe=ya(Xe),Q--;for(;0<ue-Q;)ae=ya(ae),ue--;for(;Q--;){if(Xe===ae||ae!==null&&Xe===ae.alternate)break t;Xe=ya(Xe),ae=ya(ae)}Xe=null}else Xe=null;Ge!==null&&sp(Pe,Ae,Ge,Xe,!1),qe!==null&&Jt!==null&&sp(Pe,Jt,qe,Xe,!0)}}e:{if(Ae=ge?wa(ge):window,Ge=Ae.nodeName&&Ae.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&Ae.type==="file")var Ye=C_;else if(M0(Ae))if(U0)Ye=D_;else{Ye=F_;var Qe=N_}else(Ge=Ae.nodeName)&&Ge.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(Ye=j_);if(Ye&&(Ye=Ye(s,ge))){B0(Pe,Ye,u,Ne);break e}Qe&&Qe(s,Ae,ge),s==="focusout"&&(Qe=Ae._wrapperState)&&Qe.controlled&&Ae.type==="number"&&Bt(Ae,"number",Ae.value)}switch(Qe=ge?wa(ge):window,s){case"focusin":(M0(Qe)||Qe.contentEditable==="true")&&(xa=Qe,wd=ge,jo=null);break;case"focusout":jo=wd=xa=null;break;case"mousedown":bd=!0;break;case"contextmenu":case"mouseup":case"dragend":bd=!1,q0(Pe,u,Ne);break;case"selectionchange":if(R_)break;case"keydown":case"keyup":q0(Pe,u,Ne)}var Ze;if(xd)e:{switch(s){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else ga?I0(s,u)&&(nt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(nt="onCompositionStart");nt&&(O0&&u.locale!=="ko"&&(ga||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&ga&&(Ze=C0()):(qi=Ne,dd="value"in qi?qi.value:qi.textContent,ga=!0)),Qe=ic(ge,nt),0<Qe.length&&(nt=new j0(nt,s,null,u,Ne),Pe.push({event:nt,listeners:Qe}),Ze?nt.data=Ze:(Ze=L0(u),Ze!==null&&(nt.data=Ze)))),(Ze=S_?E_(s,u):k_(s,u))&&(ge=ic(ge,"onBeforeInput"),0<ge.length&&(Ne=new j0("onBeforeInput","beforeinput",null,u,Ne),Pe.push({event:Ne,listeners:ge}),Ne.data=Ze))}np(Pe,l)})}function Po(s,l,u){return{instance:s,listener:l,currentTarget:u}}function ic(s,l){for(var u=l+"Capture",m=[];s!==null;){var x=s,w=x.stateNode;x.tag===5&&w!==null&&(x=w,w=yn(s,u),w!=null&&m.unshift(Po(s,w,x)),w=yn(s,l),w!=null&&m.push(Po(s,w,x))),s=s.return}return m}function ya(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function sp(s,l,u,m,x){for(var w=l._reactName,E=[];u!==null&&u!==m;){var U=u,Y=U.alternate,ge=U.stateNode;if(Y!==null&&Y===m)break;U.tag===5&&ge!==null&&(U=ge,x?(Y=yn(u,w),Y!=null&&E.unshift(Po(u,Y,U))):x||(Y=yn(u,w),Y!=null&&E.push(Po(u,Y,U)))),u=u.return}E.length!==0&&s.push({event:l,listeners:E})}var B_=/\r\n?/g,U_=/\u0000|\uFFFD/g;function ap(s){return(typeof s=="string"?s:""+s).replace(B_,`
`).replace(U_,"")}function sc(s,l,u){if(l=ap(l),ap(s)!==l&&u)throw Error(t(425))}function ac(){}var Cd=null,Nd=null;function Fd(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var jd=typeof setTimeout=="function"?setTimeout:void 0,z_=typeof clearTimeout=="function"?clearTimeout:void 0,op=typeof Promise=="function"?Promise:void 0,$_=typeof queueMicrotask=="function"?queueMicrotask:typeof op<"u"?function(s){return op.resolve(null).then(s).catch(W_)}:jd;function W_(s){setTimeout(function(){throw s})}function Dd(s,l){var u=l,m=0;do{var x=u.nextSibling;if(s.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"){if(m===0){s.removeChild(x),Eo(l);return}m--}else u!=="$"&&u!=="$?"&&u!=="$!"||m++;u=x}while(u);Eo(l)}function Yi(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return s}function lp(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return s;l--}else u==="/$"&&l++}s=s.previousSibling}return null}var _a=Math.random().toString(36).slice(2),ni="__reactFiber$"+_a,Ro="__reactProps$"+_a,vi="__reactContainer$"+_a,Od="__reactEvents$"+_a,H_="__reactListeners$"+_a,V_="__reactHandles$"+_a;function ks(s){var l=s[ni];if(l)return l;for(var u=s.parentNode;u;){if(l=u[vi]||u[ni]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(s=lp(s);s!==null;){if(u=s[ni])return u;s=lp(s)}return l}s=u,u=s.parentNode}return null}function Io(s){return s=s[ni]||s[vi],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function wa(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function oc(s){return s[Ro]||null}var Pd=[],ba=-1;function Ji(s){return{current:s}}function Rt(s){0>ba||(s.current=Pd[ba],Pd[ba]=null,ba--)}function Dt(s,l){ba++,Pd[ba]=s.current,s.current=l}var Qi={},jr=Ji(Qi),Vr=Ji(!1),Ts=Qi;function Sa(s,l){var u=s.type.contextTypes;if(!u)return Qi;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var x={},w;for(w in u)x[w]=l[w];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=l,s.__reactInternalMemoizedMaskedChildContext=x),x}function Gr(s){return s=s.childContextTypes,s!=null}function lc(){Rt(Vr),Rt(jr)}function cp(s,l,u){if(jr.current!==Qi)throw Error(t(168));Dt(jr,l),Dt(Vr,u)}function up(s,l,u){var m=s.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return u;m=m.getChildContext();for(var x in m)if(!(x in l))throw Error(t(108,be(s)||"Unknown",x));return me({},u,m)}function cc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Qi,Ts=jr.current,Dt(jr,s),Dt(Vr,Vr.current),!0}function dp(s,l,u){var m=s.stateNode;if(!m)throw Error(t(169));u?(s=up(s,l,Ts),m.__reactInternalMemoizedMergedChildContext=s,Rt(Vr),Rt(jr),Dt(jr,s)):Rt(Vr),Dt(Vr,u)}var yi=null,uc=!1,Rd=!1;function fp(s){yi===null?yi=[s]:yi.push(s)}function G_(s){uc=!0,fp(s)}function Zi(){if(!Rd&&yi!==null){Rd=!0;var s=0,l=lt;try{var u=yi;for(lt=1;s<u.length;s++){var m=u[s];do m=m(!0);while(m!==null)}yi=null,uc=!1}catch(x){throw yi!==null&&(yi=yi.slice(s+1)),De(bt,Zi),x}finally{lt=l,Rd=!1}}return null}var Ea=[],ka=0,dc=null,fc=0,wn=[],bn=0,As=null,_i=1,wi="";function Cs(s,l){Ea[ka++]=fc,Ea[ka++]=dc,dc=s,fc=l}function hp(s,l,u){wn[bn++]=_i,wn[bn++]=wi,wn[bn++]=As,As=s;var m=_i;s=wi;var x=32-Se(m)-1;m&=~(1<<x),u+=1;var w=32-Se(l)+x;if(30<w){var E=x-x%5;w=(m&(1<<E)-1).toString(32),m>>=E,x-=E,_i=1<<32-Se(l)+x|u<<x|m,wi=w+s}else _i=1<<w|u<<x|m,wi=s}function Id(s){s.return!==null&&(Cs(s,1),hp(s,1,0))}function Ld(s){for(;s===dc;)dc=Ea[--ka],Ea[ka]=null,fc=Ea[--ka],Ea[ka]=null;for(;s===As;)As=wn[--bn],wn[bn]=null,wi=wn[--bn],wn[bn]=null,_i=wn[--bn],wn[bn]=null}var an=null,on=null,zt=!1,zn=null;function pp(s,l){var u=Tn(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=s,l=s.deletions,l===null?(s.deletions=[u],s.flags|=16):l.push(u)}function mp(s,l){switch(s.tag){case 5:var u=s.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(s.stateNode=l,an=s,on=Yi(l.firstChild),!0):!1;case 6:return l=s.pendingProps===""||l.nodeType!==3?null:l,l!==null?(s.stateNode=l,an=s,on=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=As!==null?{id:_i,overflow:wi}:null,s.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=Tn(18,null,null,0),u.stateNode=l,u.return=s,s.child=u,an=s,on=null,!0):!1;default:return!1}}function Md(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Bd(s){if(zt){var l=on;if(l){var u=l;if(!mp(s,l)){if(Md(s))throw Error(t(418));l=Yi(u.nextSibling);var m=an;l&&mp(s,l)?pp(m,u):(s.flags=s.flags&-4097|2,zt=!1,an=s)}}else{if(Md(s))throw Error(t(418));s.flags=s.flags&-4097|2,zt=!1,an=s}}}function gp(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;an=s}function hc(s){if(s!==an)return!1;if(!zt)return gp(s),zt=!0,!1;var l;if((l=s.tag!==3)&&!(l=s.tag!==5)&&(l=s.type,l=l!=="head"&&l!=="body"&&!Fd(s.type,s.memoizedProps)),l&&(l=on)){if(Md(s))throw xp(),Error(t(418));for(;l;)pp(s,l),l=Yi(l.nextSibling)}if(gp(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(l===0){on=Yi(s.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}s=s.nextSibling}on=null}}else on=an?Yi(s.stateNode.nextSibling):null;return!0}function xp(){for(var s=on;s;)s=Yi(s.nextSibling)}function Ta(){on=an=null,zt=!1}function Ud(s){zn===null?zn=[s]:zn.push(s)}var K_=P.ReactCurrentBatchConfig;function Lo(s,l,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var m=u.stateNode}if(!m)throw Error(t(147,s));var x=m,w=""+s;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===w?l.ref:(l=function(E){var U=x.refs;E===null?delete U[w]:U[w]=E},l._stringRef=w,l)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function pc(s,l){throw s=Object.prototype.toString.call(l),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s))}function vp(s){var l=s._init;return l(s._payload)}function yp(s){function l(ae,Q){if(s){var ue=ae.deletions;ue===null?(ae.deletions=[Q],ae.flags|=16):ue.push(Q)}}function u(ae,Q){if(!s)return null;for(;Q!==null;)l(ae,Q),Q=Q.sibling;return null}function m(ae,Q){for(ae=new Map;Q!==null;)Q.key!==null?ae.set(Q.key,Q):ae.set(Q.index,Q),Q=Q.sibling;return ae}function x(ae,Q){return ae=os(ae,Q),ae.index=0,ae.sibling=null,ae}function w(ae,Q,ue){return ae.index=ue,s?(ue=ae.alternate,ue!==null?(ue=ue.index,ue<Q?(ae.flags|=2,Q):ue):(ae.flags|=2,Q)):(ae.flags|=1048576,Q)}function E(ae){return s&&ae.alternate===null&&(ae.flags|=2),ae}function U(ae,Q,ue,Le){return Q===null||Q.tag!==6?(Q=Df(ue,ae.mode,Le),Q.return=ae,Q):(Q=x(Q,ue),Q.return=ae,Q)}function Y(ae,Q,ue,Le){var Ye=ue.type;return Ye===L?Ne(ae,Q,ue.props.children,Le,ue.key):Q!==null&&(Q.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===Oe&&vp(Ye)===Q.type)?(Le=x(Q,ue.props),Le.ref=Lo(ae,Q,ue),Le.return=ae,Le):(Le=Mc(ue.type,ue.key,ue.props,null,ae.mode,Le),Le.ref=Lo(ae,Q,ue),Le.return=ae,Le)}function ge(ae,Q,ue,Le){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ue.containerInfo||Q.stateNode.implementation!==ue.implementation?(Q=Of(ue,ae.mode,Le),Q.return=ae,Q):(Q=x(Q,ue.children||[]),Q.return=ae,Q)}function Ne(ae,Q,ue,Le,Ye){return Q===null||Q.tag!==7?(Q=Is(ue,ae.mode,Le,Ye),Q.return=ae,Q):(Q=x(Q,ue),Q.return=ae,Q)}function Pe(ae,Q,ue){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Df(""+Q,ae.mode,ue),Q.return=ae,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case z:return ue=Mc(Q.type,Q.key,Q.props,null,ae.mode,ue),ue.ref=Lo(ae,null,Q),ue.return=ae,ue;case G:return Q=Of(Q,ae.mode,ue),Q.return=ae,Q;case Oe:var Le=Q._init;return Pe(ae,Le(Q._payload),ue)}if(Ht(Q)||xe(Q))return Q=Is(Q,ae.mode,ue,null),Q.return=ae,Q;pc(ae,Q)}return null}function Ae(ae,Q,ue,Le){var Ye=Q!==null?Q.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return Ye!==null?null:U(ae,Q,""+ue,Le);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case z:return ue.key===Ye?Y(ae,Q,ue,Le):null;case G:return ue.key===Ye?ge(ae,Q,ue,Le):null;case Oe:return Ye=ue._init,Ae(ae,Q,Ye(ue._payload),Le)}if(Ht(ue)||xe(ue))return Ye!==null?null:Ne(ae,Q,ue,Le,null);pc(ae,ue)}return null}function Ge(ae,Q,ue,Le,Ye){if(typeof Le=="string"&&Le!==""||typeof Le=="number")return ae=ae.get(ue)||null,U(Q,ae,""+Le,Ye);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case z:return ae=ae.get(Le.key===null?ue:Le.key)||null,Y(Q,ae,Le,Ye);case G:return ae=ae.get(Le.key===null?ue:Le.key)||null,ge(Q,ae,Le,Ye);case Oe:var Qe=Le._init;return Ge(ae,Q,ue,Qe(Le._payload),Ye)}if(Ht(Le)||xe(Le))return ae=ae.get(ue)||null,Ne(Q,ae,Le,Ye,null);pc(Q,Le)}return null}function qe(ae,Q,ue,Le){for(var Ye=null,Qe=null,Ze=Q,nt=Q=0,mr=null;Ze!==null&&nt<ue.length;nt++){Ze.index>nt?(mr=Ze,Ze=null):mr=Ze.sibling;var xt=Ae(ae,Ze,ue[nt],Le);if(xt===null){Ze===null&&(Ze=mr);break}s&&Ze&&xt.alternate===null&&l(ae,Ze),Q=w(xt,Q,nt),Qe===null?Ye=xt:Qe.sibling=xt,Qe=xt,Ze=mr}if(nt===ue.length)return u(ae,Ze),zt&&Cs(ae,nt),Ye;if(Ze===null){for(;nt<ue.length;nt++)Ze=Pe(ae,ue[nt],Le),Ze!==null&&(Q=w(Ze,Q,nt),Qe===null?Ye=Ze:Qe.sibling=Ze,Qe=Ze);return zt&&Cs(ae,nt),Ye}for(Ze=m(ae,Ze);nt<ue.length;nt++)mr=Ge(Ze,ae,nt,ue[nt],Le),mr!==null&&(s&&mr.alternate!==null&&Ze.delete(mr.key===null?nt:mr.key),Q=w(mr,Q,nt),Qe===null?Ye=mr:Qe.sibling=mr,Qe=mr);return s&&Ze.forEach(function(ls){return l(ae,ls)}),zt&&Cs(ae,nt),Ye}function Xe(ae,Q,ue,Le){var Ye=xe(ue);if(typeof Ye!="function")throw Error(t(150));if(ue=Ye.call(ue),ue==null)throw Error(t(151));for(var Qe=Ye=null,Ze=Q,nt=Q=0,mr=null,xt=ue.next();Ze!==null&&!xt.done;nt++,xt=ue.next()){Ze.index>nt?(mr=Ze,Ze=null):mr=Ze.sibling;var ls=Ae(ae,Ze,xt.value,Le);if(ls===null){Ze===null&&(Ze=mr);break}s&&Ze&&ls.alternate===null&&l(ae,Ze),Q=w(ls,Q,nt),Qe===null?Ye=ls:Qe.sibling=ls,Qe=ls,Ze=mr}if(xt.done)return u(ae,Ze),zt&&Cs(ae,nt),Ye;if(Ze===null){for(;!xt.done;nt++,xt=ue.next())xt=Pe(ae,xt.value,Le),xt!==null&&(Q=w(xt,Q,nt),Qe===null?Ye=xt:Qe.sibling=xt,Qe=xt);return zt&&Cs(ae,nt),Ye}for(Ze=m(ae,Ze);!xt.done;nt++,xt=ue.next())xt=Ge(Ze,ae,nt,xt.value,Le),xt!==null&&(s&&xt.alternate!==null&&Ze.delete(xt.key===null?nt:xt.key),Q=w(xt,Q,nt),Qe===null?Ye=xt:Qe.sibling=xt,Qe=xt);return s&&Ze.forEach(function(Tw){return l(ae,Tw)}),zt&&Cs(ae,nt),Ye}function Jt(ae,Q,ue,Le){if(typeof ue=="object"&&ue!==null&&ue.type===L&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case z:e:{for(var Ye=ue.key,Qe=Q;Qe!==null;){if(Qe.key===Ye){if(Ye=ue.type,Ye===L){if(Qe.tag===7){u(ae,Qe.sibling),Q=x(Qe,ue.props.children),Q.return=ae,ae=Q;break e}}else if(Qe.elementType===Ye||typeof Ye=="object"&&Ye!==null&&Ye.$$typeof===Oe&&vp(Ye)===Qe.type){u(ae,Qe.sibling),Q=x(Qe,ue.props),Q.ref=Lo(ae,Qe,ue),Q.return=ae,ae=Q;break e}u(ae,Qe);break}else l(ae,Qe);Qe=Qe.sibling}ue.type===L?(Q=Is(ue.props.children,ae.mode,Le,ue.key),Q.return=ae,ae=Q):(Le=Mc(ue.type,ue.key,ue.props,null,ae.mode,Le),Le.ref=Lo(ae,Q,ue),Le.return=ae,ae=Le)}return E(ae);case G:e:{for(Qe=ue.key;Q!==null;){if(Q.key===Qe)if(Q.tag===4&&Q.stateNode.containerInfo===ue.containerInfo&&Q.stateNode.implementation===ue.implementation){u(ae,Q.sibling),Q=x(Q,ue.children||[]),Q.return=ae,ae=Q;break e}else{u(ae,Q);break}else l(ae,Q);Q=Q.sibling}Q=Of(ue,ae.mode,Le),Q.return=ae,ae=Q}return E(ae);case Oe:return Qe=ue._init,Jt(ae,Q,Qe(ue._payload),Le)}if(Ht(ue))return qe(ae,Q,ue,Le);if(xe(ue))return Xe(ae,Q,ue,Le);pc(ae,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,Q!==null&&Q.tag===6?(u(ae,Q.sibling),Q=x(Q,ue),Q.return=ae,ae=Q):(u(ae,Q),Q=Df(ue,ae.mode,Le),Q.return=ae,ae=Q),E(ae)):u(ae,Q)}return Jt}var Aa=yp(!0),_p=yp(!1),mc=Ji(null),gc=null,Ca=null,zd=null;function $d(){zd=Ca=gc=null}function Wd(s){var l=mc.current;Rt(mc),s._currentValue=l}function Hd(s,l,u){for(;s!==null;){var m=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),s===u)break;s=s.return}}function Na(s,l){gc=s,zd=Ca=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&l)!==0&&(Kr=!0),s.firstContext=null)}function Sn(s){var l=s._currentValue;if(zd!==s)if(s={context:s,memoizedValue:l,next:null},Ca===null){if(gc===null)throw Error(t(308));Ca=s,gc.dependencies={lanes:0,firstContext:s}}else Ca=Ca.next=s;return l}var Ns=null;function Vd(s){Ns===null?Ns=[s]:Ns.push(s)}function wp(s,l,u,m){var x=l.interleaved;return x===null?(u.next=u,Vd(l)):(u.next=x.next,x.next=u),l.interleaved=u,bi(s,m)}function bi(s,l){s.lanes|=l;var u=s.alternate;for(u!==null&&(u.lanes|=l),u=s,s=s.return;s!==null;)s.childLanes|=l,u=s.alternate,u!==null&&(u.childLanes|=l),u=s,s=s.return;return u.tag===3?u.stateNode:null}var es=!1;function Gd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bp(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Si(s,l){return{eventTime:s,lane:l,tag:0,payload:null,callback:null,next:null}}function ts(s,l,u){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,(mt&2)!==0){var x=m.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),m.pending=l,bi(s,u)}return x=m.interleaved,x===null?(l.next=l,Vd(m)):(l.next=x.next,x.next=l),m.interleaved=l,bi(s,u)}function xc(s,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var m=l.lanes;m&=s.pendingLanes,u|=m,l.lanes=u,sr(s,u)}}function Sp(s,l){var u=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var x=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var E={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};w===null?x=w=E:w=w.next=E,u=u.next}while(u!==null);w===null?x=w=l:w=w.next=l}else x=w=l;u={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:w,shared:m.shared,effects:m.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=l}function vc(s,l,u,m){var x=s.updateQueue;es=!1;var w=x.firstBaseUpdate,E=x.lastBaseUpdate,U=x.shared.pending;if(U!==null){x.shared.pending=null;var Y=U,ge=Y.next;Y.next=null,E===null?w=ge:E.next=ge,E=Y;var Ne=s.alternate;Ne!==null&&(Ne=Ne.updateQueue,U=Ne.lastBaseUpdate,U!==E&&(U===null?Ne.firstBaseUpdate=ge:U.next=ge,Ne.lastBaseUpdate=Y))}if(w!==null){var Pe=x.baseState;E=0,Ne=ge=Y=null,U=w;do{var Ae=U.lane,Ge=U.eventTime;if((m&Ae)===Ae){Ne!==null&&(Ne=Ne.next={eventTime:Ge,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var qe=s,Xe=U;switch(Ae=l,Ge=u,Xe.tag){case 1:if(qe=Xe.payload,typeof qe=="function"){Pe=qe.call(Ge,Pe,Ae);break e}Pe=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=Xe.payload,Ae=typeof qe=="function"?qe.call(Ge,Pe,Ae):qe,Ae==null)break e;Pe=me({},Pe,Ae);break e;case 2:es=!0}}U.callback!==null&&U.lane!==0&&(s.flags|=64,Ae=x.effects,Ae===null?x.effects=[U]:Ae.push(U))}else Ge={eventTime:Ge,lane:Ae,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Ne===null?(ge=Ne=Ge,Y=Pe):Ne=Ne.next=Ge,E|=Ae;if(U=U.next,U===null){if(U=x.shared.pending,U===null)break;Ae=U,U=Ae.next,Ae.next=null,x.lastBaseUpdate=Ae,x.shared.pending=null}}while(!0);if(Ne===null&&(Y=Pe),x.baseState=Y,x.firstBaseUpdate=ge,x.lastBaseUpdate=Ne,l=x.shared.interleaved,l!==null){x=l;do E|=x.lane,x=x.next;while(x!==l)}else w===null&&(x.shared.lanes=0);Ds|=E,s.lanes=E,s.memoizedState=Pe}}function Ep(s,l,u){if(s=l.effects,l.effects=null,s!==null)for(l=0;l<s.length;l++){var m=s[l],x=m.callback;if(x!==null){if(m.callback=null,m=u,typeof x!="function")throw Error(t(191,x));x.call(m)}}}var Mo={},ii=Ji(Mo),Bo=Ji(Mo),Uo=Ji(Mo);function Fs(s){if(s===Mo)throw Error(t(174));return s}function Kd(s,l){switch(Dt(Uo,l),Dt(Bo,s),Dt(ii,Mo),s=l.nodeType,s){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:nn(null,"");break;default:s=s===8?l.parentNode:l,l=s.namespaceURI||null,s=s.tagName,l=nn(l,s)}Rt(ii),Dt(ii,l)}function Fa(){Rt(ii),Rt(Bo),Rt(Uo)}function kp(s){Fs(Uo.current);var l=Fs(ii.current),u=nn(l,s.type);l!==u&&(Dt(Bo,s),Dt(ii,u))}function qd(s){Bo.current===s&&(Rt(ii),Rt(Bo))}var $t=Ji(0);function yc(s){for(var l=s;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Xd=[];function Yd(){for(var s=0;s<Xd.length;s++)Xd[s]._workInProgressVersionPrimary=null;Xd.length=0}var _c=P.ReactCurrentDispatcher,Jd=P.ReactCurrentBatchConfig,js=0,Wt=null,ar=null,hr=null,wc=!1,zo=!1,$o=0,q_=0;function Dr(){throw Error(t(321))}function Qd(s,l){if(l===null)return!1;for(var u=0;u<l.length&&u<s.length;u++)if(!Un(s[u],l[u]))return!1;return!0}function Zd(s,l,u,m,x,w){if(js=w,Wt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,_c.current=s===null||s.memoizedState===null?Q_:Z_,s=u(m,x),zo){w=0;do{if(zo=!1,$o=0,25<=w)throw Error(t(301));w+=1,hr=ar=null,l.updateQueue=null,_c.current=ew,s=u(m,x)}while(zo)}if(_c.current=Ec,l=ar!==null&&ar.next!==null,js=0,hr=ar=Wt=null,wc=!1,l)throw Error(t(300));return s}function ef(){var s=$o!==0;return $o=0,s}function si(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hr===null?Wt.memoizedState=hr=s:hr=hr.next=s,hr}function En(){if(ar===null){var s=Wt.alternate;s=s!==null?s.memoizedState:null}else s=ar.next;var l=hr===null?Wt.memoizedState:hr.next;if(l!==null)hr=l,ar=s;else{if(s===null)throw Error(t(310));ar=s,s={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},hr===null?Wt.memoizedState=hr=s:hr=hr.next=s}return hr}function Wo(s,l){return typeof l=="function"?l(s):l}function tf(s){var l=En(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=ar,x=m.baseQueue,w=u.pending;if(w!==null){if(x!==null){var E=x.next;x.next=w.next,w.next=E}m.baseQueue=x=w,u.pending=null}if(x!==null){w=x.next,m=m.baseState;var U=E=null,Y=null,ge=w;do{var Ne=ge.lane;if((js&Ne)===Ne)Y!==null&&(Y=Y.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),m=ge.hasEagerState?ge.eagerState:s(m,ge.action);else{var Pe={lane:Ne,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};Y===null?(U=Y=Pe,E=m):Y=Y.next=Pe,Wt.lanes|=Ne,Ds|=Ne}ge=ge.next}while(ge!==null&&ge!==w);Y===null?E=m:Y.next=U,Un(m,l.memoizedState)||(Kr=!0),l.memoizedState=m,l.baseState=E,l.baseQueue=Y,u.lastRenderedState=m}if(s=u.interleaved,s!==null){x=s;do w=x.lane,Wt.lanes|=w,Ds|=w,x=x.next;while(x!==s)}else x===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function rf(s){var l=En(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var m=u.dispatch,x=u.pending,w=l.memoizedState;if(x!==null){u.pending=null;var E=x=x.next;do w=s(w,E.action),E=E.next;while(E!==x);Un(w,l.memoizedState)||(Kr=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),u.lastRenderedState=w}return[w,m]}function Tp(){}function Ap(s,l){var u=Wt,m=En(),x=l(),w=!Un(m.memoizedState,x);if(w&&(m.memoizedState=x,Kr=!0),m=m.queue,nf(Fp.bind(null,u,m,s),[s]),m.getSnapshot!==l||w||hr!==null&&hr.memoizedState.tag&1){if(u.flags|=2048,Ho(9,Np.bind(null,u,m,x,l),void 0,null),pr===null)throw Error(t(349));(js&30)!==0||Cp(u,l,x)}return x}function Cp(s,l,u){s.flags|=16384,s={getSnapshot:l,value:u},l=Wt.updateQueue,l===null?(l={lastEffect:null,stores:null},Wt.updateQueue=l,l.stores=[s]):(u=l.stores,u===null?l.stores=[s]:u.push(s))}function Np(s,l,u,m){l.value=u,l.getSnapshot=m,jp(l)&&Dp(s)}function Fp(s,l,u){return u(function(){jp(l)&&Dp(s)})}function jp(s){var l=s.getSnapshot;s=s.value;try{var u=l();return!Un(s,u)}catch{return!0}}function Dp(s){var l=bi(s,1);l!==null&&Vn(l,s,1,-1)}function Op(s){var l=si();return typeof s=="function"&&(s=s()),l.memoizedState=l.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wo,lastRenderedState:s},l.queue=s,s=s.dispatch=J_.bind(null,Wt,s),[l.memoizedState,s]}function Ho(s,l,u,m){return s={tag:s,create:l,destroy:u,deps:m,next:null},l=Wt.updateQueue,l===null?(l={lastEffect:null,stores:null},Wt.updateQueue=l,l.lastEffect=s.next=s):(u=l.lastEffect,u===null?l.lastEffect=s.next=s:(m=u.next,u.next=s,s.next=m,l.lastEffect=s)),s}function Pp(){return En().memoizedState}function bc(s,l,u,m){var x=si();Wt.flags|=s,x.memoizedState=Ho(1|l,u,void 0,m===void 0?null:m)}function Sc(s,l,u,m){var x=En();m=m===void 0?null:m;var w=void 0;if(ar!==null){var E=ar.memoizedState;if(w=E.destroy,m!==null&&Qd(m,E.deps)){x.memoizedState=Ho(l,u,w,m);return}}Wt.flags|=s,x.memoizedState=Ho(1|l,u,w,m)}function Rp(s,l){return bc(8390656,8,s,l)}function nf(s,l){return Sc(2048,8,s,l)}function Ip(s,l){return Sc(4,2,s,l)}function Lp(s,l){return Sc(4,4,s,l)}function Mp(s,l){if(typeof l=="function")return s=s(),l(s),function(){l(null)};if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function Bp(s,l,u){return u=u!=null?u.concat([s]):null,Sc(4,4,Mp.bind(null,l,s),u)}function sf(){}function Up(s,l){var u=En();l=l===void 0?null:l;var m=u.memoizedState;return m!==null&&l!==null&&Qd(l,m[1])?m[0]:(u.memoizedState=[s,l],s)}function zp(s,l){var u=En();l=l===void 0?null:l;var m=u.memoizedState;return m!==null&&l!==null&&Qd(l,m[1])?m[0]:(s=s(),u.memoizedState=[s,l],s)}function $p(s,l,u){return(js&21)===0?(s.baseState&&(s.baseState=!1,Kr=!0),s.memoizedState=u):(Un(u,l)||(u=Je(),Wt.lanes|=u,Ds|=u,s.baseState=!0),l)}function X_(s,l){var u=lt;lt=u!==0&&4>u?u:4,s(!0);var m=Jd.transition;Jd.transition={};try{s(!1),l()}finally{lt=u,Jd.transition=m}}function Wp(){return En().memoizedState}function Y_(s,l,u){var m=ss(s);if(u={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null},Hp(s))Vp(l,u);else if(u=wp(s,l,u,m),u!==null){var x=Ur();Vn(u,s,m,x),Gp(u,l,m)}}function J_(s,l,u){var m=ss(s),x={lane:m,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hp(s))Vp(l,x);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var E=l.lastRenderedState,U=w(E,u);if(x.hasEagerState=!0,x.eagerState=U,Un(U,E)){var Y=l.interleaved;Y===null?(x.next=x,Vd(l)):(x.next=Y.next,Y.next=x),l.interleaved=x;return}}catch{}finally{}u=wp(s,l,x,m),u!==null&&(x=Ur(),Vn(u,s,m,x),Gp(u,l,m))}}function Hp(s){var l=s.alternate;return s===Wt||l!==null&&l===Wt}function Vp(s,l){zo=wc=!0;var u=s.pending;u===null?l.next=l:(l.next=u.next,u.next=l),s.pending=l}function Gp(s,l,u){if((u&4194240)!==0){var m=l.lanes;m&=s.pendingLanes,u|=m,l.lanes=u,sr(s,u)}}var Ec={readContext:Sn,useCallback:Dr,useContext:Dr,useEffect:Dr,useImperativeHandle:Dr,useInsertionEffect:Dr,useLayoutEffect:Dr,useMemo:Dr,useReducer:Dr,useRef:Dr,useState:Dr,useDebugValue:Dr,useDeferredValue:Dr,useTransition:Dr,useMutableSource:Dr,useSyncExternalStore:Dr,useId:Dr,unstable_isNewReconciler:!1},Q_={readContext:Sn,useCallback:function(s,l){return si().memoizedState=[s,l===void 0?null:l],s},useContext:Sn,useEffect:Rp,useImperativeHandle:function(s,l,u){return u=u!=null?u.concat([s]):null,bc(4194308,4,Mp.bind(null,l,s),u)},useLayoutEffect:function(s,l){return bc(4194308,4,s,l)},useInsertionEffect:function(s,l){return bc(4,2,s,l)},useMemo:function(s,l){var u=si();return l=l===void 0?null:l,s=s(),u.memoizedState=[s,l],s},useReducer:function(s,l,u){var m=si();return l=u!==void 0?u(l):l,m.memoizedState=m.baseState=l,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:l},m.queue=s,s=s.dispatch=Y_.bind(null,Wt,s),[m.memoizedState,s]},useRef:function(s){var l=si();return s={current:s},l.memoizedState=s},useState:Op,useDebugValue:sf,useDeferredValue:function(s){return si().memoizedState=s},useTransition:function(){var s=Op(!1),l=s[0];return s=X_.bind(null,s[1]),si().memoizedState=s,[l,s]},useMutableSource:function(){},useSyncExternalStore:function(s,l,u){var m=Wt,x=si();if(zt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=l(),pr===null)throw Error(t(349));(js&30)!==0||Cp(m,l,u)}x.memoizedState=u;var w={value:u,getSnapshot:l};return x.queue=w,Rp(Fp.bind(null,m,w,s),[s]),m.flags|=2048,Ho(9,Np.bind(null,m,w,u,l),void 0,null),u},useId:function(){var s=si(),l=pr.identifierPrefix;if(zt){var u=wi,m=_i;u=(m&~(1<<32-Se(m)-1)).toString(32)+u,l=":"+l+"R"+u,u=$o++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=q_++,l=":"+l+"r"+u.toString(32)+":";return s.memoizedState=l},unstable_isNewReconciler:!1},Z_={readContext:Sn,useCallback:Up,useContext:Sn,useEffect:nf,useImperativeHandle:Bp,useInsertionEffect:Ip,useLayoutEffect:Lp,useMemo:zp,useReducer:tf,useRef:Pp,useState:function(){return tf(Wo)},useDebugValue:sf,useDeferredValue:function(s){var l=En();return $p(l,ar.memoizedState,s)},useTransition:function(){var s=tf(Wo)[0],l=En().memoizedState;return[s,l]},useMutableSource:Tp,useSyncExternalStore:Ap,useId:Wp,unstable_isNewReconciler:!1},ew={readContext:Sn,useCallback:Up,useContext:Sn,useEffect:nf,useImperativeHandle:Bp,useInsertionEffect:Ip,useLayoutEffect:Lp,useMemo:zp,useReducer:rf,useRef:Pp,useState:function(){return rf(Wo)},useDebugValue:sf,useDeferredValue:function(s){var l=En();return ar===null?l.memoizedState=s:$p(l,ar.memoizedState,s)},useTransition:function(){var s=rf(Wo)[0],l=En().memoizedState;return[s,l]},useMutableSource:Tp,useSyncExternalStore:Ap,useId:Wp,unstable_isNewReconciler:!1};function $n(s,l){if(s&&s.defaultProps){l=me({},l),s=s.defaultProps;for(var u in s)l[u]===void 0&&(l[u]=s[u]);return l}return l}function af(s,l,u,m){l=s.memoizedState,u=u(m,l),u=u==null?l:me({},l,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var kc={isMounted:function(s){return(s=s._reactInternals)?M(s)===s:!1},enqueueSetState:function(s,l,u){s=s._reactInternals;var m=Ur(),x=ss(s),w=Si(m,x);w.payload=l,u!=null&&(w.callback=u),l=ts(s,w,x),l!==null&&(Vn(l,s,x,m),xc(l,s,x))},enqueueReplaceState:function(s,l,u){s=s._reactInternals;var m=Ur(),x=ss(s),w=Si(m,x);w.tag=1,w.payload=l,u!=null&&(w.callback=u),l=ts(s,w,x),l!==null&&(Vn(l,s,x,m),xc(l,s,x))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var u=Ur(),m=ss(s),x=Si(u,m);x.tag=2,l!=null&&(x.callback=l),l=ts(s,x,m),l!==null&&(Vn(l,s,m,u),xc(l,s,m))}};function Kp(s,l,u,m,x,w,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,w,E):l.prototype&&l.prototype.isPureReactComponent?!Fo(u,m)||!Fo(x,w):!0}function qp(s,l,u){var m=!1,x=Qi,w=l.contextType;return typeof w=="object"&&w!==null?w=Sn(w):(x=Gr(l)?Ts:jr.current,m=l.contextTypes,w=(m=m!=null)?Sa(s,x):Qi),l=new l(u,w),s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=kc,s.stateNode=l,l._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=x,s.__reactInternalMemoizedMaskedChildContext=w),l}function Xp(s,l,u,m){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,m),l.state!==s&&kc.enqueueReplaceState(l,l.state,null)}function of(s,l,u,m){var x=s.stateNode;x.props=u,x.state=s.memoizedState,x.refs={},Gd(s);var w=l.contextType;typeof w=="object"&&w!==null?x.context=Sn(w):(w=Gr(l)?Ts:jr.current,x.context=Sa(s,w)),x.state=s.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(af(s,l,w,u),x.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(l=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),l!==x.state&&kc.enqueueReplaceState(x,x.state,null),vc(s,u,x,m),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308)}function ja(s,l){try{var u="",m=l;do u+=B(m),m=m.return;while(m);var x=u}catch(w){x=`
Error generating stack: `+w.message+`
`+w.stack}return{value:s,source:l,stack:x,digest:null}}function lf(s,l,u){return{value:s,source:null,stack:u??null,digest:l??null}}function cf(s,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var tw=typeof WeakMap=="function"?WeakMap:Map;function Yp(s,l,u){u=Si(-1,u),u.tag=3,u.payload={element:null};var m=l.value;return u.callback=function(){Dc||(Dc=!0,Ef=m),cf(s,l)},u}function Jp(s,l,u){u=Si(-1,u),u.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var x=l.value;u.payload=function(){return m(x)},u.callback=function(){cf(s,l)}}var w=s.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(u.callback=function(){cf(s,l),typeof m!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var E=l.stack;this.componentDidCatch(l.value,{componentStack:E!==null?E:""})}),u}function Qp(s,l,u){var m=s.pingCache;if(m===null){m=s.pingCache=new tw;var x=new Set;m.set(l,x)}else x=m.get(l),x===void 0&&(x=new Set,m.set(l,x));x.has(u)||(x.add(u),s=mw.bind(null,s,l,u),l.then(s,s))}function Zp(s){do{var l;if((l=s.tag===13)&&(l=s.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return s;s=s.return}while(s!==null);return null}function em(s,l,u,m,x){return(s.mode&1)===0?(s===l?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=Si(-1,1),l.tag=2,ts(u,l,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=x,s)}var rw=P.ReactCurrentOwner,Kr=!1;function Br(s,l,u,m){l.child=s===null?_p(l,null,u,m):Aa(l,s.child,u,m)}function tm(s,l,u,m,x){u=u.render;var w=l.ref;return Na(l,x),m=Zd(s,l,u,m,w,x),u=ef(),s!==null&&!Kr?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~x,Ei(s,l,x)):(zt&&u&&Id(l),l.flags|=1,Br(s,l,m,x),l.child)}function rm(s,l,u,m,x){if(s===null){var w=u.type;return typeof w=="function"&&!jf(w)&&w.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=w,nm(s,l,w,m,x)):(s=Mc(u.type,null,m,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(w=s.child,(s.lanes&x)===0){var E=w.memoizedProps;if(u=u.compare,u=u!==null?u:Fo,u(E,m)&&s.ref===l.ref)return Ei(s,l,x)}return l.flags|=1,s=os(w,m),s.ref=l.ref,s.return=l,l.child=s}function nm(s,l,u,m,x){if(s!==null){var w=s.memoizedProps;if(Fo(w,m)&&s.ref===l.ref)if(Kr=!1,l.pendingProps=m=w,(s.lanes&x)!==0)(s.flags&131072)!==0&&(Kr=!0);else return l.lanes=s.lanes,Ei(s,l,x)}return uf(s,l,u,m,x)}function im(s,l,u){var m=l.pendingProps,x=m.children,w=s!==null?s.memoizedState:null;if(m.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dt(Oa,ln),ln|=u;else{if((u&1073741824)===0)return s=w!==null?w.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:s,cachePool:null,transitions:null},l.updateQueue=null,Dt(Oa,ln),ln|=s,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=w!==null?w.baseLanes:u,Dt(Oa,ln),ln|=m}else w!==null?(m=w.baseLanes|u,l.memoizedState=null):m=u,Dt(Oa,ln),ln|=m;return Br(s,l,x,u),l.child}function sm(s,l){var u=l.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function uf(s,l,u,m,x){var w=Gr(u)?Ts:jr.current;return w=Sa(l,w),Na(l,x),u=Zd(s,l,u,m,w,x),m=ef(),s!==null&&!Kr?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~x,Ei(s,l,x)):(zt&&m&&Id(l),l.flags|=1,Br(s,l,u,x),l.child)}function am(s,l,u,m,x){if(Gr(u)){var w=!0;cc(l)}else w=!1;if(Na(l,x),l.stateNode===null)Ac(s,l),qp(l,u,m),of(l,u,m,x),m=!0;else if(s===null){var E=l.stateNode,U=l.memoizedProps;E.props=U;var Y=E.context,ge=u.contextType;typeof ge=="object"&&ge!==null?ge=Sn(ge):(ge=Gr(u)?Ts:jr.current,ge=Sa(l,ge));var Ne=u.getDerivedStateFromProps,Pe=typeof Ne=="function"||typeof E.getSnapshotBeforeUpdate=="function";Pe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(U!==m||Y!==ge)&&Xp(l,E,m,ge),es=!1;var Ae=l.memoizedState;E.state=Ae,vc(l,m,E,x),Y=l.memoizedState,U!==m||Ae!==Y||Vr.current||es?(typeof Ne=="function"&&(af(l,u,Ne,m),Y=l.memoizedState),(U=es||Kp(l,u,U,m,Ae,Y,ge))?(Pe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=Y),E.props=m,E.state=Y,E.context=ge,m=U):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{E=l.stateNode,bp(s,l),U=l.memoizedProps,ge=l.type===l.elementType?U:$n(l.type,U),E.props=ge,Pe=l.pendingProps,Ae=E.context,Y=u.contextType,typeof Y=="object"&&Y!==null?Y=Sn(Y):(Y=Gr(u)?Ts:jr.current,Y=Sa(l,Y));var Ge=u.getDerivedStateFromProps;(Ne=typeof Ge=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(U!==Pe||Ae!==Y)&&Xp(l,E,m,Y),es=!1,Ae=l.memoizedState,E.state=Ae,vc(l,m,E,x);var qe=l.memoizedState;U!==Pe||Ae!==qe||Vr.current||es?(typeof Ge=="function"&&(af(l,u,Ge,m),qe=l.memoizedState),(ge=es||Kp(l,u,ge,m,Ae,qe,Y)||!1)?(Ne||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(m,qe,Y),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(m,qe,Y)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||U===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=qe),E.props=m,E.state=qe,E.context=Y,m=ge):(typeof E.componentDidUpdate!="function"||U===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=1024),m=!1)}return df(s,l,u,m,w,x)}function df(s,l,u,m,x,w){sm(s,l);var E=(l.flags&128)!==0;if(!m&&!E)return x&&dp(l,u,!1),Ei(s,l,w);m=l.stateNode,rw.current=l;var U=E&&typeof u.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,s!==null&&E?(l.child=Aa(l,s.child,null,w),l.child=Aa(l,null,U,w)):Br(s,l,U,w),l.memoizedState=m.state,x&&dp(l,u,!0),l.child}function om(s){var l=s.stateNode;l.pendingContext?cp(s,l.pendingContext,l.pendingContext!==l.context):l.context&&cp(s,l.context,!1),Kd(s,l.containerInfo)}function lm(s,l,u,m,x){return Ta(),Ud(x),l.flags|=256,Br(s,l,u,m),l.child}var ff={dehydrated:null,treeContext:null,retryLane:0};function hf(s){return{baseLanes:s,cachePool:null,transitions:null}}function cm(s,l,u){var m=l.pendingProps,x=$t.current,w=!1,E=(l.flags&128)!==0,U;if((U=E)||(U=s!==null&&s.memoizedState===null?!1:(x&2)!==0),U?(w=!0,l.flags&=-129):(s===null||s.memoizedState!==null)&&(x|=1),Dt($t,x&1),s===null)return Bd(l),s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((l.mode&1)===0?l.lanes=1:s.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(E=m.children,s=m.fallback,w?(m=l.mode,w=l.child,E={mode:"hidden",children:E},(m&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=E):w=Bc(E,m,0,null),s=Is(s,m,u,null),w.return=l,s.return=l,w.sibling=s,l.child=w,l.child.memoizedState=hf(u),l.memoizedState=ff,s):pf(l,E));if(x=s.memoizedState,x!==null&&(U=x.dehydrated,U!==null))return nw(s,l,E,m,U,x,u);if(w){w=m.fallback,E=l.mode,x=s.child,U=x.sibling;var Y={mode:"hidden",children:m.children};return(E&1)===0&&l.child!==x?(m=l.child,m.childLanes=0,m.pendingProps=Y,l.deletions=null):(m=os(x,Y),m.subtreeFlags=x.subtreeFlags&14680064),U!==null?w=os(U,w):(w=Is(w,E,u,null),w.flags|=2),w.return=l,m.return=l,m.sibling=w,l.child=m,m=w,w=l.child,E=s.child.memoizedState,E=E===null?hf(u):{baseLanes:E.baseLanes|u,cachePool:null,transitions:E.transitions},w.memoizedState=E,w.childLanes=s.childLanes&~u,l.memoizedState=ff,m}return w=s.child,s=w.sibling,m=os(w,{mode:"visible",children:m.children}),(l.mode&1)===0&&(m.lanes=u),m.return=l,m.sibling=null,s!==null&&(u=l.deletions,u===null?(l.deletions=[s],l.flags|=16):u.push(s)),l.child=m,l.memoizedState=null,m}function pf(s,l){return l=Bc({mode:"visible",children:l},s.mode,0,null),l.return=s,s.child=l}function Tc(s,l,u,m){return m!==null&&Ud(m),Aa(l,s.child,null,u),s=pf(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function nw(s,l,u,m,x,w,E){if(u)return l.flags&256?(l.flags&=-257,m=lf(Error(t(422))),Tc(s,l,E,m)):l.memoizedState!==null?(l.child=s.child,l.flags|=128,null):(w=m.fallback,x=l.mode,m=Bc({mode:"visible",children:m.children},x,0,null),w=Is(w,x,E,null),w.flags|=2,m.return=l,w.return=l,m.sibling=w,l.child=m,(l.mode&1)!==0&&Aa(l,s.child,null,E),l.child.memoizedState=hf(E),l.memoizedState=ff,w);if((l.mode&1)===0)return Tc(s,l,E,null);if(x.data==="$!"){if(m=x.nextSibling&&x.nextSibling.dataset,m)var U=m.dgst;return m=U,w=Error(t(419)),m=lf(w,m,void 0),Tc(s,l,E,m)}if(U=(E&s.childLanes)!==0,Kr||U){if(m=pr,m!==null){switch(E&-E){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=(x&(m.suspendedLanes|E))!==0?0:x,x!==0&&x!==w.retryLane&&(w.retryLane=x,bi(s,x),Vn(m,s,x,-1))}return Ff(),m=lf(Error(t(421))),Tc(s,l,E,m)}return x.data==="$?"?(l.flags|=128,l.child=s.child,l=gw.bind(null,s),x._reactRetry=l,null):(s=w.treeContext,on=Yi(x.nextSibling),an=l,zt=!0,zn=null,s!==null&&(wn[bn++]=_i,wn[bn++]=wi,wn[bn++]=As,_i=s.id,wi=s.overflow,As=l),l=pf(l,m.children),l.flags|=4096,l)}function um(s,l,u){s.lanes|=l;var m=s.alternate;m!==null&&(m.lanes|=l),Hd(s.return,l,u)}function mf(s,l,u,m,x){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:x}:(w.isBackwards=l,w.rendering=null,w.renderingStartTime=0,w.last=m,w.tail=u,w.tailMode=x)}function dm(s,l,u){var m=l.pendingProps,x=m.revealOrder,w=m.tail;if(Br(s,l,m.children,u),m=$t.current,(m&2)!==0)m=m&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&um(s,u,l);else if(s.tag===19)um(s,u,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(Dt($t,m),(l.mode&1)===0)l.memoizedState=null;else switch(x){case"forwards":for(u=l.child,x=null;u!==null;)s=u.alternate,s!==null&&yc(s)===null&&(x=u),u=u.sibling;u=x,u===null?(x=l.child,l.child=null):(x=u.sibling,u.sibling=null),mf(l,!1,x,u,w);break;case"backwards":for(u=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&yc(s)===null){l.child=x;break}s=x.sibling,x.sibling=u,u=x,x=s}mf(l,!0,u,null,w);break;case"together":mf(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Ac(s,l){(l.mode&1)===0&&s!==null&&(s.alternate=null,l.alternate=null,l.flags|=2)}function Ei(s,l,u){if(s!==null&&(l.dependencies=s.dependencies),Ds|=l.lanes,(u&l.childLanes)===0)return null;if(s!==null&&l.child!==s.child)throw Error(t(153));if(l.child!==null){for(s=l.child,u=os(s,s.pendingProps),l.child=u,u.return=l;s.sibling!==null;)s=s.sibling,u=u.sibling=os(s,s.pendingProps),u.return=l;u.sibling=null}return l.child}function iw(s,l,u){switch(l.tag){case 3:om(l),Ta();break;case 5:kp(l);break;case 1:Gr(l.type)&&cc(l);break;case 4:Kd(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,x=l.memoizedProps.value;Dt(mc,m._currentValue),m._currentValue=x;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(Dt($t,$t.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?cm(s,l,u):(Dt($t,$t.current&1),s=Ei(s,l,u),s!==null?s.sibling:null);Dt($t,$t.current&1);break;case 19:if(m=(u&l.childLanes)!==0,(s.flags&128)!==0){if(m)return dm(s,l,u);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Dt($t,$t.current),m)break;return null;case 22:case 23:return l.lanes=0,im(s,l,u)}return Ei(s,l,u)}var fm,gf,hm,pm;fm=function(s,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},gf=function(){},hm=function(s,l,u,m){var x=s.memoizedProps;if(x!==m){s=l.stateNode,Fs(ii.current);var w=null;switch(u){case"input":x=Fe(s,x),m=Fe(s,m),w=[];break;case"select":x=me({},x,{value:void 0}),m=me({},m,{value:void 0}),w=[];break;case"textarea":x=qt(s,x),m=qt(s,m),w=[];break;default:typeof x.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=ac)}Bi(u,m);var E;u=null;for(ge in x)if(!m.hasOwnProperty(ge)&&x.hasOwnProperty(ge)&&x[ge]!=null)if(ge==="style"){var U=x[ge];for(E in U)U.hasOwnProperty(E)&&(u||(u={}),u[E]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(i.hasOwnProperty(ge)?w||(w=[]):(w=w||[]).push(ge,null));for(ge in m){var Y=m[ge];if(U=x?.[ge],m.hasOwnProperty(ge)&&Y!==U&&(Y!=null||U!=null))if(ge==="style")if(U){for(E in U)!U.hasOwnProperty(E)||Y&&Y.hasOwnProperty(E)||(u||(u={}),u[E]="");for(E in Y)Y.hasOwnProperty(E)&&U[E]!==Y[E]&&(u||(u={}),u[E]=Y[E])}else u||(w||(w=[]),w.push(ge,u)),u=Y;else ge==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,U=U?U.__html:void 0,Y!=null&&U!==Y&&(w=w||[]).push(ge,Y)):ge==="children"?typeof Y!="string"&&typeof Y!="number"||(w=w||[]).push(ge,""+Y):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(i.hasOwnProperty(ge)?(Y!=null&&ge==="onScroll"&&Pt("scroll",s),w||U===Y||(w=[])):(w=w||[]).push(ge,Y))}u&&(w=w||[]).push("style",u);var ge=w;(l.updateQueue=ge)&&(l.flags|=4)}},pm=function(s,l,u,m){u!==m&&(l.flags|=4)};function Vo(s,l){if(!zt)switch(s.tailMode){case"hidden":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function Or(s){var l=s.alternate!==null&&s.alternate.child===s.child,u=0,m=0;if(l)for(var x=s.child;x!==null;)u|=x.lanes|x.childLanes,m|=x.subtreeFlags&14680064,m|=x.flags&14680064,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)u|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=m,s.childLanes=u,l}function sw(s,l,u){var m=l.pendingProps;switch(Ld(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(l),null;case 1:return Gr(l.type)&&lc(),Or(l),null;case 3:return m=l.stateNode,Fa(),Rt(Vr),Rt(jr),Yd(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(hc(l)?l.flags|=4:s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,zn!==null&&(Af(zn),zn=null))),gf(s,l),Or(l),null;case 5:qd(l);var x=Fs(Uo.current);if(u=l.type,s!==null&&l.stateNode!=null)hm(s,l,u,m,x),s.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(t(166));return Or(l),null}if(s=Fs(ii.current),hc(l)){m=l.stateNode,u=l.type;var w=l.memoizedProps;switch(m[ni]=l,m[Ro]=w,s=(l.mode&1)!==0,u){case"dialog":Pt("cancel",m),Pt("close",m);break;case"iframe":case"object":case"embed":Pt("load",m);break;case"video":case"audio":for(x=0;x<Do.length;x++)Pt(Do[x],m);break;case"source":Pt("error",m);break;case"img":case"image":case"link":Pt("error",m),Pt("load",m);break;case"details":Pt("toggle",m);break;case"input":We(m,w),Pt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!w.multiple},Pt("invalid",m);break;case"textarea":Mr(m,w),Pt("invalid",m)}Bi(u,w),x=null;for(var E in w)if(w.hasOwnProperty(E)){var U=w[E];E==="children"?typeof U=="string"?m.textContent!==U&&(w.suppressHydrationWarning!==!0&&sc(m.textContent,U,s),x=["children",U]):typeof U=="number"&&m.textContent!==""+U&&(w.suppressHydrationWarning!==!0&&sc(m.textContent,U,s),x=["children",""+U]):i.hasOwnProperty(E)&&U!=null&&E==="onScroll"&&Pt("scroll",m)}switch(u){case"input":Z(m),jt(m,w,!0);break;case"textarea":Z(m),at(m);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(m.onclick=ac)}m=x,l.updateQueue=m,m!==null&&(l.flags|=4)}else{E=x.nodeType===9?x:x.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=_t(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=E.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=E.createElement(u,{is:m.is}):(s=E.createElement(u),u==="select"&&(E=s,m.multiple?E.multiple=!0:m.size&&(E.size=m.size))):s=E.createElementNS(s,u),s[ni]=l,s[Ro]=m,fm(s,l,!1,!1),l.stateNode=s;e:{switch(E=Es(u,m),u){case"dialog":Pt("cancel",s),Pt("close",s),x=m;break;case"iframe":case"object":case"embed":Pt("load",s),x=m;break;case"video":case"audio":for(x=0;x<Do.length;x++)Pt(Do[x],s);x=m;break;case"source":Pt("error",s),x=m;break;case"img":case"image":case"link":Pt("error",s),Pt("load",s),x=m;break;case"details":Pt("toggle",s),x=m;break;case"input":We(s,m),x=Fe(s,m),Pt("invalid",s);break;case"option":x=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},x=me({},m,{value:void 0}),Pt("invalid",s);break;case"textarea":Mr(s,m),x=qt(s,m),Pt("invalid",s);break;default:x=m}Bi(u,x),U=x;for(w in U)if(U.hasOwnProperty(w)){var Y=U[w];w==="style"?oa(s,Y):w==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,Y!=null&&sa(s,Y)):w==="children"?typeof Y=="string"?(u!=="textarea"||Y!=="")&&Nr(s,Y):typeof Y=="number"&&Nr(s,""+Y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(i.hasOwnProperty(w)?Y!=null&&w==="onScroll"&&Pt("scroll",s):Y!=null&&T(s,w,Y,E))}switch(u){case"input":Z(s),jt(s,m,!1);break;case"textarea":Z(s),at(s);break;case"option":m.value!=null&&s.setAttribute("value",""+ie(m.value));break;case"select":s.multiple=!!m.multiple,w=m.value,w!=null?gt(s,!!m.multiple,w,!1):m.defaultValue!=null&&gt(s,!!m.multiple,m.defaultValue,!0);break;default:typeof x.onClick=="function"&&(s.onclick=ac)}switch(u){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Or(l),null;case 6:if(s&&l.stateNode!=null)pm(s,l,s.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(t(166));if(u=Fs(Uo.current),Fs(ii.current),hc(l)){if(m=l.stateNode,u=l.memoizedProps,m[ni]=l,(w=m.nodeValue!==u)&&(s=an,s!==null))switch(s.tag){case 3:sc(m.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&sc(m.nodeValue,u,(s.mode&1)!==0)}w&&(l.flags|=4)}else m=(u.nodeType===9?u:u.ownerDocument).createTextNode(m),m[ni]=l,l.stateNode=m}return Or(l),null;case 13:if(Rt($t),m=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(zt&&on!==null&&(l.mode&1)!==0&&(l.flags&128)===0)xp(),Ta(),l.flags|=98560,w=!1;else if(w=hc(l),m!==null&&m.dehydrated!==null){if(s===null){if(!w)throw Error(t(318));if(w=l.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[ni]=l}else Ta(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Or(l),w=!1}else zn!==null&&(Af(zn),zn=null),w=!0;if(!w)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(l.child.flags|=8192,(l.mode&1)!==0&&(s===null||($t.current&1)!==0?or===0&&(or=3):Ff())),l.updateQueue!==null&&(l.flags|=4),Or(l),null);case 4:return Fa(),gf(s,l),s===null&&Oo(l.stateNode.containerInfo),Or(l),null;case 10:return Wd(l.type._context),Or(l),null;case 17:return Gr(l.type)&&lc(),Or(l),null;case 19:if(Rt($t),w=l.memoizedState,w===null)return Or(l),null;if(m=(l.flags&128)!==0,E=w.rendering,E===null)if(m)Vo(w,!1);else{if(or!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=yc(s),E!==null){for(l.flags|=128,Vo(w,!1),m=E.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=u,u=l.child;u!==null;)w=u,s=m,w.flags&=14680066,E=w.alternate,E===null?(w.childLanes=0,w.lanes=s,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=E.childLanes,w.lanes=E.lanes,w.child=E.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=E.memoizedProps,w.memoizedState=E.memoizedState,w.updateQueue=E.updateQueue,w.type=E.type,s=E.dependencies,w.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Dt($t,$t.current&1|2),l.child}s=s.sibling}w.tail!==null&&Re()>Pa&&(l.flags|=128,m=!0,Vo(w,!1),l.lanes=4194304)}else{if(!m)if(s=yc(E),s!==null){if(l.flags|=128,m=!0,u=s.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),Vo(w,!0),w.tail===null&&w.tailMode==="hidden"&&!E.alternate&&!zt)return Or(l),null}else 2*Re()-w.renderingStartTime>Pa&&u!==1073741824&&(l.flags|=128,m=!0,Vo(w,!1),l.lanes=4194304);w.isBackwards?(E.sibling=l.child,l.child=E):(u=w.last,u!==null?u.sibling=E:l.child=E,w.last=E)}return w.tail!==null?(l=w.tail,w.rendering=l,w.tail=l.sibling,w.renderingStartTime=Re(),l.sibling=null,u=$t.current,Dt($t,m?u&1|2:u&1),l):(Or(l),null);case 22:case 23:return Nf(),m=l.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(l.flags|=8192),m&&(l.mode&1)!==0?(ln&1073741824)!==0&&(Or(l),l.subtreeFlags&6&&(l.flags|=8192)):Or(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function aw(s,l){switch(Ld(l),l.tag){case 1:return Gr(l.type)&&lc(),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Fa(),Rt(Vr),Rt(jr),Yd(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 5:return qd(l),null;case 13:if(Rt($t),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(t(340));Ta()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Rt($t),null;case 4:return Fa(),null;case 10:return Wd(l.type._context),null;case 22:case 23:return Nf(),null;case 24:return null;default:return null}}var Cc=!1,Pr=!1,ow=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Da(s,l){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(m){Vt(s,l,m)}else u.current=null}function xf(s,l,u){try{u()}catch(m){Vt(s,l,m)}}var mm=!1;function lw(s,l){if(Cd=ql,s=K0(),_d(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var x=m.anchorOffset,w=m.focusNode;m=m.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var E=0,U=-1,Y=-1,ge=0,Ne=0,Pe=s,Ae=null;t:for(;;){for(var Ge;Pe!==u||x!==0&&Pe.nodeType!==3||(U=E+x),Pe!==w||m!==0&&Pe.nodeType!==3||(Y=E+m),Pe.nodeType===3&&(E+=Pe.nodeValue.length),(Ge=Pe.firstChild)!==null;)Ae=Pe,Pe=Ge;for(;;){if(Pe===s)break t;if(Ae===u&&++ge===x&&(U=E),Ae===w&&++Ne===m&&(Y=E),(Ge=Pe.nextSibling)!==null)break;Pe=Ae,Ae=Pe.parentNode}Pe=Ge}u=U===-1||Y===-1?null:{start:U,end:Y}}else u=null}u=u||{start:0,end:0}}else u=null;for(Nd={focusedElem:s,selectionRange:u},ql=!1,Ke=l;Ke!==null;)if(l=Ke,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Ke=s;else for(;Ke!==null;){l=Ke;try{var qe=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(qe!==null){var Xe=qe.memoizedProps,Jt=qe.memoizedState,ae=l.stateNode,Q=ae.getSnapshotBeforeUpdate(l.elementType===l.type?Xe:$n(l.type,Xe),Jt);ae.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var ue=l.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Le){Vt(l,l.return,Le)}if(s=l.sibling,s!==null){s.return=l.return,Ke=s;break}Ke=l.return}return qe=mm,mm=!1,qe}function Go(s,l,u){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var x=m=m.next;do{if((x.tag&s)===s){var w=x.destroy;x.destroy=void 0,w!==void 0&&xf(l,u,w)}x=x.next}while(x!==m)}}function Nc(s,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&s)===s){var m=u.create;u.destroy=m()}u=u.next}while(u!==l)}}function vf(s){var l=s.ref;if(l!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof l=="function"?l(s):l.current=s}}function gm(s){var l=s.alternate;l!==null&&(s.alternate=null,gm(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&(delete l[ni],delete l[Ro],delete l[Od],delete l[H_],delete l[V_])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function xm(s){return s.tag===5||s.tag===3||s.tag===4}function vm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||xm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yf(s,l,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(s,l):u.insertBefore(s,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(s,u)):(l=u,l.appendChild(s)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=ac));else if(m!==4&&(s=s.child,s!==null))for(yf(s,l,u),s=s.sibling;s!==null;)yf(s,l,u),s=s.sibling}function _f(s,l,u){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?u.insertBefore(s,l):u.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(_f(s,l,u),s=s.sibling;s!==null;)_f(s,l,u),s=s.sibling}var _r=null,Wn=!1;function rs(s,l,u){for(u=u.child;u!==null;)ym(s,l,u),u=u.sibling}function ym(s,l,u){if(le&&typeof le.onCommitFiberUnmount=="function")try{le.onCommitFiberUnmount(H,u)}catch{}switch(u.tag){case 5:Pr||Da(u,l);case 6:var m=_r,x=Wn;_r=null,rs(s,l,u),_r=m,Wn=x,_r!==null&&(Wn?(s=_r,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):_r.removeChild(u.stateNode));break;case 18:_r!==null&&(Wn?(s=_r,u=u.stateNode,s.nodeType===8?Dd(s.parentNode,u):s.nodeType===1&&Dd(s,u),Eo(s)):Dd(_r,u.stateNode));break;case 4:m=_r,x=Wn,_r=u.stateNode.containerInfo,Wn=!0,rs(s,l,u),_r=m,Wn=x;break;case 0:case 11:case 14:case 15:if(!Pr&&(m=u.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){x=m=m.next;do{var w=x,E=w.destroy;w=w.tag,E!==void 0&&((w&2)!==0||(w&4)!==0)&&xf(u,l,E),x=x.next}while(x!==m)}rs(s,l,u);break;case 1:if(!Pr&&(Da(u,l),m=u.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=u.memoizedProps,m.state=u.memoizedState,m.componentWillUnmount()}catch(U){Vt(u,l,U)}rs(s,l,u);break;case 21:rs(s,l,u);break;case 22:u.mode&1?(Pr=(m=Pr)||u.memoizedState!==null,rs(s,l,u),Pr=m):rs(s,l,u);break;default:rs(s,l,u)}}function _m(s){var l=s.updateQueue;if(l!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new ow),l.forEach(function(m){var x=xw.bind(null,s,m);u.has(m)||(u.add(m),m.then(x,x))})}}function Hn(s,l){var u=l.deletions;if(u!==null)for(var m=0;m<u.length;m++){var x=u[m];try{var w=s,E=l,U=E;e:for(;U!==null;){switch(U.tag){case 5:_r=U.stateNode,Wn=!1;break e;case 3:_r=U.stateNode.containerInfo,Wn=!0;break e;case 4:_r=U.stateNode.containerInfo,Wn=!0;break e}U=U.return}if(_r===null)throw Error(t(160));ym(w,E,x),_r=null,Wn=!1;var Y=x.alternate;Y!==null&&(Y.return=null),x.return=null}catch(ge){Vt(x,l,ge)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)wm(l,s),l=l.sibling}function wm(s,l){var u=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Hn(l,s),ai(s),m&4){try{Go(3,s,s.return),Nc(3,s)}catch(Xe){Vt(s,s.return,Xe)}try{Go(5,s,s.return)}catch(Xe){Vt(s,s.return,Xe)}}break;case 1:Hn(l,s),ai(s),m&512&&u!==null&&Da(u,u.return);break;case 5:if(Hn(l,s),ai(s),m&512&&u!==null&&Da(u,u.return),s.flags&32){var x=s.stateNode;try{Nr(x,"")}catch(Xe){Vt(s,s.return,Xe)}}if(m&4&&(x=s.stateNode,x!=null)){var w=s.memoizedProps,E=u!==null?u.memoizedProps:w,U=s.type,Y=s.updateQueue;if(s.updateQueue=null,Y!==null)try{U==="input"&&w.type==="radio"&&w.name!=null&&Be(x,w),Es(U,E);var ge=Es(U,w);for(E=0;E<Y.length;E+=2){var Ne=Y[E],Pe=Y[E+1];Ne==="style"?oa(x,Pe):Ne==="dangerouslySetInnerHTML"?sa(x,Pe):Ne==="children"?Nr(x,Pe):T(x,Ne,Pe,ge)}switch(U){case"input":ke(x,w);break;case"textarea":et(x,w);break;case"select":var Ae=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!w.multiple;var Ge=w.value;Ge!=null?gt(x,!!w.multiple,Ge,!1):Ae!==!!w.multiple&&(w.defaultValue!=null?gt(x,!!w.multiple,w.defaultValue,!0):gt(x,!!w.multiple,w.multiple?[]:"",!1))}x[Ro]=w}catch(Xe){Vt(s,s.return,Xe)}}break;case 6:if(Hn(l,s),ai(s),m&4){if(s.stateNode===null)throw Error(t(162));x=s.stateNode,w=s.memoizedProps;try{x.nodeValue=w}catch(Xe){Vt(s,s.return,Xe)}}break;case 3:if(Hn(l,s),ai(s),m&4&&u!==null&&u.memoizedState.isDehydrated)try{Eo(l.containerInfo)}catch(Xe){Vt(s,s.return,Xe)}break;case 4:Hn(l,s),ai(s);break;case 13:Hn(l,s),ai(s),x=s.child,x.flags&8192&&(w=x.memoizedState!==null,x.stateNode.isHidden=w,!w||x.alternate!==null&&x.alternate.memoizedState!==null||(Sf=Re())),m&4&&_m(s);break;case 22:if(Ne=u!==null&&u.memoizedState!==null,s.mode&1?(Pr=(ge=Pr)||Ne,Hn(l,s),Pr=ge):Hn(l,s),ai(s),m&8192){if(ge=s.memoizedState!==null,(s.stateNode.isHidden=ge)&&!Ne&&(s.mode&1)!==0)for(Ke=s,Ne=s.child;Ne!==null;){for(Pe=Ke=Ne;Ke!==null;){switch(Ae=Ke,Ge=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:Go(4,Ae,Ae.return);break;case 1:Da(Ae,Ae.return);var qe=Ae.stateNode;if(typeof qe.componentWillUnmount=="function"){m=Ae,u=Ae.return;try{l=m,qe.props=l.memoizedProps,qe.state=l.memoizedState,qe.componentWillUnmount()}catch(Xe){Vt(m,u,Xe)}}break;case 5:Da(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){Em(Pe);continue}}Ge!==null?(Ge.return=Ae,Ke=Ge):Em(Pe)}Ne=Ne.sibling}e:for(Ne=null,Pe=s;;){if(Pe.tag===5){if(Ne===null){Ne=Pe;try{x=Pe.stateNode,ge?(w=x.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(U=Pe.stateNode,Y=Pe.memoizedProps.style,E=Y!=null&&Y.hasOwnProperty("display")?Y.display:null,U.style.display=aa("display",E))}catch(Xe){Vt(s,s.return,Xe)}}}else if(Pe.tag===6){if(Ne===null)try{Pe.stateNode.nodeValue=ge?"":Pe.memoizedProps}catch(Xe){Vt(s,s.return,Xe)}}else if((Pe.tag!==22&&Pe.tag!==23||Pe.memoizedState===null||Pe===s)&&Pe.child!==null){Pe.child.return=Pe,Pe=Pe.child;continue}if(Pe===s)break e;for(;Pe.sibling===null;){if(Pe.return===null||Pe.return===s)break e;Ne===Pe&&(Ne=null),Pe=Pe.return}Ne===Pe&&(Ne=null),Pe.sibling.return=Pe.return,Pe=Pe.sibling}}break;case 19:Hn(l,s),ai(s),m&4&&_m(s);break;case 21:break;default:Hn(l,s),ai(s)}}function ai(s){var l=s.flags;if(l&2){try{e:{for(var u=s.return;u!==null;){if(xm(u)){var m=u;break e}u=u.return}throw Error(t(160))}switch(m.tag){case 5:var x=m.stateNode;m.flags&32&&(Nr(x,""),m.flags&=-33);var w=vm(s);_f(s,w,x);break;case 3:case 4:var E=m.stateNode.containerInfo,U=vm(s);yf(s,U,E);break;default:throw Error(t(161))}}catch(Y){Vt(s,s.return,Y)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function cw(s,l,u){Ke=s,bm(s)}function bm(s,l,u){for(var m=(s.mode&1)!==0;Ke!==null;){var x=Ke,w=x.child;if(x.tag===22&&m){var E=x.memoizedState!==null||Cc;if(!E){var U=x.alternate,Y=U!==null&&U.memoizedState!==null||Pr;U=Cc;var ge=Pr;if(Cc=E,(Pr=Y)&&!ge)for(Ke=x;Ke!==null;)E=Ke,Y=E.child,E.tag===22&&E.memoizedState!==null?km(x):Y!==null?(Y.return=E,Ke=Y):km(x);for(;w!==null;)Ke=w,bm(w),w=w.sibling;Ke=x,Cc=U,Pr=ge}Sm(s)}else(x.subtreeFlags&8772)!==0&&w!==null?(w.return=x,Ke=w):Sm(s)}}function Sm(s){for(;Ke!==null;){var l=Ke;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Pr||Nc(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!Pr)if(u===null)m.componentDidMount();else{var x=l.elementType===l.type?u.memoizedProps:$n(l.type,u.memoizedProps);m.componentDidUpdate(x,u.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var w=l.updateQueue;w!==null&&Ep(l,w,m);break;case 3:var E=l.updateQueue;if(E!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}Ep(l,E,u)}break;case 5:var U=l.stateNode;if(u===null&&l.flags&4){u=U;var Y=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Y.autoFocus&&u.focus();break;case"img":Y.src&&(u.src=Y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var ge=l.alternate;if(ge!==null){var Ne=ge.memoizedState;if(Ne!==null){var Pe=Ne.dehydrated;Pe!==null&&Eo(Pe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Pr||l.flags&512&&vf(l)}catch(Ae){Vt(l,l.return,Ae)}}if(l===s){Ke=null;break}if(u=l.sibling,u!==null){u.return=l.return,Ke=u;break}Ke=l.return}}function Em(s){for(;Ke!==null;){var l=Ke;if(l===s){Ke=null;break}var u=l.sibling;if(u!==null){u.return=l.return,Ke=u;break}Ke=l.return}}function km(s){for(;Ke!==null;){var l=Ke;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{Nc(4,l)}catch(Y){Vt(l,u,Y)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var x=l.return;try{m.componentDidMount()}catch(Y){Vt(l,x,Y)}}var w=l.return;try{vf(l)}catch(Y){Vt(l,w,Y)}break;case 5:var E=l.return;try{vf(l)}catch(Y){Vt(l,E,Y)}}}catch(Y){Vt(l,l.return,Y)}if(l===s){Ke=null;break}var U=l.sibling;if(U!==null){U.return=l.return,Ke=U;break}Ke=l.return}}var uw=Math.ceil,Fc=P.ReactCurrentDispatcher,wf=P.ReactCurrentOwner,kn=P.ReactCurrentBatchConfig,mt=0,pr=null,Zt=null,wr=0,ln=0,Oa=Ji(0),or=0,Ko=null,Ds=0,jc=0,bf=0,qo=null,qr=null,Sf=0,Pa=1/0,ki=null,Dc=!1,Ef=null,ns=null,Oc=!1,is=null,Pc=0,Xo=0,kf=null,Rc=-1,Ic=0;function Ur(){return(mt&6)!==0?Re():Rc!==-1?Rc:Rc=Re()}function ss(s){return(s.mode&1)===0?1:(mt&2)!==0&&wr!==0?wr&-wr:K_.transition!==null?(Ic===0&&(Ic=Je()),Ic):(s=lt,s!==0||(s=window.event,s=s===void 0?16:A0(s.type)),s)}function Vn(s,l,u,m){if(50<Xo)throw Xo=0,kf=null,Error(t(185));gi(s,u,m),((mt&2)===0||s!==pr)&&(s===pr&&((mt&2)===0&&(jc|=u),or===4&&as(s,wr)),Xr(s,m),u===1&&mt===0&&(l.mode&1)===0&&(Pa=Re()+500,uc&&Zi()))}function Xr(s,l){var u=s.callbackNode;_n(s,l);var m=Xt(s,s===pr?wr:0);if(m===0)u!==null&&Ue(u),s.callbackNode=null,s.callbackPriority=0;else if(l=m&-m,s.callbackPriority!==l){if(u!=null&&Ue(u),l===1)s.tag===0?G_(Am.bind(null,s)):fp(Am.bind(null,s)),$_(function(){(mt&6)===0&&Zi()}),u=null;else{switch(vo(m)){case 1:u=bt;break;case 4:u=Nt;break;case 16:u=Ut;break;case 536870912:u=ri;break;default:u=Ut}u=Rm(u,Tm.bind(null,s))}s.callbackPriority=l,s.callbackNode=u}}function Tm(s,l){if(Rc=-1,Ic=0,(mt&6)!==0)throw Error(t(327));var u=s.callbackNode;if(Ra()&&s.callbackNode!==u)return null;var m=Xt(s,s===pr?wr:0);if(m===0)return null;if((m&30)!==0||(m&s.expiredLanes)!==0||l)l=Lc(s,m);else{l=m;var x=mt;mt|=2;var w=Nm();(pr!==s||wr!==l)&&(ki=null,Pa=Re()+500,Ps(s,l));do try{hw();break}catch(U){Cm(s,U)}while(!0);$d(),Fc.current=w,mt=x,Zt!==null?l=0:(pr=null,wr=0,l=or)}if(l!==0){if(l===2&&(x=ht(s),x!==0&&(m=x,l=Tf(s,x))),l===1)throw u=Ko,Ps(s,0),as(s,m),Xr(s,Re()),u;if(l===6)as(s,m);else{if(x=s.current.alternate,(m&30)===0&&!dw(x)&&(l=Lc(s,m),l===2&&(w=ht(s),w!==0&&(m=w,l=Tf(s,w))),l===1))throw u=Ko,Ps(s,0),as(s,m),Xr(s,Re()),u;switch(s.finishedWork=x,s.finishedLanes=m,l){case 0:case 1:throw Error(t(345));case 2:Rs(s,qr,ki);break;case 3:if(as(s,m),(m&130023424)===m&&(l=Sf+500-Re(),10<l)){if(Xt(s,0)!==0)break;if(x=s.suspendedLanes,(x&m)!==m){Ur(),s.pingedLanes|=s.suspendedLanes&x;break}s.timeoutHandle=jd(Rs.bind(null,s,qr,ki),l);break}Rs(s,qr,ki);break;case 4:if(as(s,m),(m&4194240)===m)break;for(l=s.eventTimes,x=-1;0<m;){var E=31-Se(m);w=1<<E,E=l[E],E>x&&(x=E),m&=~w}if(m=x,m=Re()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*uw(m/1960))-m,10<m){s.timeoutHandle=jd(Rs.bind(null,s,qr,ki),m);break}Rs(s,qr,ki);break;case 5:Rs(s,qr,ki);break;default:throw Error(t(329))}}}return Xr(s,Re()),s.callbackNode===u?Tm.bind(null,s):null}function Tf(s,l){var u=qo;return s.current.memoizedState.isDehydrated&&(Ps(s,l).flags|=256),s=Lc(s,l),s!==2&&(l=qr,qr=u,l!==null&&Af(l)),s}function Af(s){qr===null?qr=s:qr.push.apply(qr,s)}function dw(s){for(var l=s;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var m=0;m<u.length;m++){var x=u[m],w=x.getSnapshot;x=x.value;try{if(!Un(w(),x))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function as(s,l){for(l&=~bf,l&=~jc,s.suspendedLanes|=l,s.pingedLanes&=~l,s=s.expirationTimes;0<l;){var u=31-Se(l),m=1<<u;s[u]=-1,l&=~m}}function Am(s){if((mt&6)!==0)throw Error(t(327));Ra();var l=Xt(s,0);if((l&1)===0)return Xr(s,Re()),null;var u=Lc(s,l);if(s.tag!==0&&u===2){var m=ht(s);m!==0&&(l=m,u=Tf(s,m))}if(u===1)throw u=Ko,Ps(s,0),as(s,l),Xr(s,Re()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=l,Rs(s,qr,ki),Xr(s,Re()),null}function Cf(s,l){var u=mt;mt|=1;try{return s(l)}finally{mt=u,mt===0&&(Pa=Re()+500,uc&&Zi())}}function Os(s){is!==null&&is.tag===0&&(mt&6)===0&&Ra();var l=mt;mt|=1;var u=kn.transition,m=lt;try{if(kn.transition=null,lt=1,s)return s()}finally{lt=m,kn.transition=u,mt=l,(mt&6)===0&&Zi()}}function Nf(){ln=Oa.current,Rt(Oa)}function Ps(s,l){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,z_(u)),Zt!==null)for(u=Zt.return;u!==null;){var m=u;switch(Ld(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&lc();break;case 3:Fa(),Rt(Vr),Rt(jr),Yd();break;case 5:qd(m);break;case 4:Fa();break;case 13:Rt($t);break;case 19:Rt($t);break;case 10:Wd(m.type._context);break;case 22:case 23:Nf()}u=u.return}if(pr=s,Zt=s=os(s.current,null),wr=ln=l,or=0,Ko=null,bf=jc=Ds=0,qr=qo=null,Ns!==null){for(l=0;l<Ns.length;l++)if(u=Ns[l],m=u.interleaved,m!==null){u.interleaved=null;var x=m.next,w=u.pending;if(w!==null){var E=w.next;w.next=x,m.next=E}u.pending=m}Ns=null}return s}function Cm(s,l){do{var u=Zt;try{if($d(),_c.current=Ec,wc){for(var m=Wt.memoizedState;m!==null;){var x=m.queue;x!==null&&(x.pending=null),m=m.next}wc=!1}if(js=0,hr=ar=Wt=null,zo=!1,$o=0,wf.current=null,u===null||u.return===null){or=1,Ko=l,Zt=null;break}e:{var w=s,E=u.return,U=u,Y=l;if(l=wr,U.flags|=32768,Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ge=Y,Ne=U,Pe=Ne.tag;if((Ne.mode&1)===0&&(Pe===0||Pe===11||Pe===15)){var Ae=Ne.alternate;Ae?(Ne.updateQueue=Ae.updateQueue,Ne.memoizedState=Ae.memoizedState,Ne.lanes=Ae.lanes):(Ne.updateQueue=null,Ne.memoizedState=null)}var Ge=Zp(E);if(Ge!==null){Ge.flags&=-257,em(Ge,E,U,w,l),Ge.mode&1&&Qp(w,ge,l),l=Ge,Y=ge;var qe=l.updateQueue;if(qe===null){var Xe=new Set;Xe.add(Y),l.updateQueue=Xe}else qe.add(Y);break e}else{if((l&1)===0){Qp(w,ge,l),Ff();break e}Y=Error(t(426))}}else if(zt&&U.mode&1){var Jt=Zp(E);if(Jt!==null){(Jt.flags&65536)===0&&(Jt.flags|=256),em(Jt,E,U,w,l),Ud(ja(Y,U));break e}}w=Y=ja(Y,U),or!==4&&(or=2),qo===null?qo=[w]:qo.push(w),w=E;do{switch(w.tag){case 3:w.flags|=65536,l&=-l,w.lanes|=l;var ae=Yp(w,Y,l);Sp(w,ae);break e;case 1:U=Y;var Q=w.type,ue=w.stateNode;if((w.flags&128)===0&&(typeof Q.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(ns===null||!ns.has(ue)))){w.flags|=65536,l&=-l,w.lanes|=l;var Le=Jp(w,U,l);Sp(w,Le);break e}}w=w.return}while(w!==null)}jm(u)}catch(Ye){l=Ye,Zt===u&&u!==null&&(Zt=u=u.return);continue}break}while(!0)}function Nm(){var s=Fc.current;return Fc.current=Ec,s===null?Ec:s}function Ff(){(or===0||or===3||or===2)&&(or=4),pr===null||(Ds&268435455)===0&&(jc&268435455)===0||as(pr,wr)}function Lc(s,l){var u=mt;mt|=2;var m=Nm();(pr!==s||wr!==l)&&(ki=null,Ps(s,l));do try{fw();break}catch(x){Cm(s,x)}while(!0);if($d(),mt=u,Fc.current=m,Zt!==null)throw Error(t(261));return pr=null,wr=0,or}function fw(){for(;Zt!==null;)Fm(Zt)}function hw(){for(;Zt!==null&&!He();)Fm(Zt)}function Fm(s){var l=Pm(s.alternate,s,ln);s.memoizedProps=s.pendingProps,l===null?jm(s):Zt=l,wf.current=null}function jm(s){var l=s;do{var u=l.alternate;if(s=l.return,(l.flags&32768)===0){if(u=sw(u,l,ln),u!==null){Zt=u;return}}else{if(u=aw(u,l),u!==null){u.flags&=32767,Zt=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{or=6,Zt=null;return}}if(l=l.sibling,l!==null){Zt=l;return}Zt=l=s}while(l!==null);or===0&&(or=5)}function Rs(s,l,u){var m=lt,x=kn.transition;try{kn.transition=null,lt=1,pw(s,l,u,m)}finally{kn.transition=x,lt=m}return null}function pw(s,l,u,m){do Ra();while(is!==null);if((mt&6)!==0)throw Error(t(327));u=s.finishedWork;var x=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var w=u.lanes|u.childLanes;if(da(s,w),s===pr&&(Zt=pr=null,wr=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Oc||(Oc=!0,Rm(Ut,function(){return Ra(),null})),w=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||w){w=kn.transition,kn.transition=null;var E=lt;lt=1;var U=mt;mt|=4,wf.current=null,lw(s,u),wm(u,s),P_(Nd),ql=!!Cd,Nd=Cd=null,s.current=u,cw(u),Ie(),mt=U,lt=E,kn.transition=w}else s.current=u;if(Oc&&(Oc=!1,is=s,Pc=x),w=s.pendingLanes,w===0&&(ns=null),Ee(u.stateNode),Xr(s,Re()),l!==null)for(m=s.onRecoverableError,u=0;u<l.length;u++)x=l[u],m(x.value,{componentStack:x.stack,digest:x.digest});if(Dc)throw Dc=!1,s=Ef,Ef=null,s;return(Pc&1)!==0&&s.tag!==0&&Ra(),w=s.pendingLanes,(w&1)!==0?s===kf?Xo++:(Xo=0,kf=s):Xo=0,Zi(),null}function Ra(){if(is!==null){var s=vo(Pc),l=kn.transition,u=lt;try{if(kn.transition=null,lt=16>s?16:s,is===null)var m=!1;else{if(s=is,is=null,Pc=0,(mt&6)!==0)throw Error(t(331));var x=mt;for(mt|=4,Ke=s.current;Ke!==null;){var w=Ke,E=w.child;if((Ke.flags&16)!==0){var U=w.deletions;if(U!==null){for(var Y=0;Y<U.length;Y++){var ge=U[Y];for(Ke=ge;Ke!==null;){var Ne=Ke;switch(Ne.tag){case 0:case 11:case 15:Go(8,Ne,w)}var Pe=Ne.child;if(Pe!==null)Pe.return=Ne,Ke=Pe;else for(;Ke!==null;){Ne=Ke;var Ae=Ne.sibling,Ge=Ne.return;if(gm(Ne),Ne===ge){Ke=null;break}if(Ae!==null){Ae.return=Ge,Ke=Ae;break}Ke=Ge}}}var qe=w.alternate;if(qe!==null){var Xe=qe.child;if(Xe!==null){qe.child=null;do{var Jt=Xe.sibling;Xe.sibling=null,Xe=Jt}while(Xe!==null)}}Ke=w}}if((w.subtreeFlags&2064)!==0&&E!==null)E.return=w,Ke=E;else e:for(;Ke!==null;){if(w=Ke,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Go(9,w,w.return)}var ae=w.sibling;if(ae!==null){ae.return=w.return,Ke=ae;break e}Ke=w.return}}var Q=s.current;for(Ke=Q;Ke!==null;){E=Ke;var ue=E.child;if((E.subtreeFlags&2064)!==0&&ue!==null)ue.return=E,Ke=ue;else e:for(E=Q;Ke!==null;){if(U=Ke,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:Nc(9,U)}}catch(Ye){Vt(U,U.return,Ye)}if(U===E){Ke=null;break e}var Le=U.sibling;if(Le!==null){Le.return=U.return,Ke=Le;break e}Ke=U.return}}if(mt=x,Zi(),le&&typeof le.onPostCommitFiberRoot=="function")try{le.onPostCommitFiberRoot(H,s)}catch{}m=!0}return m}finally{lt=u,kn.transition=l}}return!1}function Dm(s,l,u){l=ja(u,l),l=Yp(s,l,1),s=ts(s,l,1),l=Ur(),s!==null&&(gi(s,1,l),Xr(s,l))}function Vt(s,l,u){if(s.tag===3)Dm(s,s,u);else for(;l!==null;){if(l.tag===3){Dm(l,s,u);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ns===null||!ns.has(m))){s=ja(u,s),s=Jp(l,s,1),l=ts(l,s,1),s=Ur(),l!==null&&(gi(l,1,s),Xr(l,s));break}}l=l.return}}function mw(s,l,u){var m=s.pingCache;m!==null&&m.delete(l),l=Ur(),s.pingedLanes|=s.suspendedLanes&u,pr===s&&(wr&u)===u&&(or===4||or===3&&(wr&130023424)===wr&&500>Re()-Sf?Ps(s,0):bf|=u),Xr(s,l)}function Om(s,l){l===0&&((s.mode&1)===0?l=1:(l=st,st<<=1,(st&130023424)===0&&(st=4194304)));var u=Ur();s=bi(s,l),s!==null&&(gi(s,l,u),Xr(s,u))}function gw(s){var l=s.memoizedState,u=0;l!==null&&(u=l.retryLane),Om(s,u)}function xw(s,l){var u=0;switch(s.tag){case 13:var m=s.stateNode,x=s.memoizedState;x!==null&&(u=x.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(t(314))}m!==null&&m.delete(l),Om(s,u)}var Pm;Pm=function(s,l,u){if(s!==null)if(s.memoizedProps!==l.pendingProps||Vr.current)Kr=!0;else{if((s.lanes&u)===0&&(l.flags&128)===0)return Kr=!1,iw(s,l,u);Kr=(s.flags&131072)!==0}else Kr=!1,zt&&(l.flags&1048576)!==0&&hp(l,fc,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;Ac(s,l),s=l.pendingProps;var x=Sa(l,jr.current);Na(l,u),x=Zd(null,l,m,s,x,u);var w=ef();return l.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Gr(m)?(w=!0,cc(l)):w=!1,l.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,Gd(l),x.updater=kc,l.stateNode=x,x._reactInternals=l,of(l,m,s,u),l=df(null,l,m,!0,w,u)):(l.tag=0,zt&&w&&Id(l),Br(null,l,x,u),l=l.child),l;case 16:m=l.elementType;e:{switch(Ac(s,l),s=l.pendingProps,x=m._init,m=x(m._payload),l.type=m,x=l.tag=yw(m),s=$n(m,s),x){case 0:l=uf(null,l,m,s,u);break e;case 1:l=am(null,l,m,s,u);break e;case 11:l=tm(null,l,m,s,u);break e;case 14:l=rm(null,l,m,$n(m.type,s),u);break e}throw Error(t(306,m,""))}return l;case 0:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:$n(m,x),uf(s,l,m,x,u);case 1:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:$n(m,x),am(s,l,m,x,u);case 3:e:{if(om(l),s===null)throw Error(t(387));m=l.pendingProps,w=l.memoizedState,x=w.element,bp(s,l),vc(l,m,null,u);var E=l.memoizedState;if(m=E.element,w.isDehydrated)if(w={element:m,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){x=ja(Error(t(423)),l),l=lm(s,l,m,u,x);break e}else if(m!==x){x=ja(Error(t(424)),l),l=lm(s,l,m,u,x);break e}else for(on=Yi(l.stateNode.containerInfo.firstChild),an=l,zt=!0,zn=null,u=_p(l,null,m,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Ta(),m===x){l=Ei(s,l,u);break e}Br(s,l,m,u)}l=l.child}return l;case 5:return kp(l),s===null&&Bd(l),m=l.type,x=l.pendingProps,w=s!==null?s.memoizedProps:null,E=x.children,Fd(m,x)?E=null:w!==null&&Fd(m,w)&&(l.flags|=32),sm(s,l),Br(s,l,E,u),l.child;case 6:return s===null&&Bd(l),null;case 13:return cm(s,l,u);case 4:return Kd(l,l.stateNode.containerInfo),m=l.pendingProps,s===null?l.child=Aa(l,null,m,u):Br(s,l,m,u),l.child;case 11:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:$n(m,x),tm(s,l,m,x,u);case 7:return Br(s,l,l.pendingProps,u),l.child;case 8:return Br(s,l,l.pendingProps.children,u),l.child;case 12:return Br(s,l,l.pendingProps.children,u),l.child;case 10:e:{if(m=l.type._context,x=l.pendingProps,w=l.memoizedProps,E=x.value,Dt(mc,m._currentValue),m._currentValue=E,w!==null)if(Un(w.value,E)){if(w.children===x.children&&!Vr.current){l=Ei(s,l,u);break e}}else for(w=l.child,w!==null&&(w.return=l);w!==null;){var U=w.dependencies;if(U!==null){E=w.child;for(var Y=U.firstContext;Y!==null;){if(Y.context===m){if(w.tag===1){Y=Si(-1,u&-u),Y.tag=2;var ge=w.updateQueue;if(ge!==null){ge=ge.shared;var Ne=ge.pending;Ne===null?Y.next=Y:(Y.next=Ne.next,Ne.next=Y),ge.pending=Y}}w.lanes|=u,Y=w.alternate,Y!==null&&(Y.lanes|=u),Hd(w.return,u,l),U.lanes|=u;break}Y=Y.next}}else if(w.tag===10)E=w.type===l.type?null:w.child;else if(w.tag===18){if(E=w.return,E===null)throw Error(t(341));E.lanes|=u,U=E.alternate,U!==null&&(U.lanes|=u),Hd(E,u,l),E=w.sibling}else E=w.child;if(E!==null)E.return=w;else for(E=w;E!==null;){if(E===l){E=null;break}if(w=E.sibling,w!==null){w.return=E.return,E=w;break}E=E.return}w=E}Br(s,l,x.children,u),l=l.child}return l;case 9:return x=l.type,m=l.pendingProps.children,Na(l,u),x=Sn(x),m=m(x),l.flags|=1,Br(s,l,m,u),l.child;case 14:return m=l.type,x=$n(m,l.pendingProps),x=$n(m.type,x),rm(s,l,m,x,u);case 15:return nm(s,l,l.type,l.pendingProps,u);case 17:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:$n(m,x),Ac(s,l),l.tag=1,Gr(m)?(s=!0,cc(l)):s=!1,Na(l,u),qp(l,m,x),of(l,m,x,u),df(null,l,m,!0,s,u);case 19:return dm(s,l,u);case 22:return im(s,l,u)}throw Error(t(156,l.tag))};function Rm(s,l){return De(s,l)}function vw(s,l,u,m){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tn(s,l,u,m){return new vw(s,l,u,m)}function jf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function yw(s){if(typeof s=="function")return jf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===D)return 11;if(s===ye)return 14}return 2}function os(s,l){var u=s.alternate;return u===null?(u=Tn(s.tag,l,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=l,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,l=s.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function Mc(s,l,u,m,x,w){var E=2;if(m=s,typeof s=="function")jf(s)&&(E=1);else if(typeof s=="string")E=5;else e:switch(s){case L:return Is(u.children,x,w,l);case V:E=8,x|=8;break;case q:return s=Tn(12,u,l,x|2),s.elementType=q,s.lanes=w,s;case te:return s=Tn(13,u,l,x),s.elementType=te,s.lanes=w,s;case ve:return s=Tn(19,u,l,x),s.elementType=ve,s.lanes=w,s;case je:return Bc(u,x,w,l);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case O:E=10;break e;case ee:E=9;break e;case D:E=11;break e;case ye:E=14;break e;case Oe:E=16,m=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return l=Tn(E,u,l,x),l.elementType=s,l.type=m,l.lanes=w,l}function Is(s,l,u,m){return s=Tn(7,s,m,l),s.lanes=u,s}function Bc(s,l,u,m){return s=Tn(22,s,m,l),s.elementType=je,s.lanes=u,s.stateNode={isHidden:!1},s}function Df(s,l,u){return s=Tn(6,s,null,l),s.lanes=u,s}function Of(s,l,u){return l=Tn(4,s.children!==null?s.children:[],s.key,l),l.lanes=u,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}function _w(s,l,u,m,x){this.tag=l,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ir(0),this.expirationTimes=ir(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ir(0),this.identifierPrefix=m,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function Pf(s,l,u,m,x,w,E,U,Y){return s=new _w(s,l,u,U,Y),l===1?(l=1,w===!0&&(l|=8)):l=0,w=Tn(3,null,null,l),s.current=w,w.stateNode=s,w.memoizedState={element:m,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gd(w),s}function ww(s,l,u){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:m==null?null:""+m,children:s,containerInfo:l,implementation:u}}function Im(s){if(!s)return Qi;s=s._reactInternals;e:{if(M(s)!==s||s.tag!==1)throw Error(t(170));var l=s;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Gr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(Gr(u))return up(s,u,l)}return l}function Lm(s,l,u,m,x,w,E,U,Y){return s=Pf(u,m,!0,s,x,w,E,U,Y),s.context=Im(null),u=s.current,m=Ur(),x=ss(u),w=Si(m,x),w.callback=l??null,ts(u,w,x),s.current.lanes=x,gi(s,x,m),Xr(s,m),s}function Uc(s,l,u,m){var x=l.current,w=Ur(),E=ss(x);return u=Im(u),l.context===null?l.context=u:l.pendingContext=u,l=Si(w,E),l.payload={element:s},m=m===void 0?null:m,m!==null&&(l.callback=m),s=ts(x,l,E),s!==null&&(Vn(s,x,E,w),xc(s,x,E)),E}function zc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Mm(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<l?u:l}}function Rf(s,l){Mm(s,l),(s=s.alternate)&&Mm(s,l)}function bw(){return null}var Bm=typeof reportError=="function"?reportError:function(s){console.error(s)};function If(s){this._internalRoot=s}$c.prototype.render=If.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(t(409));Uc(s,l,null,null)},$c.prototype.unmount=If.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;Os(function(){Uc(null,s,null,null)}),l[vi]=null}};function $c(s){this._internalRoot=s}$c.prototype.unstable_scheduleHydration=function(s){if(s){var l=ha();s={blockedOn:null,target:s,priority:l};for(var u=0;u<Ki.length&&l!==0&&l<Ki[u].priority;u++);Ki.splice(u,0,s),u===0&&k0(s)}};function Lf(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Wc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Um(){}function Sw(s,l,u,m,x){if(x){if(typeof m=="function"){var w=m;m=function(){var ge=zc(E);w.call(ge)}}var E=Lm(l,m,s,0,null,!1,!1,"",Um);return s._reactRootContainer=E,s[vi]=E.current,Oo(s.nodeType===8?s.parentNode:s),Os(),E}for(;x=s.lastChild;)s.removeChild(x);if(typeof m=="function"){var U=m;m=function(){var ge=zc(Y);U.call(ge)}}var Y=Pf(s,0,!1,null,null,!1,!1,"",Um);return s._reactRootContainer=Y,s[vi]=Y.current,Oo(s.nodeType===8?s.parentNode:s),Os(function(){Uc(l,Y,u,m)}),Y}function Hc(s,l,u,m,x){var w=u._reactRootContainer;if(w){var E=w;if(typeof x=="function"){var U=x;x=function(){var Y=zc(E);U.call(Y)}}Uc(l,E,s,x)}else E=Sw(u,l,s,x,m);return zc(E)}fa=function(s){switch(s.tag){case 3:var l=s.stateNode;if(l.current.memoizedState.isDehydrated){var u=pt(l.pendingLanes);u!==0&&(sr(l,u|1),Xr(l,Re()),(mt&6)===0&&(Pa=Re()+500,Zi()))}break;case 13:Os(function(){var m=bi(s,1);if(m!==null){var x=Ur();Vn(m,s,1,x)}}),Rf(s,1)}},xi=function(s){if(s.tag===13){var l=bi(s,134217728);if(l!==null){var u=Ur();Vn(l,s,134217728,u)}Rf(s,134217728)}},Wi=function(s){if(s.tag===13){var l=ss(s),u=bi(s,l);if(u!==null){var m=Ur();Vn(u,s,l,m)}Rf(s,l)}},ha=function(){return lt},yo=function(s,l){var u=lt;try{return lt=s,l()}finally{lt=u}},zi=function(s,l,u){switch(l){case"input":if(ke(s,u),l=u.name,u.type==="radio"&&l!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var m=u[l];if(m!==s&&m.form===s.form){var x=oc(m);if(!x)throw Error(t(90));pe(m),ke(m,x)}}}break;case"textarea":et(s,u);break;case"select":l=u.value,l!=null&&gt(s,!!u.multiple,l,!1)}},ca=Cf,ua=Os;var Ew={usingClientEntryPoint:!1,Events:[Io,wa,oc,Rn,la,Cf]},Yo={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kw={bundleType:Yo.bundleType,version:Yo.version,rendererPackageName:Yo.rendererPackageName,rendererConfig:Yo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=de(s),s===null?null:s.stateNode},findFiberByHostInstance:Yo.findFiberByHostInstance||bw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vc.isDisabled&&Vc.supportsFiber)try{H=Vc.inject(kw),le=Vc}catch{}}return Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ew,Yr.createPortal=function(s,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lf(l))throw Error(t(200));return ww(s,l,null,u)},Yr.createRoot=function(s,l){if(!Lf(s))throw Error(t(299));var u=!1,m="",x=Bm;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(x=l.onRecoverableError)),l=Pf(s,1,!1,null,null,u,!1,m,x),s[vi]=l.current,Oo(s.nodeType===8?s.parentNode:s),new If(l)},Yr.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=de(l),s=s===null?null:s.stateNode,s},Yr.flushSync=function(s){return Os(s)},Yr.hydrate=function(s,l,u){if(!Wc(l))throw Error(t(200));return Hc(null,s,l,!0,u)},Yr.hydrateRoot=function(s,l,u){if(!Lf(s))throw Error(t(405));var m=u!=null&&u.hydratedSources||null,x=!1,w="",E=Bm;if(u!=null&&(u.unstable_strictMode===!0&&(x=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),l=Lm(l,null,s,1,u??null,x,!1,w,E),s[vi]=l.current,Oo(s),m)for(s=0;s<m.length;s++)u=m[s],x=u._getVersion,x=x(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,x]:l.mutableSourceEagerHydrationData.push(u,x);return new $c(l)},Yr.render=function(s,l,u){if(!Wc(l))throw Error(t(200));return Hc(null,s,l,!1,u)},Yr.unmountComponentAtNode=function(s){if(!Wc(s))throw Error(t(40));return s._reactRootContainer?(Os(function(){Hc(null,null,s,!1,function(){s._reactRootContainer=null,s[vi]=null})}),!0):!1},Yr.unstable_batchedUpdates=Cf,Yr.unstable_renderSubtreeIntoContainer=function(s,l,u,m){if(!Wc(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Hc(s,l,u,!1,m)},Yr.version="18.3.1-next-f1338f8080-20240426",Yr}var qm;function Pw(){if(qm)return Uf.exports;qm=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Uf.exports=Ow(),Uf.exports}var Xm;function Rw(){if(Xm)return Gc;Xm=1;var r=Pw();return Gc.createRoot=r.createRoot,Gc.hydrateRoot=r.hydrateRoot,Gc}var Iw=Rw();const Lw=Ih(Iw),Mw="modulepreload",Bw=function(r){return"/Sistema-Contable-Nuevo/"+r},Ym={},Il=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let f=function(p){return Promise.all(p.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};var o=f;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");i=f(t.map(p=>{if(p=Bw(p),p in Ym)return;Ym[p]=!0;const g=p.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const y=document.createElement("link");if(y.rel=g?"stylesheet":Mw,g||(y.as="script"),y.crossOrigin="",y.href=p,d&&y.setAttribute("nonce",d),document.head.appendChild(y),g)return new Promise((b,_)=>{y.addEventListener("load",b),y.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&a(d.reason);return e().catch(a)})},Uw=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Il(async()=>{const{default:n}=await Promise.resolve().then(()=>co);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class Mh extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class zw extends Mh{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Jm extends Mh{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Qm extends Mh{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ph;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(ph||(ph={}));var $w=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};class Ww{constructor(e,{headers:t={},customFetch:n,region:i=ph.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=Uw(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return $w(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:o}=t;let c={},{region:d}=t;d||(d=this.region);const f=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let p;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",p=o):typeof o=="string"?(c["Content-Type"]="text/plain",p=o):typeof FormData<"u"&&o instanceof FormData?p=o:(c["Content-Type"]="application/json",p=JSON.stringify(o)));const g=yield this.fetch(f.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),i),body:p}).catch(_=>{throw new zw(_)}),v=g.headers.get("x-relay-error");if(v&&v==="true")throw new Jm(g);if(!g.ok)throw new Qm(g);let y=((n=g.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield g.json():y==="application/octet-stream"?b=yield g.blob():y==="text/event-stream"?b=g:y==="multipart/form-data"?b=yield g.formData():b=yield g.text(),{data:b,error:null,response:g}}catch(i){return{data:null,error:i,response:i instanceof Qm||i instanceof Jm?i.context:void 0}}})}}var gr={},Ia={},La={},Ma={},Ba={},Ua={},Hw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ao=Hw();const Vw=ao.fetch,m1=ao.fetch.bind(ao),g1=ao.Headers,Gw=ao.Request,Kw=ao.Response,co=Object.freeze(Object.defineProperty({__proto__:null,Headers:g1,Request:Gw,Response:Kw,default:m1,fetch:Vw},Symbol.toStringTag,{value:"Module"})),qw=Aw(co);var Kc={},Zm;function x1(){if(Zm)return Kc;Zm=1,Object.defineProperty(Kc,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Kc.default=r,Kc}var eg;function v1(){if(eg)return Ua;eg=1;var r=Ua&&Ua.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ua,"__esModule",{value:!0});const e=r(qw),t=r(x1());class n{constructor(a){var o,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(o=a.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,o){return this.headers=new Headers(this.headers),this.headers.set(a,o),this}then(a,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var p,g,v,y;let b=null,_=null,S=null,A=f.status,C=f.statusText;if(f.ok){if(this.method!=="HEAD"){const G=await f.text();G===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?_=G:_=JSON.parse(G))}const P=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),z=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");P&&z&&z.length>1&&(S=parseInt(z[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(b={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,S=null,A=406,C="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const P=await f.text();try{b=JSON.parse(P),Array.isArray(b)&&f.status===404&&(_=[],b=null,A=200,C="OK")}catch{f.status===404&&P===""?(A=204,C="No Content"):b={message:P}}if(b&&this.isMaybeSingle&&(!((y=b?.details)===null||y===void 0)&&y.includes("0 rows"))&&(b=null,A=200,C="OK"),b&&this.shouldThrowOnError)throw new t.default(b)}return{error:b,data:_,count:S,status:A,statusText:C}});return this.shouldThrowOnError||(d=d.catch(f=>{var p,g,v;return{error:{message:`${(p=f?.name)!==null&&p!==void 0?p:"FetchError"}: ${f?.message}`,details:`${(g=f?.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(v=f?.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,o)}returns(){return this}overrideTypes(){return this}}return Ua.default=n,Ua}var tg;function y1(){if(tg)return Ba;tg=1;var r=Ba&&Ba.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ba,"__esModule",{value:!0});const e=r(v1());class t extends e.default{select(i){let a=!1;const o=(i??"*").split("").map(c=>/\s/.test(c)&&!a?"":(c==='"'&&(a=!a),c)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:a=!0,nullsFirst:o,foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.order`:"order",p=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${p?`${p},`:""}${i}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:a,referencedTable:o=a}={}){const c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(c,`${i}`),this}range(i,a,{foreignTable:o,referencedTable:c=o}={}){const d=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${i}`),this.url.searchParams.set(f,`${a-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:a=!1,settings:o=!1,buffers:c=!1,wal:d=!1,format:f="text"}={}){var p;const g=[i?"analyze":null,a?"verbose":null,o?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),v=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${v}"; options=${g};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Ba.default=t,Ba}var rg;function Bh(){if(rg)return Ma;rg=1;var r=Ma&&Ma.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ma,"__esModule",{value:!0});const e=r(y1());class t extends e.default{eq(i,a){return this.url.searchParams.append(i,`eq.${a}`),this}neq(i,a){return this.url.searchParams.append(i,`neq.${a}`),this}gt(i,a){return this.url.searchParams.append(i,`gt.${a}`),this}gte(i,a){return this.url.searchParams.append(i,`gte.${a}`),this}lt(i,a){return this.url.searchParams.append(i,`lt.${a}`),this}lte(i,a){return this.url.searchParams.append(i,`lte.${a}`),this}like(i,a){return this.url.searchParams.append(i,`like.${a}`),this}likeAllOf(i,a){return this.url.searchParams.append(i,`like(all).{${a.join(",")}}`),this}likeAnyOf(i,a){return this.url.searchParams.append(i,`like(any).{${a.join(",")}}`),this}ilike(i,a){return this.url.searchParams.append(i,`ilike.${a}`),this}ilikeAllOf(i,a){return this.url.searchParams.append(i,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(i,a){return this.url.searchParams.append(i,`ilike(any).{${a.join(",")}}`),this}is(i,a){return this.url.searchParams.append(i,`is.${a}`),this}in(i,a){const o=Array.from(new Set(a)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${o})`),this}contains(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cs.{${a.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(a)}`),this}containedBy(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cd.{${a.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(a)}`),this}rangeGt(i,a){return this.url.searchParams.append(i,`sr.${a}`),this}rangeGte(i,a){return this.url.searchParams.append(i,`nxl.${a}`),this}rangeLt(i,a){return this.url.searchParams.append(i,`sl.${a}`),this}rangeLte(i,a){return this.url.searchParams.append(i,`nxr.${a}`),this}rangeAdjacent(i,a){return this.url.searchParams.append(i,`adj.${a}`),this}overlaps(i,a){return typeof a=="string"?this.url.searchParams.append(i,`ov.${a}`):this.url.searchParams.append(i,`ov.{${a.join(",")}}`),this}textSearch(i,a,{config:o,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const f=o===void 0?"":`(${o})`;return this.url.searchParams.append(i,`${d}fts${f}.${a}`),this}match(i){return Object.entries(i).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(i,a,o){return this.url.searchParams.append(i,`not.${a}.${o}`),this}or(i,{foreignTable:a,referencedTable:o=a}={}){const c=o?`${o}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,a,o){return this.url.searchParams.append(i,`${a}.${o}`),this}}return Ma.default=t,Ma}var ng;function _1(){if(ng)return La;ng=1;var r=La&&La.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(La,"__esModule",{value:!0});const e=r(Bh());class t{constructor(i,{headers:a={},schema:o,fetch:c}){this.url=i,this.headers=new Headers(a),this.schema=o,this.fetch=c}select(i,{head:a=!1,count:o}={}){const c=a?"HEAD":"GET";let d=!1;const f=(i??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",f),o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:a,defaultToNull:o=!0}={}){var c;const d="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}upsert(i,{onConflict:a,ignoreDuplicates:o=!1,count:c,defaultToNull:d=!0}={}){var f;const p="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const g=i.reduce((v,y)=>v.concat(Object.keys(y)),[]);if(g.length>0){const v=[...new Set(g)].map(y=>`"${y}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(i,{count:a}={}){var o;const c="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:i}={}){var a;const o="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return La.default=t,La}var ig;function Xw(){if(ig)return Ia;ig=1;var r=Ia&&Ia.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ia,"__esModule",{value:!0});const e=r(_1()),t=r(Bh());class n{constructor(a,{headers:o={},schema:c,fetch:d}={}){this.url=a,this.headers=new Headers(o),this.schemaName=c,this.fetch=d}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:c=!1,get:d=!1,count:f}={}){var p;let g;const v=new URL(`${this.url}/rpc/${a}`);let y;c||d?(g=c?"HEAD":"GET",Object.entries(o).filter(([_,S])=>S!==void 0).map(([_,S])=>[_,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([_,S])=>{v.searchParams.append(_,S)})):(g="POST",y=o);const b=new Headers(this.headers);return f&&b.set("Prefer",`count=${f}`),new t.default({method:g,url:v,headers:b,schema:this.schemaName,body:y,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return Ia.default=n,Ia}var sg;function Yw(){if(sg)return gr;sg=1;var r=gr&&gr.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(gr,"__esModule",{value:!0}),gr.PostgrestError=gr.PostgrestBuilder=gr.PostgrestTransformBuilder=gr.PostgrestFilterBuilder=gr.PostgrestQueryBuilder=gr.PostgrestClient=void 0;const e=r(Xw());gr.PostgrestClient=e.default;const t=r(_1());gr.PostgrestQueryBuilder=t.default;const n=r(Bh());gr.PostgrestFilterBuilder=n.default;const i=r(y1());gr.PostgrestTransformBuilder=i.default;const a=r(v1());gr.PostgrestBuilder=a.default;const o=r(x1());return gr.PostgrestError=o.default,gr.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:a.default,PostgrestError:o.default},gr}var Jw=Yw();const Qw=Ih(Jw),{PostgrestClient:Zw,PostgrestQueryBuilder:vj,PostgrestFilterBuilder:yj,PostgrestTransformBuilder:_j,PostgrestBuilder:wj,PostgrestError:bj}=Qw;class e2{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const t2="2.15.4",r2=`realtime-js/${t2}`,n2="1.0.0",mh=1e4,i2=1e3,s2=100;var dl;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(dl||(dl={}));var lr;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(lr||(lr={}));var Xn;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Xn||(Xn={}));var gh;(function(r){r.websocket="websocket"})(gh||(gh={}));var Hs;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Hs||(Hs={}));class a2{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const i=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const c=n.decode(e.slice(o,o+i));o=o+i;const d=n.decode(e.slice(o,o+a));o=o+a;const f=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:c,event:d,payload:f}}}class w1{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ot;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Ot||(Ot={}));const ag=(r,e,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((a,o)=>(a[o]=o2(o,r,e,i),a),{})},o2=(r,e,t,n)=>{const i=e.find(c=>c.name===r),a=i?.type,o=t[r];return a&&!n.includes(a)?b1(a,o):xh(o)},b1=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return d2(e,t)}switch(r){case Ot.bool:return l2(e);case Ot.float4:case Ot.float8:case Ot.int2:case Ot.int4:case Ot.int8:case Ot.numeric:case Ot.oid:return c2(e);case Ot.json:case Ot.jsonb:return u2(e);case Ot.timestamp:return f2(e);case Ot.abstime:case Ot.date:case Ot.daterange:case Ot.int4range:case Ot.int8range:case Ot.money:case Ot.reltime:case Ot.text:case Ot.time:case Ot.timestamptz:case Ot.timetz:case Ot.tsrange:case Ot.tstzrange:return xh(e);default:return xh(e)}},xh=r=>r,l2=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},c2=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},u2=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},d2=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let a;const o=r.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(c=>b1(e,c))}return r},f2=r=>typeof r=="string"?r.replace(" ","T"):r,S1=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Wf{constructor(e,t,n={},i=mh){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var og;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(og||(og={}));class fl{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fl.syncState(this.state,i,a,o),this.pendingDiffs.forEach(d=>{this.state=fl.syncDiff(this.state,d,a,o)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=fl.syncDiff(this.state,i,a,o),c())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const a=this.cloneDeep(e),o=this.transformState(t),c={},d={};return this.map(a,(f,p)=>{o[f]||(d[f]=p)}),this.map(o,(f,p)=>{const g=a[f];if(g){const v=p.map(S=>S.presence_ref),y=g.map(S=>S.presence_ref),b=p.filter(S=>y.indexOf(S.presence_ref)<0),_=g.filter(S=>v.indexOf(S.presence_ref)<0);b.length>0&&(c[f]=b),_.length>0&&(d[f]=_)}else c[f]=p}),this.syncDiff(a,{joins:c,leaves:d},n,i)}static syncDiff(e,t,n,i){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(c,d)=>{var f;const p=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),p.length>0){const g=e[c].map(y=>y.presence_ref),v=p.filter(y=>g.indexOf(y.presence_ref)<0);e[c].unshift(...v)}n(c,p,d)}),this.map(o,(c,d)=>{let f=e[c];if(!f)return;const p=d.map(g=>g.presence_ref);f=f.filter(g=>p.indexOf(g.presence_ref)<0),e[c]=f,i(c,f,d),f.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return"metas"in i?t[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var lg;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(lg||(lg={}));var hl;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(hl||(hl={}));var Fi;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Fi||(Fi={}));class Uh{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=lr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Wf(this,Xn.join,this.params,this.timeout),this.rejoinTimer=new w1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=lr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=lr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Xn.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new fl(this),this.broadcastEndpointURL=S1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==lr.closed){const{config:{broadcast:o,presence:c,private:d}}=this.params,f=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(y=>y.filter))!==null&&i!==void 0?i:[],p=!!this.bindings[hl.PRESENCE]&&this.bindings[hl.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,g={},v={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(y=>e?.(Fi.CHANNEL_ERROR,y)),this._onClose(()=>e?.(Fi.CLOSED)),this.updateJoinPayload(Object.assign({config:v},g)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:y})=>{var b;if(this.socket.setAuth(),y===void 0){e?.(Fi.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,S=(b=_?.length)!==null&&b!==void 0?b:0,A=[];for(let C=0;C<S;C++){const T=_[C],{filter:{event:P,schema:z,table:G,filter:L}}=T,V=y&&y[C];if(V&&V.event===P&&V.schema===z&&V.table===G&&V.filter===L)A.push(Object.assign(Object.assign({},T),{id:V.id}));else{this.unsubscribe(),this.state=lr.errored,e?.(Fi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(Fi.SUBSCRIBED);return}}).receive("error",y=>{this.state=lr.errored,e?.(Fi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e?.(Fi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===lr.joined&&e===hl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:o}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=f.body)===null||i===void 0?void 0:i.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,c,d;const f=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=lr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Xn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Wf(this,Xn.leave,{},e),n.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=lr.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(a),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Wf(this,e,t,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>s2){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,a;const o=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:p}=Xn;if(n&&[c,d,f,p].indexOf(o)>=0&&n!==this._joinRef())return;let v=this._onMessage(o,t,n);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(y=>{var b,_,S;return((b=y.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(_=y.filter)===null||_===void 0?void 0:_.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(y=>y.callback(v,n)):(a=this.bindings[o])===null||a===void 0||a.filter(y=>{var b,_,S,A,C,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const P=y.id,z=(b=y.filter)===null||b===void 0?void 0:b.event;return P&&((_=t.ids)===null||_===void 0?void 0:_.includes(P))&&(z==="*"||z?.toLocaleLowerCase()===((S=t.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const P=(C=(A=y?.filter)===null||A===void 0?void 0:A.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return P==="*"||P===((T=t?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof v=="object"&&"ids"in v){const b=v.data,{schema:_,table:S,commit_timestamp:A,type:C,errors:T}=b;v=Object.assign(Object.assign({},{schema:_,table:S,commit_timestamp:A,eventType:C,new:{},old:{},errors:T}),this._getPayloadRecords(b))}y.callback(v,n)})}_isClosed(){return this.state===lr.closed}_isJoined(){return this.state===lr.joined}_isJoining(){return this.state===lr.joining}_isLeaving(){return this.state===lr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const i=e.toLocaleLowerCase(),a={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Uh.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Xn.close,{},e)}_onError(e){this._on(Xn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=lr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ag(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ag(e.columns,e.old_record)),t}}const Hf=()=>{},qc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},h2=[1e3,2e3,5e3,1e4],p2=1e4,m2=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class g2{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mh,this.transport=null,this.heartbeatIntervalMs=qc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Hf,this.ref=0,this.reconnectTimer=null,this.logger=Hf,this.conn=null,this.sendBuffer=[],this.serializer=new a2,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Il(async()=>{const{default:c}=await Promise.resolve().then(()=>co);return{default:c}},void 0).then(({default:c})=>c(...o)).catch(c=>{throw new Error(`Failed to load @supabase/node-fetch: ${c.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${gh.websocket}`,this.httpEndpoint=S1(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=e2.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:n2}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case dl.connecting:return Hs.Connecting;case dl.open:return Hs.Open;case dl.closing:return Hs.Closing;default:return Hs.Closed}}isConnected(){return this.connectionState()===Hs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new Uh(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:n,payload:i,ref:a}=e,o=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${t} ${n} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(i2,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},qc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:a,ref:o}=t,c=o?`(${o})`:"",d=a.status||"";this.log("receive",`${d} ${n} ${i} ${c}`.trim(),a),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(i,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Xn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([m2],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const i={access_token:t,version:r2};t&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Xn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new w1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},qc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,i,a,o,c,d,f,p;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:mh,this.heartbeatIntervalMs=(i=e?.heartbeatIntervalMs)!==null&&i!==void 0?i:qc.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Hf,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(g=>h2[g-1]||p2),this.encode=(f=e?.encode)!==null&&f!==void 0?f:((g,v)=>v(JSON.stringify(g))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class zh extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ur(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class x2 extends zh{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class vh extends zh{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var v2=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};const E1=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Il(async()=>{const{default:n}=await Promise.resolve().then(()=>co);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},y2=()=>v2(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Il(()=>Promise.resolve().then(()=>co),void 0)).Response:Response}),yh=r=>{if(Array.isArray(r))return r.map(t=>yh(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[i]=yh(n)}),e},_2=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var Zs=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};const Vf=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),w2=(r,e,t)=>Zs(void 0,void 0,void 0,function*(){const n=yield y2();r instanceof n&&!t?.noResolveJson?r.json().then(i=>{const a=r.status||500,o=i?.statusCode||a+"";e(new x2(Vf(i),a,o))}).catch(i=>{e(new vh(Vf(i),i))}):e(new vh(Vf(r),r))}),b2=(r,e,t,n)=>{const i={method:r,headers:e?.headers||{}};return r==="GET"||!n?i:(_2(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e?.headers),i.body=JSON.stringify(n)):i.body=n,e?.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),t))};function Ll(r,e,t,n,i,a){return Zs(this,void 0,void 0,function*(){return new Promise((o,c)=>{r(t,b2(e,n,i,a)).then(d=>{if(!d.ok)throw d;return n?.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>w2(d,c,n))})})}function wu(r,e,t,n){return Zs(this,void 0,void 0,function*(){return Ll(r,"GET",e,t,n)})}function di(r,e,t,n,i){return Zs(this,void 0,void 0,function*(){return Ll(r,"POST",e,n,i,t)})}function _h(r,e,t,n,i){return Zs(this,void 0,void 0,function*(){return Ll(r,"PUT",e,n,i,t)})}function S2(r,e,t,n){return Zs(this,void 0,void 0,function*(){return Ll(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function k1(r,e,t,n,i){return Zs(this,void 0,void 0,function*(){return Ll(r,"DELETE",e,n,i,t)})}var zr=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};const E2={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class k2{constructor(e,t={},n,i){this.url=e,this.headers=t,this.bucketId=n,this.fetch=E1(i)}uploadOrUpdate(e,t,n,i){return zr(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},cg),i);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),d&&a.append("metadata",this.encodeMetadata(d))):(a=n,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),i?.headers&&(c=Object.assign(Object.assign({},c),i.headers));const f=this._removeEmptyFolders(t),p=this._getFinalPath(f),g=yield(e=="PUT"?_h:di)(this.fetch,`${this.url}/object/${p}`,a,Object.assign({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(a){if(ur(a))return{data:null,error:a};throw a}})}upload(e,t,n){return zr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,i){return zr(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",t);try{let d;const f=Object.assign({upsert:cg.upsert},i),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",f.cacheControl)):(d=n,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType);const g=yield _h(this.fetch,c.toString(),d,{headers:p});return{data:{path:a,fullPath:g.Key},error:null}}catch(d){if(ur(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,t){return zr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);t?.upsert&&(i["x-upsert"]="true");const a=yield di(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+a.url),c=o.searchParams.get("token");if(!c)throw new zh("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}update(e,t,n){return zr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return zr(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ur(i))return{data:null,error:i};throw i}})}copy(e,t,n){return zr(this,void 0,void 0,function*(){try{return{data:{path:(yield di(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ur(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,n){return zr(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),a=yield di(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(ur(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,n){return zr(this,void 0,void 0,function*(){try{const i=yield di(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(ur(i))return{data:null,error:i};throw i}})}download(e,t){return zr(this,void 0,void 0,function*(){const i=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),o=a?`?${a}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield wu(this.fetch,`${this.url}/${i}/${c}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(ur(c))return{data:null,error:c};throw c}})}info(e){return zr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield wu(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:yh(n),error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}exists(e){return zr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield S2(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ur(n)&&n instanceof vh){const i=n.originalError;if([400,404].includes(i?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),i=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&i.push(a);const c=typeof t?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(t?.transform||{});d!==""&&i.push(d);let f=i.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${n}${f}`)}}}remove(e){return zr(this,void 0,void 0,function*(){try{return{data:yield k1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ur(t))return{data:null,error:t};throw t}})}list(e,t,n){return zr(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},E2),t),{prefix:e||""});return{data:yield di(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(ur(i))return{data:null,error:i};throw i}})}listV2(e,t){return zr(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield di(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const T2="2.11.0",A2={"X-Client-Info":`storage-js/${T2}`};var za=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};class C2{constructor(e,t={},n,i){const a=new URL(e);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},A2),t),this.fetch=E1(n)}listBuckets(){return za(this,void 0,void 0,function*(){try{return{data:yield wu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ur(e))return{data:null,error:e};throw e}})}getBucket(e){return za(this,void 0,void 0,function*(){try{return{data:yield wu(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ur(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return za(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return za(this,void 0,void 0,function*(){try{return{data:yield _h(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ur(n))return{data:null,error:n};throw n}})}emptyBucket(e){return za(this,void 0,void 0,function*(){try{return{data:yield di(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ur(t))return{data:null,error:t};throw t}})}deleteBucket(e){return za(this,void 0,void 0,function*(){try{return{data:yield k1(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ur(t))return{data:null,error:t};throw t}})}}class N2 extends C2{constructor(e,t={},n,i){super(e,t,n,i)}from(e){return new k2(this.url,this.headers,e,this.fetch)}}const F2="2.56.1";let sl="";typeof Deno<"u"?sl="deno":typeof document<"u"?sl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?sl="react-native":sl="node";const j2={"X-Client-Info":`supabase-js-${sl}/${F2}`},D2={headers:j2},O2={schema:"public"},P2={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},R2={};var I2=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};const L2=r=>{let e;return r?e=r:typeof fetch>"u"?e=m1:e=fetch,(...t)=>e(...t)},M2=()=>typeof Headers>"u"?g1:Headers,B2=(r,e,t)=>{const n=L2(t),i=M2();return(a,o)=>I2(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:r;let f=new i(o?.headers);return f.has("apikey")||f.set("apikey",r),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),n(a,Object.assign(Object.assign({},o),{headers:f}))})};var U2=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};function z2(r){return r.endsWith("/")?r:r+"/"}function $2(r,e){var t,n;const{db:i,auth:a,realtime:o,global:c}=r,{db:d,auth:f,realtime:p,global:g}=e,v={db:Object.assign(Object.assign({},d),i),auth:Object.assign(Object.assign({},f),a),realtime:Object.assign(Object.assign({},p),o),storage:{},global:Object.assign(Object.assign(Object.assign({},g),c),{headers:Object.assign(Object.assign({},(t=g?.headers)!==null&&t!==void 0?t:{}),(n=c?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>U2(this,void 0,void 0,function*(){return""})};return r.accessToken?v.accessToken=r.accessToken:delete v.accessToken,v}const T1="2.71.1",Ja=30*1e3,wh=3,Gf=wh*Ja,W2="http://localhost:9999",H2="supabase.auth.token",V2={"X-Client-Info":`gotrue-js/${T1}`},bh="X-Supabase-Api-Version",A1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},G2=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,K2=600*1e3;class $h extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function ot(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class q2 extends $h{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function X2(r){return ot(r)&&r.name==="AuthApiError"}class C1 extends $h{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class bs extends $h{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class ds extends bs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Y2(r){return ot(r)&&r.name==="AuthSessionMissingError"}class Xc extends bs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Yc extends bs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Jc extends bs{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function J2(r){return ot(r)&&r.name==="AuthImplicitGrantRedirectError"}class ug extends bs{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Sh extends bs{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Kf(r){return ot(r)&&r.name==="AuthRetryableFetchError"}class dg extends bs{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Eh extends bs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const bu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fg=` 	
\r=`.split(""),Q2=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<fg.length;e+=1)r[fg[e].charCodeAt(0)]=-2;for(let e=0;e<bu.length;e+=1)r[bu[e].charCodeAt(0)]=e;return r})();function hg(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(bu[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(bu[n]),e.queuedBits-=6}}function N1(r,e,t){const n=Q2[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function pg(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{tb(o,n,t)};for(let o=0;o<r.length;o+=1)N1(r.charCodeAt(o),i,a);return e.join("")}function Z2(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function eb(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}Z2(n,e)}}function tb(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if((r>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function rb(r){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<r.length;i+=1)N1(r.charCodeAt(i),t,n);return new Uint8Array(e)}function nb(r){const e=[];return eb(r,t=>e.push(t)),new Uint8Array(e)}function ib(r){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};return r.forEach(i=>hg(i,t,n)),hg(null,t,n),e.join("")}function sb(r){return Math.round(Date.now()/1e3)+r}function ab(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const qn=()=>typeof window<"u"&&typeof document<"u",Ls={tested:!1,writable:!1},F1=()=>{if(!qn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ls.tested)return Ls.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Ls.tested=!0,Ls.writable=!0}catch{Ls.tested=!0,Ls.writable=!1}return Ls.writable};function ob(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,a)=>{e[a]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}const j1=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Il(async()=>{const{default:n}=await Promise.resolve().then(()=>co);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},lb=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Qa=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ms=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},cs=async(r,e)=>{await r.removeItem(e)};class qu{constructor(){this.promise=new qu.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}qu.promiseConstructor=Promise;function qf(r){const e=r.split(".");if(e.length!==3)throw new Eh("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!G2.test(e[n]))throw new Eh("JWT not in base64url format");return{header:JSON.parse(pg(e[0])),payload:JSON.parse(pg(e[1])),signature:rb(e[2]),raw:{header:e[0],payload:e[1]}}}async function cb(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function ub(r,e){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await r(a);if(!e(a,null,o)){n(o);return}}catch(o){if(!e(a,o)){i(o);return}}})()})}function db(r){return("0"+r.toString(16)).substr(-2)}function fb(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let a=0;a<56;a++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,db).join("")}async function hb(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function pb(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await hb(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $a(r,e,t=!1){const n=fb();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await Qa(r,`${e}-code-verifier`,i);const a=await pb(n);return[a,n===a?"plain":"s256"]}const mb=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gb(r){const e=r.headers.get(bh);if(!e||!e.match(mb))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function xb(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function vb(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const yb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wa(r){if(!yb.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xf(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function mg(r){return JSON.parse(JSON.stringify(r))}var _b=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const $s=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),wb=[502,503,504];async function gg(r){var e;if(!lb(r))throw new Sh($s(r),0);if(wb.includes(r.status))throw new Sh($s(r),r.status);let t;try{t=await r.json()}catch(a){throw new C1($s(a),a)}let n;const i=gb(r);if(i&&i.getTime()>=A1["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new dg($s(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new ds}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new dg($s(t),r.status,t.weak_password.reasons);throw new q2($s(t),r.status||500,n)}const bb=(r,e,t,n)=>{const i={method:r,headers:e?.headers||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function ft(r,e,t,n){var i;const a=Object.assign({},n?.headers);a[bh]||(a[bh]=A1["2024-01-01"].name),n?.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(i=n?.query)!==null&&i!==void 0?i:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await Sb(r,e,t+c,{headers:a,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(d):{data:Object.assign({},d),error:null}}async function Sb(r,e,t,n,i,a){const o=bb(e,n,i,a);let c;try{c=await r(t,Object.assign({},o))}catch(d){throw console.error(d),new Sh($s(d),0)}if(c.ok||await gg(c),n?.noResolveJson)return c;try{return await c.json()}catch(d){await gg(d)}}function Ai(r){var e;let t=null;Ab(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=sb(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function xg(r){const e=Ai(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function fs(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Eb(r){return{data:r,error:null}}function kb(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:a}=r,o=_b(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:a},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function Tb(r){return r}function Ab(r){return r.access_token&&r.refresh_token&&r.expires_in}const Yf=["global","local","others"];var Cb=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Nb{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=j1(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Yf[0]){if(Yf.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yf.join(", ")}`);try{return await ft(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await ft(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:fs})}catch(n){if(ot(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=Cb(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n?.newEmail,delete i.newEmail),await ft(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:kb,redirectTo:t?.redirectTo})}catch(t){if(ot(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ft(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:fs})}catch(t){if(ot(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,a,o,c,d;try{const f={nextPage:null,lastPage:0,total:0},p=await ft(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=e?.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:Tb});if(p.error)throw p.error;const g=await p.json(),v=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(d=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return y.length>0&&(y.forEach(b=>{const _=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);f[`${S}Page`]=_}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(ot(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Wa(e);try{return await ft(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:fs})}catch(t){if(ot(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Wa(e);try{return await ft(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:fs})}catch(n){if(ot(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){Wa(e);try{return await ft(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:fs})}catch(n){if(ot(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Wa(e.userId);try{const{data:t,error:n}=await ft(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(ot(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Wa(e.userId),Wa(e.id);try{return{data:await ft(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}}}function vg(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Fb(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ha={debug:!!(globalThis&&F1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class D1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class jb extends D1{}async function Db(r,e,t){Ha.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Ha.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Ha.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{Ha.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw Ha.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new jb(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Ha.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Fb();const Ob={url:W2,storageKey:H2,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:V2,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function yg(r,e,t){return await t()}const Va={};class El{constructor(e){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=El.nextInstanceID,El.nextInstanceID+=1,this.instanceID>0&&qn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Ob),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Nb({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=j1(i.fetch),this.lock=i.lock||yg,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:qn()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Db:this.lock=yg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:F1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=vg(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=vg(this.memoryStorage)),qn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Va[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Va[this.storageKey]=Object.assign(Object.assign({},Va[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Va[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Va[this.storageKey]=Object.assign(Object.assign({},Va[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${T1}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ob(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),qn()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),J2(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:c}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ot(t)?{error:t}:{error:new C1("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const a=await ft(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e?.options)===null||i===void 0?void 0:i.captchaToken}},xform:Ai}),{data:o,error:c}=a;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ot(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,n,i;try{let a;if("email"in e){const{email:p,password:g,options:v}=e;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await $a(this.storage,this.storageKey)),a=await ft(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:p,password:g,data:(t=v?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:y,code_challenge_method:b},xform:Ai})}else if("phone"in e){const{phone:p,password:g,options:v}=e;a=await ft(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(n=v?.data)!==null&&n!==void 0?n:{},channel:(i=v?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Ai})}else throw new Yc("You must provide either an email or phone number and a password");const{data:o,error:c}=a;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ot(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:c}=e;t=await ft(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:xg})}else if("phone"in e){const{phone:a,password:o,options:c}=e;t=await ft(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:xg})}else throw new Yc("You must provide either an email or phone number and a password");const{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Xc}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(ot(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,i,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,n,i,a,o,c,d,f,p,g,v,y;let b,_;if("message"in e)b=e.message,_=e.signature;else{const{chain:S,wallet:A,statement:C,options:T}=e;let P;if(qn())if(typeof A=="object")P=A;else{const G=window;if("solana"in G&&typeof G.solana=="object"&&("signIn"in G.solana&&typeof G.solana.signIn=="function"||"signMessage"in G.solana&&typeof G.solana.signMessage=="function"))P=G.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!T?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=A}const z=new URL((t=T?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in P&&P.signIn){const G=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T?.signInWithSolana),{version:"1",domain:z.host,uri:z.href}),C?{statement:C}:null));let L;if(Array.isArray(G)&&G[0]&&typeof G[0]=="object")L=G[0];else if(G&&typeof G=="object"&&"signedMessage"in G&&"signature"in G)L=G;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)b=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),_=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${z.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${z.href}`,`Issued At: ${(i=(n=T?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=T?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((o=T?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((c=T?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((d=T?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((f=T?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((g=(p=T?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...T.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const G=await P.signMessage(new TextEncoder().encode(b),"utf8");if(!G||!(G instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=G}}try{const{data:S,error:A}=await ft(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:ib(_)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Ai});if(A)throw A;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new Xc}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:A})}catch(S){if(ot(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(e){const t=await Ms(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{const{data:a,error:o}=await ft(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Ai});if(await cs(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Xc}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(ot(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:a,nonce:o}=e,c=await ft(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Ai}),{data:d,error:f}=c;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Xc}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(t){if(ot(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,i,a,o;try{if("email"in e){const{email:c,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await $a(this.storage,this.storageKey));const{error:g}=await ft(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=d?.data)!==null&&t!==void 0?t:{},create_user:(n=d?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:g}}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:p}=await ft(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(i=d?.data)!==null&&i!==void 0?i:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(o=d?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:f?.message_id},error:p}}throw new Yc("You must provide either an email or phone number.")}catch(c){if(ot(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var t,n;try{let i,a;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:c}=await ft(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Ai});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,f=o.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ot(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,n,i;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await $a(this.storage,this.storageKey)),await ft(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:Eb})}catch(a){if(ot(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new ds;const{error:i}=await ft(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(ot(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:a}=e,{error:o}=await ft(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:a}=e,{data:o,error:c}=await ft(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:c}}throw new Yc("You must provide either an email or phone number and a type")}catch(t){if(ot(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ms(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Gf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await Ms(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Xf()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,f,p)=>(!o&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,p))})}return{data:{session:e},error:null}}const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ft(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:fs}):await this._useSession(async t=>{var n,i,a;const{data:o,error:c}=t;if(c)throw c;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ds}:await ft(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:fs})})}catch(t){if(ot(t))return Y2(t)&&(await this._removeSession(),await cs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new ds;const o=i.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await $a(this.storage,this.storageKey));const{data:f,error:p}=await ft(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:fs});if(p)throw p;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(ot(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ds;const t=Date.now()/1e3;let n=t,i=!0,a=null;const{payload:o}=qf(e.access_token);if(o.exp&&(n=o.exp,i=n<=t),i){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(ot(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:c}=t;if(c)throw c;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new ds;const{session:i,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ot(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!qn())throw new Jc("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Jc(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ug("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Jc("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ug("No code detected.");const{data:C,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:c,expires_at:d,token_type:f}=e;if(!a||!c||!o||!f)throw new Jc("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(c);let v=p+g;d&&(v=parseInt(d));const y=v-p;y*1e3<=Ja&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${g}s`);const b=v-g;p-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,v,p):p-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,v,p);const{data:_,error:S}=await this._getUser(a);if(S)throw S;const A={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:g,expires_at:v,refresh_token:o,token_type:f,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:A,redirectType:e.type},error:null}}catch(n){if(ot(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ms(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return{error:a};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(X2(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await cs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=ab(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:a},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await $a(this.storage,this.storageKey,!0));try{return await ft(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(ot(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:i}=await this._useSession(async a=>{var o,c,d,f,p;const{data:g,error:v}=a;if(v)throw v;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await ft(this.fetch,"GET",y,{headers:this.headers,jwt:(p=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return qn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(ot(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:a,error:o}=t;if(o)throw o;return await ft(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(ot(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await ub(async i=>(i>0&&await cb(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await ft(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ai})),(i,a)=>{const o=200*Math.pow(2,i);return a&&Kf(a)&&Date.now()+o-n<Ja})}catch(n){if(this._debug(t,"error",n),ot(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),qn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Ms(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Ms(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Qa(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o?.user)!==null&&e!==void 0?e:Xf()}else if(i&&!i.user&&!i.user){const o=await Ms(this.storage,this.storageKey+"-user");o&&o?.user?(i.user=o.user,await cs(this.storage,this.storageKey+"-user"),await Qa(this.storage,this.storageKey,i)):i.user=Xf()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Gf;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Gf}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Kf(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(i.access_token);!c&&o?.user?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new ds;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new qu;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new ds;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={session:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(i,"error",a),ot(a)){const o={session:null,error:a};return Kf(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(d){a.push(d)}});if(await Promise.all(o),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await Qa(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const a=mg(i);await Qa(this.storage,this.storageKey,a)}else{const i=mg(t);await Qa(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await cs(this.storage,this.storageKey),await cs(this.storage,this.storageKey+"-code-verifier"),await cs(this.storage,this.storageKey+"-user"),this.userStorage&&await cs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&qn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ja);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/Ja);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ja}ms, refresh threshold is ${wh} ticks`),i<=wh&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof D1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await $a(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(c.toString())}if(n?.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n?.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;return a?{data:null,error:a}:await ft(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(ot(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:a,error:o}=t;if(o)return{data:null,error:o};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:f}=await ft(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((i=d?.totp)===null||i===void 0)&&i.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(ot(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const{data:o,error:c}=await ft(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(t){if(ot(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:a}=t;return a?{data:null,error:a}:await ft(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(ot(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=e?.factors||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:i},error:a}=e;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=qf(i.access_token);let c=null;o.aal&&(c=o.aal);let d=c;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const p=o.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(c=>c.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(c=>c.kid===e),n&&this.jwks_cached_at+K2>i)return n;const{data:a,error:o}=await ft(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(c=>c.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:y,error:b}=await this.getSession();if(b||!y.session)return{data:null,error:b};n=y.session.access_token}const{header:i,payload:a,signature:o,raw:{header:c,payload:d}}=qf(n);t?.allowExpired||xb(a.exp);const f=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!f){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:a,header:i,signature:o},error:null}}const p=vb(i.alg),g=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,o,nb(`${c}.${d}`)))throw new Eh("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}}}El.nextInstanceID=0;const Pb=El;class Rb extends Pb{constructor(e){super(e)}}var Ib=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(p){try{f(n.next(p))}catch(g){o(g)}}function d(p){try{f(n.throw(p))}catch(g){o(g)}}function f(p){p.done?a(p.value):i(p.value).then(c,d)}f((n=n.apply(r,e||[])).next())})};class Lb{constructor(e,t,n){var i,a,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const c=z2(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,p={db:O2,realtime:R2,auth:Object.assign(Object.assign({},P2),{storageKey:f}),global:D2},g=$2(n??{},p);this.storageKey=(i=g.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=g.global.headers)!==null&&a!==void 0?a:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=g.auth)!==null&&o!==void 0?o:{},this.headers,g.global.fetch),this.fetch=B2(t,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.rest=new Zw(new URL("rest/v1",d).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new N2(this.storageUrl.href,this.headers,this.fetch,n?.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new Ww(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ib(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:a,flowType:o,lock:c,debug:d},f,p){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Rb({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),f),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,flowType:o,lock:c,debug:d,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new g2(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Mb=(r,e,t)=>new Lb(r,e,t);function Bb(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Bb()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ub="https://zcvkqujfneyphoiaqvuj.supabase.co",zb="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpjdmtxdWpmbmV5cGhvaWFxdnVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5NTM4MjIsImV4cCI6MjA3MTUyOTgyMn0.DQYhdzdnVxRonkcaNQzzPivwTiZvhF3gc8Fz2aYw6i4",Me=Mb(Ub,zb),$b="/Sistema-Contable-Nuevo/assets/Icon-CGQkBVuw.png";function Wb({onLogin:r}){const[e,t]=re.useState(""),[n,i]=re.useState(""),[a,o]=re.useState(!1),[c,d]=re.useState(null),f=async g=>{g.preventDefault(),o(!0),d(null);try{const{data:v,error:y}=await Me.auth.signInWithPassword({email:e,password:n});if(y)throw y;v?.user&&r(v.user)}catch(v){d(v.message)}finally{o(!1)}},p=async()=>{o(!0),d(null);try{const{data:g,error:v}=await Me.auth.signUp({email:e,password:n});if(v)throw v;g?.user&&r(g.user),alert("Cuenta creada. Revisa tu email para confirmar.")}catch(g){d(g.message)}finally{o(!1)}};return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:h.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md",children:[h.jsx("div",{className:"flex justify-center mb-4",children:h.jsx("img",{src:$b,alt:"Logo de Gestión Patrimonial",className:"h-20 w-20 object-contain"})}),h.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Gestión Patrimonial"}),c&&h.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:c}),h.jsxs("form",{onSubmit:f,children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),h.jsx("input",{type:"email",value:e,onChange:g=>t(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"tu@email.com",required:!0})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Contraseña"}),h.jsx("input",{type:"password",value:n,onChange:g=>i(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"********",required:!0})]}),h.jsxs("div",{className:"flex flex-col space-y-3",children:[h.jsx("button",{type:"submit",disabled:a,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-colors",children:a?"Cargando...":"Iniciar Sesión"}),h.jsx("button",{type:"button",onClick:p,disabled:a,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-colors",children:"Crear Cuenta"})]})]})]})})}const mn="/Sistema-Contable-Nuevo/assets/Icon-CGQkBVuw.png";function _g({user:r,setCurrentView:e}){console.log("El componente Dashboard se está renderizando.");const[t,n]=re.useState({}),[i,a]=re.useState(null),[o,c]=re.useState(!0),[d,f]=re.useState(null),p=new Date,g=new Date(p.getFullYear(),p.getMonth()-1,p.getDate()),v=ne=>ne.toISOString().split("T")[0],[y,b]=re.useState(v(g)),[_,S]=re.useState(v(p)),[A,C]=re.useState({}),[T,P]=re.useState({}),z=re.useRef(null),[G,L]=re.useState({key:"fecha",direction:"descending"});re.useEffect(()=>{console.log("El useEffect se ha ejecutado. Dependencias:",{user:r}),r?V(y,_):c(!1)},[r]),re.useEffect(()=>()=>{console.log("El componente Dashboard se está desmontando.")},[]);const V=async(ne=null,se=null)=>{if(!r){c(!1);return}try{c(!0),f(null);let Z=Me.from("entradas_contables").select("fecha, importe_ars, importe_usd, tipo, tipo_cambio_id, concepto_id").eq("usuario_id",r.id).order("fecha",{ascending:!0});ne&&(Z=Z.gte("fecha",ne)),se&&(Z=Z.lte("fecha",se));const{data:pe,error:Ce}=await Z;if(Ce)throw Ce;const{data:Fe,error:We}=await Me.from("tipos_cambio").select("id, fecha, tasa").eq("usuario_id",r.id).order("fecha",{ascending:!0});if(We)throw We;const{data:Be,error:ke}=await Me.from("rubros").select("id, nombre");if(ke)throw ke;const{data:jt,error:Bt}=await Me.from("conceptos_contables").select("id, concepto, rubro_id");if(Bt)throw Bt;const Ht=Be.reduce((et,at)=>(et[at.id]=at.nombre,et),{});P(Ht);const gt=jt.reduce((et,at)=>(et[at.id]={nombre:at.concepto,rubro_id:at.rubro_id},et),{});C(gt);const qt=Fe.reduce((et,at)=>(et[at.fecha]=at.tasa,et),{}),Mr=pe.reduce((et,at)=>{const _t=at.fecha;et[_t]||(et[_t]={"Activo Corriente":0,"Activo No Corriente":0,Pasivo:0,"Patrimonio Neto":0,"Activo Corriente_usd":0,"Activo No Corriente_usd":0,Pasivo_usd:0,"Patrimonio Neto_usd":0,tipoCambio:qt[_t]||0});const nn=at.importe_ars,fr=at.importe_usd;return at.tipo==="Activo Corriente"?(et[_t]["Activo Corriente"]+=nn,et[_t]["Activo Corriente_usd"]+=fr):at.tipo==="Activo No Corriente"?(et[_t]["Activo No Corriente"]+=nn,et[_t]["Activo No Corriente_usd"]+=fr):at.tipo==="Pasivo"&&(et[_t].Pasivo+=nn,et[_t].Pasivo_usd+=fr),et[_t]["Patrimonio Neto"]=et[_t]["Activo Corriente"]+et[_t]["Activo No Corriente"]-et[_t].Pasivo,et[_t]["Patrimonio Neto_usd"]=et[_t]["Activo Corriente_usd"]+et[_t]["Activo No Corriente_usd"]-et[_t].Pasivo_usd,et},{});n(Mr)}catch(Z){console.error("Error al cargar datos del dashboard:",Z.message),f("Error al cargar datos del dashboard. Inténtalo de nuevo.")}finally{c(!1)}},q=async ne=>{if(!r){alert("Error: No se puede cargar el detalle sin un usuario autenticado.");return}try{const{data:se,error:Z}=await Me.from("entradas_contables").select("importe_ars, importe_usd, concepto_id, tipo").eq("usuario_id",r.id).eq("fecha",ne);if(Z)throw Z;const pe=se.reduce((gt,qt)=>{const Mr=A[qt.concepto_id];if(!Mr)return gt;const et=T[Mr.rubro_id]||"Sin Rubro",at=qt.tipo;return gt[at]||(gt[at]={totalTipoArs:0,totalTipoUsd:0,rubros:{}}),gt[at].rubros[et]||(gt[at].rubros[et]={totalArs:0,totalUsd:0,conceptos:[]}),gt[at].rubros[et].totalArs+=qt.importe_ars,gt[at].rubros[et].totalUsd+=qt.importe_usd,gt[at].totalTipoArs+=qt.importe_ars,gt[at].totalTipoUsd+=qt.importe_usd,gt[at].rubros[et].conceptos.push({nombre:Mr.nombre,ars:qt.importe_ars,usd:qt.importe_usd}),gt},{}),Ce=pe["Activo Corriente"]?.totalTipoArs||0,Fe=pe["Activo No Corriente"]?.totalTipoArs||0,We=pe.Pasivo?.totalTipoArs||0,Be=Ce+Fe-We,ke=pe["Activo Corriente"]?.totalTipoUsd||0,jt=pe["Activo No Corriente"]?.totalTipoUsd||0,Bt=pe.Pasivo?.totalTipoUsd||0,Ht=ke+jt-Bt;a({fecha:ne,detalle:pe,totales:{"Activo Corriente":Ce,"Activo No Corriente":Fe,Pasivo:We,"Patrimonio Neto":Be},totalesUsd:{"Activo Corriente":ke,"Activo No Corriente":jt,Pasivo:Bt,"Patrimonio Neto":Ht}}),setTimeout(()=>{z.current?.scrollIntoView({behavior:"smooth"})},100)}catch(se){console.error("Error al cargar detalle:",se.message),alert("Error al cargar el detalle de la fecha.")}},O=()=>{V(y,_)},ee=ne=>{const se={};for(let Z=0;Z<ne.length-1;Z++){const pe=ne[Z],Ce=ne[Z+1],Fe=t[pe]?.["Patrimonio Neto"]||0,We=t[pe]?.["Patrimonio Neto_usd"]||0,Be=t[Ce]?.["Patrimonio Neto"]||0,ke=t[Ce]?.["Patrimonio Neto_usd"]||0,jt=Fe-Be,Bt=Be!==0?(jt/Be*100).toFixed(2):"N/A",Ht=We-ke,gt=ke!==0?(Ht/ke*100).toFixed(2):"N/A";se[pe]={variationMonto:jt,variationPorcentaje:Bt,variationMontoUsd:Ht,variationPorcentajeUsd:gt}}return se},D=Object.keys(t).sort((ne,se)=>new Date(se)-new Date(ne)),te=ee(D),ve=D.length>0?D[D.length-1]:null,ye=D.length>0?D[0]:null,Oe=ve?t[ve]["Patrimonio Neto"]:0,je=ve?t[ve]["Patrimonio Neto_usd"]:0,fe=ye?t[ye]["Patrimonio Neto"]:0,xe=ye?t[ye]["Patrimonio Neto_usd"]:0,me=fe-Oe,K=Oe!==0?(me/Oe*100).toFixed(2):"N/A",N=me>=0?"text-green-600":"text-red-600",X=xe-je,W=je!==0?(X/je*100).toFixed(2):"N/A",B=X>=0?"text-green-600":"text-red-600",J=ne=>{let se="ascending";G.key===ne&&G.direction==="ascending"&&(se="descending"),L({key:ne,direction:se})},ie=(()=>{const ne=Object.keys(t).map(se=>({date:se,...t[se]}));return G.key!==null&&ne.sort((se,Z)=>{let pe,Ce;if(G.key==="fecha")pe=new Date(se.date),Ce=new Date(Z.date);else if(G.key==="Patrimonio Neto")pe=se["Patrimonio Neto"],Ce=Z["Patrimonio Neto"];else if(G.key==="Patrimonio Neto_usd")pe=se["Patrimonio Neto_usd"],Ce=Z["Patrimonio Neto_usd"];else if(G.key==="tipoCambio")pe=se.tipoCambio,Ce=Z.tipoCambio;else if(G.key==="variacionPorcentaje"){const Fe=ee(Object.keys(t).sort((We,Be)=>new Date(Be)-new Date(We)));pe=parseFloat(Fe[se.date]?.variationPorcentaje)||0,Ce=parseFloat(Fe[Z.date]?.variationPorcentaje)||0}else if(G.key==="variacionPorcentajeUsd"){const Fe=ee(Object.keys(t).sort((We,Be)=>new Date(Be)-new Date(We)));pe=parseFloat(Fe[se.date]?.variationPorcentajeUsd)||0,Ce=parseFloat(Fe[Z.date]?.variationPorcentajeUsd)||0}else pe=se[G.key],Ce=Z[G.key];return pe<Ce?G.direction==="ascending"?-1:1:pe>Ce?G.direction==="ascending"?1:-1:0}),ne})();return h.jsxs(h.Fragment,{children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:"Dashboard"})]}),h.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:o?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):d?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:d})]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6 border border-gray-200",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Filtrar por Fecha"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Desde"}),h.jsx("input",{type:"date",value:y,onChange:ne=>b(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hasta"}),h.jsx("input",{type:"date",value:_,onChange:ne=>S(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),h.jsx("div",{className:"flex items-end",children:h.jsx("button",{onClick:O,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Aplicar Filtro"})})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Patrimonio Neto Inicial"}),h.jsxs("p",{className:"text-xl font-semibold text-gray-800 mt-1",children:["$",Oe.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",h.jsx("span",{className:"text-sm text-gray-500",children:"ARS"})]}),h.jsxs("p",{className:"text-base text-gray-600 mt-1",children:["$",je.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",h.jsx("span",{className:"text-sm text-gray-500",children:"USD"})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Patrimonio Neto Actual"}),h.jsxs("p",{className:"text-xl font-semibold text-gray-800 mt-1",children:["$",fe.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",h.jsx("span",{className:"text-sm text-gray-500",children:"ARS"})]}),h.jsxs("p",{className:"text-base text-gray-600 mt-1",children:["$",xe.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",h.jsx("span",{className:"text-sm text-gray-500",children:"USD"})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Variación ARS"}),h.jsxs("p",{className:`text-xl font-semibold mt-1 ${N}`,children:["$",me.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsxs("p",{className:`text-sm mt-1 ${N}`,children:[K,"%"]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Variación USD"}),h.jsxs("p",{className:`text-xl font-semibold mt-1 ${B}`,children:["$",X.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsxs("p",{className:`text-sm mt-1 ${B}`,children:[W,"%"]})]})]}),h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mt-6 border border-gray-200",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Resumen de Patrimonio Neto por Día"}),h.jsx("div",{className:"overflow-x-auto h-96",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0",children:h.jsxs("tr",{children:[h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("fecha"),children:["Fecha",G.key==="fecha"&&h.jsx("span",{className:"ml-1",children:G.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("Patrimonio Neto"),children:["Patrimonio Neto ARS",G.key==="Patrimonio Neto"&&h.jsx("span",{className:"ml-1",children:G.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("Patrimonio Neto_usd"),children:["Patrimonio Neto USD",G.key==="Patrimonio Neto_usd"&&h.jsx("span",{className:"ml-1",children:G.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("tipoCambio"),children:["Tipo de Cambio",G.key==="tipoCambio"&&h.jsx("span",{className:"ml-1",children:G.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("variacionPorcentaje"),children:["Variación ARS (%)",G.key==="variacionPorcentaje"&&h.jsx("span",{className:"ml-1",children:G.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>J("variacionPorcentajeUsd"),children:["Variación USD (%)",G.key==="variacionPorcentajeUsd"&&h.jsx("span",{className:"ml-1",children:G.direction==="ascending"?"▲":"▼"})]})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.length>0?ie.map((ne,se)=>{const Z=se===0,pe=ne["Patrimonio Neto"],Ce=ne["Patrimonio Neto_usd"],Fe=te[ne.date],We=Fe?.variationMonto>=0?"text-green-600":"text-red-600",Be=Fe?.variationMontoUsd>=0?"text-green-600":"text-red-600";return h.jsxs("tr",{className:`${Z?"font-bold":""} hover:bg-gray-50 cursor-pointer`,onClick:()=>q(ne.date),children:[h.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${Z?"text-base text-gray-800":"text-gray-800"}`,children:new Date(ne.date+"T00:00:00").toLocaleDateString("es-AR")}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:["$",pe.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:["$",Ce.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 text-right",children:ne.tipoCambio.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}),h.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right ${We}`,children:Fe?`${Fe.variationMonto.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})} (${Fe.variationPorcentaje}%)`:"N/A"}),h.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right ${Be}`,children:Fe?`${Fe.variationMontoUsd.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})} (${Fe.variationPorcentajeUsd}%)`:"N/A"})]},ne.date)}):h.jsx("tr",{children:h.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500",children:"No hay datos de patrimonio neto para mostrar."})})})]})})]}),i&&h.jsxs("div",{ref:z,className:"bg-white rounded-xl shadow-md p-6 mt-6 border-t-4 border-indigo-500 animate-fade-in",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h3",{className:"text-xl font-semibold text-gray-800",children:["Detalle del ",new Date(i.fecha+"T00:00:00").toLocaleDateString("es-AR")]}),h.jsx("button",{onClick:()=>a(null),className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:Object.entries(i.totales).map(([ne,se],Z)=>{const pe=ne==="Patrimonio Neto"?"text-indigo-700":ne==="Pasivo"?"text-red-700":"text-gray-800",Ce=ne==="Patrimonio Neto"?"text-indigo-600":ne==="Pasivo"?"text-red-600":"text-gray-600";return h.jsxs("div",{className:"bg-gray-50 rounded-lg shadow-inner p-6 border border-gray-200",children:[h.jsx("p",{className:"text-sm font-medium text-gray-500",children:ne}),h.jsxs("p",{className:`text-lg font-semibold mt-1 ${pe}`,children:["$",se.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})," ARS"]}),h.jsxs("p",{className:`text-sm mt-1 ${Ce}`,children:["$",i.totalesUsd[ne].toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})," USD"]})]},Z)})}),h.jsxs("div",{className:"border-t pt-6",children:[h.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Detalle por Concepto"}),h.jsx("div",{className:"h-96 overflow-y-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rubro"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Concepto"}),h.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Importe ARS"}),h.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Importe USD"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(i.detalle).map(([ne,se])=>Object.entries(se.rubros).map(([Z,pe])=>pe.conceptos.map((Ce,Fe)=>h.jsxs("tr",{children:[Fe===0&&h.jsx("td",{rowSpan:pe.conceptos.length,className:"px-6 py-4 text-sm text-gray-700 align-top border-r-2 border-gray-100",children:Z}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:Ce.nombre}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 text-right",children:["$",Ce.ars.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 text-right",children:["$",Ce.usd.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},`${ne}-${Z}-${Fe}`))))})]})})]})]})]})})]})}function Hb({user:r,setCurrentView:e}){const[t,n]=re.useState([]),[i,a]=re.useState(!0),[o,c]=re.useState(null),[d,f]=re.useState(!1),[p,g]=re.useState(!1),[v,y]=re.useState(null),[b,_]=re.useState(null),[S,A]=re.useState({nombre:""}),[C,T]=re.useState("");re.useEffect(()=>{P()},[r]);const P=async()=>{try{a(!0),c(null);const{data:D,error:te}=await Me.from("estados_financieros").select("*").eq("usuario_id",r.id).order("nombre",{ascending:!0});if(te)throw te;n(D||[])}catch(D){c(D.message)}finally{a(!1)}},z=(D=null)=>{D?(_(D),A({nombre:D.nombre})):(_(null),A({nombre:""})),T(""),f(!0)},G=()=>{f(!1),_(null),A({nombre:""}),T("")},L=D=>{y(D),g(!0)},V=()=>{y(null),g(!1)},q=D=>{A({...S,[D.target.name]:D.target.value})},O=async D=>{if(D.preventDefault(),!S.nombre){T("El nombre del estado es obligatorio.");return}try{if(b){const{error:te}=await Me.from("estados_financieros").update({nombre:S.nombre}).eq("id",b.id);if(te)throw te}else{const{error:te}=await Me.from("estados_financieros").insert({usuario_id:r.id,nombre:S.nombre});if(te)throw te}await P(),G()}catch(te){console.error("Error al guardar el estado financiero:",te.message),T("Error al guardar. Intenta nuevamente.")}},ee=async()=>{if(v)try{const{error:D}=await Me.from("entradas_contables").delete().eq("estado_financiero_id",v);if(D)throw D;const{error:te}=await Me.from("estados_financieros").delete().eq("id",v);if(te)throw te;await P(),V()}catch(D){console.error("Error al eliminar el estado financiero:",D.message),c("Error al eliminar. Intenta nuevamente."),V()}};return h.jsxs("div",{className:"flex h-screen bg-gray-100 font-sans",children:[h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:"Estados Financieros"})]}),h.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:i?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):o?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:o})]})]}):h.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-200",children:[h.jsxs("div",{className:"px-6 py-4 flex justify-between items-center",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Lista de Estados"}),h.jsx("button",{onClick:()=>z(),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150",children:"Nuevo Estado"})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre del Estado"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha de Creación"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length>0?t.map(D=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:D.nombre}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(D.creado_en).toLocaleDateString()}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[h.jsx("button",{onClick:()=>z(D),className:"text-indigo-600 hover:text-indigo-800 mr-4 transition-colors duration-150",children:"Editar"}),h.jsx("button",{onClick:()=>L(D.id),className:"text-red-600 hover:text-red-800 transition-colors duration-150",children:"Eliminar"})]})]},D.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"3",className:"px-6 py-4 text-center text-gray-500",children:"No hay estados financieros registrados."})})})]})})]})})]}),d&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:b?"Editar Estado Financiero":"Nuevo Estado Financiero"}),C&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:C}),h.jsxs("form",{onSubmit:O,children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Estado"}),h.jsx("input",{type:"text",name:"nombre",value:S.nombre,onChange:q,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]})}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:G,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:b?"Actualizar":"Guardar"})]})]})]})}),p&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-auto",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Confirmar Eliminación"}),h.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"¿Estás seguro de que deseas eliminar este estado financiero?"}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:ee,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-150",children:"Eliminar"})]})]})})]})}function Vb({user:r,setCurrentView:e}){const[t,n]=re.useState([]),[i,a]=re.useState(!0),[o,c]=re.useState(null),[d,f]=re.useState(!1),[p,g]=re.useState(!1),[v,y]=re.useState(null),[b,_]=re.useState(null),[S,A]=re.useState({fecha:"",tasa:""}),[C,T]=re.useState(""),[P,z]=re.useState(null),[G,L]=re.useState(""),[V,q]=re.useState(!0);re.useEffect(()=>{if(!r){a(!1);return}V&&(async()=>{a(!0),c(null),z({type:"info",text:"Iniciando proceso automático: Actualizando valor del dólar..."});try{const{data:me,error:K}=await Me.functions.invoke("actualizar-tipo-cambio",{body:{user_id:r.id}});if(K)throw new Error(K.message||"Error al actualizar el tipo de cambio.");z({type:"success",text:"Iniciando recálculo automático de registros contables..."}),await new Promise(N=>setTimeout(N,1e3)),await fe(),z({type:"success",text:"Proceso automático finalizado. Tabla actualizada."})}catch(me){console.error("❌ Error en el proceso automático:",me.message),z({type:"error",text:`Error en el proceso automático: ${me.message}`})}finally{q(!1),a(!1),O(),setTimeout(()=>z(null),5e3)}})()},[r,V]),re.useEffect(()=>{r&&!V&&O()},[r,G,V]);const O=async()=>{if(!r){a(!1);return}try{a(!0),c(null);let xe=Me.from("tipos_cambio").select("*").eq("usuario_id",r.id);G&&(xe=xe.eq("fecha",G));const{data:me,error:K}=await xe.order("fecha",{ascending:!1});if(K)throw K;n(me||[])}catch(xe){console.error("❌ Error al cargar tipos de cambio:",xe.message),c(xe.message)}finally{a(!1)}},ee=(xe=null)=>{if(xe)_(xe),A({fecha:xe.fecha,tasa:xe.tasa?.toString()||""});else{const me=new Date().toISOString().split("T")[0];_(null),A({fecha:me,tasa:""})}T(""),f(!0)},D=()=>{f(!1),_(null),A({fecha:"",tasa:""}),T("")},te=xe=>{y(xe),g(!0)},ve=()=>{y(null),g(!1)},ye=xe=>{A({...S,[xe.target.name]:xe.target.value})},Oe=async xe=>{if(xe.preventDefault(),!S.fecha||!S.tasa){T("Todos los campos son obligatorios");return}const me=parseFloat(S.tasa);if(isNaN(me)||me<=0){T("El valor del dólar debe ser un número válido mayor a 0");return}try{if(b){const{error:K}=await Me.from("tipos_cambio").update({tasa:me}).eq("id",b.id).eq("usuario_id",r.id);if(K)throw K}else{const{error:K}=await Me.from("tipos_cambio").insert({usuario_id:r.id,fecha:S.fecha,tasa:me});if(K)throw K}await O(),D()}catch(K){console.error("Error al guardar:",K.message),T("Error al guardar. Intenta nuevamente.")}},je=async()=>{if(v)try{const{error:xe}=await Me.from("entradas_contables").delete().eq("tipo_cambio_id",v);if(xe)throw xe;const{error:me}=await Me.from("tipos_cambio").delete().eq("id",v).eq("usuario_id",r.id);if(me)throw me;await O(),ve()}catch(xe){console.error("Error al eliminar:",xe.message),c("Error al eliminar. Intenta nuevamente."),ve()}},fe=async()=>{try{if(!r){z({type:"error",text:"Usuario no logueado."});return}const{data:xe,error:me}=await Me.from("tipos_cambio").select("fecha, tasa").eq("usuario_id",r.id);if(me)throw me;if(!xe||xe.length===0){z({type:"success",text:"No hay tipos de cambio cargados."});return}const K=xe.reduce((be,ie)=>(be[ie.fecha]=ie.tasa,be),{}),{data:N,error:X}=await Me.from("entradas_contables").select("id, fecha, importe_ars, importe_usd, moneda").eq("usuario_id",r.id);if(X)throw X;if(!N||N.length===0){z({type:"success",text:"No hay entradas contables para recalcular."});return}const W=[];if(N.forEach(be=>{const ie=K[be.fecha];if(!ie||ie<=0)return;let ne=!1,se={};if(be.moneda==="ARS"){const Z=parseFloat((be.importe_ars/ie).toFixed(2));Z!==be.importe_usd&&(ne=!0,se={importe_usd:Z})}else if(be.moneda==="USD"){const Z=parseFloat((be.importe_usd*ie).toFixed(2));Z!==be.importe_ars&&(ne=!0,se={importe_ars:Z})}ne&&W.push(Me.from("entradas_contables").update(se).eq("id",be.id).eq("usuario_id",r.id))}),W.length===0){z({type:"success",text:"No se encontraron registros para recalcular. Ya están actualizados."});return}const J=(await Promise.all(W)).filter(be=>be.error);if(J.length>0)throw console.error("❌ Errores en actualizaciones:",J),new Error("Algunos registros no se pudieron actualizar.");z({type:"success",text:`Recálculo masivo completado: ${W.length} registros actualizados.`})}catch(xe){console.error("Error al recalcular:",xe.message),z({type:"error",text:"Error al recalcular. Intenta nuevamente."})}};return h.jsxs("div",{className:"flex h-screen bg-gray-100 font-sans",children:[h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:"Tipo de Cambio"})]}),h.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50 p-6",children:i?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):o?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:o})]})]}):h.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-200 flex flex-col h-full",children:[h.jsxs("div",{className:"p-6 flex justify-between items-center flex-wrap gap-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Registros de Tipo de Cambio"}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("label",{htmlFor:"filter-date",className:"text-sm text-gray-600 font-medium",children:"Filtrar por Fecha:"}),h.jsx("input",{id:"filter-date",type:"date",value:G,onChange:xe=>L(xe.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),G&&h.jsx("button",{onClick:()=>L(""),className:"text-gray-500 hover:text-gray-700 text-sm font-medium",children:"Limpiar"})]}),h.jsxs("button",{onClick:()=>ee(),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center space-x-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),h.jsx("span",{children:"Nuevo Registro"})]})]})]}),h.jsx("div",{className:"overflow-auto flex-1",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor USD"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length>0?t.map(xe=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:xe.fecha}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:["$",parseFloat(xe.tasa).toFixed(2)]}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[h.jsx("button",{onClick:()=>ee(xe),className:"text-indigo-600 hover:text-indigo-800 mr-4 transition-colors duration-150",children:"Editar"}),h.jsx("button",{onClick:()=>te(xe.id),className:"text-red-600 hover:text-red-800 transition-colors duration-150",children:"Eliminar"})]})]},xe.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"3",className:"px-6 py-4 text-center text-gray-500",children:G?`No hay registros para la fecha ${G}.`:"No hay registros de tipo de cambio."})})})]})})]})})]}),d&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:b?"Editar Tipo de Cambio":"Nuevo Tipo de Cambio"}),C&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:C}),h.jsxs("form",{onSubmit:Oe,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha"}),h.jsx("input",{type:"date",name:"fecha",value:S.fecha,onChange:ye,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-gray-100 disabled:opacity-75",disabled:b,required:!0}),b&&h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No se puede cambiar la fecha en edición"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor del Dólar (ARS)"}),h.jsx("input",{type:"number",name:"tasa",value:S.tasa,onChange:ye,placeholder:"Ej: 1100",step:"0.01",min:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:D,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:b?"Actualizar":"Guardar"})]})]})]})}),p&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-auto",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Confirmar Eliminación"}),h.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"¿Estás seguro de que deseas eliminar este registro de tipo de cambio? Esta acción no se puede deshacer."}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:ve,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:je,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-150",children:"Eliminar"})]})]})}),P&&h.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-4 shadow-lg transition-all duration-300 ${P.type==="success"?"bg-green-100 text-green-700 border-b border-green-200":"bg-red-100 text-red-700 border-b border-red-200"}`,children:[h.jsx("p",{className:"text-sm font-medium",children:P.text}),h.jsx("button",{onClick:()=>z(null),className:"text-gray-500 hover:text-gray-700",children:"×"})]})]})}function Gb({user:r,setCurrentView:e}){const[t,n]=re.useState([]),[i,a]=re.useState(!0),[o,c]=re.useState(null),[d,f]=re.useState(!1),[p,g]=re.useState(!1),[v,y]=re.useState(null),[b,_]=re.useState(null),[S,A]=re.useState({nombre:""}),[C,T]=re.useState("");re.useEffect(()=>{P()},[r]);const P=async()=>{try{a(!0),c(null);const{data:D,error:te}=await Me.from("rubros").select("*").eq("usuario_id",r.id).order("nombre",{ascending:!0});if(te)throw te;n(D||[])}catch(D){c(D.message)}finally{a(!1)}},z=(D=null)=>{D?(_(D),A({nombre:D.nombre})):(_(null),A({nombre:""})),T(""),f(!0)},G=()=>{f(!1),_(null),A({nombre:""}),T("")},L=D=>{y(D),g(!0)},V=()=>{y(null),g(!1)},q=D=>{A({...S,[D.target.name]:D.target.value})},O=async D=>{if(D.preventDefault(),!S.nombre){T("El nombre del rubro es obligatorio.");return}try{if(b){const{error:te}=await Me.from("rubros").update({nombre:S.nombre}).eq("id",b.id);if(te)throw te}else{const{error:te}=await Me.from("rubros").insert({usuario_id:r.id,nombre:S.nombre});if(te)throw te}await P(),G()}catch(te){console.error("Error al guardar el rubro:",te.message),T("Error al guardar. Intenta nuevamente.")}},ee=async()=>{if(v)try{const{error:D}=await Me.from("conceptos_contables").delete().eq("rubro_id",v);if(D)throw D;const{error:te}=await Me.from("rubros").delete().eq("id",v);if(te)throw te;await P(),V()}catch(D){console.error("Error al eliminar el rubro:",D.message),c("Error al eliminar. Intenta nuevamente."),V()}};return h.jsxs("div",{className:"flex h-screen bg-gray-100 font-sans",children:[h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Gestión de Rubros"})]}),h.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:i?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):o?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:o})]})]}):h.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-200",children:[h.jsxs("div",{className:"px-6 py-4 flex justify-between items-center",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Lista de Rubros"}),h.jsxs("button",{onClick:()=>z(),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center space-x-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),h.jsx("span",{children:"Nuevo Rubro"})]})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre del Rubro"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length>0?t.map(D=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:D.nombre}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[h.jsx("button",{onClick:()=>z(D),className:"text-indigo-600 hover:text-indigo-800 mr-4 transition-colors duration-150",children:"Editar"}),h.jsx("button",{onClick:()=>L(D.id),className:"text-red-600 hover:text-red-800 transition-colors duration-150",children:"Eliminar"})]})]},D.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"2",className:"px-6 py-4 text-center text-gray-500",children:"No hay rubros registrados."})})})]})})]})})]}),d&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:b?"Editar Rubro":"Nuevo Rubro"}),C&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:C}),h.jsxs("form",{onSubmit:O,children:[h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Rubro"}),h.jsx("input",{type:"text",name:"nombre",value:S.nombre,onChange:q,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]})}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:G,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:b?"Actualizar":"Guardar"})]})]})]})}),p&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-auto",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Confirmar Eliminación"}),h.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"¿Estás seguro de que deseas eliminar este rubro? Esta acción también eliminará todos los conceptos asociados."}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:ee,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-150",children:"Eliminar"})]})]})})]})}function Kb({user:r,setCurrentView:e}){const[t,n]=re.useState([]),[i,a]=re.useState([]),[o,c]=re.useState(!0),[d,f]=re.useState(null),[p,g]=re.useState(!1),[v,y]=re.useState(!1),[b,_]=re.useState(null),[S,A]=re.useState(null),[C,T]=re.useState({rubro_id:"",concepto:""}),[P,z]=re.useState("");re.useEffect(()=>{G()},[r]);const G=async()=>{try{c(!0),f(null);const{data:ve,error:ye}=await Me.from("rubros").select("*").eq("usuario_id",r.id).order("nombre",{ascending:!0});if(ye)throw ye;a(ve||[]);const{data:Oe,error:je}=await Me.from("conceptos_contables").select(`
          id,
          concepto,
          activo,
          rubro_id,
          rubros (
            nombre
          )
        `).eq("usuario_id",r.id).order("concepto",{ascending:!0});if(je)throw je;n(Oe||[])}catch(ve){f(ve.message)}finally{c(!1)}},L=(ve=null)=>{ve?(A(ve),T({rubro_id:ve.rubro_id,concepto:ve.concepto})):(A(null),T({rubro_id:"",concepto:""})),z(""),g(!0)},V=()=>{g(!1),A(null),T({rubro_id:"",concepto:""}),z("")},q=ve=>{_(ve),y(!0)},O=()=>{_(null),y(!1)},ee=ve=>{T({...C,[ve.target.name]:ve.target.value})},D=async ve=>{if(ve.preventDefault(),!C.rubro_id||!C.concepto){z("Los campos Rubro y Concepto son obligatorios");return}try{if(S){const{error:ye}=await Me.from("conceptos_contables").update({rubro_id:C.rubro_id,concepto:C.concepto}).eq("id",S.id);if(ye)throw ye}else{const{error:ye}=await Me.from("conceptos_contables").insert({usuario_id:r.id,rubro_id:C.rubro_id,concepto:C.concepto});if(ye)throw ye}await G(),V()}catch(ye){console.error("Error al guardar el concepto:",ye.message),z("Error al guardar. Intenta nuevamente.")}},te=async()=>{if(b)try{const{error:ve}=await Me.from("conceptos_contables").update({activo:!b.activo}).eq("id",b.id);if(ve)throw ve;await G(),O()}catch(ve){console.error("Error al cambiar el estado del concepto:",ve.message),f("Error al cambiar el estado. Intenta nuevamente."),O()}};return h.jsxs("div",{className:"flex h-screen bg-gray-100 font-sans",children:[h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Gestión de Conceptos"})]}),h.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:o?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):d?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:d})]})]}):h.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden border border-gray-200",children:[h.jsxs("div",{className:"px-6 py-4 flex justify-between items-center",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Lista de Conceptos"}),h.jsxs("button",{onClick:()=>L(),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center space-x-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),h.jsx("span",{children:"Nuevo Concepto"})]})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Concepto"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rubro"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length>0?t.map(ve=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:ve.concepto}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:ve.rubros?.nombre}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:h.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ve.activo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ve.activo?"Activo":"Inactivo"})}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[h.jsx("button",{onClick:()=>L(ve),className:"text-indigo-600 hover:text-indigo-800 mr-4 transition-colors duration-150",children:"Editar"}),h.jsx("button",{onClick:()=>q(ve),className:`transition-colors duration-150 ${ve.activo?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"}`,children:ve.activo?"Deshabilitar":"Habilitar"})]})]},ve.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500",children:"No hay conceptos registrados."})})})]})})]})})]}),p&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:S?"Editar Concepto":"Nuevo Concepto"}),P&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:P}),h.jsxs("form",{onSubmit:D,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rubro"}),h.jsxs("select",{name:"rubro_id",value:C.rubro_id,onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[h.jsx("option",{value:"",children:"Selecciona un rubro"}),i.map(ve=>h.jsx("option",{value:ve.id,children:ve.nombre},ve.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Concepto"}),h.jsx("input",{type:"text",name:"concepto",value:C.concepto,onChange:ee,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:V,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:S?"Actualizar":"Guardar"})]})]})]})}),v&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-auto",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:b?.activo?"Deshabilitar Concepto":"Habilitar Concepto"}),h.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["¿Estás seguro de que deseas ",b?.activo?"deshabilitar":"habilitar",' el concepto "',b?.concepto,'"? Esta acción afectará la visibilidad en los formularios de entrada de datos.']}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:O,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:te,className:`px-4 py-2 text-sm font-medium text-white rounded-md transition-colors duration-150 ${b?.activo?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:b?.activo?"Deshabilitar":"Habilitar"})]})]})})]})}function qb({user:r,setCurrentView:e}){const[t,n]=re.useState({}),[i,a]=re.useState([]),[o,c]=re.useState([]),[d,f]=re.useState(!0),[p,g]=re.useState(null),[v,y]=re.useState("list"),[b,_]=re.useState(""),[S,A]=re.useState([]),[C,T]=re.useState(!1),[P,z]=re.useState(!1),[G,L]=re.useState(null),[V,q]=re.useState(null),[O,ee]=re.useState(!1),[D,te]=re.useState(""),ve=ie=>{_(ie),y("edit")};re.useEffect(()=>{ye()},[r]),re.useEffect(()=>{if(v==="edit"){const ie=sessionStorage.getItem("editing_day_"+b);if(ie)try{const ne=JSON.parse(ie);A(ne),f(!1);return}catch{console.warn("No se pudo recuperar los datos guardados")}Oe()}},[v,b,r]);const ye=async()=>{try{f(!0),g(null);const{data:ie,error:ne}=await Me.from("tipos_cambio").select("id, fecha, tasa").eq("usuario_id",r.id).order("fecha",{ascending:!1});if(ne)throw ne;c(ie||[]);const{data:se,error:Z}=await Me.from("entradas_contables").select(`
          id,
          fecha,
          importe_ars,
          importe_usd,
          moneda,
          estado_financiero_id,
          tipo,
          concepto_id,
          archivo_url,
          conceptos_contables (
            concepto,
            rubro_id,
            rubros (nombre)
          )
        `).eq("usuario_id",r.id).order("fecha",{ascending:!1});if(Z)throw Z;const pe={};se.forEach(Be=>{const ke=Be.fecha;pe[ke]||(pe[ke]=[]),pe[ke].push(Be)}),n(pe);const{data:Ce,error:Fe}=await Me.from("rubros").select(`
          id,
          nombre,
          conceptos_contables (
            id,
            concepto,
            activo
          )
        `).eq("usuario_id",r.id).order("nombre",{ascending:!0});if(Fe)throw Fe;const We=[];Ce.forEach(Be=>{Be.conceptos_contables.forEach(ke=>{ke.activo&&We.push({...ke,rubro_id:Be.id,rubro_nombre:Be.nombre,tipo:Be.nombre.toLowerCase().includes("activo corriente")?"Activo Corriente":Be.nombre.toLowerCase().includes("activo no corriente")?"Activo No Corriente":Be.nombre.toLowerCase().includes("pasivo")?"Pasivo":""})})}),We.sort((Be,ke)=>Be.rubro_nombre<ke.rubro_nombre?-1:Be.rubro_nombre>ke.rubro_nombre?1:Be.concepto<ke.concepto?-1:Be.concepto>ke.concepto?1:0),a(We)}catch(ie){console.error("Error al cargar datos:",ie.message),g("Error al cargar datos. Inténtalo de nuevo.")}finally{f(!1)}},Oe=async()=>{f(!0),g(null);try{const{data:ie,error:ne}=await Me.from("entradas_contables").select(`
          id,
          fecha,
          importe_ars,
          importe_usd,
          moneda,
          estado_financiero_id,
          tipo,
          concepto_id,
          archivo_url,
          conceptos_contables (
            concepto,
            rubro_id,
            rubros (nombre)
          )
        `).eq("usuario_id",r.id).eq("fecha",b);if(ne)throw ne;const Z=o.find(Ce=>Ce.fecha===b)?.tasa||1,pe=await Promise.all(ie.map(async Ce=>{const Fe=i.find(jt=>jt.id===Ce.concepto_id);let We=Ce.moneda==="ARS"?Ce.importe_ars:Ce.importe_usd,Be=0,ke=0;return Z>0&&(Ce.moneda==="ARS"?(Be=Ce.importe_ars,ke=Ce.importe_ars/Z):(ke=Ce.importe_usd,Be=Ce.importe_usd*Z)),{...Ce,rubro_nombre:Fe?.rubro_nombre||"",concepto:Ce.conceptos_contables?.concepto||"",monto:We,tipoCambio:Z,importe_ars:parseFloat(Be.toFixed(2)),importe_usd:parseFloat(ke.toFixed(2))}}));pe.sort((Ce,Fe)=>Ce.rubro_nombre<Fe.rubro_nombre?-1:Ce.rubro_nombre>Fe.rubro_nombre?1:Ce.concepto<Fe.concepto?-1:Ce.concepto>Fe.concepto?1:0),A(pe);try{sessionStorage.setItem("editing_day_"+b,JSON.stringify(pe))}catch{console.warn("No se pudo guardar en sessionStorage")}}catch(ie){console.error("Error al cargar entradas para el día seleccionado:",ie.message),g("Error al cargar entradas para el día seleccionado.")}finally{f(!1)}},je=(ie,ne,se)=>{const Z=[...S];Z[ie][ne]=se;const pe=Z[ie],Ce=pe.tipoCambio;Ce>0?(ne==="monto"&&(pe.monto=parseFloat(se)||0),ne==="moneda"&&(pe.moneda==="ARS"?pe.monto=pe.importe_ars:pe.monto=pe.importe_usd),pe.moneda==="ARS"?(pe.importe_ars=pe.monto,pe.importe_usd=pe.monto/Ce):(pe.importe_usd=pe.monto,pe.importe_ars=pe.importe_usd*Ce)):(pe.importe_ars=0,pe.importe_usd=0),A(Z);try{sessionStorage.setItem("editing_day_"+b,JSON.stringify(Z))}catch{console.warn("No se pudo guardar en sessionStorage")}},fe=async()=>{f(!0),g(null);try{const ie=o.find(pe=>pe.fecha===b),ne=ie?ie.id:null,se=S.map(pe=>({id:pe.id,estado_financiero_id:pe.estado_financiero_id,tipo:pe.tipo,usuario_id:r.id,fecha:b,moneda:pe.moneda,importe_ars:parseFloat(pe.importe_ars)||0,importe_usd:parseFloat(pe.importe_usd)||0,tipo_cambio_id:ne,concepto_id:pe.concepto_id,archivo_url:pe.archivo_url})),{error:Z}=await Me.from("entradas_contables").upsert(se);if(Z)throw Z;try{sessionStorage.removeItem("editing_day_"+b)}catch{console.warn("No se pudo limpiar sessionStorage")}alert("Cambios guardados con éxito."),ye(),y("list")}catch(ie){console.error("Error al guardar el día:",ie.message),g("Error al guardar el día. Inténtalo de nuevo.")}finally{f(!1)}},xe=async()=>{f(!0),g(null);try{const{error:ie}=await Me.from("entradas_contables").delete().eq("usuario_id",r.id).eq("fecha",b);if(ie)throw ie;try{sessionStorage.removeItem("editing_day_"+b)}catch{console.warn("No se pudo limpiar sessionStorage")}alert("Día eliminado con éxito."),ye(),y("list"),T(!1)}catch(ie){console.error("Error al eliminar el día:",ie.message),g("Error al eliminar el día. Inténtalo de nuevo.")}finally{f(!1)}},me=ie=>{L(ie),q(null),te(""),z(!0)},K=()=>{z(!1),L(null)},N=ie=>{const ne=ie.target.files?.[0];ne&&q(ne)},X=async ie=>{try{if(!ie.archivo_url){alert("No se encontró un archivo para este registro.");return}const ne=ie.archivo_url.split("/public/entradas-archivos/");if(ne.length<2){console.error("URL del archivo no tiene el formato esperado:",ie.archivo_url),alert("La URL del archivo no es válida.");return}const se=ne[1],{data:Z,error:pe}=await Me.storage.from("entradas-archivos").createSignedUrl(se,60);if(pe)throw pe;window.open(Z.signedUrl,"_blank")}catch(ne){console.error("Error al generar la URL firmada:",ne),alert("Hubo un error al intentar ver el archivo. Intenta de nuevo.")}},W=async(ie,ne)=>{if(window.confirm("¿Estás seguro de que quieres eliminar el archivo de este registro? Esta acción es irreversible.")){const Z=ie.archivo_url.split("/public/entradas-archivos/")[1];try{const{error:pe}=await Me.storage.from("entradas-archivos").remove([Z]);if(pe)throw pe;const{error:Ce}=await Me.from("entradas_contables").update({archivo_url:null}).eq("id",ie.id).eq("usuario_id",r.id);if(Ce)throw Ce;const Fe=[...S];Fe[ne].archivo_url=null,A(Fe),alert("Archivo eliminado con éxito."),Oe()}catch(pe){console.error("Error al eliminar el archivo:",pe),alert("Error al eliminar el archivo. Intenta de nuevo.")}}},B=async()=>{if(!V){te("No se ha seleccionado ningún archivo.");return}if(G){ee(!0),te("");try{const ie=V.name.split(".").pop(),ne=`${G.id}.${ie}`,se=`${r.id}/${ne}`,{error:Z}=await Me.storage.from("entradas-archivos").upload(se,V,{cacheControl:"3600",upsert:!0});if(Z)throw Z;const{data:pe}=Me.storage.from("entradas-archivos").getPublicUrl(se);if(!pe)throw new Error("No se pudo obtener la URL pública del archivo");const Ce=pe.publicUrl,{error:Fe}=await Me.from("entradas_contables").update({archivo_url:Ce}).eq("id",G.id).eq("usuario_id",r.id);if(Fe)throw Fe;const We=[...S],Be=We.findIndex(ke=>ke.id===G.id);Be!==-1&&(We[Be].archivo_url=Ce,A(We),sessionStorage.setItem("editing_day_"+b,JSON.stringify(We))),te("Archivo subido y guardado con éxito."),K()}catch(ie){console.error("Error al subir el archivo:",ie),te("Error al subir el archivo. Intenta de nuevo.")}finally{ee(!1),q(null)}}},J=()=>h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Días Contables"}),h.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:Object.keys(t).length>0?Object.keys(t).map(ie=>h.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-150",children:[h.jsxs("span",{className:"font-medium text-gray-800",children:[new Date(ie+"T00:00:00").toLocaleDateString("es-AR",{timeZone:"America/Argentina/Buenos_Aires"}),h.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",t[ie].length," registros)"]})]}),h.jsxs("button",{onClick:()=>ve(ie),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center space-x-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2d00/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.28-8.28Z"})}),h.jsx("span",{children:"Editar"})]})]},ie)):h.jsx("p",{className:"text-center text-gray-500 py-8",children:"No hay días registrados."})})]}),be=()=>{const ie=S?.length>0?S.reduce((We,Be)=>(Be?.tipo&&(We[Be.tipo]||(We[Be.tipo]={ars:0,usd:0}),We[Be.tipo].ars+=Be.importe_ars||0,We[Be.tipo].usd+=Be.importe_usd||0),We),{}):{},ne=ie["Activo Corriente"]?.ars||0,se=ie["Activo No Corriente"]?.ars||0,Z=ie.Pasivo?.ars||0,pe=ne+se-Z,Ce=S[0]?.tipoCambio||1,Fe=Ce>0?pe/Ce:0;return h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Editar registros - ",new Date(b+"T00:00:00").toLocaleDateString("es-AR",{timeZone:"America/Argentina/Buenos_Aires"})]}),h.jsxs("div",{className:"flex space-x-2",children:[h.jsx("button",{onClick:()=>y("list"),className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150",children:"Volver"}),h.jsx("button",{onClick:fe,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150",children:"Guardar Cambios"}),h.jsx("button",{onClick:()=>T(!0),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150",children:"Eliminar Día"})]})]}),h.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:h.jsx("p",{className:"text-sm text-blue-800",children:"Los valores se recalculan automáticamente con el tipo de cambio actual del día."})}),h.jsx("div",{className:"mb-6 border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:h.jsx("table",{className:"min-w-full divide-y divide-gray-200",children:h.jsxs("tbody",{className:"bg-white",children:[h.jsxs("tr",{className:"bg-gray-50",children:[h.jsx("td",{className:"w-[85%] px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Activo Corriente"}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right font-bold text-green-700",children:["$",(ie["Activo Corriente"]?.ars||0).toLocaleString("es-AR",{minimumFractionDigits:2})]}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right font-bold text-green-700",children:["$",(ie["Activo Corriente"]?.usd||0).toLocaleString("es-AR",{minimumFractionDigits:2})]})]}),h.jsxs("tr",{className:"bg-gray-50",children:[h.jsx("td",{className:"w-[85%] px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Activo No Corriente"}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right font-bold text-green-500",children:["$",(ie["Activo No Corriente"]?.ars||0).toLocaleString("es-AR",{minimumFractionDigits:2})]}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right font-bold text-green-500",children:["$",(ie["Activo No Corriente"]?.usd||0).toLocaleString("es-AR",{minimumFractionDigits:2})]})]}),h.jsxs("tr",{className:"bg-gray-50",children:[h.jsx("td",{className:"w-[85%] px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Pasivo"}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right font-bold text-red-600",children:["$",(ie.Pasivo?.ars||0).toLocaleString("es-AR",{minimumFractionDigits:2})]}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right font-bold text-red-600",children:["$",(ie.Pasivo?.usd||0).toLocaleString("es-AR",{minimumFractionDigits:2})]})]}),h.jsxs("tr",{className:"border-t-2 border-gray-300 font-bold bg-gray-50",children:[h.jsx("td",{className:"w-[85%] px-3 py-2 text-right text-lg text-gray-800",children:"Patrimonio Neto"}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right text-lg text-gray-800",children:["$",pe.toLocaleString("es-AR",{minimumFractionDigits:2})]}),h.jsxs("td",{className:"w-[15%] px-3 py-2 text-right text-lg text-gray-800",children:["$",Fe.toLocaleString("es-AR",{minimumFractionDigits:2})]})]})]})})}),h.jsx("div",{className:"max-h-[60vh] overflow-y-auto overflow-x-auto",children:h.jsxs("table",{className:"min-w-full table-fixed divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0",children:h.jsxs("tr",{children:[h.jsx("th",{className:"w-[15%] px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rubro"}),h.jsx("th",{className:"w-[20%] px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Concepto"}),h.jsx("th",{className:"w-[10%] px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Imagen"}),h.jsx("th",{className:"w-[10%] px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Moneda"}),h.jsx("th",{className:"w-[10%] px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Monto"}),h.jsx("th",{className:"w-[15%] px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tipo de Cambio"}),h.jsx("th",{className:"w-[10%] px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Valor ARS"}),h.jsx("th",{className:"w-[10%] px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Valor USD"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.length>0?S.map((We,Be)=>h.jsxs("tr",{children:[h.jsx("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600",children:We.rubro_nombre}),h.jsx("td",{className:"p-1 whitespace-nowrap text-sm font-medium text-gray-800",children:We.concepto}),h.jsx("td",{className:"p-1 whitespace-nowrap text-sm flex items-center space-x-2",children:We.archivo_url?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>X(We),className:"px-3 py-1 rounded-md text-white text-xs font-medium transition-colors duration-150 bg-indigo-600 hover:bg-indigo-700",children:"Ver Archivo"}),h.jsx("button",{onClick:()=>W(We,Be),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"(Eliminar)"})]}):h.jsx("button",{onClick:()=>me(We),className:"px-3 py-1 rounded-md text-white text-xs font-medium transition-colors duration-150 bg-gray-400 hover:bg-gray-500",children:"Anexar Archivo"})}),h.jsx("td",{className:"p-1",children:h.jsxs("select",{value:We.moneda,onChange:ke=>je(Be,"moneda",ke.target.value),className:"w-full text-sm px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[h.jsx("option",{value:"ARS",children:"ARS"}),h.jsx("option",{value:"USD",children:"USD"})]})}),h.jsx("td",{className:"p-1 text-right",children:h.jsx("input",{type:"number",step:"0.01",value:We.monto,onChange:ke=>je(Be,"monto",ke.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-right"})}),h.jsx("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600 text-right",children:We.tipoCambio.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}),h.jsxs("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600 text-right",children:["$",We.importe_ars.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsxs("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600 text-right",children:["$",We.importe_usd.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},We.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"8",className:"px-6 py-4 text-center text-gray-500",children:"No hay entradas contables para los filtros seleccionados."})})})]})})]})};return h.jsxs("div",{className:"flex h-screen bg-gray-100 font-sans",children:[h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Entradas Contables"})]}),h.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:d?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):p?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:p})]})]}):v==="list"?J():be()})]}),C&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-auto",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Confirmar Eliminación"}),h.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["¿Estás seguro de que deseas eliminar todas las entradas del día"," ",new Date(b+"T00:00:00").toLocaleDateString("es-AR",{timeZone:"America/Argentina/Buenos_Aires"}),"? Esta acción no se puede deshacer."]}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:()=>T(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:xe,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700",children:"Eliminar"})]})]})}),P&&G&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Anexar Archivo"}),D&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:D}),h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seleccionar un archivo:"}),h.jsx("input",{type:"file",onChange:N,className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:file:text-indigo-700 hover:file:bg-indigo-100"}),V&&h.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Archivo seleccionado: ",h.jsx("span",{className:"font-medium",children:V.name})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsxs("button",{type:"button",onClick:B,disabled:!V||O,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150 flex items-center space-x-2 disabled:opacity-70 disabled:cursor-not-allowed",children:[O?h.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.962l2-2.671z"})]}):null,h.jsx("span",{children:O?"Subiendo...":"Subir y Guardar"})]})]})]})})]})}function Xb({user:r,setCurrentView:e}){const[t,n]=re.useState(!0),[i,a]=re.useState(null),[o,c]=re.useState({}),[d,f]=re.useState([]),[p,g]=re.useState([]),[v,y]=re.useState([]),[b,_]=re.useState(new Date().toISOString().split("T")[0]);re.useEffect(()=>{S()},[r]);const S=async()=>{try{n(!0),a(null);const{data:C,error:T}=await Me.from("entradas_contables").select("id, fecha, concepto_id").eq("usuario_id",r.id).order("fecha",{ascending:!1});if(T)throw T;const P={};C&&C.forEach(D=>{const te=D.fecha;P[te]||(P[te]=[]),P[te].push(D)}),c(P);const{data:z,error:G}=await Me.from("rubros").select(`
          id,
          nombre,
          conceptos_contables (
            id,
            concepto,
            activo
          )
        `).eq("usuario_id",r.id).order("nombre",{ascending:!0});if(G)throw G;const L=[];z&&z.forEach(D=>{D.conceptos_contables.forEach(te=>{te.activo&&L.push({...te,rubro_id:D.id,rubro_nombre:D.nombre,tipo:D.nombre.toLowerCase().includes("activo corriente")?"Activo Corriente":D.nombre.toLowerCase().includes("activo no corriente")?"Activo No Corriente":D.nombre.toLowerCase().includes("pasivo")?"Pasivo":""})})}),f(L);const{data:V,error:q}=await Me.from("estados_financieros").select("*").eq("usuario_id",r.id).order("nombre",{ascending:!0});if(q)throw q;g(V||[]);const{data:O,error:ee}=await Me.from("tipos_cambio").select("tasa, id, fecha").eq("usuario_id",r.id).order("fecha",{ascending:!1});if(ee)throw ee;y(O||[])}catch(C){console.error("Error al cargar datos iniciales:",C.message),a("Error al cargar datos iniciales. Inténtalo de nuevo.")}finally{n(!1)}},A=async C=>{n(!0),a(null);const{data:T,error:P}=await Me.from("tipos_cambio").select("id, tasa").eq("usuario_id",r.id).eq("fecha",C).single();if(P){alert(`No se encontró un tipo de cambio para la fecha ${C}. Por favor, regístrelo antes de crear un nuevo día.`),n(!1);return}if(o[C]){alert("Ya existen entradas para esta fecha. Redirigiendo a la vista de edición."),e("entradas-contables");return}let z=[];const L=Object.keys(o).sort().reverse().find(q=>q<C);if(L){const{data:q,error:O}=await Me.from("entradas_contables").select("*").eq("usuario_id",r.id).eq("fecha",L);if(O){a("Error al replicar entradas del último día."),n(!1);return}z=d.map(ee=>{const D=q.find(fe=>fe.concepto_id===ee.id),te=p.length>0?p[0].id:"",ve=T?.tasa;let ye=0,Oe=0,je="ARS";return D&&(je=D.moneda,D.moneda==="USD"?(Oe=D.importe_usd,ye=D.importe_usd*ve):(ye=D.importe_ars,Oe=D.importe_ars/ve)),{estado_financiero_id:te,concepto_id:ee.id,importe_ars:ye||0,importe_usd:Oe||0,tipo:ee.tipo,fecha:C,tipo_cambio_id:T?.id||null,usuario_id:r.id,moneda:je}})}else z=d.map(q=>({estado_financiero_id:p.length>0?p[0].id:"",concepto_id:q.id,importe_ars:0,importe_usd:0,tipo:q.tipo,fecha:C,tipo_cambio_id:T?.id||null,usuario_id:r.id,moneda:"ARS"}));const{error:V}=await Me.from("entradas_contables").insert(z);if(V){console.error("Error al insertar nuevas entradas:",V),a("Error al registrar el nuevo día. Inténtalo de nuevo."),n(!1);return}e("entradas-contables")};return h.jsx("div",{className:"flex h-screen bg-gray-100 font-sans",children:h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Registrar Nuevo Día"})]}),h.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:t?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):i?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:i})]})]}):h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 w-full max-w-sm mx-auto border border-gray-200",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Selecciona una fecha"}),h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha"}),h.jsx("input",{type:"date",value:b,onChange:C=>_(C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:()=>e("entradas-contables"),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:()=>A(b),className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:"Crear Día"})]})]})})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Su={};Su.version="0.18.5";var O1=1252,Yb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],P1=function(r){Yb.indexOf(r)!=-1&&(O1=r)};function Jb(){P1(1252)}var kl=function(r){P1(r)};function Qb(){kl(1200),Jb()}var Qc=function(e){return String.fromCharCode(e)},wg=function(e){return String.fromCharCode(e)},Eu,hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tl(r){for(var e="",t=0,n=0,i=0,a=0,o=0,c=0,d=0,f=0;f<r.length;)t=r.charCodeAt(f++),a=t>>2,n=r.charCodeAt(f++),o=(t&3)<<4|n>>4,i=r.charCodeAt(f++),c=(n&15)<<2|i>>6,d=i&63,isNaN(n)?c=d=64:isNaN(i)&&(d=64),e+=hs.charAt(a)+hs.charAt(o)+hs.charAt(c)+hs.charAt(d);return e}function Ri(r){var e="",t=0,n=0,i=0,a=0,o=0,c=0,d=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<r.length;)a=hs.indexOf(r.charAt(f++)),o=hs.indexOf(r.charAt(f++)),t=a<<2|o>>4,e+=String.fromCharCode(t),c=hs.indexOf(r.charAt(f++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),d=hs.indexOf(r.charAt(f++)),i=(c&3)<<6|d,d!==64&&(e+=String.fromCharCode(i));return e}var wt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Mi=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Xs(r){return wt?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function bg(r){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Yn=function(e){return wt?Mi(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Xu(r){if(typeof ArrayBuffer>"u")return Yn(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Ml(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function Zb(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}var Er=wt?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Mi(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),i=0;for(e=0,t=0;e<r.length;t+=i,++e)if(i=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function eS(r){for(var e=[],t=0,n=r.length+250,i=Xs(r.length+255),a=0;a<r.length;++a){var o=r.charCodeAt(a);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=r.charCodeAt(++a)&1023;i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|c>>6&15|(o&3)<<4,i[t++]=128|c&63}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|o&63;t>n&&(e.push(i.slice(0,t)),t=0,i=Xs(65535),n=65530)}return e.push(i.slice(0,t)),Er(e)}var pl=/\u0000/g,Zc=/[\u0001-\u0006]/g;function to(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function Jn(r,e){var t=""+r;return t.length>=e?t:Gt("0",e-t.length)+t}function Wh(r,e){var t=""+r;return t.length>=e?t:Gt(" ",e-t.length)+t}function ku(r,e){var t=""+r;return t.length>=e?t:t+Gt(" ",e-t.length)}function tS(r,e){var t=""+Math.round(r);return t.length>=e?t:Gt("0",e-t.length)+t}function rS(r,e){var t=""+r;return t.length>=e?t:Gt("0",e-t.length)+t}var Sg=Math.pow(2,32);function Ga(r,e){if(r>Sg||r<-Sg)return tS(r,e);var t=Math.round(r);return rS(t,e)}function Tu(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var Eg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Jf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function nS(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',r}var Kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},kg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},iS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Au(r,e,t){for(var n=r<0?-1:1,i=r*n,a=0,o=1,c=0,d=1,f=0,p=0,g=Math.floor(i);f<e&&(g=Math.floor(i),c=g*o+a,p=g*f+d,!(i-g<5e-8));)i=1/(i-g),a=o,o=c,d=f,f=p;if(p>e&&(f>e?(p=d,c=a):(p=f,c=o)),!t)return[0,n*c,p];var v=Math.floor(n*c/p);return[v,n*c-v*p,p]}function eu(r,e,t){if(r>2958465||r<0)return null;var n=r|0,i=Math.floor(86400*(r-n)),a=0,o=[],c={D:n,T:i,u:86400*(r-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)o=t?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=t?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],a=d.getDay(),n<60&&(a=(a+6)%7),t&&(a=dS(d,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=a,c}var R1=new Date(1899,11,31,0,0,0),sS=R1.getTime(),aS=new Date(1900,2,1,0,0,0);function I1(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=aS&&(t+=1440*60*1e3),(t-(sS+(r.getTimezoneOffset()-R1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Hh(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function oS(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function lS(r){var e=r<0?12:11,t=Hh(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function cS(r){var e=Hh(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function uS(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=lS(r):e===10?t=r.toFixed(10).substr(0,12):t=cS(r),Hh(oS(t.toUpperCase()))}function kh(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):uS(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return vs(14,I1(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function dS(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function fS(r,e,t,n){var i="",a=0,o=0,c=t.y,d,f=0;switch(r){case 98:c=t.y+543;case 121:switch(e.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:d=t.m,f=e.length;break;case 3:return Jf[t.m-1][1];case 5:return Jf[t.m-1][0];default:return Jf[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=t.d,f=e.length;break;case 3:return Eg[t.q][0];default:return Eg[t.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(t.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=t.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=t.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Jn(t.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(t.S+t.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(i=Jn(a,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:d=c,f=1;break}var p=f>0?Jn(d,f):"";return p}function ps(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var L1=/%/g;function hS(r,e,t){var n=e.replace(L1,""),i=e.length-n.length;return Di(r,n,t*Math.pow(10,2*i))+Gt("%",i)}function pS(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Di(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function M1(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+M1(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,p){return d+f+p.substr(0,(i+a)%i)+"."+p.substr(a)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var B1=/# (\?+)( ?)\/( ?)(\d+)/;function mS(r,e,t){var n=parseInt(r[4],10),i=Math.round(e*n),a=Math.floor(i/n),o=i-a*n,c=n;return t+(a===0?"":""+a)+" "+(o===0?Gt(" ",r[1].length+1+r[4].length):Wh(o,r[1].length)+r[2]+"/"+r[3]+Jn(c,r[4].length))}function gS(r,e,t){return t+(e===0?"":""+e)+Gt(" ",r[1].length+2+r[4].length)}var U1=/^#*0*\.([0#]+)/,z1=/\).*[0#]/,$1=/\(###\) ###\\?-####/;function $r(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Tg(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function Ag(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function xS(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function vS(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Nn(r,e,t){if(r.charCodeAt(0)===40&&!e.match(z1)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Nn("n",n,t):"("+Nn("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return pS(r,e,t);if(e.indexOf("%")!==-1)return hS(r,e,t);if(e.indexOf("E")!==-1)return M1(e,t);if(e.charCodeAt(0)===36)return"$"+Nn(r,e.substr(e.charAt(1)==" "?2:1),t);var i,a,o,c,d=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+Ga(d,e.length);if(e.match(/^[#?]+$/))return i=Ga(t,0),i==="0"&&(i=""),i.length>e.length?i:$r(e.substr(0,e.length-i.length))+i;if(a=e.match(B1))return mS(a,d,f);if(e.match(/^#+0+$/))return f+Ga(d,e.length-e.indexOf("0"));if(a=e.match(U1))return i=Tg(t,a[1].length).replace(/^([^\.]+)$/,"$1."+$r(a[1])).replace(/\.$/,"."+$r(a[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+Gt("0",$r(a[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return f+Tg(d,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return f+ps(Ga(d,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Nn(r,e,-t):ps(""+(Math.floor(t)+xS(t,a[1].length)))+"."+Jn(Ag(t,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Nn(r,e.replace(/^#,#*,/,""),t);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=to(Nn(r,e.replace(/[\\-]/g,""),t)),o=0,to(to(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<i.length?i.charAt(o++):b==="0"?"0":""}));if(e.match($1))return i=Nn(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Au(d,Math.pow(10,o)-1,!1),i=""+f,p=Di("n",a[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+a[2]+"/"+a[3],p=ku(c[2],o),p.length<a[4].length&&(p=$r(a[4].substr(a[4].length-p.length))+p),i+=p,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Au(d,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Wh(c[1],o)+a[2]+"/"+a[3]+ku(c[2],o):Gt(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=Ga(t,0),e.length<=i.length?i:$r(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,v=e.length-i.length-g;return $r(e.substr(0,g)+i+e.substr(e.length-v))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=Ag(t,a[1].length),t<0?"-"+Nn(r,e,-t):ps(vS(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Jn(0,3-b.length):"")+b})+"."+Jn(o,a[1].length);switch(e){case"###,##0.00":return Nn(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=ps(Ga(d,0));return y!=="0"?f+y:"";case"###,###.00":return Nn(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Nn(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function yS(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Di(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function _S(r,e,t){var n=e.replace(L1,""),i=e.length-n.length;return Di(r,n,t*Math.pow(10,2*i))+Gt("%",i)}function W1(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+W1(r,-e);var i=r.indexOf(".");i===-1&&(i=r.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,p){return d+f+p.substr(0,(i+a)%i)+"."+p.substr(a)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function li(r,e,t){if(r.charCodeAt(0)===40&&!e.match(z1)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?li("n",n,t):"("+li("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return yS(r,e,t);if(e.indexOf("%")!==-1)return _S(r,e,t);if(e.indexOf("E")!==-1)return W1(e,t);if(e.charCodeAt(0)===36)return"$"+li(r,e.substr(e.charAt(1)==" "?2:1),t);var i,a,o,c,d=Math.abs(t),f=t<0?"-":"";if(e.match(/^00+$/))return f+Jn(d,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:$r(e.substr(0,e.length-i.length))+i;if(a=e.match(B1))return gS(a,d,f);if(e.match(/^#+0+$/))return f+Jn(d,e.length-e.indexOf("0"));if(a=e.match(U1))return i=(""+t).replace(/^([^\.]+)$/,"$1."+$r(a[1])).replace(/\.$/,"."+$r(a[1])),i=i.replace(/\.(\d*)$/,function(b,_){return"."+_+Gt("0",$r(a[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return f+ps(""+d);if(a=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+li(r,e,-t):ps(""+t)+"."+Gt("0",a[1].length);if(a=e.match(/^#,#*,#0/))return li(r,e.replace(/^#,#*,/,""),t);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=to(li(r,e.replace(/[\\-]/g,""),t)),o=0,to(to(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<i.length?i.charAt(o++):b==="0"?"0":""}));if(e.match($1))return i=li(r,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Au(d,Math.pow(10,o)-1,!1),i=""+f,p=Di("n",a[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+a[2]+"/"+a[3],p=ku(c[2],o),p.length<a[4].length&&(p=$r(a[4].substr(a[4].length-p.length))+p),i+=p,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Au(d,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Wh(c[1],o)+a[2]+"/"+a[3]+ku(c[2],o):Gt(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:$r(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,v=e.length-i.length-g;return $r(e.substr(0,g)+i+e.substr(e.length-v))}if(a=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+li(r,e,-t):ps(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Jn(0,3-b.length):"")+b})+"."+Jn(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=ps(""+d);return y!=="0"?f+y:"";default:if(e.match(/\.[0#?]*$/))return li(r,e.slice(0,e.lastIndexOf(".")),t)+$r(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Di(r,e,t){return(t|0)===t?li(r,e,t):Nn(r,e,t)}function wS(r){for(var e=[],t=!1,n=0,i=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(i,n-i),i=n+1}if(e[e.length]=r.substr(i),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var H1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function V1(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":Tu(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(H1))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function bS(r,e,t,n){for(var i=[],a="",o=0,c="",d="t",f,p,g,v="H";o<r.length;)switch(c=r.charAt(o)){case"G":if(!Tu(r,o))throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(g=r.charCodeAt(++o))!==34&&o<r.length;)a+=String.fromCharCode(g);i[i.length]={t:"t",v:a},++o;break;case"\\":var y=r.charAt(++o),b=y==="("||y===")"?y:"t";i[i.length]={t:b,v:y},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(r.charAt(o+1)==="1"||r.charAt(o+1)==="2"){if(f==null&&(f=eu(e,t,r.charAt(o+1)==="2"),f==null))return"";i[i.length]={t:"X",v:r.substr(o,2)},d=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=eu(e,t),f==null))return"";for(a=c;++o<r.length&&r.charAt(o).toLowerCase()===c;)a+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),i[i.length]={t:c,v:a},d=c;break;case"A":case"a":case"上":var _={t:c,v:c};if(f==null&&(f=eu(e,t)),r.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",v="h",o+=3):r.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",o+=5,v="h"):r.substr(o,5).toUpperCase()==="上午/下午"?(f!=null&&(_.v=f.H>=12?"下午":"上午"),_.t="T",o+=5,v="h"):(_.t="t",++o),f==null&&_.t==="T")return"";i[i.length]=_,d=c;break;case"[":for(a=c;r.charAt(o++)!=="]"&&o<r.length;)a+=r.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(H1)){if(f==null&&(f=eu(e,t),f==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},d=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",V1(r)||(i[i.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=c;++o<r.length&&(c=r.charAt(o))==="0";)a+=c;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++o<r.length&&"0#?.,E+-%".indexOf(c=r.charAt(o))>-1;)a+=c;i[i.length]={t:"n",v:a};break;case"?":for(a=c;r.charAt(++o)===c;)a+=c;i[i.length]={t:c,v:a},d=c;break;case"*":++o,(r.charAt(o)==" "||r.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;o<r.length&&"0123456789".indexOf(r.charAt(++o))>-1;)a+=r.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+r);i[i.length]={t:"t",v:c},++o;break}var S=0,A=0,C;for(o=i.length-1,d="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,d="h",S<1&&(S=1);break;case"s":(C=i[o].v.match(/\.0+$/))&&(A=Math.max(A,C[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":d=i[o].t;break;case"m":d==="s"&&(i[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[o].v.match(/[Hh]/)&&(S=1),S<2&&i[o].v.match(/[Mm]/)&&(S=2),S<3&&i[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var T="",P;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=fS(i[o].t.charCodeAt(0),i[o].v,f,A),i[o].t="t";break;case"n":case"?":for(P=o+1;i[P]!=null&&((c=i[P].t)==="?"||c==="D"||(c===" "||c==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[o].v+=i[P].v,i[P]={v:"",t:";"},++P;T+=i[o].v,o=P-1;break;case"G":i[o].t="t",i[o].v=kh(e,t);break}var z="",G,L;if(T.length>0){T.charCodeAt(0)==40?(G=e<0&&T.charCodeAt(0)===45?-e:e,L=Di("n",T,G)):(G=e<0&&n>1?-e:e,L=Di("n",T,G),G<0&&i[0]&&i[0].t=="t"&&(L=L.substr(1),i[0].v="-"+i[0].v)),P=L.length-1;var V=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){V=o;break}var q=i.length;if(V===i.length&&L.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(P>=i[o].v.length-1?(P-=i[o].v.length,i[o].v=L.substr(P+1,i[o].v.length)):P<0?i[o].v="":(i[o].v=L.substr(0,P+1),P=-1),i[o].t="t",q=o);P>=0&&q<i.length&&(i[q].v=L.substr(0,P+1)+i[q].v)}else if(V!==i.length&&L.indexOf("E")===-1){for(P=L.indexOf(".")-1,o=V;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(p=i[o].v.indexOf(".")>-1&&o===V?i[o].v.indexOf(".")-1:i[o].v.length-1,z=i[o].v.substr(p+1);p>=0;--p)P>=0&&(i[o].v.charAt(p)==="0"||i[o].v.charAt(p)==="#")&&(z=L.charAt(P--)+z);i[o].v=z,i[o].t="t",q=o}for(P>=0&&q<i.length&&(i[q].v=L.substr(0,P+1)+i[q].v),P=L.indexOf(".")+1,o=V;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==V)){for(p=i[o].v.indexOf(".")>-1&&o===V?i[o].v.indexOf(".")+1:0,z=i[o].v.substr(0,p);p<i[o].v.length;++p)P<L.length&&(z+=L.charAt(P++));i[o].v=z,i[o].t="t",q=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(G=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Di(i[o].t,i[o].v,G),i[o].t="t");var O="";for(o=0;o!==i.length;++o)i[o]!=null&&(O+=i[o].v);return O}var Cg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ng(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function SS(r,e){var t=wS(r),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var a=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,a];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(Cg),c=t[1].match(Cg);return Ng(e,o)?[n,t[0]]:Ng(e,c)?[n,t[1]]:[n,t[o!=null&&c!=null?2:1]]}return[n,a]}function vs(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Kt)[r],n==null&&(n=t.table&&t.table[kg[r]]||Kt[kg[r]]),n==null&&(n=iS[r]||"General");break}if(Tu(n,0))return kh(e,t);e instanceof Date&&(e=I1(e,t.date1904));var i=SS(n,e);if(Tu(i[1]))return kh(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return bS(i[1],e,t,i[0])}function G1(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Kt[t]==null){e<0&&(e=t);continue}if(Kt[t]==r){e=t;break}}e<0&&(e=391)}return Kt[e]=r,e}function Yu(r){for(var e=0;e!=392;++e)r[e]!==void 0&&G1(r[e],e)}function Ju(){Kt=nS()}var K1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ES(r){var e=typeof r=="number"?Kt[r]:r;return e=e.replace(K1,"(\\d+)"),new RegExp("^"+e+"$")}function kS(r,e,t){var n=-1,i=-1,a=-1,o=-1,c=-1,d=-1;(e.match(K1)||[]).forEach(function(g,v){var y=parseInt(t[v+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=y;break;case"d":a=y;break;case"h":o=y;break;case"s":d=y;break;case"m":o>=0?c=y:i=y;break}}),d>=0&&c==-1&&i>=0&&(c=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&c==-1&&d==-1?f:n==-1&&i==-1&&a==-1?p:f+"T"+p}var TS=(function(){var r={};r.version="1.2.0";function e(){for(var L=0,V=new Array(256),q=0;q!=256;++q)L=q,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,V[q]=L;return typeof Int32Array<"u"?new Int32Array(V):V}var t=e();function n(L){var V=0,q=0,O=0,ee=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)ee[O]=L[O];for(O=0;O!=256;++O)for(q=L[O],V=256+O;V<4096;V+=256)q=ee[V]=q>>>8^L[q&255];var D=[];for(O=1;O!=16;++O)D[O-1]=typeof Int32Array<"u"?ee.subarray(O*256,O*256+256):ee.slice(O*256,O*256+256);return D}var i=n(t),a=i[0],o=i[1],c=i[2],d=i[3],f=i[4],p=i[5],g=i[6],v=i[7],y=i[8],b=i[9],_=i[10],S=i[11],A=i[12],C=i[13],T=i[14];function P(L,V){for(var q=V^-1,O=0,ee=L.length;O<ee;)q=q>>>8^t[(q^L.charCodeAt(O++))&255];return~q}function z(L,V){for(var q=V^-1,O=L.length-15,ee=0;ee<O;)q=T[L[ee++]^q&255]^C[L[ee++]^q>>8&255]^A[L[ee++]^q>>16&255]^S[L[ee++]^q>>>24]^_[L[ee++]]^b[L[ee++]]^y[L[ee++]]^v[L[ee++]]^g[L[ee++]]^p[L[ee++]]^f[L[ee++]]^d[L[ee++]]^c[L[ee++]]^o[L[ee++]]^a[L[ee++]]^t[L[ee++]];for(O+=15;ee<O;)q=q>>>8^t[(q^L[ee++])&255];return~q}function G(L,V){for(var q=V^-1,O=0,ee=L.length,D=0,te=0;O<ee;)D=L.charCodeAt(O++),D<128?q=q>>>8^t[(q^D)&255]:D<2048?(q=q>>>8^t[(q^(192|D>>6&31))&255],q=q>>>8^t[(q^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,te=L.charCodeAt(O++)&1023,q=q>>>8^t[(q^(240|D>>8&7))&255],q=q>>>8^t[(q^(128|D>>2&63))&255],q=q>>>8^t[(q^(128|te>>6&15|(D&3)<<4))&255],q=q>>>8^t[(q^(128|te&63))&255]):(q=q>>>8^t[(q^(224|D>>12&15))&255],q=q>>>8^t[(q^(128|D>>6&63))&255],q=q>>>8^t[(q^(128|D&63))&255]);return~q}return r.table=t,r.bstr=P,r.buf=z,r.str=G,r})(),Ft=(function(){var e={};e.version="1.2.1";function t(k,R){for(var F=k.split("/"),j=R.split("/"),I=0,M=0,ce=Math.min(F.length,j.length);I<ce;++I){if(M=F[I].length-j[I].length)return M;if(F[I]!=j[I])return F[I]<j[I]?-1:1}return F.length-j.length}function n(k){if(k.charAt(k.length-1)=="/")return k.slice(0,-1).indexOf("/")===-1?k:n(k.slice(0,-1));var R=k.lastIndexOf("/");return R===-1?k:k.slice(0,R+1)}function i(k){if(k.charAt(k.length-1)=="/")return i(k.slice(0,-1));var R=k.lastIndexOf("/");return R===-1?k:k.slice(R+1)}function a(k,R){typeof R=="string"&&(R=new Date(R));var F=R.getHours();F=F<<6|R.getMinutes(),F=F<<5|R.getSeconds()>>>1,k.write_shift(2,F);var j=R.getFullYear()-1980;j=j<<4|R.getMonth()+1,j=j<<5|R.getDate(),k.write_shift(2,j)}function o(k){var R=k.read_shift(2)&65535,F=k.read_shift(2)&65535,j=new Date,I=F&31;F>>>=5;var M=F&15;F>>>=4,j.setMilliseconds(0),j.setFullYear(F+1980),j.setMonth(M-1),j.setDate(I);var ce=R&31;R>>>=5;var we=R&63;return R>>>=6,j.setHours(R),j.setMinutes(we),j.setSeconds(ce<<1),j}function c(k){fn(k,0);for(var R={},F=0;k.l<=k.length-4;){var j=k.read_shift(2),I=k.read_shift(2),M=k.l+I,ce={};switch(j){case 21589:F=k.read_shift(1),F&1&&(ce.mtime=k.read_shift(4)),I>5&&(F&2&&(ce.atime=k.read_shift(4)),F&4&&(ce.ctime=k.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}k.l=M,R[j]=ce}return R}var d;function f(){return d||(d={})}function p(k,R){if(k[0]==80&&k[1]==75)return zi(k,R);if((k[0]|32)==109&&(k[1]|32)==105)return Ln(k,R);if(k.length<512)throw new Error("CFB file size "+k.length+" < 512");var F=3,j=512,I=0,M=0,ce=0,we=0,oe=0,de=[],he=k.slice(0,512);fn(he,0);var De=g(he);switch(F=De[0],F){case 3:j=512;break;case 4:j=4096;break;case 0:if(De[1]==0)return zi(k,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}j!==512&&(he=k.slice(0,j),fn(he,28));var Ue=k.slice(0,j);v(he,F);var He=he.read_shift(4,"i");if(F===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);he.l+=4,ce=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),we=he.read_shift(4,"i"),I=he.read_shift(4,"i"),oe=he.read_shift(4,"i"),M=he.read_shift(4,"i");for(var Ie=-1,Re=0;Re<109&&(Ie=he.read_shift(4,"i"),!(Ie<0));++Re)de[Re]=Ie;var rt=y(k,j);S(oe,M,rt,j,de);var bt=C(rt,ce,de,j);bt[ce].name="!Directory",I>0&&we!==te&&(bt[we].name="!MiniFAT"),bt[de[0]].name="!FAT",bt.fat_addrs=de,bt.ssz=j;var Nt={},Ut=[],mi=[],ri=[];T(ce,bt,rt,Ut,I,Nt,mi,we),b(mi,ri,Ut),Ut.shift();var H={FileIndex:mi,FullPaths:ri};return R&&R.raw&&(H.raw={header:Ue,sectors:rt}),H}function g(k){if(k[k.l]==80&&k[k.l+1]==75)return[0,0];k.chk(ve,"Header Signature: "),k.l+=16;var R=k.read_shift(2,"u");return[k.read_shift(2,"u"),R]}function v(k,R){var F=9;switch(k.l+=2,F=k.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}k.chk("0600","Mini Sector Shift: "),k.chk("000000000000","Reserved: ")}function y(k,R){for(var F=Math.ceil(k.length/R)-1,j=[],I=1;I<F;++I)j[I-1]=k.slice(I*R,(I+1)*R);return j[F-1]=k.slice(F*R),j}function b(k,R,F){for(var j=0,I=0,M=0,ce=0,we=0,oe=F.length,de=[],he=[];j<oe;++j)de[j]=he[j]=j,R[j]=F[j];for(;we<he.length;++we)j=he[we],I=k[j].L,M=k[j].R,ce=k[j].C,de[j]===j&&(I!==-1&&de[I]!==I&&(de[j]=de[I]),M!==-1&&de[M]!==M&&(de[j]=de[M])),ce!==-1&&(de[ce]=j),I!==-1&&j!=de[j]&&(de[I]=de[j],he.lastIndexOf(I)<we&&he.push(I)),M!==-1&&j!=de[j]&&(de[M]=de[j],he.lastIndexOf(M)<we&&he.push(M));for(j=1;j<oe;++j)de[j]===j&&(M!==-1&&de[M]!==M?de[j]=de[M]:I!==-1&&de[I]!==I&&(de[j]=de[I]));for(j=1;j<oe;++j)if(k[j].type!==0){if(we=j,we!=de[we])do we=de[we],R[j]=R[we]+"/"+R[j];while(we!==0&&de[we]!==-1&&we!=de[we]);de[j]=-1}for(R[0]+="/",j=1;j<oe;++j)k[j].type!==2&&(R[j]+="/")}function _(k,R,F){for(var j=k.start,I=k.size,M=[],ce=j;F&&I>0&&ce>=0;)M.push(R.slice(ce*D,ce*D+D)),I-=D,ce=Vs(F,ce*4);return M.length===0?_e(0):Er(M).slice(0,k.size)}function S(k,R,F,j,I){var M=te;if(k===te){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(k!==-1){var ce=F[k],we=(j>>>2)-1;if(!ce)return;for(var oe=0;oe<we&&(M=Vs(ce,oe*4))!==te;++oe)I.push(M);S(Vs(ce,j-4),R-1,F,j,I)}}function A(k,R,F,j,I){var M=[],ce=[];I||(I=[]);var we=j-1,oe=0,de=0;for(oe=R;oe>=0;){I[oe]=!0,M[M.length]=oe,ce.push(k[oe]);var he=F[Math.floor(oe*4/j)];if(de=oe*4&we,j<4+de)throw new Error("FAT boundary crossed: "+oe+" 4 "+j);if(!k[he])break;oe=Vs(k[he],de)}return{nodes:M,data:Lg([ce])}}function C(k,R,F,j){var I=k.length,M=[],ce=[],we=[],oe=[],de=j-1,he=0,De=0,Ue=0,He=0;for(he=0;he<I;++he)if(we=[],Ue=he+R,Ue>=I&&(Ue-=I),!ce[Ue]){oe=[];var Ie=[];for(De=Ue;De>=0;){Ie[De]=!0,ce[De]=!0,we[we.length]=De,oe.push(k[De]);var Re=F[Math.floor(De*4/j)];if(He=De*4&de,j<4+He)throw new Error("FAT boundary crossed: "+De+" 4 "+j);if(!k[Re]||(De=Vs(k[Re],He),Ie[De]))break}M[Ue]={nodes:we,data:Lg([oe])}}return M}function T(k,R,F,j,I,M,ce,we){for(var oe=0,de=j.length?2:0,he=R[k].data,De=0,Ue=0,He;De<he.length;De+=128){var Ie=he.slice(De,De+128);fn(Ie,64),Ue=Ie.read_shift(2),He=Xh(Ie,0,Ue-de),j.push(He);var Re={name:He,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},rt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);rt!==0&&(Re.ct=P(Ie,Ie.l-8));var bt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);bt!==0&&(Re.mt=P(Ie,Ie.l-8)),Re.start=Ie.read_shift(4,"i"),Re.size=Ie.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=te,Re.name=""),Re.type===5?(oe=Re.start,I>0&&oe!==te&&(R[oe].name="!StreamData")):Re.size>=4096?(Re.storage="fat",R[Re.start]===void 0&&(R[Re.start]=A(F,Re.start,R.fat_addrs,R.ssz)),R[Re.start].name=Re.name,Re.content=R[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:oe!==te&&Re.start!==te&&R[oe]&&(Re.content=_(Re,R[oe].data,(R[we]||{}).data))),Re.content&&fn(Re.content,0),M[He]=Re,ce.push(Re)}}function P(k,R){return new Date((pn(k,R+4)/1e7*Math.pow(2,32)+pn(k,R)/1e7-11644473600)*1e3)}function z(k,R){return f(),p(d.readFileSync(k),R)}function G(k,R){var F=R&&R.type;switch(F||wt&&Buffer.isBuffer(k)&&(F="buffer"),F||"base64"){case"file":return z(k,R);case"base64":return p(Yn(Ri(k)),R);case"binary":return p(Yn(k),R)}return p(k,R)}function L(k,R){var F=R||{},j=F.root||"Root Entry";if(k.FullPaths||(k.FullPaths=[]),k.FileIndex||(k.FileIndex=[]),k.FullPaths.length!==k.FileIndex.length)throw new Error("inconsistent CFB structure");k.FullPaths.length===0&&(k.FullPaths[0]=j+"/",k.FileIndex[0]={name:j,type:5}),F.CLSID&&(k.FileIndex[0].clsid=F.CLSID),V(k)}function V(k){var R="Sh33tJ5";if(!Ft.find(k,"/"+R)){var F=_e(4);F[0]=55,F[1]=F[3]=50,F[2]=54,k.FileIndex.push({name:R,type:2,content:F,size:4,L:69,R:69,C:69}),k.FullPaths.push(k.FullPaths[0]+R),q(k)}}function q(k,R){L(k);for(var F=!1,j=!1,I=k.FullPaths.length-1;I>=0;--I){var M=k.FileIndex[I];switch(M.type){case 0:j?F=!0:(k.FileIndex.pop(),k.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(M.R*M.L*M.C)&&(F=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!R)){var ce=new Date(1987,1,19),we=0,oe=Object.create?Object.create(null):{},de=[];for(I=0;I<k.FullPaths.length;++I)oe[k.FullPaths[I]]=!0,k.FileIndex[I].type!==0&&de.push([k.FullPaths[I],k.FileIndex[I]]);for(I=0;I<de.length;++I){var he=n(de[I][0]);j=oe[he],j||(de.push([he,{name:i(he).replace("/",""),type:1,clsid:Oe,ct:ce,mt:ce,content:null}]),oe[he]=!0)}for(de.sort(function(He,Ie){return t(He[0],Ie[0])}),k.FullPaths=[],k.FileIndex=[],I=0;I<de.length;++I)k.FullPaths[I]=de[I][0],k.FileIndex[I]=de[I][1];for(I=0;I<de.length;++I){var De=k.FileIndex[I],Ue=k.FullPaths[I];if(De.name=i(Ue).replace("/",""),De.L=De.R=De.C=-(De.color=1),De.size=De.content?De.content.length:0,De.start=0,De.clsid=De.clsid||Oe,I===0)De.C=de.length>1?1:-1,De.size=0,De.type=5;else if(Ue.slice(-1)=="/"){for(we=I+1;we<de.length&&n(k.FullPaths[we])!=Ue;++we);for(De.C=we>=de.length?-1:we,we=I+1;we<de.length&&n(k.FullPaths[we])!=n(Ue);++we);De.R=we>=de.length?-1:we,De.type=1}else n(k.FullPaths[I+1]||"")==n(Ue)&&(De.R=I+1),De.type=2}}}function O(k,R){var F=R||{};if(F.fileType=="mad")return yn(k,F);switch(q(k),F.fileType){case"zip":return Pn(k,F)}var j=(function(He){for(var Ie=0,Re=0,rt=0;rt<He.FileIndex.length;++rt){var bt=He.FileIndex[rt];if(bt.content){var Nt=bt.content.length;Nt>0&&(Nt<4096?Ie+=Nt+63>>6:Re+=Nt+511>>9)}}for(var Ut=He.FullPaths.length+3>>2,mi=Ie+7>>3,ri=Ie+127>>7,H=mi+Re+Ut+ri,le=H+127>>7,Ee=le<=109?0:Math.ceil((le-109)/127);H+le+Ee+127>>7>le;)Ee=++le<=109?0:Math.ceil((le-109)/127);var Se=[1,Ee,le,ri,Ut,Re,Ie,0];return He.FileIndex[0].size=Ie<<6,Se[7]=(He.FileIndex[0].start=Se[0]+Se[1]+Se[2]+Se[3]+Se[4]+Se[5])+(Se[6]+7>>3),Se})(k),I=_e(j[7]<<9),M=0,ce=0;{for(M=0;M<8;++M)I.write_shift(1,ye[M]);for(M=0;M<8;++M)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),M=0;M<3;++M)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,j[2]),I.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:te),I.write_shift(4,j[3]),I.write_shift(-4,j[1]?j[0]-1:te),I.write_shift(4,j[1]),M=0;M<109;++M)I.write_shift(-4,M<j[2]?j[1]+M:-1)}if(j[1])for(ce=0;ce<j[1];++ce){for(;M<236+ce*127;++M)I.write_shift(-4,M<j[2]?j[1]+M:-1);I.write_shift(-4,ce===j[1]-1?te:ce+1)}var we=function(He){for(ce+=He;M<ce-1;++M)I.write_shift(-4,M+1);He&&(++M,I.write_shift(-4,te))};for(ce=M=0,ce+=j[1];M<ce;++M)I.write_shift(-4,je.DIFSECT);for(ce+=j[2];M<ce;++M)I.write_shift(-4,je.FATSECT);we(j[3]),we(j[4]);for(var oe=0,de=0,he=k.FileIndex[0];oe<k.FileIndex.length;++oe)he=k.FileIndex[oe],he.content&&(de=he.content.length,!(de<4096)&&(he.start=ce,we(de+511>>9)));for(we(j[6]+7>>3);I.l&511;)I.write_shift(-4,je.ENDOFCHAIN);for(ce=M=0,oe=0;oe<k.FileIndex.length;++oe)he=k.FileIndex[oe],he.content&&(de=he.content.length,!(!de||de>=4096)&&(he.start=ce,we(de+63>>6)));for(;I.l&511;)I.write_shift(-4,je.ENDOFCHAIN);for(M=0;M<j[4]<<2;++M){var De=k.FullPaths[M];if(!De||De.length===0){for(oe=0;oe<17;++oe)I.write_shift(4,0);for(oe=0;oe<3;++oe)I.write_shift(4,-1);for(oe=0;oe<12;++oe)I.write_shift(4,0);continue}he=k.FileIndex[M],M===0&&(he.start=he.size?he.start-1:te);var Ue=M===0&&F.root||he.name;if(de=2*(Ue.length+1),I.write_shift(64,Ue,"utf16le"),I.write_shift(2,de),I.write_shift(1,he.type),I.write_shift(1,he.color),I.write_shift(-4,he.L),I.write_shift(-4,he.R),I.write_shift(-4,he.C),he.clsid)I.write_shift(16,he.clsid,"hex");else for(oe=0;oe<4;++oe)I.write_shift(4,0);I.write_shift(4,he.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,he.start),I.write_shift(4,he.size),I.write_shift(4,0)}for(M=1;M<k.FileIndex.length;++M)if(he=k.FileIndex[M],he.size>=4096)if(I.l=he.start+1<<9,wt&&Buffer.isBuffer(he.content))he.content.copy(I,I.l,0,he.size),I.l+=he.size+511&-512;else{for(oe=0;oe<he.size;++oe)I.write_shift(1,he.content[oe]);for(;oe&511;++oe)I.write_shift(1,0)}for(M=1;M<k.FileIndex.length;++M)if(he=k.FileIndex[M],he.size>0&&he.size<4096)if(wt&&Buffer.isBuffer(he.content))he.content.copy(I,I.l,0,he.size),I.l+=he.size+63&-64;else{for(oe=0;oe<he.size;++oe)I.write_shift(1,he.content[oe]);for(;oe&63;++oe)I.write_shift(1,0)}if(wt)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function ee(k,R){var F=k.FullPaths.map(function(oe){return oe.toUpperCase()}),j=F.map(function(oe){var de=oe.split("/");return de[de.length-(oe.slice(-1)=="/"?2:1)]}),I=!1;R.charCodeAt(0)===47?(I=!0,R=F[0].slice(0,-1)+R):I=R.indexOf("/")!==-1;var M=R.toUpperCase(),ce=I===!0?F.indexOf(M):j.indexOf(M);if(ce!==-1)return k.FileIndex[ce];var we=!M.match(Zc);for(M=M.replace(pl,""),we&&(M=M.replace(Zc,"!")),ce=0;ce<F.length;++ce)if((we?F[ce].replace(Zc,"!"):F[ce]).replace(pl,"")==M||(we?j[ce].replace(Zc,"!"):j[ce]).replace(pl,"")==M)return k.FileIndex[ce];return null}var D=64,te=-2,ve="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],Oe="00000000000000000000000000000000",je={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(k,R,F){f();var j=O(k,F);d.writeFileSync(R,j)}function xe(k){for(var R=new Array(k.length),F=0;F<k.length;++F)R[F]=String.fromCharCode(k[F]);return R.join("")}function me(k,R){var F=O(k,R);switch(R&&R.type||"buffer"){case"file":return f(),d.writeFileSync(R.filename,F),F;case"binary":return typeof F=="string"?F:xe(F);case"base64":return Tl(typeof F=="string"?F:xe(F));case"buffer":if(wt)return Buffer.isBuffer(F)?F:Mi(F);case"array":return typeof F=="string"?Yn(F):F}return F}var K;function N(k){try{var R=k.InflateRaw,F=new R;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)K=k;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function X(k,R){if(!K)return Ui(k,R);var F=K.InflateRaw,j=new F,I=j._processChunk(k.slice(k.l),j._finishFlushFlag);return k.l+=j.bytesRead,I}function W(k){return K?K.deflateRawSync(k):Nr(k)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(k){var R=(k<<1|k<<11)&139536|(k<<5|k<<15)&558144;return(R>>16|R>>8|R)&255}for(var ne=typeof Uint8Array<"u",se=ne?new Uint8Array(256):[],Z=0;Z<256;++Z)se[Z]=ie(Z);function pe(k,R){var F=se[k&255];return R<=8?F>>>8-R:(F=F<<8|se[k>>8&255],R<=16?F>>>16-R:(F=F<<8|se[k>>16&255],F>>>24-R))}function Ce(k,R){var F=R&7,j=R>>>3;return(k[j]|(F<=6?0:k[j+1]<<8))>>>F&3}function Fe(k,R){var F=R&7,j=R>>>3;return(k[j]|(F<=5?0:k[j+1]<<8))>>>F&7}function We(k,R){var F=R&7,j=R>>>3;return(k[j]|(F<=4?0:k[j+1]<<8))>>>F&15}function Be(k,R){var F=R&7,j=R>>>3;return(k[j]|(F<=3?0:k[j+1]<<8))>>>F&31}function ke(k,R){var F=R&7,j=R>>>3;return(k[j]|(F<=1?0:k[j+1]<<8))>>>F&127}function jt(k,R,F){var j=R&7,I=R>>>3,M=(1<<F)-1,ce=k[I]>>>j;return F<8-j||(ce|=k[I+1]<<8-j,F<16-j)||(ce|=k[I+2]<<16-j,F<24-j)||(ce|=k[I+3]<<24-j),ce&M}function Bt(k,R,F){var j=R&7,I=R>>>3;return j<=5?k[I]|=(F&7)<<j:(k[I]|=F<<j&255,k[I+1]=(F&7)>>8-j),R+3}function Ht(k,R,F){var j=R&7,I=R>>>3;return F=(F&1)<<j,k[I]|=F,R+1}function gt(k,R,F){var j=R&7,I=R>>>3;return F<<=j,k[I]|=F&255,F>>>=8,k[I+1]=F,R+8}function qt(k,R,F){var j=R&7,I=R>>>3;return F<<=j,k[I]|=F&255,F>>>=8,k[I+1]=F&255,k[I+2]=F>>>8,R+16}function Mr(k,R){var F=k.length,j=2*F>R?2*F:R+5,I=0;if(F>=R)return k;if(wt){var M=bg(j);if(k.copy)k.copy(M);else for(;I<k.length;++I)M[I]=k[I];return M}else if(ne){var ce=new Uint8Array(j);if(ce.set)ce.set(k);else for(;I<F;++I)ce[I]=k[I];return ce}return k.length=j,k}function et(k){for(var R=new Array(k),F=0;F<k;++F)R[F]=0;return R}function at(k,R,F){var j=1,I=0,M=0,ce=0,we=0,oe=k.length,de=ne?new Uint16Array(32):et(32);for(M=0;M<32;++M)de[M]=0;for(M=oe;M<F;++M)k[M]=0;oe=k.length;var he=ne?new Uint16Array(oe):et(oe);for(M=0;M<oe;++M)de[I=k[M]]++,j<I&&(j=I),he[M]=0;for(de[0]=0,M=1;M<=j;++M)de[M+16]=we=we+de[M-1]<<1;for(M=0;M<oe;++M)we=k[M],we!=0&&(he[M]=de[we+16]++);var De=0;for(M=0;M<oe;++M)if(De=k[M],De!=0)for(we=pe(he[M],j)>>j-De,ce=(1<<j+4-De)-1;ce>=0;--ce)R[we|ce<<De]=De&15|M<<4;return j}var _t=ne?new Uint16Array(512):et(512),nn=ne?new Uint16Array(32):et(32);if(!ne){for(var fr=0;fr<512;++fr)_t[fr]=0;for(fr=0;fr<32;++fr)nn[fr]=0}(function(){for(var k=[],R=0;R<32;R++)k.push(5);at(k,nn,32);var F=[];for(R=0;R<=143;R++)F.push(8);for(;R<=255;R++)F.push(9);for(;R<=279;R++)F.push(7);for(;R<=287;R++)F.push(8);at(F,_t,288)})();var sa=(function(){for(var R=ne?new Uint8Array(32768):[],F=0,j=0;F<be.length-1;++F)for(;j<be[F+1];++j)R[j]=F;for(;j<32768;++j)R[j]=29;var I=ne?new Uint8Array(259):[];for(F=0,j=0;F<J.length-1;++F)for(;j<J[F+1];++j)I[j]=F;function M(we,oe){for(var de=0;de<we.length;){var he=Math.min(65535,we.length-de),De=de+he==we.length;for(oe.write_shift(1,+De),oe.write_shift(2,he),oe.write_shift(2,~he&65535);he-- >0;)oe[oe.l++]=we[de++]}return oe.l}function ce(we,oe){for(var de=0,he=0,De=ne?new Uint16Array(32768):[];he<we.length;){var Ue=Math.min(65535,we.length-he);if(Ue<10){for(de=Bt(oe,de,+(he+Ue==we.length)),de&7&&(de+=8-(de&7)),oe.l=de/8|0,oe.write_shift(2,Ue),oe.write_shift(2,~Ue&65535);Ue-- >0;)oe[oe.l++]=we[he++];de=oe.l*8;continue}de=Bt(oe,de,+(he+Ue==we.length)+2);for(var He=0;Ue-- >0;){var Ie=we[he];He=(He<<5^Ie)&32767;var Re=-1,rt=0;if((Re=De[He])&&(Re|=he&-32768,Re>he&&(Re-=32768),Re<he))for(;we[Re+rt]==we[he+rt]&&rt<250;)++rt;if(rt>2){Ie=I[rt],Ie<=22?de=gt(oe,de,se[Ie+1]>>1)-1:(gt(oe,de,3),de+=5,gt(oe,de,se[Ie-23]>>5),de+=3);var bt=Ie<8?0:Ie-4>>2;bt>0&&(qt(oe,de,rt-J[Ie]),de+=bt),Ie=R[he-Re],de=gt(oe,de,se[Ie]>>3),de-=3;var Nt=Ie<4?0:Ie-2>>1;Nt>0&&(qt(oe,de,he-Re-be[Ie]),de+=Nt);for(var Ut=0;Ut<rt;++Ut)De[He]=he&32767,He=(He<<5^we[he])&32767,++he;Ue-=rt-1}else Ie<=143?Ie=Ie+48:de=Ht(oe,de,1),de=gt(oe,de,se[Ie]),De[He]=he&32767,++he}de=gt(oe,de,0)-1}return oe.l=(de+7)/8|0,oe.l}return function(oe,de){return oe.length<8?M(oe,de):ce(oe,de)}})();function Nr(k){var R=_e(50+Math.floor(k.length*1.1)),F=sa(k,R);return R.slice(0,F)}var xn=ne?new Uint16Array(32768):et(32768),go=ne?new Uint16Array(32768):et(32768),aa=ne?new Uint16Array(128):et(128),oa=1,xo=1;function Bi(k,R){var F=Be(k,R)+257;R+=5;var j=Be(k,R)+1;R+=5;var I=We(k,R)+4;R+=4;for(var M=0,ce=ne?new Uint8Array(19):et(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,de=ne?new Uint8Array(8):et(8),he=ne?new Uint8Array(8):et(8),De=ce.length,Ue=0;Ue<I;++Ue)ce[B[Ue]]=M=Fe(k,R),oe<M&&(oe=M),de[M]++,R+=3;var He=0;for(de[0]=0,Ue=1;Ue<=oe;++Ue)he[Ue]=He=He+de[Ue-1]<<1;for(Ue=0;Ue<De;++Ue)(He=ce[Ue])!=0&&(we[Ue]=he[He]++);var Ie=0;for(Ue=0;Ue<De;++Ue)if(Ie=ce[Ue],Ie!=0){He=se[we[Ue]]>>8-Ie;for(var Re=(1<<7-Ie)-1;Re>=0;--Re)aa[He|Re<<Ie]=Ie&7|Ue<<3}var rt=[];for(oe=1;rt.length<F+j;)switch(He=aa[ke(k,R)],R+=He&7,He>>>=3){case 16:for(M=3+Ce(k,R),R+=2,He=rt[rt.length-1];M-- >0;)rt.push(He);break;case 17:for(M=3+Fe(k,R),R+=3;M-- >0;)rt.push(0);break;case 18:for(M=11+ke(k,R),R+=7;M-- >0;)rt.push(0);break;default:rt.push(He),oe<He&&(oe=He);break}var bt=rt.slice(0,F),Nt=rt.slice(F);for(Ue=F;Ue<286;++Ue)bt[Ue]=0;for(Ue=j;Ue<30;++Ue)Nt[Ue]=0;return oa=at(bt,xn,286),xo=at(Nt,go,30),R}function Es(k,R){if(k[0]==3&&!(k[1]&3))return[Xs(R),2];for(var F=0,j=0,I=bg(R||1<<18),M=0,ce=I.length>>>0,we=0,oe=0;(j&1)==0;){if(j=Fe(k,F),F+=3,j>>>1)j>>1==1?(we=9,oe=5):(F=Bi(k,F),we=oa,oe=xo);else{F&7&&(F+=8-(F&7));var de=k[F>>>3]|k[(F>>>3)+1]<<8;if(F+=32,de>0)for(!R&&ce<M+de&&(I=Mr(I,M+de),ce=I.length);de-- >0;)I[M++]=k[F>>>3],F+=8;continue}for(;;){!R&&ce<M+32767&&(I=Mr(I,M+32767),ce=I.length);var he=jt(k,F,we),De=j>>>1==1?_t[he]:xn[he];if(F+=De&15,De>>>=4,(De>>>8&255)===0)I[M++]=De;else{if(De==256)break;De-=257;var Ue=De<8?0:De-4>>2;Ue>5&&(Ue=0);var He=M+J[De];Ue>0&&(He+=jt(k,F,Ue),F+=Ue),he=jt(k,F,oe),De=j>>>1==1?nn[he]:go[he],F+=De&15,De>>>=4;var Ie=De<4?0:De-2>>1,Re=be[De];for(Ie>0&&(Re+=jt(k,F,Ie),F+=Ie),!R&&ce<He&&(I=Mr(I,He+100),ce=I.length);M<He;)I[M]=I[M-Re],++M}}}return R?[I,F+7>>>3]:[I.slice(0,M),F+7>>>3]}function Ui(k,R){var F=k.slice(k.l||0),j=Es(F,R);return k.l+=j[1],j[0]}function On(k,R){if(k)typeof console<"u"&&console.error(R);else throw new Error(R)}function zi(k,R){var F=k;fn(F,0);var j=[],I=[],M={FileIndex:j,FullPaths:I};L(M,{root:R.root});for(var ce=F.length-4;(F[ce]!=80||F[ce+1]!=75||F[ce+2]!=5||F[ce+3]!=6)&&ce>=0;)--ce;F.l=ce+4,F.l+=4;var we=F.read_shift(2);F.l+=6;var oe=F.read_shift(4);for(F.l=oe,ce=0;ce<we;++ce){F.l+=20;var de=F.read_shift(4),he=F.read_shift(4),De=F.read_shift(2),Ue=F.read_shift(2),He=F.read_shift(2);F.l+=8;var Ie=F.read_shift(4),Re=c(F.slice(F.l+De,F.l+De+Ue));F.l+=De+Ue+He;var rt=F.l;F.l=Ie+4,vn(F,de,he,M,Re),F.l=rt}return M}function vn(k,R,F,j,I){k.l+=2;var M=k.read_shift(2),ce=k.read_shift(2),we=o(k);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var oe=k.read_shift(4),de=k.read_shift(4),he=k.read_shift(4),De=k.read_shift(2),Ue=k.read_shift(2),He="",Ie=0;Ie<De;++Ie)He+=String.fromCharCode(k[k.l++]);if(Ue){var Re=c(k.slice(k.l,k.l+Ue));(Re[21589]||{}).mt&&(we=Re[21589].mt),((I||{})[21589]||{}).mt&&(we=I[21589].mt)}k.l+=Ue;var rt=k.slice(k.l,k.l+de);switch(ce){case 8:rt=X(k,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var bt=!1;M&8&&(oe=k.read_shift(4),oe==134695760&&(oe=k.read_shift(4),bt=!0),de=k.read_shift(4),he=k.read_shift(4)),de!=R&&On(bt,"Bad compressed size: "+R+" != "+de),he!=F&&On(bt,"Bad uncompressed size: "+F+" != "+he),Fr(j,He,rt,{unsafe:!0,mt:we})}function Pn(k,R){var F=R||{},j=[],I=[],M=_e(1),ce=F.compression?8:0,we=0,oe=0,de=0,he=0,De=0,Ue=k.FullPaths[0],He=Ue,Ie=k.FileIndex[0],Re=[],rt=0;for(oe=1;oe<k.FullPaths.length;++oe)if(He=k.FullPaths[oe].slice(Ue.length),Ie=k.FileIndex[oe],!(!Ie.size||!Ie.content||He=="Sh33tJ5")){var bt=he,Nt=_e(He.length);for(de=0;de<He.length;++de)Nt.write_shift(1,He.charCodeAt(de)&127);Nt=Nt.slice(0,Nt.l),Re[De]=TS.buf(Ie.content,0);var Ut=Ie.content;ce==8&&(Ut=W(Ut)),M=_e(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,we),M.write_shift(2,ce),Ie.mt?a(M,Ie.mt):M.write_shift(4,0),M.write_shift(-4,Re[De]),M.write_shift(4,Ut.length),M.write_shift(4,Ie.content.length),M.write_shift(2,Nt.length),M.write_shift(2,0),he+=M.length,j.push(M),he+=Nt.length,j.push(Nt),he+=Ut.length,j.push(Ut),M=_e(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,we),M.write_shift(2,ce),M.write_shift(4,0),M.write_shift(-4,Re[De]),M.write_shift(4,Ut.length),M.write_shift(4,Ie.content.length),M.write_shift(2,Nt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,bt),rt+=M.l,I.push(M),rt+=Nt.length,I.push(Nt),++De}return M=_e(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,De),M.write_shift(2,De),M.write_shift(4,rt),M.write_shift(4,he),M.write_shift(2,0),Er([Er(j),Er(I),M])}var ei={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rn(k,R){if(k.ctype)return k.ctype;var F=k.name||"",j=F.match(/\.([^\.]+)$/);return j&&ei[j[1]]||R&&(j=(F=R).match(/[\.\\]([^\.\\])+$/),j&&ei[j[1]])?ei[j[1]]:"application/octet-stream"}function la(k){for(var R=Tl(k),F=[],j=0;j<R.length;j+=76)F.push(R.slice(j,j+76));return F.join(`\r
`)+`\r
`}function ca(k){var R=k.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var he=de.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],j=R.split(`\r
`),I=0;I<j.length;++I){var M=j[I];if(M.length==0){F.push("");continue}for(var ce=0;ce<M.length;){var we=76,oe=M.slice(ce,ce+we);oe.charAt(we-1)=="="?we--:oe.charAt(we-2)=="="?we-=2:oe.charAt(we-3)=="="&&(we-=3),oe=M.slice(ce,ce+we),ce+=we,ce<M.length&&(oe+="="),F.push(oe)}}return F.join(`\r
`)}function ua(k){for(var R=[],F=0;F<k.length;++F){for(var j=k[F];F<=k.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+k[++F];R.push(j)}for(var I=0;I<R.length;++I)R[I]=R[I].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Yn(R.join(`\r
`))}function In(k,R,F){for(var j="",I="",M="",ce,we=0;we<10;++we){var oe=R[we];if(!oe||oe.match(/^\s*$/))break;var de=oe.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":j=de[2].trim();break;case"content-type":M=de[2].trim();break;case"content-transfer-encoding":I=de[2].trim();break}}switch(++we,I.toLowerCase()){case"base64":ce=Yn(Ri(R.slice(we).join("")));break;case"quoted-printable":ce=ua(R.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var he=Fr(k,j.slice(F.length),ce,{unsafe:!0});M&&(he.ctype=M)}function Ln(k,R){if(xe(k.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=R&&R.root||"",j=(wt&&Buffer.isBuffer(k)?k.toString("binary"):xe(k)).split(`\r
`),I=0,M="";for(I=0;I<j.length;++I)if(M=j[I],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),F||(F=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),M.slice(0,F.length)!=F););var ce=(j[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var we="--"+(ce[1]||""),oe=[],de=[],he={FileIndex:oe,FullPaths:de};L(he);var De,Ue=0;for(I=0;I<j.length;++I){var He=j[I];He!==we&&He!==we+"--"||(Ue++&&In(he,j.slice(De,I),F),De=I)}return he}function yn(k,R){var F=R||{},j=F.boundary||"SheetJS";j="------="+j;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],M=k.FullPaths[0],ce=M,we=k.FileIndex[0],oe=1;oe<k.FullPaths.length;++oe)if(ce=k.FullPaths[oe].slice(M.length),we=k.FileIndex[oe],!(!we.size||!we.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(rt){return"_x"+rt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(rt){return"_u"+rt.charCodeAt(0).toString(16)+"_"});for(var de=we.content,he=wt&&Buffer.isBuffer(de)?de.toString("binary"):xe(de),De=0,Ue=Math.min(1024,he.length),He=0,Ie=0;Ie<=Ue;++Ie)(He=he.charCodeAt(Ie))>=32&&He<128&&++De;var Re=De>=Ue*4/5;I.push(j),I.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+ce),I.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),I.push("Content-Type: "+Rn(we,ce)),I.push(""),I.push(Re?ca(he):la(he))}return I.push(j+`--\r
`),I.join(`\r
`)}function Mn(k){var R={};return L(R,k),R}function Fr(k,R,F,j){var I=j&&j.unsafe;I||L(k);var M=!I&&Ft.find(k,R);if(!M){var ce=k.FullPaths[0];R.slice(0,ce.length)==ce?ce=R:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+R).replace("//","/")),M={name:i(R),type:2},k.FileIndex.push(M),k.FullPaths.push(ce),I||Ft.utils.cfb_gc(k)}return M.content=F,M.size=F?F.length:0,j&&(j.CLSID&&(M.clsid=j.CLSID),j.mt&&(M.mt=j.mt),j.ct&&(M.ct=j.ct)),M}function Bn(k,R){L(k);var F=Ft.find(k,R);if(F){for(var j=0;j<k.FileIndex.length;++j)if(k.FileIndex[j]==F)return k.FileIndex.splice(j,1),k.FullPaths.splice(j,1),!0}return!1}function ti(k,R,F){L(k);var j=Ft.find(k,R);if(j){for(var I=0;I<k.FileIndex.length;++I)if(k.FileIndex[I]==j)return k.FileIndex[I].name=i(F),k.FullPaths[I]=F,!0}return!1}function $i(k){q(k,!0)}return e.find=ee,e.read=G,e.parse=p,e.write=me,e.writeFile=fe,e.utils={cfb_new:Mn,cfb_add:Fr,cfb_del:Bn,cfb_mov:ti,cfb_gc:$i,ReadShift:gl,CheckField:dv,prep_blob:fn,bconcat:Er,use_zlib:N,_deflateRaw:Nr,_inflateRaw:Ui,consts:je},e})();function AS(r){return typeof r=="string"?Xu(r):Array.isArray(r)?Zb(r):r}function Bl(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Xu(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?Cl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var i=new Blob([AS(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,r);if(typeof saveAs<"u")return saveAs(i,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:r,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=r,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(r);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=Ml(e)),c.write(e),c.close(),e}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+r)}function Cr(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function Fg(r,e){for(var t=[],n=Cr(r),i=0;i!==n.length;++i)t[r[n[i]][e]]==null&&(t[r[n[i]][e]]=n[i]);return t}function Vh(r){for(var e=[],t=Cr(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function Qu(r){for(var e=[],t=Cr(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function CS(r){for(var e=[],t=Cr(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var Cu=new Date(1899,11,30,0,0,0);function tn(r,e){var t=r.getTime(),n=Cu.getTime()+(r.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var q1=new Date,NS=Cu.getTime()+(q1.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4,jg=q1.getTimezoneOffset();function X1(r){var e=new Date;return e.setTime(r*24*60*60*1e3+NS),e.getTimezoneOffset()!==jg&&e.setTime(e.getTime()+(e.getTimezoneOffset()-jg)*6e4),e}var Dg=new Date("2017-02-19T19:06:09.000Z"),Y1=isNaN(Dg.getFullYear())?new Date("2/19/17"):Dg,FS=Y1.getFullYear()==2017;function Hr(r,e){var t=new Date(r);if(FS)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(Y1.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=r.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return r.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Zu(r,e){if(wt&&Buffer.isBuffer(r))return r.toString("binary");if(typeof TextDecoder<"u")try{var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return t[a]||a})}catch{}for(var n=[],i=0;i!=r.length;++i)n.push(String.fromCharCode(r[i]));return n.join("")}function rn(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=rn(r[t]));return e}function Gt(r,e){for(var t="";t.length<e;)t+=r;return t}function Oi(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return t=-t,a}),!isNaN(e=Number(n)))?e/t:e}var jS=["january","february","march","april","may","june","july","august","september","october","november","december"];function Al(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),i=e.getMonth(),a=e.getDate();if(isNaN(a))return t;var o=r.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&jS.indexOf(o)==-1)return t}else if(o.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||a>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}function ct(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return wt?n=Mi(t):n=eS(t),Ft.utils.cfb_add(r,e,n)}Ft.utils.cfb_add(r,e,t)}else r.file(e,t)}function Gh(){return Ft.utils.cfb_new()}var nr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,DS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Kh=Vh(DS),qh=/[&<>'"]/g,OS=/[\u0000-\u0008\u000b-\u001f]/g;function At(r){var e=r+"";return e.replace(qh,function(t){return Kh[t]}).replace(OS,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Og(r){return At(r).replace(/ /g,"_x0020_")}var J1=/[\u0000-\u001f]/g;function PS(r){var e=r+"";return e.replace(qh,function(t){return Kh[t]}).replace(/\n/g,"<br/>").replace(J1,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function RS(r){var e=r+"";return e.replace(qh,function(t){return Kh[t]}).replace(J1,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function IS(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function LS(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Qf(r){for(var e="",t=0,n=0,i=0,a=0,o=0,c=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(i=r.charCodeAt(t++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(a=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=r.charCodeAt(t++),c=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Pg(r){var e=Xs(2*r.length),t,n,i=1,a=0,o=0,c;for(n=0;n<r.length;n+=i)i=1,(c=r.charCodeAt(n))<128?t=c:c<224?(t=(c&31)*64+(r.charCodeAt(n+1)&63),i=2):c<240?(t=(c&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),i=3):(i=4,t=(c&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=t%256,e[a++]=t>>>8;return e.slice(0,a).toString("ucs2")}function Rg(r){return Mi(r,"binary").toString("utf8")}var tu="foo bar bazâð£",ml=wt&&(Rg(tu)==Qf(tu)&&Rg||Pg(tu)==Qf(tu)&&Pg)||Qf,Cl=wt?function(r){return Mi(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,i=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},MS=(function(){var r=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<r.length;++i)n=n.replace(r[i][0],r[i][1]);return n}})(),Q1=/(^\s|\s$|\n)/;function kr(r,e){return"<"+r+(e.match(Q1)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function Nl(r){return Cr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function ze(r,e,t){return"<"+r+(t!=null?Nl(t):"")+(e!=null?(e.match(Q1)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function Th(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function BS(r,e){switch(typeof r){case"string":var t=ze("vt:lpwstr",At(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return ze((r|0)==r?"vt:i4":"vt:r8",At(String(r)));case"boolean":return ze("vt:bool",r?"true":"false")}if(r instanceof Date)return ze("vt:filetime",Th(r));throw new Error("Unable to serialize "+r)}var xr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},uo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],hn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function US(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),i=r[e+6]&15,a=5;a>=0;--a)i=i*256+r[e+a];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function zS(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,o=n?-e:e;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var c=0;c<=5;++c,a/=256)r[t+c]=a&255;r[t+6]=(i&15)<<4|a&15,r[t+7]=i>>4|n}var Ig=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var i=0,a=r[0][n].length;i<a;i+=t)e.push.apply(e,r[0][n].slice(i,i+t));return e},Lg=wt?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Mi(e)})):Ig(r)}:Ig,Mg=function(r,e,t){for(var n=[],i=e;i<t;i+=2)n.push(String.fromCharCode(al(r,i)));return n.join("").replace(pl,"")},Xh=wt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(pl,""):Mg(r,e,t)}:Mg,Bg=function(r,e,t){for(var n=[],i=e;i<e+t;++i)n.push(("0"+r[i].toString(16)).slice(-2));return n.join("")},Z1=wt?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):Bg(r,e,t)}:Bg,Ug=function(r,e,t){for(var n=[],i=e;i<t;i++)n.push(String.fromCharCode(Za(r,i)));return n.join("")},Ul=wt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Ug(e,t,n)}:Ug,ev=function(r,e){var t=pn(r,e);return t>0?Ul(r,e+4,e+4+t-1):""},tv=ev,rv=function(r,e){var t=pn(r,e);return t>0?Ul(r,e+4,e+4+t-1):""},nv=rv,iv=function(r,e){var t=2*pn(r,e);return t>0?Ul(r,e+4,e+4+t-1):""},sv=iv,av=function(e,t){var n=pn(e,t);return n>0?Xh(e,t+4,t+4+n):""},ov=av,lv=function(r,e){var t=pn(r,e);return t>0?Ul(r,e+4,e+4+t):""},cv=lv,uv=function(r,e){return US(r,e)},Nu=uv,Yh=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wt&&(tv=function(e,t){if(!Buffer.isBuffer(e))return ev(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},nv=function(e,t){if(!Buffer.isBuffer(e))return rv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},sv=function(e,t){if(!Buffer.isBuffer(e))return iv(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},ov=function(e,t){if(!Buffer.isBuffer(e))return av(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},cv=function(e,t){if(!Buffer.isBuffer(e))return lv(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Nu=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):uv(e,t)},Yh=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Za=function(r,e){return r[e]},al=function(r,e){return r[e+1]*256+r[e]},$S=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},pn=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Vs=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},WS=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function gl(r,e){var t="",n,i,a=[],o,c,d,f;switch(e){case"dbcs":if(f=this.l,wt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(d=0;d<r;++d)t+=String.fromCharCode(al(this,f)),f+=2;r*=2;break;case"utf8":t=Ul(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Xh(this,this.l,this.l+r);break;case"wstr":return gl.call(this,r,"dbcs");case"lpstr-ansi":t=tv(this,this.l),r=4+pn(this,this.l);break;case"lpstr-cp":t=nv(this,this.l),r=4+pn(this,this.l);break;case"lpwstr":t=sv(this,this.l),r=4+2*pn(this,this.l);break;case"lpp4":r=4+pn(this,this.l),t=ov(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+pn(this,this.l),t=cv(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(o=Za(this,this.l+r++))!==0;)a.push(Qc(o));t=a.join("");break;case"_wstr":for(r=0,t="";(o=al(this,this.l+r))!==0;)a.push(Qc(o)),r+=2;r+=2,t=a.join("");break;case"dbcs-cont":for(t="",f=this.l,d=0;d<r;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Za(this,f),this.l=f+1,c=gl.call(this,r-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Qc(al(this,f))),f+=2}t=a.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",f=this.l,d=0;d!=r;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Za(this,f),this.l=f+1,c=gl.call(this,r-d,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Qc(Za(this,f))),f+=1}t=a.join("");break;default:switch(r){case 1:return n=Za(this,this.l),this.l++,n;case 2:return n=(e==="i"?$S:al)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(r>0?Vs:WS)(this,this.l),this.l+=4,n):(i=pn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return r==8?i=Nu(this,this.l):i=Nu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;r=8;case 16:t=Z1(this,this.l,r);break}}return this.l+=r,t}var HS=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},VS=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},GS=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function KS(r,e,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)GS(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(t==="hex"){for(;i<r;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+r,this.length);for(i=0;i<Math.min(e.length,r);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,HS(this,e,this.l);break;case 8:if(n=8,t==="f"){zS(this,e,this.l);break}case 16:break;case-4:n=4,VS(this,e,this.l);break}return this.l+=n,this}function dv(r,e){var t=Z1(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function fn(r,e){r.l=e,r.read_shift=gl,r.chk=dv,r.write_shift=KS}function pi(r,e){r.l+=e}function _e(r){var e=Xs(r);return fn(e,0),e}function en(){var r=[],e=wt?256:2048,t=function(f){var p=_e(f);return fn(p,0),p},n=t(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(i(),n=t(Math.max(f+1,e)))},o=function(){return i(),Er(r)},c=function(f){i(),n=f,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:c,end:o,_bufs:r}}function Te(r,e,t,n){var i=+e,a;if(!isNaN(i)){n||(n=UC[i].p||(t||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=r.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var c=0;c!=4;++c)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Yh(t)&&r.push(t)}}function xl(r,e,t){var n=rn(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function zg(r,e,t){var n=rn(r);return n.s=xl(n.s,e.s,t),n.e=xl(n.e,e.s,t),n}function vl(r,e){if(r.cRel&&r.c<0)for(r=rn(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=rn(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=Ct(r);return!r.cRel&&r.cRel!=null&&(t=YS(t)),!r.rRel&&r.rRel!=null&&(t=qS(t)),t}function Zf(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+Rr(r.s.c)+":"+(r.e.cRel?"":"$")+Rr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Ar(r.s.r)+":"+(r.e.rRel?"":"$")+Ar(r.e.r):vl(r.s,e.biff)+":"+vl(r.e,e.biff)}function Jh(r){return parseInt(XS(r),10)-1}function Ar(r){return""+(r+1)}function qS(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function XS(r){return r.replace(/\$(\d+)$/,"$1")}function Qh(r){for(var e=JS(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function Rr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function YS(r){return r.replace(/^([A-Z])/,"$$$1")}function JS(r){return r.replace(/^\$([A-Z])/,"$1")}function QS(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vr(r){for(var e=0,t=0,n=0;n<r.length;++n){var i=r.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Ct(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function gn(r){var e=r.indexOf(":");return e==-1?{s:vr(r),e:vr(r)}:{s:vr(r.slice(0,e)),e:vr(r.slice(e+1))}}function rr(r,e){return typeof e>"u"||typeof e=="number"?rr(r.s,r.e):(typeof r!="string"&&(r=Ct(r)),typeof e!="string"&&(e=Ct(e)),r==e?r:r+":"+e)}function Mt(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,a=r.length;for(t=0;n<a&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.s.c=--t,t=0;n<a&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(e.s.r=--t,n===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=a&&!((i=r.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(e.e.c=--t,t=0;n!=a&&!((i=r.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return e.e.r=--t,e}function $g(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=vs(r.z,t?tn(e):e)}catch{}try{return r.w=vs((r.XF||{}).numFmtId||(t?14:0),t?tn(e):e)}catch{return""+e}}function Ii(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?zl[r.v]||r.v:e==null?$g(r,r.v):$g(r,e))}function ea(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function fv(r,e,t){var n=t||{},i=r?Array.isArray(r):n.dense,a=r||(i?[]:{}),o=0,c=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var d=typeof n.origin=="string"?vr(n.origin):n.origin;o=d.r,c=d.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var p=Mt(a["!ref"]);f.s.c=p.s.c,f.s.r=p.s.r,f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),o==-1&&(f.e.r=o=p.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[g].length;++v)if(!(typeof e[g][v]>"u")){var y={v:e[g][v]},b=o+g,_=c+v;if(f.s.r>b&&(f.s.r=b),f.s.c>_&&(f.s.c=_),f.e.r<b&&(f.e.r=b),f.e.c<_&&(f.e.c=_),e[g][v]&&typeof e[g][v]=="object"&&!Array.isArray(e[g][v])&&!(e[g][v]instanceof Date))y=e[g][v];else if(Array.isArray(y.v)&&(y.f=e[g][v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||Kt[14],n.cellDates?(y.t="d",y.w=vs(y.z,tn(y.v))):(y.t="n",y.v=tn(y.v),y.w=vs(y.z,y.v))):y.t="s";if(i)a[b]||(a[b]=[]),a[b][_]&&a[b][_].z&&(y.z=a[b][_].z),a[b][_]=y;else{var S=Ct({c:_,r:b});a[S]&&a[S].z&&(y.z=a[S].z),a[S]=y}}}return f.s.c<1e7&&(a["!ref"]=rr(f)),a}function fo(r,e){return fv(null,r,e)}function ZS(r){return r.read_shift(4,"i")}function Qn(r,e){return e||(e=_e(4)),e.write_shift(4,r),e}function Ir(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function yr(r,e){var t=!1;return e==null&&(t=!0,e=_e(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function eE(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function tE(r,e){return e||(e=_e(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Zh(r,e){var t=r.l,n=r.read_shift(1),i=Ir(r),a=[],o={t:i,h:i};if((n&1)!==0){for(var c=r.read_shift(4),d=0;d!=c;++d)a.push(eE(r));o.r=a}else o.r=[{ich:0,ifnt:0}];return r.l=t+e,o}function rE(r,e){var t=!1;return e==null&&(t=!0,e=_e(15+4*r.t.length)),e.write_shift(1,0),yr(r.t,e),t?e.slice(0,e.l):e}var nE=Zh;function iE(r,e){var t=!1;return e==null&&(t=!0,e=_e(23+4*r.t.length)),e.write_shift(1,1),yr(r.t,e),e.write_shift(4,1),tE({},e),t?e.slice(0,e.l):e}function Dn(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function ta(r,e){return e==null&&(e=_e(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function ra(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function na(r,e){return e==null&&(e=_e(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var sE=Ir,hv=yr;function e0(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function Fu(r,e){var t=!1;return e==null&&(t=!0,e=_e(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var aE=Ir,Ah=e0,t0=Fu;function pv(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var i=n===0?Nu([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Vs(e,0)>>2;return t?i/100:i}function mv(r,e){e==null&&(e=_e(4));var t=0,n=0,i=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?i:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function gv(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function oE(r,e){return e||(e=_e(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var ia=gv,ho=oE;function po(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function Ys(r,e){return(e||_e(8)).write_shift(8,r,"f")}function lE(r){var e={},t=r.read_shift(1),n=t>>>1,i=r.read_shift(1),a=r.read_shift(2,"i"),o=r.read_shift(1),c=r.read_shift(1),d=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var f=xE[i];f&&(e.rgb=Zg(f));break;case 2:e.rgb=Zg([o,c,d]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function ju(r,e){if(e||(e=_e(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function cE(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function uE(r,e){e||(e=_e(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var xv=2,dn=3,ru=11,Du=19,nu=64,dE=65,fE=71,hE=4108,pE=4126,Sr=80,Wg={1:{n:"CodePage",t:xv},2:{n:"Category",t:Sr},3:{n:"PresentationFormat",t:Sr},4:{n:"ByteCount",t:dn},5:{n:"LineCount",t:dn},6:{n:"ParagraphCount",t:dn},7:{n:"SlideCount",t:dn},8:{n:"NoteCount",t:dn},9:{n:"HiddenCount",t:dn},10:{n:"MultimediaClipCount",t:dn},11:{n:"ScaleCrop",t:ru},12:{n:"HeadingPairs",t:hE},13:{n:"TitlesOfParts",t:pE},14:{n:"Manager",t:Sr},15:{n:"Company",t:Sr},16:{n:"LinksUpToDate",t:ru},17:{n:"CharacterCount",t:dn},19:{n:"SharedDoc",t:ru},22:{n:"HyperlinksChanged",t:ru},23:{n:"AppVersion",t:dn,p:"version"},24:{n:"DigSig",t:dE},26:{n:"ContentType",t:Sr},27:{n:"ContentStatus",t:Sr},28:{n:"Language",t:Sr},29:{n:"Version",t:Sr},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},Hg={1:{n:"CodePage",t:xv},2:{n:"Title",t:Sr},3:{n:"Subject",t:Sr},4:{n:"Author",t:Sr},5:{n:"Keywords",t:Sr},6:{n:"Comments",t:Sr},7:{n:"Template",t:Sr},8:{n:"LastAuthor",t:Sr},9:{n:"RevNumber",t:Sr},10:{n:"EditTime",t:nu},11:{n:"LastPrinted",t:nu},12:{n:"CreatedDate",t:nu},13:{n:"ModifiedDate",t:nu},14:{n:"PageCount",t:dn},15:{n:"WordCount",t:dn},16:{n:"CharCount",t:dn},17:{n:"Thumbnail",t:fE},18:{n:"Application",t:Sr},19:{n:"DocSecurity",t:dn},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}};function mE(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var gE=mE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xE=rn(gE),zl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},iu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function vv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yv(r,e){var t=CS(vE),n=[],i;n[n.length]=nr,n[n.length]=ze("Types",null,{xmlns:xr.CT,"xmlns:xsd":xr.xsd,"xmlns:xsi":xr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return ze("Default",null,{Extension:d[0],ContentType:d[1]})}));var a=function(d){r[d]&&r[d].length>0&&(i=r[d][0],n[n.length]=ze("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:iu[d][e.bookType]||iu[d].xlsx}))},o=function(d){(r[d]||[]).forEach(function(f){n[n.length]=ze("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:iu[d][e.bookType]||iu[d].xlsx})})},c=function(d){(r[d]||[]).forEach(function(f){n[n.length]=ze("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:t[d][0]})})};return a("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var vt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function _v(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function ro(r){var e=[nr,ze("Relationships",null,{xmlns:xr.RELS})];return Cr(r["!id"]).forEach(function(t){e[e.length]=ze("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Et(r,e,t,n,i,a){if(i||(i={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=t,[vt.HLINK,vt.XPATH,vt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),r["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][i.Id]=i,r[("/"+i.Target).replace("//","/")]=i,e}function yE(r){var e=[nr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Vg(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function _E(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function wE(r){var e=[nr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(Vg(r[t][0],r[t][1])),e.push(_E("",r[t][0]));return e.push(Vg("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function wv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Su.version+"</meta:generator></office:meta></office:document-meta>"}var Ks=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function eh(r,e,t,n,i){i[r]!=null||e==null||e===""||(i[r]=e,e=At(e),n[n.length]=t?ze(r,e,t):kr(r,e))}function bv(r,e){var t=e||{},n=[nr,ze("cp:coreProperties",null,{"xmlns:cp":xr.CORE_PROPS,"xmlns:dc":xr.dc,"xmlns:dcterms":xr.dcterms,"xmlns:dcmitype":xr.dcmitype,"xmlns:xsi":xr.xsi})],i={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&eh("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:Th(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),r.ModifiedDate!=null&&eh("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:Th(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=Ks.length;++a){var o=Ks[a],c=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:r?r[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&eh(o[0],c,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var no=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Sv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ev(r){var e=[],t=ze;return r||(r={}),r.Application="SheetJS",e[e.length]=nr,e[e.length]=ze("Properties",null,{xmlns:xr.EXT_PROPS,"xmlns:vt":xr.vt}),no.forEach(function(n){if(r[n[1]]!==void 0){var i;switch(n[2]){case"string":i=At(String(r[n[1]]));break;case"bool":i=r[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(n[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+At(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function kv(r){var e=[nr,ze("Properties",null,{xmlns:xr.CUST_PROPS,"xmlns:vt":xr.vt})];if(!r)return e.join("");var t=1;return Cr(r).forEach(function(i){++t,e[e.length]=ze("property",BS(r[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:At(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Gg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function bE(r,e){var t=[];return Cr(Gg).map(function(n){for(var i=0;i<Ks.length;++i)if(Ks[i][1]==n)return Ks[i];for(i=0;i<no.length;++i)if(no[i][1]==n)return no[i];throw n}).forEach(function(n){if(r[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(kr(Gg[n[1]]||n[1],i))}}),ze("DocumentProperties",t.join(""),{xmlns:hn.o})}function SE(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return r&&Cr(r).forEach(function(a){if(Object.prototype.hasOwnProperty.call(r,a)){for(var o=0;o<Ks.length;++o)if(a==Ks[o][1])return;for(o=0;o<no.length;++o)if(a==no[o][1])return;for(o=0;o<t.length;++o)if(a==t[o])return;var c=r[a],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c=String(c),i.push(ze(Og(a),c,{"dt:dt":d}))}}),e&&Cr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(r&&Object.prototype.hasOwnProperty.call(r,a))){var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ze(Og(a),o,{"dt:dt":c}))}}),"<"+n+' xmlns="'+hn.o+'">'+i.join("")+"</"+n+">"}function EE(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var o=_e(8);return o.write_shift(4,n),o.write_shift(4,i),o}function Kg(r,e){var t=_e(4),n=_e(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=_e(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=EE(e);break;case 31:case 80:for(n=_e(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return Er([t,n])}var Tv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function kE(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function qg(r,e,t){var n=_e(8),i=[],a=[],o=8,c=0,d=_e(8),f=_e(8);if(d.write_shift(4,2),d.write_shift(4,1200),f.write_shift(4,1),a.push(d),i.push(f),o+=8+d.length,!e){f=_e(8),f.write_shift(4,0),i.unshift(f);var p=[_e(4)];for(p[0].write_shift(4,r.length),c=0;c<r.length;++c){var g=r[c][0];for(d=_e(8+2*(g.length+1)+(g.length%2?0:2)),d.write_shift(4,c+2),d.write_shift(4,g.length+1),d.write_shift(0,g,"dbcs");d.l!=d.length;)d.write_shift(1,0);p.push(d)}d=Er(p),a.unshift(d),o+=8+d.length}for(c=0;c<r.length;++c)if(!(e&&!e[r[c][0]])&&!(Tv.indexOf(r[c][0])>-1||Sv.indexOf(r[c][0])>-1)&&r[c][1]!=null){var v=r[c][1],y=0;if(e){y=+e[r[c][0]];var b=t[y];if(b.p=="version"&&typeof v=="string"){var _=v.split(".");v=(+_[0]<<16)+(+_[1]||0)}d=Kg(b.t,v)}else{var S=kE(v);S==-1&&(S=31,v=String(v)),d=Kg(S,v)}a.push(d),f=_e(8),f.write_shift(4,e?y:2+c),i.push(f),o+=8+d.length}var A=8*(a.length+1);for(c=0;c<a.length;++c)i[c].write_shift(4,A),A+=a[c].length;return n.write_shift(4,o),n.write_shift(4,a.length),Er([n].concat(i).concat(a))}function Xg(r,e,t,n,i,a){var o=_e(i?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ft.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var d=qg(r,t,n);if(c.push(d),i){var f=qg(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+d.length),c.push(f)}return Er(c)}function TE(r,e){e||(e=_e(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function AE(r,e){return r.read_shift(e)===1}function Wr(r,e){return e||(e=_e(2)),e.write_shift(2,+!!r),e}function Av(r){return r.read_shift(2,"u")}function Fn(r,e){return e||(e=_e(2)),e.write_shift(2,r),e}function Cv(r,e,t){return t||(t=_e(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function Nv(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var a=r.read_shift(1);a&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=n?r.read_shift(n,i):"";return o}function CE(r){var e=r.t||"",t=_e(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=_e(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[t,n];return Er(i)}function NE(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var i=r.read_shift(1);return i===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function FE(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):NE(r,n,t)}function jE(r,e,t){if(t.biff>5)return FE(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function Fv(r,e,t){return t||(t=_e(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function Yg(r,e){e||(e=_e(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function DE(r){var e=_e(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)e.write_shift(4,o[t]);if(a==28)n=n.slice(1),Yg(n,e);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));var c=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)e.write_shift(2,c.charCodeAt(t));e.write_shift(2,0),a&8&&Yg(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));for(var d=0;n.slice(d*3,d*3+3)=="../"||n.slice(d*3,d*3+3)=="..\\";)++d;for(e.write_shift(2,d),e.write_shift(4,n.length-3*d+1),t=0;t<n.length-3*d;++t)e.write_shift(1,n.charCodeAt(t+3*d)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Js(r,e,t,n){return n||(n=_e(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function OE(r,e,t){var n=t.biff>8?4:2,i=r.read_shift(n),a=r.read_shift(n,"i"),o=r.read_shift(n,"i");return[i,a,o]}function PE(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),i=r.read_shift(2);return{s:{c:n,r:e},e:{c:i,r:t}}}function jv(r,e){return e||(e=_e(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function r0(r,e,t){var n=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=_e(i);return a.write_shift(2,n),a.write_shift(2,e),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function RE(r,e){var t=!e||e.biff==8,n=_e(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function IE(r,e){var t=!e||e.biff>=8?2:1,n=_e(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function LE(r,e){var t=_e(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],i=0;i<r.length;++i)n[i]=CE(r[i]);var a=Er([t].concat(n));return a.parts=[t.length].concat(n.map(function(o){return o.length})),a}function ME(){var r=_e(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function BE(r){var e=_e(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function UE(r,e){var t=r.name||"Arial",n=e&&e.biff==5,i=n?15+t.length:16+2*t.length,a=_e(i);return a.write_shift(2,r.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),a}function zE(r,e,t,n){var i=_e(10);return Js(r,e,n,i),i.write_shift(4,t),i}function $E(r,e,t,n,i){var a=!i||i.biff==8,o=_e(8+ +a+(1+a)*t.length);return Js(r,e,n,o),o.write_shift(2,t.length),a&&o.write_shift(1,1),o.write_shift((1+a)*t.length,t,a?"utf16le":"sbcs"),o}function WE(r,e,t,n){var i=t&&t.biff==5;n||(n=_e(i?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function HE(r,e){var t=e.biff==8||!e.biff?4:2,n=_e(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function Jg(r,e,t,n){var i=t&&t.biff==5;n||(n=_e(i?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var a=0;return r.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function VE(r){var e=_e(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function GE(r,e,t,n,i,a){var o=_e(8);return Js(r,e,n,o),Cv(t,a,o),o}function KE(r,e,t,n){var i=_e(14);return Js(r,e,n,i),Ys(t,i),i}function qE(r,e,t){if(t.biff<8)return XE(r,e,t);for(var n=[],i=r.l+e,a=r.read_shift(t.biff>8?4:2);a--!==0;)n.push(OE(r,t.biff>8?12:6,t));if(r.l!=i)throw new Error("Bad ExternSheet: "+r.l+" != "+i);return n}function XE(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=Nv(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function YE(r){var e=_e(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)jv(r[t],e);return e}function JE(r){var e=_e(24),t=vr(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Er([e,DE(r[1])])}function QE(r){var e=r[1].Tooltip,t=_e(10+2*(e.length+1));t.write_shift(2,2048);var n=vr(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function ZE(r){return r||(r=_e(4)),r.write_shift(2,1),r.write_shift(2,1),r}function ek(r,e,t){if(!t.cellStyles)return pi(r,e);var n=t&&t.biff>=12?4:2,i=r.read_shift(n),a=r.read_shift(n),o=r.read_shift(n),c=r.read_shift(n),d=r.read_shift(2);n==2&&(r.l+=2);var f={s:i,e:a,w:o,ixfe:c,flags:d};return(t.biff>=5||!t.biff)&&(f.level=d>>8&7),f}function tk(r,e){var t=_e(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function rk(r){for(var e=_e(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}function nk(r,e,t){var n=_e(15);return Wl(n,r,e),n.write_shift(8,t,"f"),n}function ik(r,e,t){var n=_e(9);return Wl(n,r,e),n.write_shift(2,t),n}var sk=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Vh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,d){var f=[],p=Xs(1);switch(d.type){case"base64":p=Yn(Ri(c));break;case"binary":p=Yn(c);break;case"buffer":case"array":p=c;break}fn(p,0);var g=p.read_shift(1),v=!!(g&136),y=!1,b=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,v=!0;break;case 49:y=!0,v=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var _=0,S=521;g==2&&(_=p.read_shift(2)),p.l+=3,g!=2&&(_=p.read_shift(4)),_>1048576&&(_=1e6),g!=2&&(S=p.read_shift(2));var A=p.read_shift(2),C=d.codepage||1252;g!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(C=r[p[p.l]]),p.l+=1,p.l+=2),b&&(p.l+=36);for(var T=[],P={},z=Math.min(p.length,g==2?521:S-10-(y?264:0)),G=b?32:11;p.l<z&&p[p.l]!=13;)switch(P={},P.name=Eu.utils.decode(C,p.slice(p.l,p.l+G)).replace(/[\u0000\r\n].*$/g,""),p.l+=G,P.type=String.fromCharCode(p.read_shift(1)),g!=2&&!b&&(P.offset=p.read_shift(4)),P.len=p.read_shift(1),g==2&&(P.offset=p.read_shift(2)),P.dec=p.read_shift(1),P.name.length&&T.push(P),g!=2&&(p.l+=b?13:14),P.type){case"B":(!y||P.len!=8)&&d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(p[p.l]!==13&&(p.l=S-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=S;var L=0,V=0;for(f[0]=[],V=0;V!=T.length;++V)f[0][V]=T[V].name;for(;_-- >0;){if(p[p.l]===42){p.l+=A;continue}for(++p.l,f[++L]=[],V=0,V=0;V!=T.length;++V){var q=p.slice(p.l,p.l+T[V].len);p.l+=T[V].len,fn(q,0);var O=Eu.utils.decode(C,q);switch(T[V].type){case"C":O.trim().length&&(f[L][V]=O.replace(/\s+$/,""));break;case"D":O.length===8?f[L][V]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):f[L][V]=O;break;case"F":f[L][V]=parseFloat(O.trim());break;case"+":case"I":f[L][V]=b?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":f[L][V]=!0;break;case"N":case"F":f[L][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[L][V]="##MEMO##"+(b?parseInt(O.trim(),10):q.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(f[L][V]=+O||0);break;case"@":f[L][V]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":f[L][V]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":f[L][V]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[L][V]=-q.read_shift(-8,"f");break;case"B":if(y&&T[V].len==8){f[L][V]=q.read_shift(8,"f");break}case"G":case"P":q.l+=T[V].len;break;case"0":if(T[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[V].type)}}}if(g!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=T,f}function n(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var p=fo(t(c,f),f);return p["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,p}function i(c,d){try{return ea(n(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,d){var f=d||{};if(+f.codepage>=0&&kl(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=en(),g=Lu(c,{header:1,raw:!0,cellDates:!0}),v=g[0],y=g.slice(1),b=c["!cols"]||[],_=0,S=0,A=0,C=1;for(_=0;_<v.length;++_){if(((b[_]||{}).DBF||{}).name){v[_]=b[_].DBF.name,++A;continue}if(v[_]!=null){if(++A,typeof v[_]=="number"&&(v[_]=v[_].toString(10)),typeof v[_]!="string")throw new Error("DBF Invalid column name "+v[_]+" |"+typeof v[_]+"|");if(v.indexOf(v[_])!==_){for(S=0;S<1024;++S)if(v.indexOf(v[_]+"_"+S)==-1){v[_]+="_"+S;break}}}}var T=Mt(c["!ref"]),P=[],z=[],G=[];for(_=0;_<=T.e.c-T.s.c;++_){var L="",V="",q=0,O=[];for(S=0;S<y.length;++S)y[S][_]!=null&&O.push(y[S][_]);if(O.length==0||v[_]==null){P[_]="?";continue}for(S=0;S<O.length;++S){switch(typeof O[S]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=O[S]instanceof Date?"D":"C";break;default:V="C"}q=Math.max(q,String(O[S]).length),L=L&&L!=V?"C":V}q>250&&(q=250),V=((b[_]||{}).DBF||{}).type,V=="C"&&b[_].DBF.len>q&&(q=b[_].DBF.len),L=="B"&&V=="N"&&(L="N",G[_]=b[_].DBF.dec,q=b[_].DBF.len),z[_]=L=="C"||V=="N"?q:a[L]||0,C+=z[_],P[_]=L}var ee=p.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,y.length),ee.write_shift(2,296+32*A),ee.write_shift(2,C),_=0;_<4;++_)ee.write_shift(4,0);for(ee.write_shift(4,0|(+e[O1]||3)<<8),_=0,S=0;_<v.length;++_)if(v[_]!=null){var D=p.next(32),te=(v[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,te,"sbcs"),D.write_shift(1,P[_]=="?"?"C":P[_],"sbcs"),D.write_shift(4,S),D.write_shift(1,z[_]||a[P[_]]||0),D.write_shift(1,G[_]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),S+=z[_]||a[P[_]]||0}var ve=p.next(264);for(ve.write_shift(4,13),_=0;_<65;++_)ve.write_shift(4,0);for(_=0;_<y.length;++_){var ye=p.next(C);for(ye.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(P[S]){case"L":ye.write_shift(1,y[_][S]==null?63:y[_][S]?84:70);break;case"B":ye.write_shift(8,y[_][S]||0,"f");break;case"N":var Oe="0";for(typeof y[_][S]=="number"&&(Oe=y[_][S].toFixed(G[S]||0)),A=0;A<z[S]-Oe.length;++A)ye.write_shift(1,32);ye.write_shift(1,Oe,"sbcs");break;case"D":y[_][S]?(ye.write_shift(4,("0000"+y[_][S].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(y[_][S].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+y[_][S].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var je=String(y[_][S]!=null?y[_][S]:"").slice(0,z[S]);for(ye.write_shift(1,je,"sbcs"),A=0;A<z[S]-je.length;++A)ye.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),ak=(function(){var r={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Cr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(v,y){var b=r[y];return typeof b=="number"?wg(b):b},n=function(v,y,b){var _=y.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return _==59?v:wg(_)};r["|"]=254;function i(v,y){switch(y.type){case"base64":return a(Ri(v),y);case"binary":return a(v,y);case"buffer":return a(wt&&Buffer.isBuffer(v)?v.toString("binary"):Ml(v),y);case"array":return a(Zu(v),y)}throw new Error("Unrecognized type "+y.type)}function a(v,y){var b=v.split(/[\n\r]+/),_=-1,S=-1,A=0,C=0,T=[],P=[],z=null,G={},L=[],V=[],q=[],O=0,ee;for(+y.codepage>=0&&kl(+y.codepage);A!==b.length;++A){O=0;var D=b[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),te=D.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),ve=te[0],ye;if(D.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&P.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Oe=!1,je=!1,fe=!1,xe=!1,me=-1,K=-1;for(C=1;C<te.length;++C)switch(te[C].charAt(0)){case"A":break;case"X":S=parseInt(te[C].slice(1))-1,je=!0;break;case"Y":for(_=parseInt(te[C].slice(1))-1,je||(S=0),ee=T.length;ee<=_;++ee)T[ee]=[];break;case"K":ye=te[C].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(Oi(ye))?isNaN(Al(ye).getDate())||(ye=Hr(ye)):(ye=Oi(ye),z!==null&&V1(z)&&(ye=X1(ye))),Oe=!0;break;case"E":xe=!0;var N=iT(te[C].slice(1),{r:_,c:S});T[_][S]=[T[_][S],N];break;case"S":fe=!0,T[_][S]=[T[_][S],"S5S"];break;case"G":break;case"R":me=parseInt(te[C].slice(1))-1;break;case"C":K=parseInt(te[C].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}if(Oe&&(T[_][S]&&T[_][S].length==2?T[_][S][0]=ye:T[_][S]=ye,z=null),fe){if(xe)throw new Error("SYLK shared formula cannot have own formula");var X=me>-1&&T[me][K];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");T[_][S][1]=sT(X[1],{r:_-me,c:S-K})}break;case"F":var W=0;for(C=1;C<te.length;++C)switch(te[C].charAt(0)){case"X":S=parseInt(te[C].slice(1))-1,++W;break;case"Y":for(_=parseInt(te[C].slice(1))-1,ee=T.length;ee<=_;++ee)T[ee]=[];break;case"M":O=parseInt(te[C].slice(1))/20;break;case"F":break;case"G":break;case"P":z=P[parseInt(te[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=te[C].slice(1).split(" "),ee=parseInt(q[0],10);ee<=parseInt(q[1],10);++ee)O=parseInt(q[2],10),V[ee-1]=O===0?{hidden:!0}:{wch:O},n0(V[ee-1]);break;case"C":S=parseInt(te[C].slice(1))-1,V[S]||(V[S]={});break;case"R":_=parseInt(te[C].slice(1))-1,L[_]||(L[_]={}),O>0?(L[_].hpt=O,L[_].hpx=Iv(O)):O===0&&(L[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}W<1&&(z=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+D)}}return L.length>0&&(G["!rows"]=L),V.length>0&&(G["!cols"]=V),y&&y.sheetRows&&(T=T.slice(0,y.sheetRows)),[T,G]}function o(v,y){var b=i(v,y),_=b[0],S=b[1],A=fo(_,y);return Cr(S).forEach(function(C){A[C]=S[C]}),A}function c(v,y){return ea(o(v,y),y)}function d(v,y,b,_){var S="C;Y"+(b+1)+";X"+(_+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+s0(v.f,{r:b,c:_}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(v,y){y.forEach(function(b,_){var S="F;W"+(_+1)+" "+(_+1)+" ";b.hidden?S+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Ou(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Pu(b.wpx)),typeof b.wch=="number"&&(S+=Math.round(b.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function p(v,y){y.forEach(function(b,_){var S="F;";b.hidden?S+="M0;":b.hpt?S+="M"+20*b.hpt+";":b.hpx&&(S+="M"+20*Ru(b.hpx)+";"),S.length>2&&v.push(S+"R"+(_+1))})}function g(v,y){var b=["ID;PWXL;N;E"],_=[],S=Mt(v["!ref"]),A,C=Array.isArray(v),T=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),v["!cols"]&&f(b,v["!cols"]),v["!rows"]&&p(b,v["!rows"]),b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var P=S.s.r;P<=S.e.r;++P)for(var z=S.s.c;z<=S.e.c;++z){var G=Ct({r:P,c:z});A=C?(v[P]||[])[z]:v[G],!(!A||A.v==null&&(!A.f||A.F))&&_.push(d(A,v,P,z))}return b.join(T)+T+_.join(T)+T+"E"+T}return{to_workbook:c,to_sheet:o,from_sheet:g}})(),ok=(function(){function r(a,o){switch(o.type){case"base64":return e(Ri(a),o);case"binary":return e(a,o);case"buffer":return e(wt&&Buffer.isBuffer(a)?a.toString("binary"):Ml(a),o);case"array":return e(Zu(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var c=a.split(`
`),d=-1,f=-1,p=0,g=[];p!==c.length;++p){if(c[p].trim()==="BOT"){g[++d]=[],f=0;continue}if(!(d<0)){var v=c[p].trim().split(","),y=v[0],b=v[1];++p;for(var _=c[p]||"";(_.match(/["]/g)||[]).length&1&&p<c.length-1;)_+=`
`+c[++p];switch(_=_.trim(),+y){case-1:if(_==="BOT"){g[++d]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?g[d][f]=!0:_==="FALSE"?g[d][f]=!1:isNaN(Oi(b))?isNaN(Al(b).getDate())?g[d][f]=b:g[d][f]=Hr(b):g[d][f]=Oi(b),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),g[d][f++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function t(a,o){return fo(r(a,o),o)}function n(a,o){return ea(t(a,o),o)}var i=(function(){var a=function(d,f,p,g,v){d.push(f),d.push(p+","+g),d.push('"'+v.replace(/"/g,'""')+'"')},o=function(d,f,p,g){d.push(f+","+p),d.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(d){var f=[],p=Mt(d["!ref"]),g,v=Array.isArray(d);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,p.e.r-p.s.r+1,""),a(f,"TUPLES",0,p.e.c-p.s.c+1,""),a(f,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){o(f,-1,0,"BOT");for(var b=p.s.c;b<=p.e.c;++b){var _=Ct({r:y,c:b});if(g=v?(d[y]||[])[b]:d[_],!g){o(f,1,0,"");continue}switch(g.t){case"n":var S=g.w;!S&&g.v!=null&&(S=g.v),S==null?g.f&&!g.F?o(f,1,0,"="+g.f):o(f,1,0,""):o(f,0,S,"V");break;case"b":o(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=vs(g.z||Kt[14],tn(Hr(g.v)))),o(f,0,g.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var A=`\r
`,C=f.join(A);return C}})();return{to_workbook:n,to_sheet:t,from_sheet:i}})(),Dv=(function(){function r(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,v){for(var y=g.split(`
`),b=-1,_=-1,S=0,A=[];S!==y.length;++S){var C=y[S].trim().split(":");if(C[0]==="cell"){var T=vr(C[1]);if(A.length<=T.r)for(b=A.length;b<=T.r;++b)A[b]||(A[b]=[]);switch(b=T.r,_=T.c,C[2]){case"t":A[b][_]=r(C[3]);break;case"v":A[b][_]=+C[3];break;case"vtf":var P=C[C.length-1];case"vtc":switch(C[3]){case"nl":A[b][_]=!!+C[4];break;default:A[b][_]=+C[4];break}C[2]=="vtf"&&(A[b][_]=[A[b][_],P])}}}return v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),A}function n(g,v){return fo(t(g,v),v)}function i(g,v){return ea(n(g,v),v)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var v=[],y=[],b,_="",S=gn(g["!ref"]),A=Array.isArray(g),C=S.s.r;C<=S.e.r;++C)for(var T=S.s.c;T<=S.e.c;++T)if(_=Ct({r:C,c:T}),b=A?(g[C]||[])[T]:g[_],!(!b||b.v==null||b.t==="z")){switch(y=["cell",_,"t"],b.t){case"s":case"str":y.push(e(b.v));break;case"n":b.f?(y[2]="vtf",y[3]="n",y[4]=b.v,y[5]=e(b.f)):(y[2]="v",y[3]=b.v);break;case"b":y[2]="vt"+(b.f?"f":"c"),y[3]="nl",y[4]=b.v?"1":"0",y[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var P=tn(Hr(b.v));y[2]="vtc",y[3]="nd",y[4]=""+P,y[5]=b.w||vs(b.z||Kt[14],P);break;case"e":continue}v.push(y.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(g){return[a,o,c,o,f(g),d].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}})(),lk=(function(){function r(p,g,v,y,b){b.raw?g[v][y]=p:p===""||(p==="TRUE"?g[v][y]=!0:p==="FALSE"?g[v][y]=!1:isNaN(Oi(p))?isNaN(Al(p).getDate())?g[v][y]=p:g[v][y]=Hr(p):g[v][y]=Oi(p))}function e(p,g){var v=g||{},y=[];if(!p||p.length===0)return y;for(var b=p.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var S=10,A=0,C=0;C<=_;++C)A=b[C].indexOf(" "),A==-1?A=b[C].length:A++,S=Math.max(S,A);for(C=0;C<=_;++C){y[C]=[];var T=0;for(r(b[C].slice(0,S).trim(),y,C,T,v),T=1;T<=(b[C].length-S)/10+1;++T)r(b[C].slice(S+(T-1)*10,S+T*10).trim(),y,C,T,v)}return v.sheetRows&&(y=y.slice(0,v.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var g={},v=!1,y=0,b=0;y<p.length;++y)(b=p.charCodeAt(y))==34?v=!v:!v&&b in t&&(g[b]=(g[b]||0)+1);b=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&b.push([g[y],y]);if(!b.length){g=n;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&b.push([g[y],y])}return b.sort(function(_,S){return _[0]-S[0]||n[_[1]]-n[S[1]]}),t[b.pop()[1]]||44}function a(p,g){var v=g||{},y="",b=v.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=i(p.slice(0,1024)):v&&v.FS?y=v.FS:y=i(p.slice(0,1024));var S=0,A=0,C=0,T=0,P=0,z=y.charCodeAt(0),G=!1,L=0,V=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var q=v.dateNF!=null?ES(v.dateNF):null;function O(){var ee=p.slice(T,P),D={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)D.t="z";else if(v.raw)D.t="s",D.v=ee;else if(ee.trim().length===0)D.t="s",D.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(D.t="s",D.v=ee.slice(2,-1).replace(/""/g,'"')):aT(ee)?(D.t="n",D.f=ee.slice(1)):(D.t="s",D.v=ee);else if(ee=="TRUE")D.t="b",D.v=!0;else if(ee=="FALSE")D.t="b",D.v=!1;else if(!isNaN(C=Oi(ee)))D.t="n",v.cellText!==!1&&(D.w=ee),D.v=C;else if(!isNaN(Al(ee).getDate())||q&&ee.match(q)){D.z=v.dateNF||Kt[14];var te=0;q&&ee.match(q)&&(ee=kS(ee,v.dateNF,ee.match(q)||[]),te=1),v.cellDates?(D.t="d",D.v=Hr(ee,te)):(D.t="n",D.v=tn(Hr(ee,te))),v.cellText!==!1&&(D.w=vs(D.z,D.v instanceof Date?tn(D.v):D.v)),v.cellNF||delete D.z}else D.t="s",D.v=ee;if(D.t=="z"||(v.dense?(b[S]||(b[S]=[]),b[S][A]=D):b[Ct({c:A,r:S})]=D),T=P+1,V=p.charCodeAt(T),_.e.c<A&&(_.e.c=A),_.e.r<S&&(_.e.r=S),L==z)++A;else if(A=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;P<p.length;++P)switch(L=p.charCodeAt(P)){case 34:V===34&&(G=!G);break;case z:case 10:case 13:if(!G&&O())break e;break}return P-T>0&&O(),b["!ref"]=rr(_),b}function o(p,g){return!(g&&g.PRN)||g.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?a(p,g):fo(e(p,g),g)}function c(p,g){var v="",y=g.type=="string"?[0,0,0,0]:_N(p,g);switch(g.type){case"base64":v=Ri(p);break;case"binary":v=p;break;case"buffer":g.codepage==65001?v=p.toString("utf8"):g.codepage&&typeof Eu<"u"||(v=wt&&Buffer.isBuffer(p)?p.toString("binary"):Ml(p));break;case"array":v=Zu(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?v=ml(v.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?v=ml(v):g.type=="binary"&&typeof Eu<"u",v.slice(0,19)=="socialcalc:version:"?Dv.to_sheet(g.type=="string"?v:ml(v),g):o(v,g)}function d(p,g){return ea(c(p,g),g)}function f(p){for(var g=[],v=Mt(p["!ref"]),y,b=Array.isArray(p),_=v.s.r;_<=v.e.r;++_){for(var S=[],A=v.s.c;A<=v.e.c;++A){var C=Ct({r:_,c:A});if(y=b?(p[_]||[])[A]:p[C],!y||y.v==null){S.push("          ");continue}for(var T=(y.w||(Ii(y),y.w)||"").slice(0,10);T.length<10;)T+=" ";S.push(T+(A===0?" ":""))}g.push(S.join(""))}return g.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}})(),Qg=(function(){function r(N,X,W){if(N){fn(N,N.l||0);for(var B=W.Enum||me;N.l<N.length;){var J=N.read_shift(2),be=B[J]||B[65535],ie=N.read_shift(2),ne=N.l+ie,se=be.f&&be.f(N,ie,W);if(N.l=ne,X(se,be,J))return}}}function e(N,X){switch(X.type){case"base64":return t(Yn(Ri(N)),X);case"binary":return t(Yn(N),X);case"buffer":case"array":return t(N,X)}throw"Unsupported type "+X.type}function t(N,X){if(!N)return N;var W=X||{},B=W.dense?[]:{},J="Sheet1",be="",ie=0,ne={},se=[],Z=[],pe={s:{r:0,c:0},e:{r:0,c:0}},Ce=W.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)W.Enum=me,r(N,function(ke,jt,Bt){switch(Bt){case 0:W.vers=ke,ke>=4096&&(W.qpro=!0);break;case 6:pe=ke;break;case 204:ke&&(be=ke);break;case 222:be=ke;break;case 15:case 51:W.qpro||(ke[1].v=ke[1].v.slice(1));case 13:case 14:case 16:Bt==14&&(ke[2]&112)==112&&(ke[2]&15)>1&&(ke[2]&15)<15&&(ke[1].z=W.dateNF||Kt[14],W.cellDates&&(ke[1].t="d",ke[1].v=X1(ke[1].v))),W.qpro&&ke[3]>ie&&(B["!ref"]=rr(pe),ne[J]=B,se.push(J),B=W.dense?[]:{},pe={s:{r:0,c:0},e:{r:0,c:0}},ie=ke[3],J=be||"Sheet"+(ie+1),be="");var Ht=W.dense?(B[ke[0].r]||[])[ke[0].c]:B[Ct(ke[0])];if(Ht){Ht.t=ke[1].t,Ht.v=ke[1].v,ke[1].z!=null&&(Ht.z=ke[1].z),ke[1].f!=null&&(Ht.f=ke[1].f);break}W.dense?(B[ke[0].r]||(B[ke[0].r]=[]),B[ke[0].r][ke[0].c]=ke[1]):B[Ct(ke[0])]=ke[1];break}},W);else if(N[2]==26||N[2]==14)W.Enum=K,N[2]==14&&(W.qpro=!0,N.l=0),r(N,function(ke,jt,Bt){switch(Bt){case 204:J=ke;break;case 22:ke[1].v=ke[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ke[3]>ie&&(B["!ref"]=rr(pe),ne[J]=B,se.push(J),B=W.dense?[]:{},pe={s:{r:0,c:0},e:{r:0,c:0}},ie=ke[3],J="Sheet"+(ie+1)),Ce>0&&ke[0].r>=Ce)break;W.dense?(B[ke[0].r]||(B[ke[0].r]=[]),B[ke[0].r][ke[0].c]=ke[1]):B[Ct(ke[0])]=ke[1],pe.e.c<ke[0].c&&(pe.e.c=ke[0].c),pe.e.r<ke[0].r&&(pe.e.r=ke[0].r);break;case 27:ke[14e3]&&(Z[ke[14e3][0]]=ke[14e3][1]);break;case 1537:Z[ke[0]]=ke[1],ke[0]==ie&&(J=ke[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(B["!ref"]=rr(pe),ne[be||J]=B,se.push(be||J),!Z.length)return{SheetNames:se,Sheets:ne};for(var Fe={},We=[],Be=0;Be<Z.length;++Be)ne[se[Be]]?(We.push(Z[Be]||se[Be]),Fe[Z[Be]]=ne[Z[Be]]||ne[se[Be]]):(We.push(Z[Be]),Fe[Z[Be]]={"!ref":"A1"});return{SheetNames:We,Sheets:Fe}}function n(N,X){var W=X||{};if(+W.codepage>=0&&kl(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var B=en(),J=Mt(N["!ref"]),be=Array.isArray(N),ie=[];$e(B,0,a(1030)),$e(B,6,d(J));for(var ne=Math.min(J.e.r,8191),se=J.s.r;se<=ne;++se)for(var Z=Ar(se),pe=J.s.c;pe<=J.e.c;++pe){se===J.s.r&&(ie[pe]=Rr(pe));var Ce=ie[pe]+Z,Fe=be?(N[se]||[])[pe]:N[Ce];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?$e(B,13,y(se,pe,Fe.v)):$e(B,14,_(se,pe,Fe.v));else{var We=Ii(Fe);$e(B,15,g(se,pe,We.slice(0,239)))}}return $e(B,1),B.end()}function i(N,X){var W=X||{};if(+W.codepage>=0&&kl(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var B=en();$e(B,0,o(N));for(var J=0,be=0;J<N.SheetNames.length;++J)(N.Sheets[N.SheetNames[J]]||{})["!ref"]&&$e(B,27,xe(N.SheetNames[J],be++));var ie=0;for(J=0;J<N.SheetNames.length;++J){var ne=N.Sheets[N.SheetNames[J]];if(!(!ne||!ne["!ref"])){for(var se=Mt(ne["!ref"]),Z=Array.isArray(ne),pe=[],Ce=Math.min(se.e.r,8191),Fe=se.s.r;Fe<=Ce;++Fe)for(var We=Ar(Fe),Be=se.s.c;Be<=se.e.c;++Be){Fe===se.s.r&&(pe[Be]=Rr(Be));var ke=pe[Be]+We,jt=Z?(ne[Fe]||[])[Be]:ne[ke];if(!(!jt||jt.t=="z"))if(jt.t=="n")$e(B,23,O(Fe,Be,ie,jt.v));else{var Bt=Ii(jt);$e(B,22,L(Fe,Be,ie,Bt.slice(0,239)))}}++ie}}return $e(B,1),B.end()}function a(N){var X=_e(2);return X.write_shift(2,N),X}function o(N){var X=_e(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var W=0,B=0,J=0,be=0;be<N.SheetNames.length;++be){var ie=N.SheetNames[be],ne=N.Sheets[ie];if(!(!ne||!ne["!ref"])){++J;var se=gn(ne["!ref"]);W<se.e.r&&(W=se.e.r),B<se.e.c&&(B=se.e.c)}}return W>8191&&(W=8191),X.write_shift(2,W),X.write_shift(1,J),X.write_shift(1,B),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function c(N,X,W){var B={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&W.qpro?(B.s.c=N.read_shift(1),N.l++,B.s.r=N.read_shift(2),B.e.c=N.read_shift(1),N.l++,B.e.r=N.read_shift(2),B):(B.s.c=N.read_shift(2),B.s.r=N.read_shift(2),X==12&&W.qpro&&(N.l+=2),B.e.c=N.read_shift(2),B.e.r=N.read_shift(2),X==12&&W.qpro&&(N.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function d(N){var X=_e(8);return X.write_shift(2,N.s.c),X.write_shift(2,N.s.r),X.write_shift(2,N.e.c),X.write_shift(2,N.e.r),X}function f(N,X,W){var B=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(B[0].c=N.read_shift(1),B[3]=N.read_shift(1),B[0].r=N.read_shift(2),N.l+=2):(B[2]=N.read_shift(1),B[0].c=N.read_shift(2),B[0].r=N.read_shift(2)),B}function p(N,X,W){var B=N.l+X,J=f(N,X,W);if(J[1].t="s",W.vers==20768){N.l++;var be=N.read_shift(1);return J[1].v=N.read_shift(be,"utf8"),J}return W.qpro&&N.l++,J[1].v=N.read_shift(B-N.l,"cstr"),J}function g(N,X,W){var B=_e(7+W.length);B.write_shift(1,255),B.write_shift(2,X),B.write_shift(2,N),B.write_shift(1,39);for(var J=0;J<B.length;++J){var be=W.charCodeAt(J);B.write_shift(1,be>=128?95:be)}return B.write_shift(1,0),B}function v(N,X,W){var B=f(N,X,W);return B[1].v=N.read_shift(2,"i"),B}function y(N,X,W){var B=_e(7);return B.write_shift(1,255),B.write_shift(2,X),B.write_shift(2,N),B.write_shift(2,W,"i"),B}function b(N,X,W){var B=f(N,X,W);return B[1].v=N.read_shift(8,"f"),B}function _(N,X,W){var B=_e(13);return B.write_shift(1,255),B.write_shift(2,X),B.write_shift(2,N),B.write_shift(8,W,"f"),B}function S(N,X,W){var B=N.l+X,J=f(N,X,W);if(J[1].v=N.read_shift(8,"f"),W.qpro)N.l=B;else{var be=N.read_shift(2);P(N.slice(N.l,N.l+be),J),N.l+=be}return J}function A(N,X,W){var B=X&32768;return X&=-32769,X=(B?N:0)+(X>=8192?X-16384:X),(B?"":"$")+(W?Rr(X):Ar(X))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(N,X){fn(N,0);for(var W=[],B=0,J="",be="",ie="",ne="";N.l<N.length;){var se=N[N.l++];switch(se){case 0:W.push(N.read_shift(8,"f"));break;case 1:be=A(X[0].c,N.read_shift(2),!0),J=A(X[0].r,N.read_shift(2),!1),W.push(be+J);break;case 2:{var Z=A(X[0].c,N.read_shift(2),!0),pe=A(X[0].r,N.read_shift(2),!1);be=A(X[0].c,N.read_shift(2),!0),J=A(X[0].r,N.read_shift(2),!1),W.push(Z+pe+":"+be+J)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(N.read_shift(2));break;case 6:{for(var Ce="";se=N[N.l++];)Ce+=String.fromCharCode(se);W.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:ne=W.pop(),ie=W.pop(),W.push(["AND","OR"][se-20]+"("+ie+","+ne+")");break;default:if(se<32&&T[se])ne=W.pop(),ie=W.pop(),W.push(ie+T[se]+ne);else if(C[se]){if(B=C[se][1],B==69&&(B=N[N.l++]),B>W.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+W.join("|")+"|");return}var Fe=W.slice(-B);W.length-=B,W.push(C[se][0]+"("+Fe.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}W.length==1?X[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function z(N){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=N.read_shift(2),X[3]=N[N.l++],X[0].c=N[N.l++],X}function G(N,X){var W=z(N);return W[1].t="s",W[1].v=N.read_shift(X-4,"cstr"),W}function L(N,X,W,B){var J=_e(6+B.length);J.write_shift(2,N),J.write_shift(1,W),J.write_shift(1,X),J.write_shift(1,39);for(var be=0;be<B.length;++be){var ie=B.charCodeAt(be);J.write_shift(1,ie>=128?95:ie)}return J.write_shift(1,0),J}function V(N,X){var W=z(N);W[1].v=N.read_shift(2);var B=W[1].v>>1;if(W[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return W[1].v=B,W}function q(N,X){var W=z(N),B=N.read_shift(4),J=N.read_shift(4),be=N.read_shift(2);if(be==65535)return B===0&&J===3221225472?(W[1].t="e",W[1].v=15):B===0&&J===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var ie=be&32768;return be=(be&32767)-16446,W[1].v=(1-ie*2)*(J*Math.pow(2,be+32)+B*Math.pow(2,be)),W}function O(N,X,W,B){var J=_e(14);if(J.write_shift(2,N),J.write_shift(1,W),J.write_shift(1,X),B==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var be=0,ie=0,ne=0,se=0;return B<0&&(be=1,B=-B),ie=Math.log2(B)|0,B/=Math.pow(2,ie-31),se=B>>>0,(se&2147483648)==0&&(B/=2,++ie,se=B>>>0),B-=se,se|=2147483648,se>>>=0,B*=Math.pow(2,32),ne=B>>>0,J.write_shift(4,ne),J.write_shift(4,se),ie+=16383+(be?32768:0),J.write_shift(2,ie),J}function ee(N,X){var W=q(N);return N.l+=X-14,W}function D(N,X){var W=z(N),B=N.read_shift(4);return W[1].v=B>>6,W}function te(N,X){var W=z(N),B=N.read_shift(8,"f");return W[1].v=B,W}function ve(N,X){var W=te(N);return N.l+=X-10,W}function ye(N,X){return N[N.l+X-1]==0?N.read_shift(X,"cstr"):""}function Oe(N,X){var W=N[N.l++];W>X-1&&(W=X-1);for(var B="";B.length<W;)B+=String.fromCharCode(N[N.l++]);return B}function je(N,X,W){if(!(!W.qpro||X<21)){var B=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var J=N.read_shift(X-21,"cstr");return[B,J]}}function fe(N,X){for(var W={},B=N.l+X;N.l<B;){var J=N.read_shift(2);if(J==14e3){for(W[J]=[0,""],W[J][0]=N.read_shift(2);N[N.l];)W[J][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return W}function xe(N,X){var W=_e(5+N.length);W.write_shift(2,14e3),W.write_shift(2,X);for(var B=0;B<N.length;++B){var J=N.charCodeAt(B);W[W.l++]=J>127?95:J}return W[W.l++]=0,W}var me={0:{n:"BOF",f:Av},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:Oe},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:je},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}})(),ck=/^\s|\s$|[\t\n\r]/;function Ov(r,e){if(!e.bookSST)return"";var t=[nr];t[t.length]=ze("sst",null,{xmlns:uo[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var i=r[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(ck)&&(a+=' xml:space="preserve"'),a+=">"+At(i.t)+"</t>"),a+="</si>",t[t.length]=a}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function uk(r){return[r.read_shift(4),r.read_shift(4)]}function dk(r,e){return e||(e=_e(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var fk=rE;function hk(r){var e=en();Te(e,159,dk(r));for(var t=0;t<r.length;++t)Te(e,19,fk(r[t]));return Te(e,160),e.end()}function pk(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Pv(r){var e=0,t,n=pk(r),i=n.length+1,a,o,c,d,f;for(t=Xs(i),t[0]=n.length,a=1;a!=i;++a)t[a]=n[a-1];for(a=i-1;a>=0;--a)o=t[a],c=(e&16384)===0?0:1,d=e<<1&32767,f=c|d,e=f^o;return e^52811}var mk=(function(){function r(i,a){switch(a.type){case"base64":return e(Ri(i),a);case"binary":return e(i,a);case"buffer":return e(wt&&Buffer.isBuffer(i)?i.toString("binary"):Ml(i),a);case"array":return e(Zu(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){var o=a||{},c=o.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(p,g){Array.isArray(c)&&(c[g]=[]);for(var v=/\\\w+\b/g,y=0,b,_=-1;b=v.exec(p);){switch(b[0]){case"\\cell":var S=p.slice(y,v.lastIndex-b[0].length);if(S[0]==" "&&(S=S.slice(1)),++_,S.length){var A={v:S,t:"s"};Array.isArray(c)?c[g][_]=A:c[Ct({r:g,c:_})]=A}break}y=v.lastIndex}_>f.e.c&&(f.e.c=_)}),c["!ref"]=rr(f),c}function t(i,a){return ea(r(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Mt(i["!ref"]),c,d=Array.isArray(i),f=o.s.r;f<=o.e.r;++f){a.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)a.push("\\cellx"+(p+1));for(a.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var g=Ct({r:f,c:p});c=d?(i[f]||[])[p]:i[g],!(!c||c.v==null&&(!c.f||c.F))&&(a.push(" "+(c.w||(Ii(c),c.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}})();function Zg(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}var gk=6,Pi=gk;function Ou(r){return Math.floor((r+Math.round(128/Pi)/256)*Pi)}function Pu(r){return Math.floor((r-5)/Pi*100+.5)/100}function Ch(r){return Math.round((r*Pi+5)/Pi*256)/256}function n0(r){r.width?(r.wpx=Ou(r.width),r.wch=Pu(r.wpx),r.MDW=Pi):r.wpx?(r.wch=Pu(r.wpx),r.width=Ch(r.wch),r.MDW=Pi):typeof r.wch=="number"&&(r.width=Ch(r.wch),r.wpx=Ou(r.width),r.MDW=Pi),r.customWidth&&delete r.customWidth}var xk=96,Rv=xk;function Ru(r){return r*96/Rv}function Iv(r){return r*Rv/96}function vk(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=ze("numFmt",null,{numFmtId:n,formatCode:At(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ze("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function yk(r){var e=[];return e[e.length]=ze("cellXfs",null),r.forEach(function(t){e[e.length]=ze("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ze("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Lv(r,e){var t=[nr,ze("styleSheet",null,{xmlns:uo[0],"xmlns:vt":xr.vt})],n;return r.SSF&&(n=vk(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=yk(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function _k(r,e){var t=r.read_shift(2),n=Ir(r);return[t,n]}function wk(r,e,t){t||(t=_e(6+4*e.length)),t.write_shift(2,r),yr(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function bk(r,e,t){var n={};n.sz=r.read_shift(2)/20;var i=cE(r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=r.read_shift(2);switch(a===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=r.read_shift(1);o!=0&&(n.underline=o);var c=r.read_shift(1);c>0&&(n.family=c);var d=r.read_shift(1);switch(d>0&&(n.charset=d),r.l++,n.color=lE(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ir(r),n}function Sk(r,e){e||(e=_e(153)),e.write_shift(2,r.sz*20),uE(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),ju(r.color,e);var n=0;return n=2,e.write_shift(1,n),yr(r.name,e),e.length>e.l?e.slice(0,e.l):e}var Ek=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],th,kk=pi;function ex(r,e){e||(e=_e(84)),th||(th=Vh(Ek));var t=th[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(ju({auto:1},e),ju({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Tk(r,e){var t=r.l+e,n=r.read_shift(2),i=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:i}}function Mv(r,e,t){t||(t=_e(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Qo(r,e){return e||(e=_e(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Ak=pi;function Ck(r,e){return e||(e=_e(51)),e.write_shift(1,0),Qo(null,e),Qo(null,e),Qo(null,e),Qo(null,e),Qo(null,e),e.length>e.l?e.slice(0,e.l):e}function Nk(r,e){return e||(e=_e(52)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Fu(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Fk(r,e,t){var n=_e(2052);return n.write_shift(4,r),Fu(e,n),Fu(t,n),n.length>n.l?n.slice(0,n.l):n}function jk(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++t}),t!=0&&(Te(r,615,Qn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Te(r,44,wk(i,e[i]))}),Te(r,616))}}function Dk(r){var e=1;Te(r,611,Qn(e)),Te(r,43,Sk({sz:12,color:{theme:1},name:"Calibri",family:2})),Te(r,612)}function Ok(r){var e=2;Te(r,603,Qn(e)),Te(r,45,ex({patternType:"none"})),Te(r,45,ex({patternType:"gray125"})),Te(r,604)}function Pk(r){var e=1;Te(r,613,Qn(e)),Te(r,46,Ck()),Te(r,614)}function Rk(r){var e=1;Te(r,626,Qn(e)),Te(r,47,Mv({numFmtId:0},65535)),Te(r,627)}function Ik(r,e){Te(r,617,Qn(e.length)),e.forEach(function(t){Te(r,47,Mv(t,0))}),Te(r,618)}function Lk(r){var e=1;Te(r,619,Qn(e)),Te(r,48,Nk({xfId:0,name:"Normal"})),Te(r,620)}function Mk(r){var e=0;Te(r,505,Qn(e)),Te(r,506)}function Bk(r){var e=0;Te(r,508,Fk(e,"TableStyleMedium9","PivotStyleMedium4")),Te(r,509)}function Uk(r,e){var t=en();return Te(t,278),jk(t,r.SSF),Dk(t),Ok(t),Pk(t),Rk(t),Ik(t,e.cellXfs),Lk(t),Mk(t),Bk(t),Te(t,279),t.end()}function Bv(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[nr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function zk(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:Ir(r)}}function $k(r){var e=_e(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),yr(r.name,e),e.slice(0,e.l)}function Wk(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function Hk(r){var e=_e(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function Vk(r,e){var t=_e(8+2*e.length);return t.write_shift(4,r),yr(e,t),t.slice(0,t.l)}function Gk(r){return r.l+=4,r.read_shift(4)!=0}function Kk(r,e){var t=_e(8);return t.write_shift(4,r),t.write_shift(4,1),t}function qk(){var r=en();return Te(r,332),Te(r,334,Qn(1)),Te(r,335,$k({name:"XLDAPR",version:12e4,flags:3496657072})),Te(r,336),Te(r,339,Vk(1,"XLDAPR")),Te(r,52),Te(r,35,Qn(514)),Te(r,4096,Qn(0)),Te(r,4097,Fn(1)),Te(r,36),Te(r,53),Te(r,340),Te(r,337,Kk(1)),Te(r,51,Hk([[1,0]])),Te(r,338),Te(r,333),r.end()}function Uv(){var r=[nr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function Xk(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=Ct(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var eo=1024;function zv(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[ze("xml",null,{"xmlns:v":hn.v,"xmlns:o":hn.o,"xmlns:x":hn.x,"xmlns:mv":hn.mv}).replace(/\/>/,">"),ze("o:shapelayout",ze("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),ze("v:shapetype",[ze("v:stroke",null,{joinstyle:"miter"}),ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];eo<r*1e3;)eo+=1e3;return e.forEach(function(a){var o=vr(a[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var d=c.type=="gradient"?ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=ze("v:fill",d,c),p={on:"t",obscured:"t"};++eo,i=i.concat(["<v:shape"+Nl({id:"_x0000_s"+eo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,ze("v:shadow",null,p),ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),kr("x:AutoFill","False"),kr("x:Row",String(o.r)),kr("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function $v(r){var e=[nr,ze("comments",null,{xmlns:uo[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(i){var a=At(i.a);t.indexOf(a)==-1&&(t.push(a),e.push("<author>"+a+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(d){d.a&&(i=t.indexOf(At(d.a))),a.push(d.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)e.push(kr("t",At(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,c=1;c<a.length;++c)o+=`Reply:
    `+a[c]+`
`;e.push(kr("t",At(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Yk(r,e,t){var n=[nr,ze("ThreadedComments",null,{xmlns:xr.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var d={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?a=d.id:d.parentId=a,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(ze("threadedComment",kr("text",o.t||""),d))})}),n.push("</ThreadedComments>"),n.join("")}function Jk(r){var e=[nr,ze("personList",null,{xmlns:xr.TCMNT,"xmlns:x":uo[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(ze("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Qk(r){var e={};e.iauthor=r.read_shift(4);var t=ia(r);return e.rfx=t.s,e.ref=Ct(t.s),r.l+=16,e}function Zk(r,e){return e==null&&(e=_e(36)),e.write_shift(4,r[1].iauthor),ho(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var eT=Ir;function tT(r){return yr(r.slice(0,54))}function rT(r){var e=en(),t=[];return Te(e,628),Te(e,630),r.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Te(e,632,tT(i.a)))})}),Te(e,631),Te(e,633),r.forEach(function(n){n[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var a={s:vr(n[0]),e:vr(n[0])};Te(e,635,Zk([a,i])),i.t&&i.t.length>0&&Te(e,637,iE(i)),Te(e,636),delete i.iauthor})}),Te(e,634),Te(e,629),e.end()}function nT(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ft.utils.cfb_add(r,i,e.FileIndex[n].content)}})}var Wv=["xlsb","xlsm","xlam","biff8","xla"],iT=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,i,a,o){var c=!1,d=!1;a.length==0?d=!0:a.charAt(0)=="["&&(d=!0,a=a.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return c?p+=e.c:--p,d?f+=e.r:--f,i+(c?"":"$")+Rr(p)+(d?"":"$")+Ar(f)}return function(i,a){return e=a,i.replace(r,t)}})(),i0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,s0=(function(){return function(e,t){return e.replace(i0,function(n,i,a,o,c,d){var f=Qh(o)-(a?0:t.c),p=Jh(d)-(c?0:t.r),g=p==0?"":c?p+1:"["+p+"]",v=f==0?"":a?f+1:"["+f+"]";return i+"R"+g+"C"+v})}})();function sT(r,e){return r.replace(i0,function(t,n,i,a,o,c){return n+(i=="$"?i+a:Rr(Qh(a)+e.c))+(o=="$"?o+c:Ar(Jh(c)+e.r))})}function aT(r){return r.length!=1}function er(r){r.l+=1}function ys(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Hv(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Vv(r);t.biff==12&&(n=4)}var i=r.read_shift(n),a=r.read_shift(n),o=ys(r),c=ys(r);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function Vv(r){var e=ys(r),t=ys(r),n=r.read_shift(1),i=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function oT(r,e,t){if(t.biff<8)return Vv(r);var n=r.read_shift(t.biff==12?4:2),i=r.read_shift(t.biff==12?4:2),a=ys(r),o=ys(r);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Gv(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return lT(r);var n=r.read_shift(t&&t.biff==12?4:2),i=ys(r);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function lT(r){var e=ys(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function cT(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function uT(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return dT(r);var i=r.read_shift(n>=12?4:2),a=r.read_shift(2),o=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:c}}function dT(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:n}}function fT(r,e,t){var n=(r[r.l++]&96)>>5,i=Hv(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function hT(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2,"i"),a=8;if(t)switch(t.biff){case 5:r.l+=12,a=6;break;case 12:a=12;break}var o=Hv(r,a,t);return[n,i,o]}function pT(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function mT(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),a=8;if(t)switch(t.biff){case 5:r.l+=12,a=6;break;case 12:a=12;break}return r.l+=a,[n,i]}function gT(r,e,t){var n=(r[r.l++]&96)>>5,i=oT(r,e-1,t);return[n,i]}function xT(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function tx(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function vT(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(r.read_shift(t&&t.biff==2?1:2));return i}function yT(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function _T(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function wT(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function bT(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function Kv(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function ST(r){return r.read_shift(2),Kv(r)}function ET(r){return r.read_shift(2),Kv(r)}function kT(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=Gv(r,0,t);return[n,i]}function TT(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=uT(r,0,t);return[n,i]}function AT(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var a=Gv(r,0,t);return[n,i,a]}function CT(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var i=r.read_shift(t&&t.biff<=3?1:2);return[C4[i],Yv[i],n]}function NT(r,e,t){var n=r[r.l++],i=r.read_shift(1),a=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:FT(r);return[i,(a[0]===0?Yv:A4)[a[1]]]}function FT(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function jT(r,e,t){r.l+=t&&t.biff==2?3:4}function DT(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function OT(r){return r.l++,zl[r.read_shift(1)]}function PT(r){return r.l++,r.read_shift(2)}function RT(r){return r.l++,r.read_shift(1)!==0}function IT(r){return r.l++,po(r)}function LT(r,e,t){return r.l++,Nv(r,e-1,t)}function MT(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=AE(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=zl[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=po(r);break;case 2:t[1]=jE(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function BT(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((t.biff==12?ia:PE)(r));return i}function UT(r,e,t){var n=0,i=0;t.biff==12?(n=r.read_shift(4),i=r.read_shift(4)):(i=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var c=0;c!=i;++c)o[a][c]=MT(r,t.biff);return o}function zT(r,e,t){var n=r.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,a=r.read_shift(i);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,a]}function $T(r,e,t){if(t.biff==5)return WT(r);var n=r.read_shift(1)>>>5&3,i=r.read_shift(2),a=r.read_shift(4);return[n,i,a]}function WT(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function HT(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function VT(r,e,t){var n=r.read_shift(1)>>>5&3,i=r.read_shift(t&&t.biff==2?1:2);return[n,i]}function GT(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function KT(r,e,t){var n=(r[r.l++]&96)>>5,i=r.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6;break}return r.l+=a,[n,i]}var qT=pi,XT=pi,YT=pi;function $l(r,e,t){return r.l+=2,[cT(r)]}function a0(r){return r.l+=6,[]}var JT=$l,QT=a0,ZT=a0,e4=$l;function qv(r){return r.l+=2,[Av(r),r.read_shift(2)&1]}var t4=$l,r4=qv,n4=a0,i4=$l,s4=$l,a4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function o4(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),i=r.read_shift(2),a=r.read_shift(2),o=a4[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:n,c:i,C:a}}function l4(r){return r.l+=2,[r.read_shift(4)]}function c4(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function u4(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function d4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function f4(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function h4(r){return r.l+=4,[0,0]}var rx={1:{n:"PtgExp",f:DT},2:{n:"PtgTbl",f:YT},3:{n:"PtgAdd",f:er},4:{n:"PtgSub",f:er},5:{n:"PtgMul",f:er},6:{n:"PtgDiv",f:er},7:{n:"PtgPower",f:er},8:{n:"PtgConcat",f:er},9:{n:"PtgLt",f:er},10:{n:"PtgLe",f:er},11:{n:"PtgEq",f:er},12:{n:"PtgGe",f:er},13:{n:"PtgGt",f:er},14:{n:"PtgNe",f:er},15:{n:"PtgIsect",f:er},16:{n:"PtgUnion",f:er},17:{n:"PtgRange",f:er},18:{n:"PtgUplus",f:er},19:{n:"PtgUminus",f:er},20:{n:"PtgPercent",f:er},21:{n:"PtgParen",f:er},22:{n:"PtgMissArg",f:er},23:{n:"PtgStr",f:LT},26:{n:"PtgSheet",f:c4},27:{n:"PtgEndSheet",f:u4},28:{n:"PtgErr",f:OT},29:{n:"PtgBool",f:RT},30:{n:"PtgInt",f:PT},31:{n:"PtgNum",f:IT},32:{n:"PtgArray",f:xT},33:{n:"PtgFunc",f:CT},34:{n:"PtgFuncVar",f:NT},35:{n:"PtgName",f:zT},36:{n:"PtgRef",f:kT},37:{n:"PtgArea",f:fT},38:{n:"PtgMemArea",f:HT},39:{n:"PtgMemErr",f:qT},40:{n:"PtgMemNoMem",f:XT},41:{n:"PtgMemFunc",f:VT},42:{n:"PtgRefErr",f:GT},43:{n:"PtgAreaErr",f:pT},44:{n:"PtgRefN",f:TT},45:{n:"PtgAreaN",f:gT},46:{n:"PtgMemAreaN",f:d4},47:{n:"PtgMemNoMemN",f:f4},57:{n:"PtgNameX",f:$T},58:{n:"PtgRef3d",f:AT},59:{n:"PtgArea3d",f:hT},60:{n:"PtgRefErr3d",f:KT},61:{n:"PtgAreaErr3d",f:mT},255:{}},p4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},m4={1:{n:"PtgElfLel",f:qv},2:{n:"PtgElfRw",f:i4},3:{n:"PtgElfCol",f:JT},6:{n:"PtgElfRwV",f:s4},7:{n:"PtgElfColV",f:e4},10:{n:"PtgElfRadical",f:t4},11:{n:"PtgElfRadicalS",f:n4},13:{n:"PtgElfColS",f:QT},15:{n:"PtgElfColSV",f:ZT},16:{n:"PtgElfRadicalLel",f:r4},25:{n:"PtgList",f:o4},29:{n:"PtgSxName",f:l4},255:{}},g4={0:{n:"PtgAttrNoop",f:h4},1:{n:"PtgAttrSemi",f:bT},2:{n:"PtgAttrIf",f:_T},4:{n:"PtgAttrChoose",f:vT},8:{n:"PtgAttrGoto",f:yT},16:{n:"PtgAttrSum",f:jT},32:{n:"PtgAttrBaxcel",f:tx},33:{n:"PtgAttrBaxcel",f:tx},64:{n:"PtgAttrSpace",f:ST},65:{n:"PtgAttrSpaceSemi",f:ET},128:{n:"PtgAttrIfError",f:wT},255:{}};function x4(r,e,t,n){if(n.biff<8)return pi(r,e);for(var i=r.l+e,a=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=UT(r,0,n),a.push(t[o][1]);break;case"PtgMemArea":t[o][2]=BT(r,t[o][1],n),a.push(t[o][2]);break;case"PtgExp":n&&n.biff==12&&(t[o][1][1]=r.read_shift(4),a.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=i-r.l,e!==0&&a.push(pi(r,e)),a}function v4(r,e,t){for(var n=r.l+e,i,a,o=[];n!=r.l;)e=n-r.l,a=r[r.l],i=rx[a]||rx[p4[a]],(a===24||a===25)&&(i=(a===24?m4:g4)[r[r.l+1]]),!i||!i.f?pi(r,e):o.push([i.n,i.f(r,e,t)]);return o}function y4(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var _4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function w4(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function Xv(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(r[n[0]][0]){case 357:return i=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return r[n[0]][0][3]?(i=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function nx(r,e,t){var n=Xv(r,e,t);return n=="#REF"?n:w4(n,t)}function oo(r,e,t,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},c=[],d,f,p,g=0,v=0,y,b="";if(!r[0]||!r[0][0])return"";for(var _=-1,S="",A=0,C=r[0].length;A<C;++A){var T=r[0][A];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),_>=0){switch(r[0][_][1][0]){case 0:S=Gt(" ",r[0][_][1][1]);break;case 1:S=Gt("\r",r[0][_][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][_][1][0])}f=f+S,_=-1}c.push(f+_4[T[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=xl(T[1][1],o,i),c.push(vl(p,a));break;case"PtgRefN":p=t?xl(T[1][1],t,i):T[1][1],c.push(vl(p,a));break;case"PtgRef3d":g=T[1][1],p=xl(T[1][2],o,i),b=nx(n,g,i),c.push(b+"!"+vl(p,a));break;case"PtgFunc":case"PtgFuncVar":var P=T[1][0],z=T[1][1];P||(P=0),P&=127;var G=P==0?[]:c.slice(-P);c.length-=P,z==="User"&&(z=G.shift()),c.push(z+"("+G.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":y=zg(T[1][1],t?{s:t}:o,i),c.push(Zf(y,i));break;case"PtgArea":y=zg(T[1][1],o,i),c.push(Zf(y,i));break;case"PtgArea3d":g=T[1][1],y=T[1][2],b=nx(n,g,i),c.push(b+"!"+Zf(y,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=T[1][2];var L=(n.names||[])[v-1]||(n[0]||[])[v],V=L?L.Name:"SH33TJSNAME"+String(v);V&&V.slice(0,6)=="_xlfn."&&!i.xlfn&&(V=V.slice(6)),c.push(V);break;case"PtgNameX":var q=T[1][1];v=T[1][2];var O;if(i.biff<=5)q<0&&(q=-q),n[q]&&(O=n[q][v]);else{var ee="";if(((n[q]||[])[0]||[])[0]==14849||(((n[q]||[])[0]||[])[0]==1025?n[q][v]&&n[q][v].itab>0&&(ee=n.SheetNames[n[q][v].itab-1]+"!"):ee=n.SheetNames[v-1]+"!"),n[q]&&n[q][v])ee+=n[q][v].Name;else if(n[0]&&n[0][v])ee+=n[0][v].Name;else{var D=(Xv(n,q,i)||"").split(";;");D[v-1]?ee=D[v-1]:ee+="SH33TJSERRX"}c.push(ee);break}O||(O={Name:"SH33TJSERRY"}),c.push(O.Name);break;case"PtgParen":var te="(",ve=")";if(_>=0){switch(S="",r[0][_][1][0]){case 2:te=Gt(" ",r[0][_][1][1])+te;break;case 3:te=Gt("\r",r[0][_][1][1])+te;break;case 4:ve=Gt(" ",r[0][_][1][1])+ve;break;case 5:ve=Gt("\r",r[0][_][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][_][1][0])}_=-1}c.push(te+c.pop()+ve);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:T[1][1],r:T[1][0]};var ye={c:t.c,r:t.r};if(n.sharedf[Ct(p)]){var Oe=n.sharedf[Ct(p)];c.push(oo(Oe,o,ye,n,i))}else{var je=!1;for(d=0;d!=n.arrayf.length;++d)if(f=n.arrayf[d],!(p.c<f[0].s.c||p.c>f[0].e.c)&&!(p.r<f[0].s.r||p.r>f[0].e.r)){c.push(oo(f[1],o,ye,n,i)),je=!0;break}je||c.push(T[1])}break;case"PtgArray":c.push("{"+y4(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&fe.indexOf(r[0][A][0])==-1){T=r[0][_];var xe=!0;switch(T[1][0]){case 4:xe=!1;case 0:S=Gt(" ",T[1][1]);break;case 5:xe=!1;case 1:S=Gt("\r",T[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((xe?S:"")+c.pop()+(xe?"":S)),_=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function b4(r){if(r==null){var e=_e(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return Ys(r);return Ys(0)}function S4(r,e,t,n,i){var a=Js(e,t,i),o=b4(r.v),c=_e(6),d=33;c.write_shift(2,d),c.write_shift(4,0);for(var f=_e(r.bf.length),p=0;p<r.bf.length;++p)f[p]=r.bf[p];var g=Er([a,o,c,f]);return g}function ed(r,e,t){var n=r.read_shift(4),i=v4(r,n,t),a=r.read_shift(4),o=a>0?x4(r,a,i,t):null;return[i,o]}var E4=ed,td=ed,k4=ed,T4=ed,A4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Yv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},C4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function N4(r){var e="of:="+r.replace(i0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function F4(r){return r.replace(/\./,"!")}var yl=typeof Map<"u";function o0(r,e,t){var n=0,i=r.length;if(t){if(yl?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var a=yl?t.get(e):t[e];n<a.length;++n)if(r[a[n]].t===e)return r.Count++,a[n]}}else for(;n<i;++n)if(r[n].t===e)return r.Count++,n;return r[i]={t:e},r.Count++,r.Unique++,t&&(yl?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function rd(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(Pi=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=Pu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=Ch(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Jv(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function Ss(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],i=60,a=r.length;if(n==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){G1(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=n=i;break}}for(i=0;i!=a;++i)if(r[i].numFmtId===n)return i;return r[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function j4(r,e,t){if(r&&r["!ref"]){var n=Mt(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function D4(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+rr(r[t])+'"/>';return e+"</mergeCells>"}function O4(r,e,t,n,i){var a=!1,o={},c=null;if(n.bookType!=="xlsx"&&e.vbaraw){var d=e.SheetNames[t];try{e.Workbook&&(d=e.Workbook.Sheets[t].CodeName||d)}catch{}a=!0,o.codeName=Cl(At(d))}if(r&&r["!outline"]){var f={summaryBelow:1,summaryRight:1};r["!outline"].above&&(f.summaryBelow=0),r["!outline"].left&&(f.summaryRight=0),c=(c||"")+ze("outlinePr",null,f)}!a&&!c||(i[i.length]=ze("sheetPr",c,o))}var P4=["objects","scenarios","selectLockedCells","selectUnlockedCells"],R4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function I4(r){var e={sheet:1};return P4.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),R4.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=Pv(r.password).toString(16).toUpperCase()),ze("sheetProtection",null,e)}function L4(r){return Jv(r),ze("pageMargins",null,r)}function M4(r,e){for(var t=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(t[t.length]=ze("col",null,rd(i,n)));return t[t.length]="</cols>",t.join("")}function B4(r,e,t,n){var i=typeof r.ref=="string"?r.ref:rr(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=gn(i);o.s.r==o.e.r&&(o.e.r=gn(e["!ref"]).e.r,i=rr(o));for(var c=0;c<a.length;++c){var d=a[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+t.SheetNames[n]+"'!"+i;break}}return c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),ze("autoFilter",null,{ref:i})}function U4(r,e,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ze("sheetViews",ze("sheetView",null,i),{})}function z4(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var i="",a=r.t,o=r.v;if(r.t!=="z")switch(r.t){case"b":i=r.v?"1":"0";break;case"n":i=""+r.v;break;case"e":i=zl[r.v];break;case"d":n&&n.cellDates?i=Hr(r.v,-1).toISOString():(r=rn(r),r.t="n",i=""+(r.v=tn(Hr(r.v)))),typeof r.z>"u"&&(r.z=Kt[14]);break;default:i=r.v;break}var c=kr("v",At(i)),d={r:e},f=Ss(n.cellXfs,r,n);switch(f!==0&&(d.s=f),r.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=kr("v",""+o0(n.Strings,r.v,n.revStrings)),d.t="s";break}d.t="str";break}if(r.t!=a&&(r.t=a,r.v=o),typeof r.f=="string"&&r.f){var p=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;c=ze("f",At(r.f),p)+(r.v!=null?c:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(d.cm=1),ze("c",c,d)}function $4(r,e,t,n){var i=[],a=[],o=Mt(r["!ref"]),c="",d,f="",p=[],g=0,v=0,y=r["!rows"],b=Array.isArray(r),_={r:f},S,A=-1;for(v=o.s.c;v<=o.e.c;++v)p[v]=Rr(v);for(g=o.s.r;g<=o.e.r;++g){for(a=[],f=Ar(g),v=o.s.c;v<=o.e.c;++v){d=p[v]+f;var C=b?(r[g]||[])[v]:r[d];C!==void 0&&(c=z4(C,d,r,e))!=null&&a.push(c)}(a.length>0||y&&y[g])&&(_={r:f},y&&y[g]&&(S=y[g],S.hidden&&(_.hidden=1),A=-1,S.hpx?A=Ru(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(_.ht=A,_.customHeight=1),S.level&&(_.outlineLevel=S.level)),i[i.length]=ze("row",a.join(""),_))}if(y)for(;g<y.length;++g)y&&y[g]&&(_={r:g+1},S=y[g],S.hidden&&(_.hidden=1),A=-1,S.hpx?A=Ru(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(_.ht=A,_.customHeight=1),S.level&&(_.outlineLevel=S.level),i[i.length]=ze("row","",_));return i.join("")}function Qv(r,e,t,n){var i=[nr,ze("worksheet",null,{xmlns:uo[0],"xmlns:r":xr.r})],a=t.SheetNames[r],o=0,c="",d=t.Sheets[a];d==null&&(d={});var f=d["!ref"]||"A1",p=Mt(f);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),f=rr(p)}n||(n={}),d["!comments"]=[];var g=[];O4(d,t,r,e,i),i[i.length]=ze("dimension",null,{ref:f}),i[i.length]=U4(d,e,r,t),e.sheetFormat&&(i[i.length]=ze("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(i[i.length]=M4(d,d["!cols"])),i[o=i.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(c=$4(d,e),c.length>0&&(i[i.length]=c)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),d["!protect"]&&(i[i.length]=I4(d["!protect"])),d["!autofilter"]!=null&&(i[i.length]=B4(d["!autofilter"],d,t,r)),d["!merges"]!=null&&d["!merges"].length>0&&(i[i.length]=D4(d["!merges"]));var v=-1,y,b=-1;return d["!links"].length>0&&(i[i.length]="<hyperlinks>",d["!links"].forEach(function(_){_[1].Target&&(y={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=Et(n,-1,At(_[1].Target).replace(/#.*$/,""),vt.HLINK),y["r:id"]="rId"+b),(v=_[1].Target.indexOf("#"))>-1&&(y.location=At(_[1].Target.slice(v+1))),_[1].Tooltip&&(y.tooltip=At(_[1].Tooltip)),i[i.length]=ze("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(i[i.length]=L4(d["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=kr("ignoredErrors",ze("ignoredError",null,{numberStoredAsText:1,sqref:f}))),g.length>0&&(b=Et(n,-1,"../drawings/drawing"+(r+1)+".xml",vt.DRAW),i[i.length]=ze("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=g),d["!comments"].length>0&&(b=Et(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",vt.VML),i[i.length]=ze("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function W4(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var i=r.read_shift(2);r.l+=1;var a=r.read_shift(1);return r.l=n,a&7&&(t.level=a&7),a&16&&(t.hidden=!0),a&32&&(t.hpt=i/20),t}function H4(r,e,t){var n=_e(145),i=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var a=320;i.hpx?a=Ru(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var c=0,d=n.l;n.l+=4;for(var f={r,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var g=-1,v=-1,y=p<<10;y<p+1<<10;++y){f.c=y;var b=Array.isArray(t)?(t[f.r]||[])[f.c]:t[Ct(f)];b&&(g<0&&(g=y),v=y)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,v))}var _=n.l;return n.l=d,n.write_shift(4,c),n.l=_,n.length>n.l?n.slice(0,n.l):n}function V4(r,e,t,n){var i=H4(n,t,e);(i.length>17||(e["!rows"]||[])[n])&&Te(r,0,i)}var G4=ia,K4=ho;function q4(){}function X4(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=sE(r),t}function Y4(r,e,t){t==null&&(t=_e(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return ju({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),hv(r,t),t.slice(0,t.l)}function J4(r){var e=Dn(r);return[e]}function Q4(r,e,t){return t==null&&(t=_e(8)),ta(e,t)}function Z4(r){var e=ra(r);return[e]}function eA(r,e,t){return t==null&&(t=_e(4)),na(e,t)}function tA(r){var e=Dn(r),t=r.read_shift(1);return[e,t,"b"]}function rA(r,e,t){return t==null&&(t=_e(9)),ta(e,t),t.write_shift(1,r.v?1:0),t}function nA(r){var e=ra(r),t=r.read_shift(1);return[e,t,"b"]}function iA(r,e,t){return t==null&&(t=_e(5)),na(e,t),t.write_shift(1,r.v?1:0),t}function sA(r){var e=Dn(r),t=r.read_shift(1);return[e,t,"e"]}function aA(r,e,t){return t==null&&(t=_e(9)),ta(e,t),t.write_shift(1,r.v),t}function oA(r){var e=ra(r),t=r.read_shift(1);return[e,t,"e"]}function lA(r,e,t){return t==null&&(t=_e(8)),na(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function cA(r){var e=Dn(r),t=r.read_shift(4);return[e,t,"s"]}function uA(r,e,t){return t==null&&(t=_e(12)),ta(e,t),t.write_shift(4,e.v),t}function dA(r){var e=ra(r),t=r.read_shift(4);return[e,t,"s"]}function fA(r,e,t){return t==null&&(t=_e(8)),na(e,t),t.write_shift(4,e.v),t}function hA(r){var e=Dn(r),t=po(r);return[e,t,"n"]}function pA(r,e,t){return t==null&&(t=_e(16)),ta(e,t),Ys(r.v,t),t}function mA(r){var e=ra(r),t=po(r);return[e,t,"n"]}function gA(r,e,t){return t==null&&(t=_e(12)),na(e,t),Ys(r.v,t),t}function xA(r){var e=Dn(r),t=pv(r);return[e,t,"n"]}function vA(r,e,t){return t==null&&(t=_e(12)),ta(e,t),mv(r.v,t),t}function yA(r){var e=ra(r),t=pv(r);return[e,t,"n"]}function _A(r,e,t){return t==null&&(t=_e(8)),na(e,t),mv(r.v,t),t}function wA(r){var e=Dn(r),t=Zh(r);return[e,t,"is"]}function bA(r){var e=Dn(r),t=Ir(r);return[e,t,"str"]}function SA(r,e,t){return t==null&&(t=_e(12+4*r.v.length)),ta(e,t),yr(r.v,t),t.length>t.l?t.slice(0,t.l):t}function EA(r){var e=ra(r),t=Ir(r);return[e,t,"str"]}function kA(r,e,t){return t==null&&(t=_e(8+4*r.v.length)),na(e,t),yr(r.v,t),t.length>t.l?t.slice(0,t.l):t}function TA(r,e,t){var n=r.l+e,i=Dn(r);i.r=t["!row"];var a=r.read_shift(1),o=[i,a,"b"];if(t.cellFormula){r.l+=2;var c=td(r,n-r.l,t);o[3]=oo(c,null,i,t.supbooks,t)}else r.l=n;return o}function AA(r,e,t){var n=r.l+e,i=Dn(r);i.r=t["!row"];var a=r.read_shift(1),o=[i,a,"e"];if(t.cellFormula){r.l+=2;var c=td(r,n-r.l,t);o[3]=oo(c,null,i,t.supbooks,t)}else r.l=n;return o}function CA(r,e,t){var n=r.l+e,i=Dn(r);i.r=t["!row"];var a=po(r),o=[i,a,"n"];if(t.cellFormula){r.l+=2;var c=td(r,n-r.l,t);o[3]=oo(c,null,i,t.supbooks,t)}else r.l=n;return o}function NA(r,e,t){var n=r.l+e,i=Dn(r);i.r=t["!row"];var a=Ir(r),o=[i,a,"str"];if(t.cellFormula){r.l+=2;var c=td(r,n-r.l,t);o[3]=oo(c,null,i,t.supbooks,t)}else r.l=n;return o}var FA=ia,jA=ho;function DA(r,e){return e==null&&(e=_e(4)),e.write_shift(4,r),e}function OA(r,e){var t=r.l+e,n=ia(r),i=e0(r),a=Ir(r),o=Ir(r),c=Ir(r);r.l=t;var d={rfx:n,relId:i,loc:a,display:c};return o&&(d.Tooltip=o),d}function PA(r,e){var t=_e(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));ho({s:vr(r[0]),e:vr(r[0])},t),t0("rId"+e,t);var n=r[1].Target.indexOf("#"),i=n==-1?"":r[1].Target.slice(n+1);return yr(i||"",t),yr(r[1].Tooltip||"",t),yr("",t),t.slice(0,t.l)}function RA(){}function IA(r,e,t){var n=r.l+e,i=gv(r),a=r.read_shift(1),o=[i];if(o[2]=a,t.cellFormula){var c=E4(r,n-r.l,t);o[1]=c}else r.l=n;return o}function LA(r,e,t){var n=r.l+e,i=ia(r),a=[i];if(t.cellFormula){var o=T4(r,n-r.l,t);a[1]=o,r.l=n}else r.l=n;return a}function MA(r,e,t){t==null&&(t=_e(18));var n=rd(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var Zv=["left","right","top","bottom","header","footer"];function BA(r){var e={};return Zv.forEach(function(t){e[t]=po(r)}),e}function UA(r,e){return e==null&&(e=_e(48)),Jv(r),Zv.forEach(function(t){Ys(r[t],e)}),e}function zA(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function $A(r,e,t){t==null&&(t=_e(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function WA(r){var e=_e(24);return e.write_shift(4,4),e.write_shift(4,1),ho(r,e),e}function HA(r,e){return e==null&&(e=_e(66)),e.write_shift(2,r.password?Pv(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function VA(){}function GA(){}function KA(r,e,t,n,i,a,o){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=rn(e),e.z=e.z||Kt[14],e.v=tn(Hr(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var d={r:t,c:n};switch(d.s=Ss(i.cellXfs,e,i),e.l&&a["!links"].push([Ct(d),e.l]),e.c&&a["!comments"].push([Ct(d),e.c]),e.t){case"s":case"str":return i.bookSST?(c=o0(i.Strings,e.v,i.revStrings),d.t="s",d.v=c,o?Te(r,18,fA(e,d)):Te(r,7,uA(e,d))):(d.t="str",o?Te(r,17,kA(e,d)):Te(r,6,SA(e,d))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Te(r,13,_A(e,d)):Te(r,2,vA(e,d)):o?Te(r,16,gA(e,d)):Te(r,5,pA(e,d)),!0;case"b":return d.t="b",o?Te(r,15,iA(e,d)):Te(r,4,rA(e,d)),!0;case"e":return d.t="e",o?Te(r,14,lA(e,d)):Te(r,3,aA(e,d)),!0}return o?Te(r,12,eA(e,d)):Te(r,1,Q4(e,d)),!0}function qA(r,e,t,n){var i=Mt(e["!ref"]||"A1"),a,o="",c=[];Te(r,145);var d=Array.isArray(e),f=i.e.r;e["!rows"]&&(f=Math.max(i.e.r,e["!rows"].length-1));for(var p=i.s.r;p<=f;++p){o=Ar(p),V4(r,e,i,p);var g=!1;if(p<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){p===i.s.r&&(c[v]=Rr(v)),a=c[v]+o;var y=d?(e[p]||[])[v]:e[a];if(!y){g=!1;continue}g=KA(r,y,p,v,n,e,g)}}Te(r,146)}function XA(r,e){!e||!e["!merges"]||(Te(r,177,DA(e["!merges"].length)),e["!merges"].forEach(function(t){Te(r,176,jA(t))}),Te(r,178))}function YA(r,e){!e||!e["!cols"]||(Te(r,390),e["!cols"].forEach(function(t,n){t&&Te(r,60,MA(n,t))}),Te(r,391))}function JA(r,e){!e||!e["!ref"]||(Te(r,648),Te(r,649,WA(Mt(e["!ref"]))),Te(r,650))}function QA(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var i=Et(t,-1,n[1].Target.replace(/#.*$/,""),vt.HLINK);Te(r,494,PA(n,i))}}),delete e["!links"]}function ZA(r,e,t,n){if(e["!comments"].length>0){var i=Et(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",vt.VML);Te(r,551,t0("rId"+i)),e["!legacy"]=i}}function eC(r,e,t,n){if(e["!autofilter"]){var i=e["!autofilter"],a=typeof i.ref=="string"?i.ref:rr(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,c=gn(a);c.s.r==c.e.r&&(c.e.r=gn(e["!ref"]).e.r,a=rr(c));for(var d=0;d<o.length;++d){var f=o[d];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+a;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),Te(r,161,ho(Mt(a))),Te(r,162)}}function tC(r,e,t){Te(r,133),Te(r,137,$A(e,t)),Te(r,138),Te(r,134)}function rC(r,e){e["!protect"]&&Te(r,535,HA(e["!protect"]))}function nC(r,e,t,n){var i=en(),a=t.SheetNames[r],o=t.Sheets[a]||{},c=a;try{t&&t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}var d=Mt(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Te(i,129),(t.vbaraw||o["!outline"])&&Te(i,147,Y4(c,o["!outline"])),Te(i,148,K4(d)),tC(i,o,t.Workbook),YA(i,o),qA(i,o,r,e),rC(i,o),eC(i,o,t,r),XA(i,o),QA(i,o,n),o["!margins"]&&Te(i,476,UA(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&JA(i,o),ZA(i,o,r,n),Te(i,130),i.end()}function iC(r,e){r.l+=10;var t=Ir(r);return{name:t}}var sC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function aC(r){return!r.Workbook||!r.Workbook.WBProps?"false":LS(r.Workbook.WBProps.date1904)?"true":"false"}var oC="][*?/\\".split("");function ey(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return oC.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function lC(r,e,t){r.forEach(function(n,i){ey(n);for(var a=0;a<i;++a)if(n==r[a])throw new Error("Duplicate Sheet Name: "+n);if(t){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function cC(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];lC(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)j4(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}function ty(r){var e=[nr];e[e.length]=ze("workbook",null,{xmlns:uo[0],"xmlns:r":xr.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(sC.forEach(function(c){r.Workbook.WBProps[c[0]]!=null&&r.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=r.Workbook.WBProps[c[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ze("workbookPr",null,n);var i=r.Workbook&&r.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=r.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==r.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=r.SheetNames.length;++a){var o={name:At(r.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=ze("sheet",null,o)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(c){var d={name:c.Name};c.Comment&&(d.comment=c.Comment),c.Sheet!=null&&(d.localSheetId=""+c.Sheet),c.Hidden&&(d.hidden="1"),c.Ref&&(e[e.length]=ze("definedName",At(c.Ref),d))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function uC(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=Ah(r),t.name=Ir(r),t}function dC(r,e){return e||(e=_e(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),t0(r.strRelID,e),yr(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function fC(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var i=e>8?Ir(r):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function hC(r,e){e||(e=_e(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),hv(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function pC(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var i=r.read_shift(4),a=aE(r),o=k4(r,0,t),c=e0(r);r.l=n;var d={Name:a,Ptg:o};return i<268435455&&(d.Sheet=i),c&&(d.Comment=c),d}function mC(r,e){Te(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Te(r,156,dC(i))}Te(r,144)}function gC(r,e){e||(e=_e(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return yr("SheetJS",e),yr(Su.version,e),yr(Su.version,e),yr("7262",e),e.length>e.l?e.slice(0,e.l):e}function xC(r,e){e||(e=_e(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function vC(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,i=-1,a=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&i==-1?i=n:t[n].Hidden==1&&a==-1&&(a=n);a>i||(Te(r,135),Te(r,158,xC(i)),Te(r,136))}}function yC(r,e){var t=en();return Te(t,131),Te(t,128,gC()),Te(t,153,hC(r.Workbook&&r.Workbook.WBProps||null)),vC(t,r),mC(t,r),Te(t,132),t.end()}function _C(r,e,t){return(e.slice(-4)===".bin"?yC:ty)(r)}function wC(r,e,t,n,i){return(e.slice(-4)===".bin"?nC:Qv)(r,t,n,i)}function bC(r,e,t){return(e.slice(-4)===".bin"?Uk:Lv)(r,t)}function SC(r,e,t){return(e.slice(-4)===".bin"?hk:Ov)(r,t)}function EC(r,e,t){return(e.slice(-4)===".bin"?rT:$v)(r)}function kC(r){return(r.slice(-4)===".bin"?qk:Uv)()}function TC(r,e){var t=[];return r.Props&&t.push(bE(r.Props,e)),r.Custprops&&t.push(SE(r.Props,r.Custprops)),t.join("")}function AC(){return""}function CC(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var a=[];a.push(ze("NumberFormat",null,{"ss:Format":At(Kt[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};t.push(ze("Style",a.join(""),o))}),ze("Styles",t.join(""))}function ry(r){return ze("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+s0(r.Ref,{r:0,c:0})})}function NC(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(ry(i)))}return ze("Names",t.join(""))}function FC(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],o=0;o<i.length;++o){var c=i[o];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||a.push(ry(c)))}return a.join("")}function jC(r,e,t,n){if(!r)return"";var i=[];if(r["!margins"]&&(i.push("<PageSetup>"),r["!margins"].header&&i.push(ze("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&i.push(ze("Footer",null,{"x:Margin":r["!margins"].footer})),i.push(ze("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(ze("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<t&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),r["!protect"]&&(i.push(kr("ProtectContents","True")),r["!protect"].objects&&i.push(kr("ProtectObjects","True")),r["!protect"].scenarios&&i.push(kr("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?i.push(kr("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&i.push(kr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){r["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ze("WorksheetOptions",i.join(""),{xmlns:hn.x})}function DC(r){return r.map(function(e){var t=IS(e.t||""),n=ze("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return ze("Comment",n,{"ss:Author":e.a})}).join("")}function OC(r,e,t,n,i,a,o){if(!r||r.v==null&&r.f==null)return"";var c={};if(r.f&&(c["ss:Formula"]="="+At(s0(r.f,o))),r.F&&r.F.slice(0,e.length)==e){var d=vr(r.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(r.l&&r.l.Target&&(c["ss:HRef"]=At(r.l.Target),r.l.Tooltip&&(c["x:HRefScreenTip"]=At(r.l.Tooltip))),t["!merges"])for(var f=t["!merges"],p=0;p!=f.length;++p)f[p].s.c!=o.c||f[p].s.r!=o.r||(f[p].e.c>f[p].s.c&&(c["ss:MergeAcross"]=f[p].e.c-f[p].s.c),f[p].e.r>f[p].s.r&&(c["ss:MergeDown"]=f[p].e.r-f[p].s.r));var g="",v="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",v=String(r.v);break;case"b":g="Boolean",v=r.v?"1":"0";break;case"e":g="Error",v=zl[r.v];break;case"d":g="DateTime",v=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||Kt[14]);break;case"s":g="String",v=RS(r.v||"");break}var y=Ss(n.cellXfs,r,n);c["ss:StyleID"]="s"+(21+y),c["ss:Index"]=o.c+1;var b=r.v!=null?v:"",_=r.t=="z"?"":'<Data ss:Type="'+g+'">'+b+"</Data>";return(r.c||[]).length>0&&(_+=DC(r.c)),ze("Cell",_,c)}function PC(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Iv(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function RC(r,e,t,n){if(!r["!ref"])return"";var i=Mt(r["!ref"]),a=r["!merges"]||[],o=0,c=[];r["!cols"]&&r["!cols"].forEach(function(S,A){n0(S);var C=!!S.width,T=rd(A,S),P={"ss:Index":A+1};C&&(P["ss:Width"]=Ou(T.width)),S.hidden&&(P["ss:Hidden"]="1"),c.push(ze("Column",null,P))});for(var d=Array.isArray(r),f=i.s.r;f<=i.e.r;++f){for(var p=[PC(f,(r["!rows"]||[])[f])],g=i.s.c;g<=i.e.c;++g){var v=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>g)&&!(a[o].s.r>f)&&!(a[o].e.c<g)&&!(a[o].e.r<f)){(a[o].s.c!=g||a[o].s.r!=f)&&(v=!0);break}if(!v){var y={r:f,c:g},b=Ct(y),_=d?(r[f]||[])[g]:r[b];p.push(OC(_,b,r,e,t,n,y))}}p.push("</Row>"),p.length>2&&c.push(p.join(""))}return c.join("")}function IC(r,e,t){var n=[],i=t.SheetNames[r],a=t.Sheets[i],o=a?FC(a,e,r,t):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?RC(a,e,r,t):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(jC(a,e,r,t)),n.join("")}function LC(r,e){e||(e={}),r.SSF||(r.SSF=rn(Kt)),r.SSF&&(Ju(),Yu(r.SSF),e.revssf=Qu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],Ss(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(TC(r,e)),t.push(AC()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(ze("Worksheet",IC(n,e,r),{"ss:Name":At(r.SheetNames[n])}));return t[2]=CC(r,e),t[3]=NC(r),nr+ze("Workbook",t.join(""),{xmlns:hn.ss,"xmlns:o":hn.o,"xmlns:x":hn.x,"xmlns:ss":hn.ss,"xmlns:dt":hn.dt,"xmlns:html":hn.html})}var rh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function MC(r,e){var t=[],n=[],i=[],a=0,o,c=Fg(Wg,"n"),d=Fg(Hg,"n");if(r.Props)for(o=Cr(r.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(c,o[a])?t:Object.prototype.hasOwnProperty.call(d,o[a])?n:i).push([o[a],r.Props[o[a]]]);if(r.Custprops)for(o=Cr(r.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(r.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(c,o[a])?t:Object.prototype.hasOwnProperty.call(d,o[a])?n:i).push([o[a],r.Custprops[o[a]]]);var f=[];for(a=0;a<i.length;++a)Tv.indexOf(i[a][0])>-1||Sv.indexOf(i[a][0])>-1||i[a][1]!=null&&f.push(i[a]);n.length&&Ft.utils.cfb_add(e,"/SummaryInformation",Xg(n,rh.SI,d,Hg)),(t.length||f.length)&&Ft.utils.cfb_add(e,"/DocumentSummaryInformation",Xg(t,rh.DSI,c,Wg,f.length?f:null,rh.UDI))}function BC(r,e){var t=e||{},n=Ft.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Ft.utils.cfb_add(n,i,ny(r,t)),t.biff==8&&(r.Props||r.Custprops)&&MC(r,n),t.biff==8&&r.vbaraw&&nT(n,Ft.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var UC={0:{f:W4},1:{f:J4},2:{f:xA},3:{f:sA},4:{f:tA},5:{f:hA},6:{f:bA},7:{f:cA},8:{f:NA},9:{f:CA},10:{f:TA},11:{f:AA},12:{f:Z4},13:{f:yA},14:{f:oA},15:{f:nA},16:{f:mA},17:{f:EA},18:{f:dA},19:{f:Zh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pC},40:{},42:{},43:{f:bk},44:{f:_k},45:{f:kk},46:{f:Ak},47:{f:Tk},48:{},49:{f:ZS},50:{},51:{f:Wk},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ek},62:{f:wA},63:{f:Xk},64:{f:VA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:X4},148:{f:G4,p:16},151:{f:RA},152:{},153:{f:fC},154:{},155:{},156:{f:uC},157:{},158:{},159:{T:1,f:uk},160:{T:-1},161:{T:1,f:ia},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:FA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:zk},336:{T:-1},337:{f:Gk,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ah},357:{},358:{},359:{},360:{T:1},361:{},362:{f:qE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:IA},427:{f:LA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:BA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:q4},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:OA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ah},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:eT},633:{T:1},634:{T:-1},635:{T:1,f:Qk},636:{T:-1},637:{f:nE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:GA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function $e(r,e,t,n){var i=e;if(!isNaN(i)){var a=n||(t||[]).length||0,o=r.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Yh(t)&&r.push(t)}}function zC(r,e,t,n){var i=(t||[]).length||0;if(i<=8224)return $e(r,e,t,i);var a=e;if(!isNaN(a)){for(var o=t.parts||[],c=0,d=0,f=0;f+(o[c]||8224)<=8224;)f+=o[c]||8224,c++;var p=r.next(4);for(p.write_shift(2,a),p.write_shift(2,f),r.push(t.slice(d,d+f)),d+=f;d<i;){for(p=r.next(4),p.write_shift(2,60),f=0;f+(o[c]||8224)<=8224;)f+=o[c]||8224,c++;p.write_shift(2,f),r.push(t.slice(d,d+f)),d+=f}}}function Wl(r,e,t){return r||(r=_e(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function $C(r,e,t,n){var i=_e(9);return Wl(i,r,e),Cv(t,n||"b",i),i}function WC(r,e,t){var n=_e(8+2*t.length);return Wl(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function HC(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?tn(Hr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?$e(r,2,ik(t,n,i)):$e(r,3,nk(t,n,i));return;case"b":case"e":$e(r,5,$C(t,n,e.v,e.t));return;case"s":case"str":$e(r,4,WC(t,n,(e.v||"").slice(0,255)));return}$e(r,1,Wl(null,t,n))}function VC(r,e,t,n){var i=Array.isArray(e),a=Mt(e["!ref"]||"A1"),o,c="",d=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=rr(a)}for(var f=a.s.r;f<=a.e.r;++f){c=Ar(f);for(var p=a.s.c;p<=a.e.c;++p){f===a.s.r&&(d[p]=Rr(p)),o=d[p]+c;var g=i?(e[f]||[])[p]:e[o];g&&HC(r,g,f,p)}}}function GC(r,e){for(var t=e||{},n=en(),i=0,a=0;a<r.SheetNames.length;++a)r.SheetNames[a]==t.sheet&&(i=a);if(i==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return $e(n,t.biff==4?1033:t.biff==3?521:9,r0(r,16,t)),VC(n,r.Sheets[r.SheetNames[i]],i,t),$e(n,10),n.end()}function KC(r,e,t){$e(r,49,UE({sz:12,name:"Arial"},t))}function qC(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&$e(r,1054,WE(i,e[i],t))})}function XC(r,e){var t=_e(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),$e(r,2151,t),t=_e(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),jv(Mt(e["!ref"]||"A1"),t),t.write_shift(4,4),$e(r,2152,t)}function YC(r,e){for(var t=0;t<16;++t)$e(r,224,Jg({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){$e(r,224,Jg(n,0,e))})}function JC(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];$e(r,440,JE(n)),n[1].Tooltip&&$e(r,2048,QE(n))}delete e["!links"]}function QC(r,e){if(e){var t=0;e.forEach(function(n,i){++t<=256&&n&&$e(r,125,tk(rd(i,n),i))})}}function ZC(r,e,t,n,i){var a=16+Ss(i.cellXfs,e,i);if(e.v==null&&!e.bf){$e(r,513,Js(t,n,a));return}if(e.bf)$e(r,6,S4(e,t,n,i,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?tn(Hr(e.v)):e.v;$e(r,515,KE(t,n,o,a));break;case"b":case"e":$e(r,517,GE(t,n,e.v,a,i,e.t));break;case"s":case"str":if(i.bookSST){var c=o0(i.Strings,e.v,i.revStrings);$e(r,253,zE(t,n,c,a))}else $e(r,516,$E(t,n,(e.v||"").slice(0,255),a,i));break;default:$e(r,513,Js(t,n,a))}}function eN(r,e,t){var n=en(),i=t.SheetNames[r],a=t.Sheets[i]||{},o=(t||{}).Workbook||{},c=(o.Sheets||[])[r]||{},d=Array.isArray(a),f=e.biff==8,p,g="",v=[],y=Mt(a["!ref"]||"A1"),b=f?65536:16384;if(y.e.c>255||y.e.r>=b){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,b-1)}$e(n,2057,r0(t,16,e)),$e(n,13,Fn(1)),$e(n,12,Fn(100)),$e(n,15,Wr(!0)),$e(n,17,Wr(!1)),$e(n,16,Ys(.001)),$e(n,95,Wr(!0)),$e(n,42,Wr(!1)),$e(n,43,Wr(!1)),$e(n,130,Fn(1)),$e(n,128,VE()),$e(n,131,Wr(!1)),$e(n,132,Wr(!1)),f&&QC(n,a["!cols"]),$e(n,512,HE(y,e)),f&&(a["!links"]=[]);for(var _=y.s.r;_<=y.e.r;++_){g=Ar(_);for(var S=y.s.c;S<=y.e.c;++S){_===y.s.r&&(v[S]=Rr(S)),p=v[S]+g;var A=d?(a[_]||[])[S]:a[p];A&&(ZC(n,A,_,S,e),f&&A.l&&a["!links"].push([p,A.l]))}}var C=c.CodeName||c.name||i;return f&&$e(n,574,BE((o.Views||[])[0])),f&&(a["!merges"]||[]).length&&$e(n,229,YE(a["!merges"])),f&&JC(n,a),$e(n,442,Fv(C)),f&&XC(n,a),$e(n,10),n.end()}function tN(r,e,t){var n=en(),i=(r||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},c=t.biff==8,d=t.biff==5;if($e(n,2057,r0(r,5,t)),t.bookType=="xla"&&$e(n,135),$e(n,225,c?Fn(1200):null),$e(n,193,TE(2)),d&&$e(n,191),d&&$e(n,192),$e(n,226),$e(n,92,RE("SheetJS",t)),$e(n,66,Fn(c?1200:1252)),c&&$e(n,353,Fn(0)),c&&$e(n,448),$e(n,317,rk(r.SheetNames.length)),c&&r.vbaraw&&$e(n,211),c&&r.vbaraw){var f=o.CodeName||"ThisWorkbook";$e(n,442,Fv(f))}$e(n,156,Fn(17)),$e(n,25,Wr(!1)),$e(n,18,Wr(!1)),$e(n,19,Fn(0)),c&&$e(n,431,Wr(!1)),c&&$e(n,444,Fn(0)),$e(n,61,ME()),$e(n,64,Wr(!1)),$e(n,141,Fn(0)),$e(n,34,Wr(aC(r)=="true")),$e(n,14,Wr(!0)),c&&$e(n,439,Wr(!1)),$e(n,218,Fn(0)),KC(n,r,t),qC(n,r.SSF,t),YC(n,t),c&&$e(n,352,Wr(!1));var p=n.end(),g=en();c&&$e(g,140,ZE()),c&&t.Strings&&zC(g,252,LE(t.Strings)),$e(g,10);var v=g.end(),y=en(),b=0,_=0;for(_=0;_<r.SheetNames.length;++_)b+=(c?12:11)+(c?2:1)*r.SheetNames[_].length;var S=p.length+b+v.length;for(_=0;_<r.SheetNames.length;++_){var A=a[_]||{};$e(y,133,IE({pos:S,hs:A.Hidden||0,dt:0,name:r.SheetNames[_]},t)),S+=e[_].length}var C=y.end();if(b!=C.length)throw new Error("BS8 "+b+" != "+C.length);var T=[];return p.length&&T.push(p),C.length&&T.push(C),v.length&&T.push(v),Er(T)}function rN(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=rn(Kt)),r&&r.SSF&&(Ju(),Yu(r.SSF),t.revssf=Qu(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,l0(t),t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var i=0;i<r.SheetNames.length;++i)n[n.length]=eN(i,t,r);return n.unshift(tN(r,n,t)),Er(n)}function ny(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var i=gn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return rN(r,e);case 4:case 3:case 2:return GC(r,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function nN(r,e,t,n){for(var i=r["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,d=0,f=0;f<i.length;++f)if(!(i[f].s.r>t||i[f].s.c>o)&&!(i[f].e.r<t||i[f].e.c<o)){if(i[f].s.r<t||i[f].s.c<o){c=-1;break}c=i[f].e.r-i[f].s.r+1,d=i[f].e.c-i[f].s.c+1;break}if(!(c<0)){var p=Ct({r:t,c:o}),g=n.dense?(r[t]||[])[o]:r[p],v=g&&g.v!=null&&(g.h||PS(g.w||(Ii(g),g.w)||""))||"",y={};c>1&&(y.rowspan=c),d>1&&(y.colspan=d),n.editable?v='<span contenteditable="true">'+v+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+g.l.Target+'">'+v+"</a>")),y.id=(n.id||"sjs")+"-"+p,a.push(ze("td",v,y))}}var b="<tr>";return b+a.join("")+"</tr>"}var iN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',sN="</body></html>";function aN(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function iy(r,e){var t=e||{},n=t.header!=null?t.header:iN,i=t.footer!=null?t.footer:sN,a=[n],o=gn(r["!ref"]);t.dense=Array.isArray(r),a.push(aN(r,o,t));for(var c=o.s.r;c<=o.e.r;++c)a.push(nN(r,o,c,t));return a.push("</table>"+i),a.join("")}function sy(r,e,t){var n=t||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?vr(n.origin):n.origin;i=o.r,a=o.c}var c=e.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:i,c:a}};if(r["!ref"]){var p=gn(r["!ref"]);f.s.r=Math.min(f.s.r,p.s.r),f.s.c=Math.min(f.s.c,p.s.c),f.e.r=Math.max(f.e.r,p.e.r),f.e.c=Math.max(f.e.c,p.e.c),i==-1&&(f.e.r=i=p.e.r+1)}var g=[],v=0,y=r["!rows"]||(r["!rows"]=[]),b=0,_=0,S=0,A=0,C=0,T=0;for(r["!cols"]||(r["!cols"]=[]);b<c.length&&_<d;++b){var P=c[b];if(ix(P)){if(n.display)continue;y[_]={hidden:!0}}var z=P.children;for(S=A=0;S<z.length;++S){var G=z[S];if(!(n.display&&ix(G))){var L=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):MS(G.innerHTML),V=G.getAttribute("data-z")||G.getAttribute("z");for(v=0;v<g.length;++v){var q=g[v];q.s.c==A+a&&q.s.r<_+i&&_+i<=q.e.r&&(A=q.e.c+1-a,v=-1)}T=+G.getAttribute("colspan")||1,((C=+G.getAttribute("rowspan")||1)>1||T>1)&&g.push({s:{r:_+i,c:A+a},e:{r:_+i+(C||1)-1,c:A+a+(T||1)-1}});var O={t:"s",v:L},ee=G.getAttribute("data-t")||G.getAttribute("t")||"";L!=null&&(L.length==0?O.t=ee||"z":n.raw||L.trim().length==0||ee=="s"||(L==="TRUE"?O={t:"b",v:!0}:L==="FALSE"?O={t:"b",v:!1}:isNaN(Oi(L))?isNaN(Al(L).getDate())||(O={t:"d",v:Hr(L)},n.cellDates||(O={t:"n",v:tn(O.v)}),O.z=n.dateNF||Kt[14]):O={t:"n",v:Oi(L)})),O.z===void 0&&V!=null&&(O.z=V);var D="",te=G.getElementsByTagName("A");if(te&&te.length)for(var ve=0;ve<te.length&&!(te[ve].hasAttribute("href")&&(D=te[ve].getAttribute("href"),D.charAt(0)!="#"));++ve);D&&D.charAt(0)!="#"&&(O.l={Target:D}),n.dense?(r[_+i]||(r[_+i]=[]),r[_+i][A+a]=O):r[Ct({c:A+a,r:_+i})]=O,f.e.c<A+a&&(f.e.c=A+a),A+=T}}++_}return g.length&&(r["!merges"]=(r["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,_-1+i),r["!ref"]=rr(f),_>=d&&(r["!fullref"]=rr((f.e.r=c.length-b+_-1+i,f))),r}function ay(r,e){var t=e||{},n=t.dense?[]:{};return sy(n,r,e)}function oN(r,e){return ea(ay(r,e),e)}function ix(r){var e="",t=lN(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function lN(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var cN=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Nl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return nr+e}})(),sx=(function(){var r=function(a){return At(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(a,o,c){var d=[];d.push('      <table:table table:name="'+At(o.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,p=0,g=gn(a["!ref"]||"A1"),v=a["!merges"]||[],y=0,b=Array.isArray(a);if(a["!cols"])for(p=0;p<=g.e.c;++p)d.push("        <table:table-column"+(a["!cols"][p]?' table:style-name="co'+a["!cols"][p].ods+'"':"")+`></table:table-column>
`);var _="",S=a["!rows"]||[];for(f=0;f<g.s.r;++f)_=S[f]?' table:style-name="ro'+S[f].ods+'"':"",d.push("        <table:table-row"+_+`></table:table-row>
`);for(;f<=g.e.r;++f){for(_=S[f]?' table:style-name="ro'+S[f].ods+'"':"",d.push("        <table:table-row"+_+`>
`),p=0;p<g.s.c;++p)d.push(e);for(;p<=g.e.c;++p){var A=!1,C={},T="";for(y=0;y!=v.length;++y)if(!(v[y].s.c>p)&&!(v[y].s.r>f)&&!(v[y].e.c<p)&&!(v[y].e.r<f)){(v[y].s.c!=p||v[y].s.r!=f)&&(A=!0),C["table:number-columns-spanned"]=v[y].e.c-v[y].s.c+1,C["table:number-rows-spanned"]=v[y].e.r-v[y].s.r+1;break}if(A){d.push(t);continue}var P=Ct({r:f,c:p}),z=b?(a[f]||[])[p]:a[P];if(z&&z.f&&(C["table:formula"]=At(N4(z.f)),z.F&&z.F.slice(0,P.length)==P)){var G=gn(z.F);C["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,C["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!z){d.push(e);continue}switch(z.t){case"b":T=z.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=z.v?"true":"false";break;case"n":T=z.w||String(z.v||0),C["office:value-type"]="float",C["office:value"]=z.v||0;break;case"s":case"str":T=z.v==null?"":z.v,C["office:value-type"]="string";break;case"d":T=z.w||Hr(z.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Hr(z.v).toISOString(),C["table:style-name"]="ce1";break;default:d.push(e);continue}var L=r(T);if(z.l&&z.l.Target){var V=z.l.Target;V=V.charAt(0)=="#"?"#"+F4(V.slice(1)):V,V.charAt(0)!="#"&&!V.match(/^\w+:/)&&(V="../"+V),L=ze("text:a",L,{"xlink:href":V.replace(/&/g,"&amp;")})}d.push("          "+ze("table:table-cell",ze("text:p",L,{}),C)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},i=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var p=0;p<f["!cols"].length;++p)if(f["!cols"][p]){var g=f["!cols"][p];if(g.width==null&&g.wpx==null&&g.wch==null)continue;n0(g),g.ods=c;var v=f["!cols"][p].wpx+"px";a.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),a.push(`  </style:style>
`),++c}}});var d=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var p=0;p<f["!rows"].length;++p)if(f["!rows"][p]){f["!rows"][p].ods=d;var g=f["!rows"][p].hpx+"px";a.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),a.push(`  </style:style>
`),++d}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,c){var d=[nr],f=Nl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Nl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(d.push("<office:document"+f+p+`>
`),d.push(wv().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+f+`>
`),i(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)d.push(n(o.Sheets[o.SheetNames[g]],o,g));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),c.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function oy(r,e){if(e.bookType=="fods")return sx(r,e);var t=Gh(),n="",i=[],a=[];return n="mimetype",ct(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ct(t,n,sx(r,e)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",ct(t,n,cN(r,e)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",ct(t,n,nr+wv()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",ct(t,n,wE(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ct(t,n,yE(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Iu(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function uN(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Yn(Cl(r))}function dN(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function _s(r){var e=r.reduce(function(i,a){return i+a.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}function fN(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)r[e+a]=i&255;r[e+15]|=t>=0?0:128}function Fl(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function St(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function io(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function cr(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],i=Fl(r,t),a=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(a){case 0:{for(var d=t[0];r[t[0]++]>=128;);c=r.slice(d,t[0])}break;case 5:o=4,c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Fl(r,t),c=r.slice(t[0],t[0]+o),t[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var f={data:c,type:a};e[i]==null?e[i]=[f]:e[i].push(f)}return e}function br(r){var e=[];return r.forEach(function(t,n){t.forEach(function(i){i.data&&(e.push(St(n*8+i.type)),i.type==2&&e.push(St(i.data.length)),e.push(i.data))})}),_s(e)}function Gn(r){for(var e,t=[],n=[0];n[0]<r.length;){var i=Fl(r,n),a=cr(r.slice(n[0],n[0]+i));n[0]+=i;var o={id:io(a[1][0].data),messages:[]};a[2].forEach(function(c){var d=cr(c.data),f=io(d[3][0].data);o.messages.push({meta:d,data:r.slice(n[0],n[0]+f)}),n[0]+=f}),(e=a[3])!=null&&e[0]&&(o.merge=io(a[3][0].data)>>>0>0),t.push(o)}return t}function Ka(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:St(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:St(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:St(o.data.length)}],n[2].push({data:br(o.meta),type:2})});var a=br(n);e.push(St(a.length)),e.push(a),i.forEach(function(o){return e.push(o)})}),_s(e)}function hN(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=Fl(e,t),i=[];t[0]<e.length;){var a=e[t[0]]&3;if(a==0){var o=e[t[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[t[0]],c>1&&(o|=e[t[0]+1]<<8),c>2&&(o|=e[t[0]+2]<<16),c>3&&(o|=e[t[0]+3]<<24),o>>>=0,o++,t[0]+=c}i.push(e.slice(t[0],t[0]+o)),t[0]+=o;continue}else{var d=0,f=0;if(a==1?(f=(e[t[0]]>>2&7)+4,d=(e[t[0]++]&224)<<3,d|=e[t[0]++]):(f=(e[t[0]++]>>2)+1,a==2?(d=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(d=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[_s(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(i.push(i[0].slice(-d)),f-=d;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-d,-d+f))}}var p=_s(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Kn(r){for(var e=[],t=0;t<r.length;){var n=r[t++],i=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(hN(n,r.slice(t,t+i))),t+=i}if(t!==r.length)throw new Error("data is not a valid framed stream!");return _s(e)}function qa(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),i=new Uint8Array(4);e.push(i);var a=St(n),o=a.length;e.push(a),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,t+=n}return _s(e)}function nh(r,e){var t=new Uint8Array(32),n=Iu(t),i=12,a=0;switch(t[0]=5,r.t){case"n":t[1]=2,fN(t,i,r.v),a|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,r.v?1:0,!0),a|=2,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(i,e.indexOf(r.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,a,!0),t.slice(0,i)}function ih(r,e){var t=new Uint8Array(32),n=Iu(t),i=12,a=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(i,r.v,!0),a|=32,i+=8;break;case"b":t[2]=6,n.setFloat64(i,r.v?1:0,!0),a|=32,i+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(i,e.indexOf(r.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,a,!0),t.slice(0,i)}function us(r){var e=cr(r);return Fl(e[1][0].data)}function pN(r,e,t){var n,i,a,o;if(!((n=r[6])!=null&&n[0])||!((i=r[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(a=r[8])==null?void 0:a[0])==null?void 0:o.data)&&io(r[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var d=0,f=Iu(r[7][0].data),p=0,g=[],v=Iu(r[4][0].data),y=0,b=[],_=0;_<e.length;++_){if(e[_]==null){f.setUint16(_*2,65535,!0),v.setUint16(_*2,65535);continue}f.setUint16(_*2,p,!0),v.setUint16(_*2,y,!0);var S,A;switch(typeof e[_]){case"string":S=nh({t:"s",v:e[_]},t),A=ih({t:"s",v:e[_]},t);break;case"number":S=nh({t:"n",v:e[_]},t),A=ih({t:"n",v:e[_]},t);break;case"boolean":S=nh({t:"b",v:e[_]},t),A=ih({t:"b",v:e[_]},t);break;default:throw new Error("Unsupported value "+e[_])}g.push(S),p+=S.length,b.push(A),y+=A.length,++d}for(r[2][0].data=St(d);_<r[7][0].data.length/2;++_)f.setUint16(_*2,65535,!0),v.setUint16(_*2,65535,!0);return r[6][0].data=_s(g),r[3][0].data=_s(b),d}function mN(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=gn(t["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(rr(n)));var a=Lu(t,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(X){return X.forEach(function(W){typeof W=="string"&&o.push(W)})});var c={},d=[],f=Ft.read(e.numbers,{type:"base64"});f.FileIndex.map(function(X,W){return[X,f.FullPaths[W]]}).forEach(function(X){var W=X[0],B=X[1];if(W.type==2&&W.name.match(/\.iwa/)){var J=W.content,be=Kn(J),ie=Gn(be);ie.forEach(function(ne){d.push(ne.id),c[ne.id]={deps:[],location:B,type:io(ne.messages[0].meta[1][0].data)}})}}),d.sort(function(X,W){return X-W});var p=d.filter(function(X){return X>1}).map(function(X){return[X,St(X)]});f.FileIndex.map(function(X,W){return[X,f.FullPaths[W]]}).forEach(function(X){var W=X[0];if(X[1],!!W.name.match(/\.iwa/)){var B=Gn(Kn(W.content));B.forEach(function(J){J.messages.forEach(function(be){p.forEach(function(ie){J.messages.some(function(ne){return io(ne.meta[1][0].data)!=11006&&dN(ne.data,ie[1])})&&c[ie[0]].deps.push(J.id)})})})}});for(var g=Ft.find(f,c[1].location),v=Gn(Kn(g.content)),y,b=0;b<v.length;++b){var _=v[b];_.id==1&&(y=_)}var S=us(cr(y.messages[0].data)[1][0].data);for(g=Ft.find(f,c[S].location),v=Gn(Kn(g.content)),b=0;b<v.length;++b)_=v[b],_.id==S&&(y=_);for(S=us(cr(y.messages[0].data)[2][0].data),g=Ft.find(f,c[S].location),v=Gn(Kn(g.content)),b=0;b<v.length;++b)_=v[b],_.id==S&&(y=_);for(S=us(cr(y.messages[0].data)[2][0].data),g=Ft.find(f,c[S].location),v=Gn(Kn(g.content)),b=0;b<v.length;++b)_=v[b],_.id==S&&(y=_);var A=cr(y.messages[0].data);{A[6][0].data=St(n.e.r+1),A[7][0].data=St(n.e.c+1);var C=us(A[46][0].data),T=Ft.find(f,c[C].location),P=Gn(Kn(T.content));{for(var z=0;z<P.length&&P[z].id!=C;++z);if(P[z].id!=C)throw"Bad ColumnRowUIDMapArchive";var G=cr(P[z].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var L=0;L<=n.e.c;++L){var V=[];V[1]=V[2]=[{type:0,data:St(L+420690)}],G[1].push({type:2,data:br(V)}),G[2].push({type:0,data:St(L)}),G[3].push({type:0,data:St(L)})}G[4]=[],G[5]=[],G[6]=[];for(var q=0;q<=n.e.r;++q)V=[],V[1]=V[2]=[{type:0,data:St(q+726270)}],G[4].push({type:2,data:br(V)}),G[5].push({type:0,data:St(q)}),G[6].push({type:0,data:St(q)});P[z].messages[0].data=br(G)}T.content=qa(Ka(P)),T.size=T.content.length,delete A[46];var O=cr(A[4][0].data);{O[7][0].data=St(n.e.r+1);var ee=cr(O[1][0].data),D=us(ee[2][0].data);T=Ft.find(f,c[D].location),P=Gn(Kn(T.content));{if(P[0].id!=D)throw"Bad HeaderStorageBucket";var te=cr(P[0].messages[0].data);for(q=0;q<a.length;++q){var ve=cr(te[2][0].data);ve[1][0].data=St(q),ve[4][0].data=St(a[q].length),te[2][q]={type:te[2][0].type,data:br(ve)}}P[0].messages[0].data=br(te)}T.content=qa(Ka(P)),T.size=T.content.length;var ye=us(O[2][0].data);T=Ft.find(f,c[ye].location),P=Gn(Kn(T.content));{if(P[0].id!=ye)throw"Bad HeaderStorageBucket";for(te=cr(P[0].messages[0].data),L=0;L<=n.e.c;++L)ve=cr(te[2][0].data),ve[1][0].data=St(L),ve[4][0].data=St(n.e.r+1),te[2][L]={type:te[2][0].type,data:br(ve)};P[0].messages[0].data=br(te)}T.content=qa(Ka(P)),T.size=T.content.length;var Oe=us(O[4][0].data);(function(){for(var X=Ft.find(f,c[Oe].location),W=Gn(Kn(X.content)),B,J=0;J<W.length;++J){var be=W[J];be.id==Oe&&(B=be)}var ie=cr(B.messages[0].data);{ie[3]=[];var ne=[];o.forEach(function(pe,Ce){ne[1]=[{type:0,data:St(Ce)}],ne[2]=[{type:0,data:St(1)}],ne[3]=[{type:2,data:uN(pe)}],ie[3].push({type:2,data:br(ne)})})}B.messages[0].data=br(ie);var se=Ka(W),Z=qa(se);X.content=Z,X.size=X.content.length})();var je=cr(O[3][0].data);{var fe=je[1][0];delete je[2];var xe=cr(fe.data);{var me=us(xe[2][0].data);(function(){for(var X=Ft.find(f,c[me].location),W=Gn(Kn(X.content)),B,J=0;J<W.length;++J){var be=W[J];be.id==me&&(B=be)}var ie=cr(B.messages[0].data);{delete ie[6],delete je[7];var ne=new Uint8Array(ie[5][0].data);ie[5]=[];for(var se=0,Z=0;Z<=n.e.r;++Z){var pe=cr(ne);se+=pN(pe,a[Z],o),pe[1][0].data=St(Z),ie[5].push({data:br(pe),type:2})}ie[1]=[{type:0,data:St(n.e.c+1)}],ie[2]=[{type:0,data:St(n.e.r+1)}],ie[3]=[{type:0,data:St(se)}],ie[4]=[{type:0,data:St(n.e.r+1)}]}B.messages[0].data=br(ie);var Ce=Ka(W),Fe=qa(Ce);X.content=Fe,X.size=X.content.length})()}fe.data=br(xe)}O[3][0].data=br(je)}A[4][0].data=br(O)}y.messages[0].data=br(A);var K=Ka(v),N=qa(K);return g.content=N,g.size=g.content.length,f}function gN(r){return function(t){for(var n=0;n!=r.length;++n){var i=r[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function l0(r){gN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function xN(r,e){return e.bookType=="ods"?oy(r,e):e.bookType=="numbers"?mN(r,e):e.bookType=="xlsb"?vN(r,e):yN(r,e)}function vN(r,e){eo=1024,r&&!r.SSF&&(r.SSF=rn(Kt)),r&&r.SSF&&(Ju(),Yu(r.SSF),e.revssf=Qu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,yl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=Wv.indexOf(e.bookType)>-1,i=vv();l0(e=e||{});var a=Gh(),o="",c=0;if(e.cellXfs=[],Ss(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),o="docProps/core.xml",ct(a,o,bv(r.Props,e)),i.coreprops.push(o),Et(e.rels,2,o,vt.CORE_PROPS),o="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var d=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(r.SheetNames[f]);r.Props.SheetNames=d}for(r.Props.Worksheets=r.Props.SheetNames.length,ct(a,o,Ev(r.Props)),i.extprops.push(o),Et(e.rels,3,o,vt.EXT_PROPS),r.Custprops!==r.Props&&Cr(r.Custprops||{}).length>0&&(o="docProps/custom.xml",ct(a,o,kv(r.Custprops)),i.custprops.push(o),Et(e.rels,4,o,vt.CUST_PROPS)),c=1;c<=r.SheetNames.length;++c){var p={"!id":{}},g=r.Sheets[r.SheetNames[c-1]],v=(g||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+c+"."+t,ct(a,o,wC(c-1,o,e,r,p)),i.sheets.push(o),Et(e.wbrels,-1,"worksheets/sheet"+c+"."+t,vt.WS[0])}if(g){var y=g["!comments"],b=!1,_="";y&&y.length>0&&(_="xl/comments"+c+"."+t,ct(a,_,EC(y,_)),i.comments.push(_),Et(p,-1,"../comments"+c+"."+t,vt.CMNT),b=!0),g["!legacy"]&&b&&ct(a,"xl/drawings/vmlDrawing"+c+".vml",zv(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&ct(a,_v(o),ro(p))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,ct(a,o,SC(e.Strings,o,e)),i.strs.push(o),Et(e.wbrels,-1,"sharedStrings."+t,vt.SST)),o="xl/workbook."+t,ct(a,o,_C(r,o)),i.workbooks.push(o),Et(e.rels,1,o,vt.WB),o="xl/theme/theme1.xml",ct(a,o,Bv(r.Themes,e)),i.themes.push(o),Et(e.wbrels,-1,"theme/theme1.xml",vt.THEME),o="xl/styles."+t,ct(a,o,bC(r,o,e)),i.styles.push(o),Et(e.wbrels,-1,"styles."+t,vt.STY),r.vbaraw&&n&&(o="xl/vbaProject.bin",ct(a,o,r.vbaraw),i.vba.push(o),Et(e.wbrels,-1,"vbaProject.bin",vt.VBA)),o="xl/metadata."+t,ct(a,o,kC(o)),i.metadata.push(o),Et(e.wbrels,-1,"metadata."+t,vt.XLMETA),ct(a,"[Content_Types].xml",yv(i,e)),ct(a,"_rels/.rels",ro(e.rels)),ct(a,"xl/_rels/workbook."+t+".rels",ro(e.wbrels)),delete e.revssf,delete e.ssf,a}function yN(r,e){eo=1024,r&&!r.SSF&&(r.SSF=rn(Kt)),r&&r.SSF&&(Ju(),Yu(r.SSF),e.revssf=Qu(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,yl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=Wv.indexOf(e.bookType)>-1,i=vv();l0(e=e||{});var a=Gh(),o="",c=0;if(e.cellXfs=[],Ss(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),o="docProps/core.xml",ct(a,o,bv(r.Props,e)),i.coreprops.push(o),Et(e.rels,2,o,vt.CORE_PROPS),o="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var d=[],f=0;f<r.SheetNames.length;++f)(r.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(r.SheetNames[f]);r.Props.SheetNames=d}r.Props.Worksheets=r.Props.SheetNames.length,ct(a,o,Ev(r.Props)),i.extprops.push(o),Et(e.rels,3,o,vt.EXT_PROPS),r.Custprops!==r.Props&&Cr(r.Custprops||{}).length>0&&(o="docProps/custom.xml",ct(a,o,kv(r.Custprops)),i.custprops.push(o),Et(e.rels,4,o,vt.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,c=1;c<=r.SheetNames.length;++c){var g={"!id":{}},v=r.Sheets[r.SheetNames[c-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+c+"."+t,ct(a,o,Qv(c-1,e,r,g)),i.sheets.push(o),Et(e.wbrels,-1,"worksheets/sheet"+c+"."+t,vt.WS[0])}if(v){var b=v["!comments"],_=!1,S="";if(b&&b.length>0){var A=!1;b.forEach(function(C){C[1].forEach(function(T){T.T==!0&&(A=!0)})}),A&&(S="xl/threadedComments/threadedComment"+c+"."+t,ct(a,S,Yk(b,p,e)),i.threadedcomments.push(S),Et(g,-1,"../threadedComments/threadedComment"+c+"."+t,vt.TCMNT)),S="xl/comments"+c+"."+t,ct(a,S,$v(b)),i.comments.push(S),Et(g,-1,"../comments"+c+"."+t,vt.CMNT),_=!0}v["!legacy"]&&_&&ct(a,"xl/drawings/vmlDrawing"+c+".vml",zv(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}g["!id"].rId1&&ct(a,_v(o),ro(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,ct(a,o,Ov(e.Strings,e)),i.strs.push(o),Et(e.wbrels,-1,"sharedStrings."+t,vt.SST)),o="xl/workbook."+t,ct(a,o,ty(r)),i.workbooks.push(o),Et(e.rels,1,o,vt.WB),o="xl/theme/theme1.xml",ct(a,o,Bv(r.Themes,e)),i.themes.push(o),Et(e.wbrels,-1,"theme/theme1.xml",vt.THEME),o="xl/styles."+t,ct(a,o,Lv(r,e)),i.styles.push(o),Et(e.wbrels,-1,"styles."+t,vt.STY),r.vbaraw&&n&&(o="xl/vbaProject.bin",ct(a,o,r.vbaraw),i.vba.push(o),Et(e.wbrels,-1,"vbaProject.bin",vt.VBA)),o="xl/metadata."+t,ct(a,o,Uv()),i.metadata.push(o),Et(e.wbrels,-1,"metadata."+t,vt.XLMETA),p.length>1&&(o="xl/persons/person.xml",ct(a,o,Jk(p)),i.people.push(o),Et(e.wbrels,-1,"persons/person.xml",vt.PEOPLE)),ct(a,"[Content_Types].xml",yv(i,e)),ct(a,"_rels/.rels",ro(e.rels)),ct(a,"xl/_rels/workbook."+t+".rels",ro(e.wbrels)),delete e.revssf,delete e.ssf,a}function _N(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Ri(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function ly(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Bl(e.file,Ft.write(r,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Ft.write(r,e)}function wN(r,e){var t=rn(e||{}),n=xN(r,t);return bN(n,t)}function bN(r,e){var t={},n=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=r.FullPaths?Ft.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Xu(i))}return e.password&&typeof encrypt_agile<"u"?ly(encrypt_agile(i,e.password),e):e.type==="file"?Bl(e.file,i):e.type=="string"?ml(i):i}function SN(r,e){var t=e||{},n=BC(r,t);return ly(n,t)}function ci(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Tl(Cl(n));case"binary":return Cl(n);case"string":return r;case"file":return Bl(e.file,n,"utf8");case"buffer":return wt?Mi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ci(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function EN(r,e){switch(e.type){case"base64":return Tl(r);case"binary":return r;case"string":return r;case"file":return Bl(e.file,r,"binary");case"buffer":return wt?Mi(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function su(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Tl(t):e.type=="string"?ml(t):t;case"file":return Bl(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function cy(r,e){Qb(),cC(r);var t=rn(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=cy(r,t);return t.type="array",Xu(n)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=r.SheetNames.indexOf(t.sheet),!r.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ci(LC(r,t),t);case"slk":case"sylk":return ci(ak.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"htm":case"html":return ci(iy(r.Sheets[r.SheetNames[i]],t),t);case"txt":return EN(uy(r.Sheets[r.SheetNames[i]],t),t);case"csv":return ci(c0(r.Sheets[r.SheetNames[i]],t),t,"\uFEFF");case"dif":return ci(ok.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"dbf":return su(sk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"prn":return ci(lk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"rtf":return ci(mk.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"eth":return ci(Dv.from_sheet(r.Sheets[r.SheetNames[i]],t),t);case"fods":return ci(oy(r,t),t);case"wk1":return su(Qg.sheet_to_wk1(r.Sheets[r.SheetNames[i]],t),t);case"wk3":return su(Qg.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),su(ny(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),SN(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return wN(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function kN(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function Nh(r,e,t){var n={};return n.type="file",n.file=e,kN(n),cy(r,n)}function TN(r,e,t,n,i,a,o,c){var d=Ar(t),f=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:t,enumerable:!1})}catch{v.__rowNum__=t}else v.__rowNum__=t;if(!o||r[t])for(var y=e.s.c;y<=e.e.c;++y){var b=o?r[t][y]:r[n[y]+d];if(b===void 0||b.t===void 0){if(f===void 0)continue;a[y]!=null&&(v[a[y]]=f);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(a[y]!=null){if(_==null)if(b.t=="e"&&_===null)v[a[y]]=null;else if(f!==void 0)v[a[y]]=f;else if(p&&_===null)v[a[y]]=null;else continue;else v[a[y]]=p&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?_:Ii(b,_,c);_!=null&&(g=!1)}}return{row:v,isempty:g}}function Lu(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,a=[],o=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},p=f.range!=null?f.range:r["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof p){case"string":d=Mt(p);break;case"number":d=Mt(r["!ref"]),d.s.r=p;break;default:d=p}n>0&&(i=0);var g=Ar(d.s.r),v=[],y=[],b=0,_=0,S=Array.isArray(r),A=d.s.r,C=0,T={};S&&!r[A]&&(r[A]=[]);var P=f.skipHidden&&r["!cols"]||[],z=f.skipHidden&&r["!rows"]||[];for(C=d.s.c;C<=d.e.c;++C)if(!(P[C]||{}).hidden)switch(v[C]=Rr(C),t=S?r[A][C]:r[v[C]+g],n){case 1:a[C]=C-d.s.c;break;case 2:a[C]=v[C];break;case 3:a[C]=f.header[C-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=o=Ii(t,null,f),_=T[o]||0,!_)T[o]=1;else{do c=o+"_"+_++;while(T[c]);T[o]=_,T[c]=1}a[C]=c}for(A=d.s.r+i;A<=d.e.r;++A)if(!(z[A]||{}).hidden){var G=TN(r,d,A,v,n,a,S,f);(G.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(y[b++]=G.row)}return y.length=b,y}var ax=/"/g;function AN(r,e,t,n,i,a,o,c){for(var d=!0,f=[],p="",g=Ar(t),v=e.s.c;v<=e.e.c;++v)if(n[v]){var y=c.dense?(r[t]||[])[v]:r[n[v]+g];if(y==null)p="";else if(y.v!=null){d=!1,p=""+(c.rawNumbers&&y.t=="n"?y.v:Ii(y,null,c));for(var b=0,_=0;b!==p.length;++b)if((_=p.charCodeAt(b))===i||_===a||_===34||c.forceQuotes){p='"'+p.replace(ax,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(d=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(ax,'""')+'"')):p="";f.push(p)}return c.blankrows===!1&&d?null:f.join(o)}function c0(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var i=Mt(r["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,d=c.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),p="",g=[];n.dense=Array.isArray(r);for(var v=n.skipHidden&&r["!cols"]||[],y=n.skipHidden&&r["!rows"]||[],b=i.s.c;b<=i.e.c;++b)(v[b]||{}).hidden||(g[b]=Rr(b));for(var _=0,S=i.s.r;S<=i.e.r;++S)(y[S]||{}).hidden||(p=AN(r,i,S,g,o,d,a,n),p!=null&&(n.strip&&(p=p.replace(f,"")),(p||n.blankrows!==!1)&&t.push((_++?c:"")+p)));return delete n.dense,t.join("")}function uy(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=c0(r,e);return t}function CN(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var i=Mt(r["!ref"]),a="",o=[],c,d=[],f=Array.isArray(r);for(c=i.s.c;c<=i.e.c;++c)o[c]=Rr(c);for(var p=i.s.r;p<=i.e.r;++p)for(a=Ar(p),c=i.s.c;c<=i.e.c;++c)if(e=o[c]+a,t=f?(r[p]||[])[c]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}d[d.length]=e+"="+n}return d}function dy(r,e,t){var n=t||{},i=+!n.skipHeader,a=r||{},o=0,c=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var d=typeof n.origin=="string"?vr(n.origin):n.origin;o=d.r,c=d.c}var f,p={s:{c:0,r:0},e:{c,r:o+e.length-1+i}};if(a["!ref"]){var g=Mt(a["!ref"]);p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),o==-1&&(o=g.e.r+1,p.e.r=o+e.length-1+i)}else o==-1&&(o=0,p.e.r=e.length-1+i);var v=n.header||[],y=0;e.forEach(function(_,S){Cr(_).forEach(function(A){(y=v.indexOf(A))==-1&&(v[y=v.length]=A);var C=_[A],T="z",P="",z=Ct({c:c+y,r:o+S+i});f=jl(a,z),C&&typeof C=="object"&&!(C instanceof Date)?a[z]=C:(typeof C=="number"?T="n":typeof C=="boolean"?T="b":typeof C=="string"?T="s":C instanceof Date?(T="d",n.cellDates||(T="n",C=tn(C)),P=n.dateNF||Kt[14]):C===null&&n.nullError&&(T="e",C=0),f?(f.t=T,f.v=C,delete f.w,delete f.R,P&&(f.z=P)):a[z]=f={t:T,v:C},P&&(f.z=P))})}),p.e.c=Math.max(p.e.c,c+v.length-1);var b=Ar(o);if(i)for(y=0;y<v.length;++y)a[Rr(y+c)+b]={t:"s",v:v[y]};return a["!ref"]=rr(p),a}function NN(r,e){return dy(null,r,e)}function jl(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=vr(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?jl(r,Ct(e)):jl(r,Ct({r:e,c:t||0}))}function FN(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function jN(){return{SheetNames:[],Sheets:{}}}function DN(r,e,t,n){var i=1;if(!t)for(;i<=65535&&r.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var a=t.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||t;for(++i;i<=65535&&r.SheetNames.indexOf(t=o+i)!=-1;++i);}if(ey(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function ON(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=FN(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function PN(r,e){return r.z=e,r}function fy(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function RN(r,e,t){return fy(r,"#"+e,t)}function IN(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function LN(r,e,t,n){for(var i=typeof e!="string"?e:Mt(e),a=typeof e=="string"?e:rr(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var d=jl(r,o,c);d.t="n",d.F=a,delete d.v,o==i.s.r&&c==i.s.c&&(d.f=t,n&&(d.D=!0))}return r}var un={encode_col:Rr,encode_row:Ar,encode_cell:Ct,encode_range:rr,decode_col:Qh,decode_row:Jh,split_cell:QS,decode_cell:vr,decode_range:gn,format_cell:Ii,sheet_add_aoa:fv,sheet_add_json:dy,sheet_add_dom:sy,aoa_to_sheet:fo,json_to_sheet:NN,table_to_sheet:ay,table_to_book:oN,sheet_to_csv:c0,sheet_to_txt:uy,sheet_to_json:Lu,sheet_to_html:iy,sheet_to_formulae:CN,sheet_to_row_object_array:Lu,sheet_get_cell:jl,book_new:jN,book_append_sheet:DN,book_set_sheet_visibility:ON,cell_set_number_format:PN,cell_set_hyperlink:fy,cell_set_internal_link:RN,cell_add_comment:IN,sheet_set_array_formula:LN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function MN({user:r,setCurrentView:e}){const[t,n]=re.useState([]),[i,a]=re.useState({}),[o,c]=re.useState(!1),[d,f]=re.useState(null),p=new Date,g=new Date(p.getFullYear(),p.getMonth(),p.getDate());g.setMonth(g.getMonth()-1);const v=z=>{const G=z.getFullYear(),L=String(z.getMonth()+1).padStart(2,"0"),V=String(z.getDate()).padStart(2,"0");return`${G}-${L}-${V}`},[y,b]=re.useState(v(g)),[_,S]=re.useState(v(p)),[A,C]=re.useState(!1);re.useEffect(()=>{T()},[r,y,_]);const T=async()=>{c(!0),f(null);try{const z=new Date(_);z.setDate(z.getDate()+1);const G=v(z);let L=Me.from("tipos_cambio").select("fecha, tasa").eq("usuario_id",r.id);y&&_?L=L.gte("fecha",y).lt("fecha",G):y?L=L.gte("fecha",y):_&&(L=L.lt("fecha",G));const{data:V,error:q}=await L;if(q)throw q;const O={};V?.forEach(ve=>{O[ve.fecha]=parseFloat(ve.tasa)}),a(O);let ee=Me.from("entradas_contables").select(`
          fecha,
          importe_ars,
          importe_usd,
          moneda,
          tipo,
          conceptos_contables (
            concepto,
            rubro_id,
            rubros (nombre)
          )
        `).eq("usuario_id",r.id).order("fecha",{ascending:!1});y&&_?ee=ee.gte("fecha",y).lt("fecha",G):y?ee=ee.gte("fecha",y):_&&(ee=ee.lt("fecha",G));const{data:D,error:te}=await ee;if(te)throw te;n(D||[])}catch(z){console.error("Error al filtrar datos:",z.message),f("Error al filtrar datos. Inténtalo de nuevo.")}finally{c(!1)}},P=async()=>{if(!t||t.length===0){alert("No hay datos en la tabla para exportar.");return}C(!0);try{const z=t.map(O=>{const ee=i[O.fecha]??"N/A";return{Fecha:O.fecha,Rubro:O.conceptos_contables?.rubros?.nombre||"",Concepto:O.conceptos_contables?.concepto||"",Moneda:O.moneda,"Valor ARS":parseFloat(O.importe_ars),"Valor USD":parseFloat(O.importe_usd),"Tipo de Cambio (ARS/USD)":typeof ee=="number"?ee:"N/A"}}),G=un.json_to_sheet(z),L=un.book_new();un.book_append_sheet(L,G,"Registros");const V="A";for(let O=2;O<=z.length+1;O++){const ee=G[V+O];ee&&ee.t==="d"&&(ee.z="dd/mm/yyyy")}const q=`Registros_${new Date().toISOString().split("T")[0]}.xlsx`;Nh(L,q)}catch(z){console.error("Error al exportar a Excel:",z),alert("Error al exportar a Excel. Inténtalo de nuevo.")}finally{C(!1)}};return h.jsx("div",{className:"flex h-screen bg-gray-100 font-sans",children:h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Exportar a Excel"})]}),h.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsx("div",{className:"mb-6 space-y-4",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Desde"}),h.jsx("input",{type:"date",value:y,onChange:z=>b(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Hasta"}),h.jsx("input",{type:"date",value:_,onChange:z=>S(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),h.jsxs("div",{className:"flex items-end space-x-2",children:[h.jsx("button",{onClick:T,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150",children:"Ver"}),h.jsx("button",{onClick:P,disabled:t.length===0||A,className:`w-full px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center justify-center space-x-2 ${t.length===0||A?"bg-gray-400 cursor-not-allowed text-gray-200":"bg-green-600 hover:bg-green-700 text-white"}`,children:A?h.jsxs(h.Fragment,{children:[h.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.962l2-2.671z"})]}),h.jsx("span",{children:"Generando Excel..."})]}):h.jsxs(h.Fragment,{children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),h.jsx("span",{children:"Exportar a Excel"})]})})]})]})}),o?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):d?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:d})]})]}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Fecha"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rubro"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Concepto"}),h.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Moneda"}),h.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Valor ARS"}),h.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Valor USD"}),h.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Tipo Cambio"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length>0?t.map((z,G)=>{const L=i[z.fecha]??"N/A",[V,q,O]=z.fecha.split("-");return h.jsxs("tr",{children:[h.jsx("td",{className:"p-1 whitespace-nowrap text-sm font-medium text-gray-800",children:`${O}/${q}/${V}`}),h.jsx("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600",children:z.conceptos_contables?.rubros?.nombre}),h.jsx("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600",children:z.conceptos_contables?.concepto}),h.jsx("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600",children:z.moneda}),h.jsxs("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600 text-right",children:["$",parseFloat(z.importe_ars).toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsxs("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600 text-right",children:["$",parseFloat(z.importe_usd).toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),h.jsx("td",{className:"p-1 whitespace-nowrap text-sm text-gray-600 text-right font-medium",children:typeof L=="number"?`$${L.toLocaleString("es-AR",{minimumFractionDigits:2})}`:"N/A"})]},G)}):h.jsx("tr",{children:h.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"No hay entradas contables para los filtros seleccionados."})})})]})})]})})]})})}function BN({user:r,setCurrentView:e,updateMessage:t,setUpdateMessage:n}){const[i,a]=re.useState([]),[o,c]=re.useState(!0),[d,f]=re.useState(null),[p,g]=re.useState(!1),[v,y]=re.useState(!1),[b,_]=re.useState(null),[S,A]=re.useState(null),[C,T]=re.useState({tipo:"",simbolo:"",nombre:"",moneda:"",submarket:""}),[P,z]=re.useState(""),[G,L]=re.useState(!1),[V,q]=re.useState(null),[O,ee]=re.useState({key:"simbolo",direction:"ascending"}),[D,te]=re.useState(""),[ve,ye]=re.useState(""),Oe=["accion","cedear","etf","bono"],je=["ARS","USD"];re.useEffect(()=>{fe(),xe()},[r,t]);const fe=async()=>{if(!r){c(!1);return}try{c(!0),f(null);const{data:Z,error:pe}=await Me.from("activos").select("*, ultimo_precio, ultimo_precio_ars, fecha_actualizacion").order("tipo",{ascending:!0}).order("simbolo",{ascending:!0});if(pe)throw pe;a(Z||[])}catch(Z){console.error("❌ Error al cargar activos:",Z.message),f(Z.message)}finally{c(!1)}},xe=async()=>{if(r)try{const{data:Z}=await Me.from("tipos_cambio").select("tasa").eq("usuario_id",r.id).order("fecha",{ascending:!1}).limit(1).single();q(Z?.tasa||null)}catch(Z){console.error("Error al cargar tipo de cambio:",Z.message)}},me=(Z=null)=>{Z?(A(Z),T({tipo:Z.tipo,simbolo:Z.simbolo,nombre:Z.nombre,moneda:Z.moneda,submarket:Z.submarket||""})):(A(null),T({tipo:"",simbolo:"",nombre:"",moneda:"",submarket:""})),z(""),g(!0)},K=()=>{g(!1),A(null),T({tipo:"",simbolo:"",nombre:"",moneda:"",submarket:""}),z("")},N=Z=>{_(Z),y(!0)},X=()=>{_(null),y(!1)},W=Z=>{T({...C,[Z.target.name]:Z.target.value})},B=async Z=>{Z.preventDefault();const{tipo:pe,simbolo:Ce,nombre:Fe,moneda:We,submarket:Be}=C;if(!pe||!Ce||!Fe||!We||!Be){z("Todos los campos son obligatorios");return}try{if(S){const{error:ke}=await Me.from("activos").update({tipo:pe,simbolo:Ce,nombre:Fe,moneda:We,submarket:Be}).eq("id",S.id);if(ke)throw ke}else{const{error:ke}=await Me.from("activos").insert({tipo:pe,simbolo:Ce.toUpperCase(),nombre:Fe,moneda:We,submarket:Be});if(ke)throw ke}await fe(),K(),n({type:"success",text:S?"Activo actualizado con éxito.":"Activo creado con éxito."})}catch(ke){console.error("Error al guardar el activo:",ke.message),z("Error al guardar. Intenta nuevamente."),n({type:"error",text:"Error al guardar el activo."})}finally{setTimeout(()=>n(null),5e3)}},J=async()=>{if(b)try{const{error:Z}=await Me.from("activos").delete().eq("id",b);if(Z)throw Z;await fe(),X(),n({type:"success",text:"Activo eliminado con éxito."})}catch(Z){console.error("Error al eliminar el activo:",Z.message),f("Error al eliminar. Intenta nuevamente."),n({type:"error",text:"Error al eliminar el activo."}),X()}finally{setTimeout(()=>n(null),5e3)}},be=async()=>{L(!0),n(null);try{if(!r){n({type:"error",text:"Usuario no logueado."});return}const{data:Z,error:pe}=await Me.functions.invoke("actualizar-precios-docta",{body:{user_id:r.id}});if(pe)throw pe;await new Promise(Ce=>setTimeout(Ce,1e3)),await fe(),await xe(),n({type:"success",text:Z?.message||"Precios actualizados correctamente."})}catch(Z){console.error("Error al actualizar precios:",Z),n({type:"error",text:"Error al actualizar precios. Por favor, revisa la consola."})}finally{L(!1),setTimeout(()=>n(null),5e3)}},ie=Z=>{let pe="ascending";O.key===Z&&O.direction==="ascending"&&(pe="descending"),ee({key:Z,direction:pe})},se=(()=>{let Z=[...i];return D&&(Z=Z.filter(pe=>pe.tipo===D)),ve&&(Z=Z.filter(pe=>pe.simbolo.toLowerCase().includes(ve.toLowerCase()))),O.key!==null&&Z.sort((pe,Ce)=>{let Fe,We;return O.key==="ultimo_precio"||O.key==="ultimo_precio_ars"?(Fe=pe[O.key]||0,We=Ce[O.key]||0):O.key==="fecha_actualizacion"?(Fe=pe.fecha_actualizacion?new Date(pe.fecha_actualizacion):new Date(0),We=Ce.fecha_actualizacion?new Date(Ce.fecha_actualizacion):new Date(0)):(Fe=(pe[O.key]||"").toLowerCase(),We=(Ce[O.key]||"").toLowerCase()),Fe<We?O.direction==="ascending"?-1:1:Fe>We?O.direction==="ascending"?1:-1:0}),Z})();return h.jsxs("div",{className:"flex h-screen bg-gray-100 font-sans",children:[h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Precios"})]}),h.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6",children:o?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):d?h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar los datos"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:d})]})]}):h.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200",children:[h.jsxs("div",{className:"px-6 py-4 flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Lista de Activos"}),h.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[V&&h.jsxs("span",{className:"text-sm text-gray-600 font-medium whitespace-nowrap",children:["T.C. actual: ",h.jsxs("span",{className:"font-mono font-semibold",children:["$",V?.toFixed(2)]})]}),h.jsx("div",{className:"flex flex-col items-end space-y-2",children:h.jsx("button",{onClick:be,disabled:G,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2 ${G?"bg-gray-400 cursor-not-allowed text-gray-200":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:G?h.jsxs(h.Fragment,{children:[h.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.962l2-2.671z"})]}),h.jsx("span",{children:"Actualizando precios..."})]}):h.jsxs(h.Fragment,{children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.03M4.032 9.417l2.687-2.685m-2.687 2.685a8.25 8.25 0 0113.803-3.03L21.03 3.485c.036.002.071.006.106.01L2.985 19.644z"})}),h.jsx("span",{children:"Actualizar precios"})]})})}),h.jsxs("button",{onClick:()=>me(),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center space-x-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),h.jsx("span",{children:"Nuevo Activo"})]})]})]}),h.jsxs("div",{className:"p-6 bg-gray-100 border-t border-gray-200 flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{htmlFor:"filter-tipo",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filtrar por Tipo"}),h.jsxs("select",{id:"filter-tipo",value:D,onChange:Z=>te(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[h.jsx("option",{value:"",children:"Todos"}),Oe.map(Z=>h.jsx("option",{value:Z,children:Z==="accion"?"Acción":Z==="cedear"?"Cedear":Z==="etf"?"ETF":"Bono"},Z))]})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{htmlFor:"filter-simbolo",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filtrar por Ticker"}),h.jsx("input",{type:"text",id:"filter-simbolo",value:ve,onChange:Z=>ye(Z.target.value),placeholder:"Ej: GGAL",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),h.jsx("div",{className:"overflow-x-auto max-h-[60vh] lg:max-h-[70vh]",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:h.jsxs("tr",{children:[h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>ie("tipo"),children:["Tipo",O.key==="tipo"&&h.jsx("span",{className:"ml-1",children:O.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>ie("simbolo"),children:["Ticker",O.key==="simbolo"&&h.jsx("span",{className:"ml-1",children:O.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>ie("submarket"),children:["Submarket",O.key==="submarket"&&h.jsx("span",{className:"ml-1",children:O.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>ie("moneda"),children:["Moneda",O.key==="moneda"&&h.jsx("span",{className:"ml-1",children:O.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>ie("ultimo_precio"),children:["Precio USD",O.key==="ultimo_precio"&&h.jsx("span",{className:"ml-1",children:O.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>ie("ultimo_precio_ars"),children:["Precio ARS",O.key==="ultimo_precio_ars"&&h.jsx("span",{className:"ml-1",children:O.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>ie("fecha_actualizacion"),children:["Última Actualización",O.key==="fecha_actualizacion"&&h.jsx("span",{className:"ml-1",children:O.direction==="ascending"?"▲":"▼"})]}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.length>0?se.map(Z=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 capitalize",children:Z.tipo}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:Z.simbolo}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 capitalize",children:Z.submarket}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-mono",children:Z.moneda}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:Z.ultimo_precio?`$${Z.ultimo_precio?.toLocaleString("en-US",{minimumFractionDigits:4,maximumFractionDigits:4})}`:h.jsx("span",{className:"text-gray-400",children:"Sin datos"})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:Z.ultimo_precio_ars?`$${Z.ultimo_precio_ars?.toLocaleString("es-AR",{minimumFractionDigits:2})}`:h.jsx("span",{className:"text-gray-400",children:"Sin datos"})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:Z.fecha_actualizacion?new Date(Z.fecha_actualizacion).toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short"}):"N/A"}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[h.jsx("button",{onClick:()=>me(Z),className:"text-indigo-600 hover:text-indigo-800 mr-4 transition-colors duration-150",children:"Editar"}),h.jsx("button",{onClick:()=>N(Z.id),className:"text-red-600 hover:text-red-800 transition-colors duration-150",children:"Eliminar"})]})]},Z.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"8",className:"px-6 py-4 text-center text-gray-500",children:"No tenés activos registrados."})})})]})})]})})]}),p&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:S?"Editar Activo":"Nuevo Activo"}),P&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:P}),h.jsxs("form",{onSubmit:B,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),h.jsxs("select",{name:"tipo",value:C.tipo,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[h.jsx("option",{value:"",children:"Seleccionar tipo"}),Oe.map(Z=>h.jsx("option",{value:Z,children:Z==="accion"?"Acción":Z==="cedear"?"Cedear":Z==="etf"?"ETF":"Bono"},Z))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ticker"}),h.jsx("input",{type:"text",name:"simbolo",value:C.simbolo,onChange:Z=>T({...C,simbolo:Z.target.value.toUpperCase()}),placeholder:"Ej: GGAL, AAPL, AL30",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),h.jsx("input",{type:"text",name:"nombre",value:C.nombre,onChange:W,placeholder:"Ej: Grupo Galicia, Apple Inc.",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda"}),h.jsxs("select",{name:"moneda",value:C.moneda,onChange:W,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[h.jsx("option",{value:"",children:"Seleccionar moneda"}),je.map(Z=>h.jsx("option",{value:Z,children:Z},Z))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Submarket"}),h.jsx("input",{type:"text",name:"submarket",value:C.submarket,onChange:W,placeholder:"Ej: BYMA",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:S?"Actualizar":"Guardar"})]})]})]})}),v&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-auto",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Confirmar Eliminación"}),h.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"¿Estás seguro de que deseas eliminar este activo? Esta acción no se puede deshacer."}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:X,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:J,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-150",children:"Eliminar"})]})]})}),t&&h.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-4 shadow-lg transition-all duration-300 ${t.type==="success"?"bg-green-100 text-green-700 border-b border-green-200":"bg-red-100 text-red-700 border-b border-red-200"}`,children:[h.jsx("p",{className:"text-sm font-medium",children:t.text}),h.jsx("button",{onClick:()=>n(null),className:"text-gray-500 hover:text-gray-700",children:"×"})]})]})}function UN({user:r,setCurrentView:e,updateMessage:t,setUpdateMessage:n,portfolioCurrencies:i,setPortfolioCurrencies:a}){const[o,c]=re.useState([]),[d,f]=re.useState(!0),[p,g]=re.useState(!1),[v,y]=re.useState({name:"",description:""}),[b,_]=re.useState(""),[S,A]=re.useState([]),[C,T]=re.useState(!1);re.useEffect(()=>{r&&G()},[r]),re.useEffect(()=>{r&&S.length>0&&z()},[r,S]);const P=async()=>{try{n({type:"info",text:"Recalculando valores contables..."});const{data:D,error:te}=await Me.from("tipos_cambio").select("fecha, tasa").eq("usuario_id",r.id);if(te)throw te;const ve=D.reduce((me,K)=>(me[K.fecha]=K.tasa,me),{}),{data:ye,error:Oe}=await Me.from("entradas_contables").select("id, fecha, importe_ars, importe_usd, moneda").eq("usuario_id",r.id);if(Oe)throw Oe;const je=ye.map(me=>{const K=ve[me.fecha];if(!K||K<=0)return null;let N=!1,X={};if(me.moneda==="ARS"){const W=parseFloat((me.importe_ars/K).toFixed(2));W!==me.importe_usd&&(N=!0,X={importe_usd:W})}else if(me.moneda==="USD"){const W=parseFloat((me.importe_usd*K).toFixed(2));W!==me.importe_ars&&(N=!0,X={importe_ars:W})}return N?Me.from("entradas_contables").update(X).eq("id",me.id).eq("usuario_id",r.id):null}).filter(Boolean);if(je.length>0&&(await Promise.all(je)).filter(N=>N.error).length>0)throw new Error("Algunos registros contables no se pudieron actualizar.");n({type:"info",text:"Actualizando los valors de los registros contables y los precios de los activos en cartera..."}),await new Promise(me=>setTimeout(me,1e3));const{data:fe,error:xe}=await Me.functions.invoke("actualizar-precios-docta",{body:{user_id:r.id}});if(xe)throw xe;return{success:!0}}catch(D){throw console.error("Error al recalcular y actualizar precios:",D),new Error(D.message||"Error en el proceso de actualización.")}},z=async()=>{T(!0);try{n({type:"info",text:"Iniciando actualización completa..."}),n({type:"info",text:"Actualizando la información del tipo de cambio Mep..."});const{error:D}=await Me.functions.invoke("actualizar-tipo-cambio",{body:{user_id:r.id}});if(D)throw D;await new Promise(te=>setTimeout(te,1e3)),await P(),n({type:"success",text:"¡Actualización completa! Todos los precios han sido sincronizados."})}catch(D){console.error("Error en la actualización completa:",D),n({type:"error",text:D.message||"Error en la actualización. Por favor, intenta de nuevo."})}finally{O(),T(!1),setTimeout(()=>n(null),5e3)}},G=async()=>{try{const{data:D,error:te}=await Me.from("tipos_cambio").select("fecha, tasa").order("fecha",{ascending:!0});if(te)throw te;A(D)}catch(D){console.error("Error fetching tipos de cambio:",D.message)}},L=D=>{const te=S.find(ve=>ve.fecha===D);return te?te.tasa:0},V=(D,te,ve,ye)=>{if(te===ve)return D;const Oe=L(ye);return Oe===0?0:te==="ARS"&&ve==="USD"?D/Oe:te==="USD"&&ve==="ARS"?D*Oe:D},q=(D,te="todos")=>{const ve=te==="todos"?D:D.filter(B=>B.broker_id===te),ye={};ve.sort((B,J)=>new Date(B.fecha)-new Date(J.fecha)),ve.forEach(B=>{const J=B.activo_id;ye[J]||(ye[J]={cantidad:0,costo_total_ars:0,costo_total_usd:0,activoInfo:B.activos,brokers:{},compras:[]});const be=parseFloat(B.cantidad),ie=parseFloat(B.precio_unitario),ne=be*ie,se=B.activos?.tipo?.toLowerCase()==="bono",Z=V(ne,B.moneda,"ARS",B.fecha),pe=V(ne,B.moneda,"USD",B.fecha),Ce=B.broker_id;if(ye[J].brokers[Ce]||(ye[J].brokers[Ce]={cantidad:0,costo_total_ars:0,costo_total_usd:0}),B.tipo_operacion==="compra"){const Fe=se?Z/100/be:Z/be,We=se?pe/100/be:pe/be;ye[J].compras.push({id:B.id,cantidad_restante:be,costo_unitario_ars:Fe,costo_unitario_usd:We,broker_id:Ce})}else if(B.tipo_operacion==="venta"){let Fe=be;for(let We=0;We<ye[J].compras.length&&Fe>0;We++){const Be=ye[J].compras[We];if(Be.cantidad_restante>0){const ke=Math.min(Fe,Be.cantidad_restante);Be.cantidad_restante-=ke,Fe-=ke}}}});for(const B in ye){const J=ye[B];J.cantidad=0,J.costo_total_ars=0,J.costo_total_usd=0;for(const se in J.brokers)J.brokers[se].cantidad=0,J.brokers[se].costo_total_ars=0,J.brokers[se].costo_total_usd=0;J.compras.forEach(se=>{const Z=se.cantidad_restante;Z>0&&(J.cantidad+=Z,J.brokers[se.broker_id].cantidad+=Z,J.costo_total_ars+=Z*se.costo_unitario_ars,J.costo_total_usd+=Z*se.costo_unitario_usd,J.brokers[se.broker_id].costo_total_ars+=Z*se.costo_unitario_ars,J.brokers[se.broker_id].costo_total_usd+=Z*se.costo_unitario_usd)});const be=J.activoInfo?.tipo?.toLowerCase()==="bono",ie=J.cantidad>0?be?J.cantidad*J.activoInfo.ultimo_precio_ars/100:J.cantidad*J.activoInfo.ultimo_precio_ars:0,ne=J.cantidad>0?be?J.cantidad*J.activoInfo.ultimo_precio/100:J.cantidad*J.activoInfo.ultimo_precio:0;J.valor_actual_ars=ie,J.valor_actual_usd=ne}let Oe=0,je=0,fe=0,xe=0,me=0;for(const B in ye){const J=ye[B];Oe+=J.valor_actual_ars,je+=J.valor_actual_usd,fe+=J.costo_total_ars,xe+=J.costo_total_usd,J.cantidad>0&&me++}const K=Oe-fe,N=fe>0?K/fe*100:0,X=je-xe,W=xe>0?X/xe*100:0;return{valorActualArs:Oe,valorActualUsd:je,costoTotalArs:fe,costoTotalUsd:xe,rendimientoMontoArs:K,rendimientoPorcentajeArs:N,rendimientoMontoUsd:X,rendimientoPorcentajeUsd:W,cantidadActivos:me}},O=async()=>{try{f(!0);const{data:D,error:te}=await Me.from("portfolios").select("*").eq("user_id",r.id).order("created_at",{ascending:!1});if(te)throw te;const ve=await Promise.all(D.map(async ye=>{const{data:Oe,error:je}=await Me.from("transacciones").select("*, activos(id, tipo, ultimo_precio, ultimo_precio_ars)").eq("portafolio_id",ye.id).order("fecha",{ascending:!0});if(je)throw je;const fe=q(Oe,"todos");return{...ye,valorActualArs:fe.valorActualArs,valorActualUsd:fe.valorActualUsd,rendimientoMontoArs:fe.rendimientoMontoArs,rendimientoMontoUsd:fe.rendimientoMontoUsd,rendimientoPorcentajeArs:fe.rendimientoPorcentajeArs,rendimientoPorcentajeUsd:fe.rendimientoPorcentajeUsd,cantidadActivos:fe.cantidadActivos}}));c(ve)}catch(D){console.error("Error al cargar portfolios:",D.message)}finally{f(!1)}},ee=async D=>{if(D.preventDefault(),!v.name){_("El nombre es obligatorio.");return}_("");try{const{data:te,error:ve}=await Me.from("portfolios").insert({user_id:r.id,name:v.name,description:v.description}).select();if(ve)throw ve;y({name:"",description:""}),g(!1),O()}catch(te){console.error("Error al crear el portafolio:",te.message),_("Error al crear el portafolio. Intenta de nuevo.")}};return h.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsxs("div",{className:"flex space-x-4",children:[h.jsx("button",{onClick:z,disabled:C,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2 ${C?"bg-gray-400 cursor-not-allowed text-gray-200":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:C?h.jsxs(h.Fragment,{children:[h.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.962l2-2.671z"})]}),h.jsx("span",{children:"Actualizando..."})]}):h.jsxs(h.Fragment,{children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.03M4.032 9.417l2.687-2.685m-2.687 2.685a8.25 8.25 0 0113.803-3.03L21.03 3.485c.036.002.071.006.106.01L2.985 19.644z"})}),h.jsx("span",{children:"Actualizar precios"})]})}),h.jsx("button",{onClick:()=>g(!0),className:"bg-black text-white px-6 py-2 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors duration-150",children:"Crear Portafolio"})]})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:"Portafolios"})]}),t&&h.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-4 shadow-lg transition-all duration-300 ${t.type==="success"?"bg-green-100 text-green-700 border-b border-green-200":"bg-red-100 text-red-700 border-b border-red-200"}`,children:[h.jsx("p",{className:"text-sm font-medium",children:t.text}),h.jsx("button",{onClick:()=>n(null),className:"text-gray-500 hover:text-gray-700",children:"×"})]}),h.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:d?h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})}):h.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:o.length>0?o.map(D=>h.jsx(zN,{portfolio:D,setCurrentView:e,portfolioCurrencies:i,setPortfolioCurrencies:a},D.id)):h.jsx("div",{className:"col-span-full bg-white rounded-xl shadow-md p-6 text-center text-gray-500",children:h.jsx("p",{children:"Aún no tienes portafolios. ¡Crea uno para empezar!"})})})}),p&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Crear Nuevo Portafolio"}),b&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:b}),h.jsxs("form",{onSubmit:ee,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),h.jsx("input",{type:"text",name:"name",value:v.name,onChange:D=>y({...v,name:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Ej: Cartera de Inversión a Largo Plazo",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción (opcional)"}),h.jsx("textarea",{name:"description",value:v.description,onChange:D=>y({...v,description:D.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Una breve descripción de esta cartera"})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:()=>{g(!1),_(""),y({name:"",description:""})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:"Crear"})]})]})]})})]})}const zN=({portfolio:r,setCurrentView:e,portfolioCurrencies:t,setPortfolioCurrencies:n})=>{const i=t[r.id]||"ARS",a=()=>{let c,d,f,p;i==="ARS"?(c=r.rendimientoMontoArs,d=r.rendimientoPorcentajeArs,f="ARS"):(c=r.rendimientoMontoUsd,d=r.rendimientoPorcentajeUsd,f="USD"),p=c>=0;const g=`${c.toLocaleString("es-AR",{style:"currency",currency:f,minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"})}`,v=`${d.toFixed(2)}%`,y=p?"text-green-600":"text-red-600";return h.jsxs("p",{className:`text-lg font-semibold ${y}`,children:[g," (",v,")"]})},o=(c,d)=>i==="ARS"?`$${c.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})} ARS`:`$${d.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})} USD`;return h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:r.name}),h.jsx("p",{className:"text-sm text-gray-500",children:r.description})]}),h.jsxs("div",{className:"bg-gray-200 rounded-full p-1 flex items-center flex-shrink-0",children:[h.jsx("button",{onClick:()=>n({...t,[r.id]:"ARS"}),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors duration-200 ${i==="ARS"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"ARS"}),h.jsx("button",{onClick:()=>n({...t,[r.id]:"USD"}),className:`px-3 py-1 rounded-full text-xs font-medium transition-colors duration-200 ${i==="USD"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"USD"})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Valor Actual"}),h.jsx("p",{className:"text-xl font-bold text-gray-800",children:o(r.valorActualArs,r.valorActualUsd)})]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Rendimiento"}),a()]}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Cantidad de Activos"}),h.jsx("p",{className:"text-lg font-medium text-gray-700",children:r.cantidadActivos})]})]}),h.jsx("div",{className:"mt-6 flex justify-end",children:h.jsx("button",{onClick:()=>e("portfolio-detail",r.id,i),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors duration-150",children:"Ver detalles del porfolio"})})]},r.id)};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Hl(r){return r+.5|0}const ms=(r,e,t)=>Math.max(Math.min(r,t),e);function ol(r){return ms(Hl(r*2.55),0,255)}function xs(r){return ms(Hl(r*255),0,255)}function ji(r){return ms(Hl(r/2.55)/100,0,1)}function ox(r){return ms(Hl(r*100),0,100)}const An={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Fh=[..."0123456789ABCDEF"],$N=r=>Fh[r&15],WN=r=>Fh[(r&240)>>4]+Fh[r&15],au=r=>(r&240)>>4===(r&15),HN=r=>au(r.r)&&au(r.g)&&au(r.b)&&au(r.a);function VN(r){var e=r.length,t;return r[0]==="#"&&(e===4||e===5?t={r:255&An[r[1]]*17,g:255&An[r[2]]*17,b:255&An[r[3]]*17,a:e===5?An[r[4]]*17:255}:(e===7||e===9)&&(t={r:An[r[1]]<<4|An[r[2]],g:An[r[3]]<<4|An[r[4]],b:An[r[5]]<<4|An[r[6]],a:e===9?An[r[7]]<<4|An[r[8]]:255})),t}const GN=(r,e)=>r<255?e(r):"";function KN(r){var e=HN(r)?$N:WN;return r?"#"+e(r.r)+e(r.g)+e(r.b)+GN(r.a,e):void 0}const qN=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hy(r,e,t){const n=e*Math.min(t,1-t),i=(a,o=(a+r/30)%12)=>t-n*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function XN(r,e,t){const n=(i,a=(i+r/60)%6)=>t-t*e*Math.max(Math.min(a,4-a,1),0);return[n(5),n(3),n(1)]}function YN(r,e,t){const n=hy(r,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)n[i]*=1-e-t,n[i]+=e;return n}function JN(r,e,t,n,i){return r===i?(e-t)/n+(e<t?6:0):e===i?(t-r)/n+2:(r-e)/n+4}function u0(r){const t=r.r/255,n=r.g/255,i=r.b/255,a=Math.max(t,n,i),o=Math.min(t,n,i),c=(a+o)/2;let d,f,p;return a!==o&&(p=a-o,f=c>.5?p/(2-a-o):p/(a+o),d=JN(t,n,i,p,a),d=d*60+.5),[d|0,f||0,c]}function d0(r,e,t,n){return(Array.isArray(e)?r(e[0],e[1],e[2]):r(e,t,n)).map(xs)}function f0(r,e,t){return d0(hy,r,e,t)}function QN(r,e,t){return d0(YN,r,e,t)}function ZN(r,e,t){return d0(XN,r,e,t)}function py(r){return(r%360+360)%360}function e3(r){const e=qN.exec(r);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?ol(+e[5]):xs(+e[5]));const i=py(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?n=QN(i,a,o):e[1]==="hsv"?n=ZN(i,a,o):n=f0(i,a,o),{r:n[0],g:n[1],b:n[2],a:t}}function t3(r,e){var t=u0(r);t[0]=py(t[0]+e),t=f0(t),r.r=t[0],r.g=t[1],r.b=t[2]}function r3(r){if(!r)return;const e=u0(r),t=e[0],n=ox(e[1]),i=ox(e[2]);return r.a<255?`hsla(${t}, ${n}%, ${i}%, ${ji(r.a)})`:`hsl(${t}, ${n}%, ${i}%)`}const lx={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},cx={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function n3(){const r={},e=Object.keys(cx),t=Object.keys(lx);let n,i,a,o,c;for(n=0;n<e.length;n++){for(o=c=e[n],i=0;i<t.length;i++)a=t[i],c=c.replace(a,lx[a]);a=parseInt(cx[o],16),r[c]=[a>>16&255,a>>8&255,a&255]}return r}let ou;function i3(r){ou||(ou=n3(),ou.transparent=[0,0,0,0]);const e=ou[r.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const s3=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function a3(r){const e=s3.exec(r);let t=255,n,i,a;if(e){if(e[7]!==n){const o=+e[7];t=e[8]?ol(o):ms(o*255,0,255)}return n=+e[1],i=+e[3],a=+e[5],n=255&(e[2]?ol(n):ms(n,0,255)),i=255&(e[4]?ol(i):ms(i,0,255)),a=255&(e[6]?ol(a):ms(a,0,255)),{r:n,g:i,b:a,a:t}}}function o3(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${ji(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const sh=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,Xa=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function l3(r,e,t){const n=Xa(ji(r.r)),i=Xa(ji(r.g)),a=Xa(ji(r.b));return{r:xs(sh(n+t*(Xa(ji(e.r))-n))),g:xs(sh(i+t*(Xa(ji(e.g))-i))),b:xs(sh(a+t*(Xa(ji(e.b))-a))),a:r.a+t*(e.a-r.a)}}function lu(r,e,t){if(r){let n=u0(r);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=f0(n),r.r=n[0],r.g=n[1],r.b=n[2]}}function my(r,e){return r&&Object.assign(e||{},r)}function ux(r){var e={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(e={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(e.a=xs(r[3]))):(e=my(r,{r:0,g:0,b:0,a:1}),e.a=xs(e.a)),e}function c3(r){return r.charAt(0)==="r"?a3(r):e3(r)}class Dl{constructor(e){if(e instanceof Dl)return e;const t=typeof e;let n;t==="object"?n=ux(e):t==="string"&&(n=VN(e)||i3(e)||c3(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=my(this._rgb);return e&&(e.a=ji(e.a)),e}set rgb(e){this._rgb=ux(e)}rgbString(){return this._valid?o3(this._rgb):void 0}hexString(){return this._valid?KN(this._rgb):void 0}hslString(){return this._valid?r3(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,i=e.rgb;let a;const o=t===a?.5:t,c=2*o-1,d=n.a-i.a,f=((c*d===-1?c:(c+d)/(1+c*d))+1)/2;a=1-f,n.r=255&f*n.r+a*i.r+.5,n.g=255&f*n.g+a*i.g+.5,n.b=255&f*n.b+a*i.b+.5,n.a=o*n.a+(1-o)*i.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=l3(this._rgb,e._rgb,t)),this}clone(){return new Dl(this.rgb)}alpha(e){return this._rgb.a=xs(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Hl(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return lu(this._rgb,2,e),this}darken(e){return lu(this._rgb,2,-e),this}saturate(e){return lu(this._rgb,1,e),this}desaturate(e){return lu(this._rgb,1,-e),this}rotate(e){return t3(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ti(){}const u3=(()=>{let r=0;return()=>r++})();function Lr(r){return r==null}function Tr(r){if(Array.isArray&&Array.isArray(r))return!0;const e=Object.prototype.toString.call(r);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function yt(r){return r!==null&&Object.prototype.toString.call(r)==="[object Object]"}function Li(r){return(typeof r=="number"||r instanceof Number)&&isFinite(+r)}function oi(r,e){return Li(r)?r:e}function Tt(r,e){return typeof r>"u"?e:r}const d3=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100:+r/e,gy=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100*e:+r;function It(r,e,t){if(r&&typeof r.call=="function")return r.apply(t,e)}function kt(r,e,t,n){let i,a,o;if(Tr(r))for(a=r.length,i=0;i<a;i++)e.call(t,r[i],i);else if(yt(r))for(o=Object.keys(r),a=o.length,i=0;i<a;i++)e.call(t,r[o[i]],o[i])}function Mu(r,e){let t,n,i,a;if(!r||!e||r.length!==e.length)return!1;for(t=0,n=r.length;t<n;++t)if(i=r[t],a=e[t],i.datasetIndex!==a.datasetIndex||i.index!==a.index)return!1;return!0}function Bu(r){if(Tr(r))return r.map(Bu);if(yt(r)){const e=Object.create(null),t=Object.keys(r),n=t.length;let i=0;for(;i<n;++i)e[t[i]]=Bu(r[t[i]]);return e}return r}function xy(r){return["__proto__","prototype","constructor"].indexOf(r)===-1}function f3(r,e,t,n){if(!xy(r))return;const i=e[r],a=t[r];yt(i)&&yt(a)?Ol(i,a,n):e[r]=Bu(a)}function Ol(r,e,t){const n=Tr(e)?e:[e],i=n.length;if(!yt(r))return r;t=t||{};const a=t.merger||f3;let o;for(let c=0;c<i;++c){if(o=n[c],!yt(o))continue;const d=Object.keys(o);for(let f=0,p=d.length;f<p;++f)a(d[f],r,o,t)}return r}function _l(r,e){return Ol(r,e,{merger:h3})}function h3(r,e,t){if(!xy(r))return;const n=e[r],i=t[r];yt(n)&&yt(i)?_l(n,i):Object.prototype.hasOwnProperty.call(e,r)||(e[r]=Bu(i))}const dx={"":r=>r,x:r=>r.x,y:r=>r.y};function p3(r){const e=r.split("."),t=[];let n="";for(const i of e)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function m3(r){const e=p3(r);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function Pl(r,e){return(dx[e]||(dx[e]=m3(e)))(r)}function h0(r){return r.charAt(0).toUpperCase()+r.slice(1)}const Uu=r=>typeof r<"u",ws=r=>typeof r=="function",fx=(r,e)=>{if(r.size!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0};function g3(r){return r.type==="mouseup"||r.type==="click"||r.type==="contextmenu"}const Lt=Math.PI,tr=2*Lt,zu=Number.POSITIVE_INFINITY,x3=Lt/180,dr=Lt/2,Bs=Lt/4,hx=Lt*2/3,px=Math.sign;function v3(r){const e=[],t=Math.sqrt(r);let n;for(n=1;n<t;n++)r%n===0&&(e.push(n),e.push(r/n));return t===(t|0)&&e.push(t),e.sort((i,a)=>i-a).pop(),e}function y3(r){return typeof r=="symbol"||typeof r=="object"&&r!==null&&!(Symbol.toPrimitive in r||"toString"in r||"valueOf"in r)}function $u(r){return!y3(r)&&!isNaN(parseFloat(r))&&isFinite(r)}function Gs(r){return r*(Lt/180)}function _3(r){return r*(180/Lt)}function vy(r,e){const t=e.x-r.x,n=e.y-r.y,i=Math.sqrt(t*t+n*n);let a=Math.atan2(n,t);return a<-.5*Lt&&(a+=tr),{angle:a,distance:i}}function w3(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function hi(r){return(r%tr+tr)%tr}function Wu(r,e,t,n){const i=hi(r),a=hi(e),o=hi(t),c=hi(a-i),d=hi(o-i),f=hi(i-a),p=hi(i-o);return i===a||i===o||n&&a===o||c>d&&f<p}function jn(r,e,t){return Math.max(e,Math.min(t,r))}function b3(r){return jn(r,-32768,32767)}function ll(r,e,t,n=1e-6){return r>=Math.min(e,t)-n&&r<=Math.max(e,t)+n}function p0(r,e,t){t=t||(o=>r[o]<e);let n=r.length-1,i=0,a;for(;n-i>1;)a=i+n>>1,t(a)?i=a:n=a;return{lo:i,hi:n}}const jh=(r,e,t,n)=>p0(r,t,n?i=>{const a=r[i][e];return a<t||a===t&&r[i+1][e]===t}:i=>r[i][e]<t),S3=(r,e,t)=>p0(r,t,n=>r[n][e]>=t);function E3(r,e,t){let n=0,i=r.length;for(;n<i&&r[n]<e;)n++;for(;i>n&&r[i-1]>t;)i--;return n>0||i<r.length?r.slice(n,i):r}const yy=["push","pop","shift","splice","unshift"];function k3(r,e){if(r._chartjs){r._chartjs.listeners.push(e);return}Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),yy.forEach(t=>{const n="_onData"+h0(t),i=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value(...a){const o=i.apply(this,a);return r._chartjs.listeners.forEach(c=>{typeof c[n]=="function"&&c[n](...a)}),o}})})}function mx(r,e){const t=r._chartjs;if(!t)return;const n=t.listeners,i=n.indexOf(e);i!==-1&&n.splice(i,1),!(n.length>0)&&(yy.forEach(a=>{delete r[a]}),delete r._chartjs)}function T3(r){const e=new Set(r);return e.size===r.length?r:Array.from(e)}const _y=(function(){return typeof window>"u"?function(r){return r()}:window.requestAnimationFrame})();function wy(r,e){let t=[],n=!1;return function(...i){t=i,n||(n=!0,_y.call(window,()=>{n=!1,r.apply(e,t)}))}}function A3(r,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(r,e,n)):r.apply(this,n),e}}const by=r=>r==="start"?"left":r==="end"?"right":"center",cn=(r,e,t)=>r==="start"?e:r==="end"?t:(e+t)/2,C3=(r,e,t,n)=>r===(n?"left":"right")?t:r==="center"?(e+t)/2:e,cu=r=>r===0||r===1,gx=(r,e,t)=>-(Math.pow(2,10*(r-=1))*Math.sin((r-e)*tr/t)),xx=(r,e,t)=>Math.pow(2,-10*r)*Math.sin((r-e)*tr/t)+1,wl={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>-r*(r-2),easeInOutQuad:r=>(r/=.5)<1?.5*r*r:-.5*(--r*(r-2)-1),easeInCubic:r=>r*r*r,easeOutCubic:r=>(r-=1)*r*r+1,easeInOutCubic:r=>(r/=.5)<1?.5*r*r*r:.5*((r-=2)*r*r+2),easeInQuart:r=>r*r*r*r,easeOutQuart:r=>-((r-=1)*r*r*r-1),easeInOutQuart:r=>(r/=.5)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2),easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>(r-=1)*r*r*r*r+1,easeInOutQuint:r=>(r/=.5)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2),easeInSine:r=>-Math.cos(r*dr)+1,easeOutSine:r=>Math.sin(r*dr),easeInOutSine:r=>-.5*(Math.cos(Lt*r)-1),easeInExpo:r=>r===0?0:Math.pow(2,10*(r-1)),easeOutExpo:r=>r===1?1:-Math.pow(2,-10*r)+1,easeInOutExpo:r=>cu(r)?r:r<.5?.5*Math.pow(2,10*(r*2-1)):.5*(-Math.pow(2,-10*(r*2-1))+2),easeInCirc:r=>r>=1?r:-(Math.sqrt(1-r*r)-1),easeOutCirc:r=>Math.sqrt(1-(r-=1)*r),easeInOutCirc:r=>(r/=.5)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1),easeInElastic:r=>cu(r)?r:gx(r,.075,.3),easeOutElastic:r=>cu(r)?r:xx(r,.075,.3),easeInOutElastic(r){return cu(r)?r:r<.5?.5*gx(r*2,.1125,.45):.5+.5*xx(r*2-1,.1125,.45)},easeInBack(r){return r*r*((1.70158+1)*r-1.70158)},easeOutBack(r){return(r-=1)*r*((1.70158+1)*r+1.70158)+1},easeInOutBack(r){let e=1.70158;return(r/=.5)<1?.5*(r*r*(((e*=1.525)+1)*r-e)):.5*((r-=2)*r*(((e*=1.525)+1)*r+e)+2)},easeInBounce:r=>1-wl.easeOutBounce(1-r),easeOutBounce(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},easeInOutBounce:r=>r<.5?wl.easeInBounce(r*2)*.5:wl.easeOutBounce(r*2-1)*.5+.5};function Sy(r){if(r&&typeof r=="object"){const e=r.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function vx(r){return Sy(r)?r:new Dl(r)}function ah(r){return Sy(r)?r:new Dl(r).saturate(.5).darken(.1).hexString()}const N3=["x","y","borderWidth","radius","tension"],F3=["color","borderColor","backgroundColor"];function j3(r){r.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),r.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),r.set("animations",{colors:{type:"color",properties:F3},numbers:{type:"number",properties:N3}}),r.describe("animations",{_fallback:"animation"}),r.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function D3(r){r.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const yx=new Map;function O3(r,e){e=e||{};const t=r+JSON.stringify(e);let n=yx.get(t);return n||(n=new Intl.NumberFormat(r,e),yx.set(t,n)),n}function P3(r,e,t){return O3(e,t).format(r)}const R3={values(r){return Tr(r)?r:""+r}};var I3={formatters:R3};function L3(r){r.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:I3.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),r.route("scale.ticks","color","","color"),r.route("scale.grid","color","","borderColor"),r.route("scale.border","color","","borderColor"),r.route("scale.title","color","","color"),r.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),r.describe("scales",{_fallback:"scale"}),r.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Qs=Object.create(null),Dh=Object.create(null);function bl(r,e){if(!e)return r;const t=e.split(".");for(let n=0,i=t.length;n<i;++n){const a=t[n];r=r[a]||(r[a]=Object.create(null))}return r}function oh(r,e,t){return typeof e=="string"?Ol(bl(r,e),t):Ol(bl(r,""),e)}class M3{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>ah(i.backgroundColor),this.hoverBorderColor=(n,i)=>ah(i.borderColor),this.hoverColor=(n,i)=>ah(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return oh(this,e,t)}get(e){return bl(this,e)}describe(e,t){return oh(Dh,e,t)}override(e,t){return oh(Qs,e,t)}route(e,t,n,i){const a=bl(this,e),o=bl(this,n),c="_"+t;Object.defineProperties(a,{[c]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const d=this[c],f=o[i];return yt(d)?Object.assign({},f,d):Tt(d,f)},set(d){this[c]=d}}})}apply(e){e.forEach(t=>t(this))}}var Qt=new M3({_scriptable:r=>!r.startsWith("on"),_indexable:r=>r!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[j3,D3,L3]);function B3(r){return!r||Lr(r.size)||Lr(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family}function _x(r,e,t,n,i){let a=e[i];return a||(a=e[i]=r.measureText(i).width,t.push(i)),a>n&&(n=a),n}function Us(r,e,t){const n=r.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*n)/n+i}function wx(r,e){!e&&!r||(e=e||r.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,r.width,r.height),e.restore())}function bx(r,e,t,n){Ey(r,e,t,n,null)}function Ey(r,e,t,n,i){let a,o,c,d,f,p,g,v;const y=e.pointStyle,b=e.rotation,_=e.radius;let S=(b||0)*x3;if(y&&typeof y=="object"&&(a=y.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){r.save(),r.translate(t,n),r.rotate(S),r.drawImage(y,-y.width/2,-y.height/2,y.width,y.height),r.restore();return}if(!(isNaN(_)||_<=0)){switch(r.beginPath(),y){default:i?r.ellipse(t,n,i/2,_,0,0,tr):r.arc(t,n,_,0,tr),r.closePath();break;case"triangle":p=i?i/2:_,r.moveTo(t+Math.sin(S)*p,n-Math.cos(S)*_),S+=hx,r.lineTo(t+Math.sin(S)*p,n-Math.cos(S)*_),S+=hx,r.lineTo(t+Math.sin(S)*p,n-Math.cos(S)*_),r.closePath();break;case"rectRounded":f=_*.516,d=_-f,o=Math.cos(S+Bs)*d,g=Math.cos(S+Bs)*(i?i/2-f:d),c=Math.sin(S+Bs)*d,v=Math.sin(S+Bs)*(i?i/2-f:d),r.arc(t-g,n-c,f,S-Lt,S-dr),r.arc(t+v,n-o,f,S-dr,S),r.arc(t+g,n+c,f,S,S+dr),r.arc(t-v,n+o,f,S+dr,S+Lt),r.closePath();break;case"rect":if(!b){d=Math.SQRT1_2*_,p=i?i/2:d,r.rect(t-p,n-d,2*p,2*d);break}S+=Bs;case"rectRot":g=Math.cos(S)*(i?i/2:_),o=Math.cos(S)*_,c=Math.sin(S)*_,v=Math.sin(S)*(i?i/2:_),r.moveTo(t-g,n-c),r.lineTo(t+v,n-o),r.lineTo(t+g,n+c),r.lineTo(t-v,n+o),r.closePath();break;case"crossRot":S+=Bs;case"cross":g=Math.cos(S)*(i?i/2:_),o=Math.cos(S)*_,c=Math.sin(S)*_,v=Math.sin(S)*(i?i/2:_),r.moveTo(t-g,n-c),r.lineTo(t+g,n+c),r.moveTo(t+v,n-o),r.lineTo(t-v,n+o);break;case"star":g=Math.cos(S)*(i?i/2:_),o=Math.cos(S)*_,c=Math.sin(S)*_,v=Math.sin(S)*(i?i/2:_),r.moveTo(t-g,n-c),r.lineTo(t+g,n+c),r.moveTo(t+v,n-o),r.lineTo(t-v,n+o),S+=Bs,g=Math.cos(S)*(i?i/2:_),o=Math.cos(S)*_,c=Math.sin(S)*_,v=Math.sin(S)*(i?i/2:_),r.moveTo(t-g,n-c),r.lineTo(t+g,n+c),r.moveTo(t+v,n-o),r.lineTo(t-v,n+o);break;case"line":o=i?i/2:Math.cos(S)*_,c=Math.sin(S)*_,r.moveTo(t-o,n-c),r.lineTo(t+o,n+c);break;case"dash":r.moveTo(t,n),r.lineTo(t+Math.cos(S)*(i?i/2:_),n+Math.sin(S)*_);break;case!1:r.closePath();break}r.fill(),e.borderWidth>0&&r.stroke()}}function ky(r,e,t){return t=t||.5,!e||r&&r.x>e.left-t&&r.x<e.right+t&&r.y>e.top-t&&r.y<e.bottom+t}function m0(r,e){r.save(),r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()}function g0(r){r.restore()}function U3(r,e){e.translation&&r.translate(e.translation[0],e.translation[1]),Lr(e.rotation)||r.rotate(e.rotation),e.color&&(r.fillStyle=e.color),e.textAlign&&(r.textAlign=e.textAlign),e.textBaseline&&(r.textBaseline=e.textBaseline)}function z3(r,e,t,n,i){if(i.strikethrough||i.underline){const a=r.measureText(n),o=e-a.actualBoundingBoxLeft,c=e+a.actualBoundingBoxRight,d=t-a.actualBoundingBoxAscent,f=t+a.actualBoundingBoxDescent,p=i.strikethrough?(d+f)/2:f;r.strokeStyle=r.fillStyle,r.beginPath(),r.lineWidth=i.decorationWidth||2,r.moveTo(o,p),r.lineTo(c,p),r.stroke()}}function $3(r,e){const t=r.fillStyle;r.fillStyle=e.color,r.fillRect(e.left,e.top,e.width,e.height),r.fillStyle=t}function Hu(r,e,t,n,i,a={}){const o=Tr(e)?e:[e],c=a.strokeWidth>0&&a.strokeColor!=="";let d,f;for(r.save(),r.font=i.string,U3(r,a),d=0;d<o.length;++d)f=o[d],a.backdrop&&$3(r,a.backdrop),c&&(a.strokeColor&&(r.strokeStyle=a.strokeColor),Lr(a.strokeWidth)||(r.lineWidth=a.strokeWidth),r.strokeText(f,t,n,a.maxWidth)),r.fillText(f,t,n,a.maxWidth),z3(r,t,n,f,a),n+=Number(i.lineHeight);r.restore()}function Oh(r,e){const{x:t,y:n,w:i,h:a,radius:o}=e;r.arc(t+o.topLeft,n+o.topLeft,o.topLeft,1.5*Lt,Lt,!0),r.lineTo(t,n+a-o.bottomLeft),r.arc(t+o.bottomLeft,n+a-o.bottomLeft,o.bottomLeft,Lt,dr,!0),r.lineTo(t+i-o.bottomRight,n+a),r.arc(t+i-o.bottomRight,n+a-o.bottomRight,o.bottomRight,dr,0,!0),r.lineTo(t+i,n+o.topRight),r.arc(t+i-o.topRight,n+o.topRight,o.topRight,0,-dr,!0),r.lineTo(t+o.topLeft,n)}const W3=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,H3=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function V3(r,e){const t=(""+r).match(W3);if(!t||t[1]==="normal")return e*1.2;switch(r=+t[2],t[3]){case"px":return r;case"%":r/=100;break}return e*r}const G3=r=>+r||0;function x0(r,e){const t={},n=yt(e),i=n?Object.keys(e):e,a=yt(r)?n?o=>Tt(r[o],r[e[o]]):o=>r[o]:()=>r;for(const o of i)t[o]=G3(a(o));return t}function K3(r){return x0(r,{top:"y",right:"x",bottom:"y",left:"x"})}function Sl(r){return x0(r,["topLeft","topRight","bottomLeft","bottomRight"])}function Zn(r){const e=K3(r);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Zr(r,e){r=r||{},e=e||Qt.font;let t=Tt(r.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=Tt(r.style,e.style);n&&!(""+n).match(H3)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:Tt(r.family,e.family),lineHeight:V3(Tt(r.lineHeight,e.lineHeight),t),size:t,style:n,weight:Tt(r.weight,e.weight),string:""};return i.string=B3(i),i}function uu(r,e,t,n){let i,a,o;for(i=0,a=r.length;i<a;++i)if(o=r[i],o!==void 0&&o!==void 0)return o}function q3(r,e,t){const{min:n,max:i}=r,a=gy(e,(i-n)/2),o=(c,d)=>t&&c===0?0:c+d;return{min:o(n,-Math.abs(a)),max:o(i,a)}}function mo(r,e){return Object.assign(Object.create(r),e)}function v0(r,e=[""],t,n,i=()=>r[0]){const a=t||r;typeof n>"u"&&(n=Ny("_fallback",r));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:r,_rootScopes:a,_fallback:n,_getTarget:i,override:c=>v0([c,...r],e,a,n)};return new Proxy(o,{deleteProperty(c,d){return delete c[d],delete c._keys,delete r[0][d],!0},get(c,d){return Ay(c,d,()=>r5(d,e,r,c))},getOwnPropertyDescriptor(c,d){return Reflect.getOwnPropertyDescriptor(c._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(r[0])},has(c,d){return Ex(c).includes(d)},ownKeys(c){return Ex(c)},set(c,d,f){const p=c._storage||(c._storage=i());return c[d]=p[d]=f,delete c._keys,!0}})}function lo(r,e,t,n){const i={_cacheable:!1,_proxy:r,_context:e,_subProxy:t,_stack:new Set,_descriptors:Ty(r,n),setContext:a=>lo(r,a,t,n),override:a=>lo(r.override(a),e,t,n)};return new Proxy(i,{deleteProperty(a,o){return delete a[o],delete r[o],!0},get(a,o,c){return Ay(a,o,()=>Y3(a,o,c))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(r,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(r,o)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},has(a,o){return Reflect.has(r,o)},ownKeys(){return Reflect.ownKeys(r)},set(a,o,c){return r[o]=c,delete a[o],!0}})}function Ty(r,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:i=e.allKeys}=r;return{allKeys:i,scriptable:t,indexable:n,isScriptable:ws(t)?t:()=>t,isIndexable:ws(n)?n:()=>n}}const X3=(r,e)=>r?r+h0(e):e,y0=(r,e)=>yt(e)&&r!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Ay(r,e,t){if(Object.prototype.hasOwnProperty.call(r,e)||e==="constructor")return r[e];const n=t();return r[e]=n,n}function Y3(r,e,t){const{_proxy:n,_context:i,_subProxy:a,_descriptors:o}=r;let c=n[e];return ws(c)&&o.isScriptable(e)&&(c=J3(e,c,r,t)),Tr(c)&&c.length&&(c=Q3(e,c,r,o.isIndexable)),y0(e,c)&&(c=lo(c,i,a&&a[e],o)),c}function J3(r,e,t,n){const{_proxy:i,_context:a,_subProxy:o,_stack:c}=t;if(c.has(r))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+r);c.add(r);let d=e(a,o||n);return c.delete(r),y0(r,d)&&(d=_0(i._scopes,i,r,d)),d}function Q3(r,e,t,n){const{_proxy:i,_context:a,_subProxy:o,_descriptors:c}=t;if(typeof a.index<"u"&&n(r))return e[a.index%e.length];if(yt(e[0])){const d=e,f=i._scopes.filter(p=>p!==d);e=[];for(const p of d){const g=_0(f,i,r,p);e.push(lo(g,a,o&&o[r],c))}}return e}function Cy(r,e,t){return ws(r)?r(e,t):r}const Z3=(r,e)=>r===!0?e:typeof r=="string"?Pl(e,r):void 0;function e5(r,e,t,n,i){for(const a of e){const o=Z3(t,a);if(o){r.add(o);const c=Cy(o._fallback,t,i);if(typeof c<"u"&&c!==t&&c!==n)return c}else if(o===!1&&typeof n<"u"&&t!==n)return null}return!1}function _0(r,e,t,n){const i=e._rootScopes,a=Cy(e._fallback,t,n),o=[...r,...i],c=new Set;c.add(n);let d=Sx(c,o,t,a||t,n);return d===null||typeof a<"u"&&a!==t&&(d=Sx(c,o,a,d,n),d===null)?!1:v0(Array.from(c),[""],i,a,()=>t5(e,t,n))}function Sx(r,e,t,n,i){for(;t;)t=e5(r,e,t,n,i);return t}function t5(r,e,t){const n=r._getTarget();e in n||(n[e]={});const i=n[e];return Tr(i)&&yt(t)?t:i||{}}function r5(r,e,t,n){let i;for(const a of e)if(i=Ny(X3(a,r),t),typeof i<"u")return y0(r,i)?_0(t,n,r,i):i}function Ny(r,e){for(const t of e){if(!t)continue;const n=t[r];if(typeof n<"u")return n}}function Ex(r){let e=r._keys;return e||(e=r._keys=n5(r._scopes)),e}function n5(r){const e=new Set;for(const t of r)for(const n of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(n);return Array.from(e)}function w0(){return typeof window<"u"&&typeof document<"u"}function b0(r){let e=r.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Vu(r,e,t){let n;return typeof r=="string"?(n=parseInt(r,10),r.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=r,n}const nd=r=>r.ownerDocument.defaultView.getComputedStyle(r,null);function i5(r,e){return nd(r).getPropertyValue(e)}const s5=["top","right","bottom","left"];function qs(r,e,t){const n={};t=t?"-"+t:"";for(let i=0;i<4;i++){const a=s5[i];n[a]=parseFloat(r[e+"-"+a+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const a5=(r,e,t)=>(r>0||e>0)&&(!t||!t.shadowRoot);function o5(r,e){const t=r.touches,n=t&&t.length?t[0]:r,{offsetX:i,offsetY:a}=n;let o=!1,c,d;if(a5(i,a,r.target))c=i,d=a;else{const f=e.getBoundingClientRect();c=n.clientX-f.left,d=n.clientY-f.top,o=!0}return{x:c,y:d,box:o}}function Ws(r,e){if("native"in r)return r;const{canvas:t,currentDevicePixelRatio:n}=e,i=nd(t),a=i.boxSizing==="border-box",o=qs(i,"padding"),c=qs(i,"border","width"),{x:d,y:f,box:p}=o5(r,t),g=o.left+(p&&c.left),v=o.top+(p&&c.top);let{width:y,height:b}=e;return a&&(y-=o.width+c.width,b-=o.height+c.height),{x:Math.round((d-g)/y*t.width/n),y:Math.round((f-v)/b*t.height/n)}}function l5(r,e,t){let n,i;if(e===void 0||t===void 0){const a=r&&b0(r);if(!a)e=r.clientWidth,t=r.clientHeight;else{const o=a.getBoundingClientRect(),c=nd(a),d=qs(c,"border","width"),f=qs(c,"padding");e=o.width-f.width-d.width,t=o.height-f.height-d.height,n=Vu(c.maxWidth,a,"clientWidth"),i=Vu(c.maxHeight,a,"clientHeight")}}return{width:e,height:t,maxWidth:n||zu,maxHeight:i||zu}}const du=r=>Math.round(r*10)/10;function c5(r,e,t,n){const i=nd(r),a=qs(i,"margin"),o=Vu(i.maxWidth,r,"clientWidth")||zu,c=Vu(i.maxHeight,r,"clientHeight")||zu,d=l5(r,e,t);let{width:f,height:p}=d;if(i.boxSizing==="content-box"){const v=qs(i,"border","width"),y=qs(i,"padding");f-=y.width+v.width,p-=y.height+v.height}return f=Math.max(0,f-a.width),p=Math.max(0,n?f/n:p-a.height),f=du(Math.min(f,o,d.maxWidth)),p=du(Math.min(p,c,d.maxHeight)),f&&!p&&(p=du(f/2)),(e!==void 0||t!==void 0)&&n&&d.height&&p>d.height&&(p=d.height,f=du(Math.floor(p*n))),{width:f,height:p}}function kx(r,e,t){const n=e||1,i=Math.floor(r.height*n),a=Math.floor(r.width*n);r.height=Math.floor(r.height),r.width=Math.floor(r.width);const o=r.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${r.height}px`,o.style.width=`${r.width}px`),r.currentDevicePixelRatio!==n||o.height!==i||o.width!==a?(r.currentDevicePixelRatio=n,o.height=i,o.width=a,r.ctx.setTransform(n,0,0,n,0,0),!0):!1}const u5=(function(){let r=!1;try{const e={get passive(){return r=!0,!1}};w0()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return r})();function Tx(r,e){const t=i5(r,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}const d5=function(r,e){return{x(t){return r+r+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},f5=function(){return{x(r){return r},setWidth(r){},textAlign(r){return r},xPlus(r,e){return r+e},leftForLtr(r,e){return r}}};function so(r,e,t){return r?d5(e,t):f5()}function Fy(r,e){let t,n;(e==="ltr"||e==="rtl")&&(t=r.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),r.prevTextDirection=n)}function jy(r,e){e!==void 0&&(delete r.prevTextDirection,r.canvas.style.setProperty("direction",e[0],e[1]))}function fu(r,e,t){return r.options.clip?r[t]:e[t]}function h5(r,e){const{xScale:t,yScale:n}=r;return t&&n?{left:fu(t,e,"left"),right:fu(t,e,"right"),top:fu(n,e,"top"),bottom:fu(n,e,"bottom")}:e}function p5(r,e){const t=e._clip;if(t.disabled)return!1;const n=h5(e,r.chartArea);return{left:t.left===!1?0:n.left-(t.left===!0?0:t.left),right:t.right===!1?r.width:n.right+(t.right===!0?0:t.right),top:t.top===!1?0:n.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?r.height:n.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class m5{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const a=t.listeners[i],o=t.duration;a.forEach(c=>c({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=_y.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const a=n.items;let o=a.length-1,c=!1,d;for(;o>=0;--o)d=a[o],d._active?(d._total>n.duration&&(n.duration=d._total),d.tick(e),c=!0):(a[o]=a[a.length-1],a.pop());c&&(i.draw(),this._notify(i,n,e,"progress")),a.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),t+=a.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Ci=new m5;const Ax="transparent",g5={boolean(r,e,t){return t>.5?e:r},color(r,e,t){const n=vx(r||Ax),i=n.valid&&vx(e||Ax);return i&&i.valid?i.mix(n,t).hexString():e},number(r,e,t){return r+(e-r)*t}};class x5{constructor(e,t,n,i){const a=t[n];i=uu([e.to,i,a,e.from]);const o=uu([e.from,a,i]);this._active=!0,this._fn=e.fn||g5[e.type||typeof o],this._easing=wl[e.easing]||wl.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const i=this._target[this._prop],a=n-this._start,o=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=uu([e.to,t,i,e.from]),this._from=uu([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,i=this._prop,a=this._from,o=this._loop,c=this._to;let d;if(this._active=a!==c&&(o||t<n),!this._active){this._target[i]=c,this._notify(!0);return}if(t<0){this._target[i]=a;return}d=t/n%2,d=o&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[i]=this._fn(a,c,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][t]()}}class Dy{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!yt(e))return;const t=Object.keys(Qt.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const a=e[i];if(!yt(a))return;const o={};for(const c of t)o[c]=a[c];(Tr(a.properties)&&a.properties||[i]).forEach(c=>{(c===i||!n.has(c))&&n.set(c,o)})})}_animateOptions(e,t){const n=t.options,i=y5(e,n);if(!i)return[];const a=this._createAnimations(i,n);return n.$shared&&v5(e.options.$animations,n).then(()=>{e.options=n},()=>{}),a}_createAnimations(e,t){const n=this._properties,i=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),c=Date.now();let d;for(d=o.length-1;d>=0;--d){const f=o[d];if(f.charAt(0)==="$")continue;if(f==="options"){i.push(...this._animateOptions(e,t));continue}const p=t[f];let g=a[f];const v=n.get(f);if(g)if(v&&g.active()){g.update(v,p,c);continue}else g.cancel();if(!v||!v.duration){e[f]=p;continue}a[f]=g=new x5(v,e,f,p),i.push(g)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return Ci.add(this._chart,n),!0}}function v5(r,e){const t=[],n=Object.keys(e);for(let i=0;i<n.length;i++){const a=r[n[i]];a&&a.active()&&t.push(a.wait())}return Promise.all(t)}function y5(r,e){if(!e)return;let t=r.options;if(!t){r.options=e;return}return t.$shared&&(r.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function Cx(r,e){const t=r&&r.options||{},n=t.reverse,i=t.min===void 0?e:0,a=t.max===void 0?e:0;return{start:n?a:i,end:n?i:a}}function _5(r,e,t){if(t===!1)return!1;const n=Cx(r,t),i=Cx(e,t);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function w5(r){let e,t,n,i;return yt(r)?(e=r.top,t=r.right,n=r.bottom,i=r.left):e=t=n=i=r,{top:e,right:t,bottom:n,left:i,disabled:r===!1}}function Oy(r,e){const t=[],n=r._getSortedDatasetMetas(e);let i,a;for(i=0,a=n.length;i<a;++i)t.push(n[i].index);return t}function Nx(r,e,t,n={}){const i=r.keys,a=n.mode==="single";let o,c,d,f;if(e===null)return;let p=!1;for(o=0,c=i.length;o<c;++o){if(d=+i[o],d===t){if(p=!0,n.all)continue;break}f=r.values[d],Li(f)&&(a||e===0||px(e)===px(f))&&(e+=f)}return!p&&!n.all?0:e}function b5(r,e){const{iScale:t,vScale:n}=e,i=t.axis==="x"?"x":"y",a=n.axis==="x"?"x":"y",o=Object.keys(r),c=new Array(o.length);let d,f,p;for(d=0,f=o.length;d<f;++d)p=o[d],c[d]={[i]:p,[a]:r[p]};return c}function lh(r,e){const t=r&&r.options.stacked;return t||t===void 0&&e.stack!==void 0}function S5(r,e,t){return`${r.id}.${e.id}.${t.stack||t.type}`}function E5(r){const{min:e,max:t,minDefined:n,maxDefined:i}=r.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function k5(r,e,t){const n=r[e]||(r[e]={});return n[t]||(n[t]={})}function Fx(r,e,t,n){for(const i of e.getMatchingVisibleMetas(n).reverse()){const a=r[i.index];if(t&&a>0||!t&&a<0)return i.index}return null}function jx(r,e){const{chart:t,_cachedMeta:n}=r,i=t._stacks||(t._stacks={}),{iScale:a,vScale:o,index:c}=n,d=a.axis,f=o.axis,p=S5(a,o,n),g=e.length;let v;for(let y=0;y<g;++y){const b=e[y],{[d]:_,[f]:S}=b,A=b._stacks||(b._stacks={});v=A[f]=k5(i,p,_),v[c]=S,v._top=Fx(v,o,!0,n.type),v._bottom=Fx(v,o,!1,n.type);const C=v._visualValues||(v._visualValues={});C[c]=S}}function ch(r,e){const t=r.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function T5(r,e){return mo(r,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function A5(r,e,t){return mo(r,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Zo(r,e){const t=r.controller.index,n=r.vScale&&r.vScale.axis;if(n){e=e||r._parsed;for(const i of e){const a=i._stacks;if(!a||a[n]===void 0||a[n][t]===void 0)return;delete a[n][t],a[n]._visualValues!==void 0&&a[n]._visualValues[t]!==void 0&&delete a[n]._visualValues[t]}}}const uh=r=>r==="reset"||r==="none",Dx=(r,e)=>e?r:Object.assign({},r),C5=(r,e,t)=>r&&!e.hidden&&e._stacked&&{keys:Oy(t,!0),values:null};class Py{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=lh(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Zo(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),i=(g,v,y,b)=>g==="x"?v:g==="r"?b:y,a=t.xAxisID=Tt(n.xAxisID,ch(e,"x")),o=t.yAxisID=Tt(n.yAxisID,ch(e,"y")),c=t.rAxisID=Tt(n.rAxisID,ch(e,"r")),d=t.indexAxis,f=t.iAxisID=i(d,a,o,c),p=t.vAxisID=i(d,o,a,c);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(c),t.iScale=this.getScaleForId(f),t.vScale=this.getScaleForId(p)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&mx(this._data,this),e._stacked&&Zo(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(yt(t)){const i=this._cachedMeta;this._data=b5(t,i)}else if(n!==t){if(n){mx(n,this);const i=this._cachedMeta;Zo(i),i._parsed=[]}t&&Object.isExtensible(t)&&k3(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const a=t._stacked;t._stacked=lh(t.vScale,t),t.stack!==n.stack&&(i=!0,Zo(t),t.stack=n.stack),this._resyncElements(e),(i||a!==t._stacked)&&(jx(this,t._parsed),t._stacked=lh(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:i}=this,{iScale:a,_stacked:o}=n,c=a.axis;let d=e===0&&t===i.length?!0:n._sorted,f=e>0&&n._parsed[e-1],p,g,v;if(this._parsing===!1)n._parsed=i,n._sorted=!0,v=i;else{Tr(i[e])?v=this.parseArrayData(n,i,e,t):yt(i[e])?v=this.parseObjectData(n,i,e,t):v=this.parsePrimitiveData(n,i,e,t);const y=()=>g[c]===null||f&&g[c]<f[c];for(p=0;p<t;++p)n._parsed[p+e]=g=v[p],d&&(y()&&(d=!1),f=g);n._sorted=d}o&&jx(this,v)}parsePrimitiveData(e,t,n,i){const{iScale:a,vScale:o}=e,c=a.axis,d=o.axis,f=a.getLabels(),p=a===o,g=new Array(i);let v,y,b;for(v=0,y=i;v<y;++v)b=v+n,g[v]={[c]:p||a.parse(f[b],b),[d]:o.parse(t[b],b)};return g}parseArrayData(e,t,n,i){const{xScale:a,yScale:o}=e,c=new Array(i);let d,f,p,g;for(d=0,f=i;d<f;++d)p=d+n,g=t[p],c[d]={x:a.parse(g[0],p),y:o.parse(g[1],p)};return c}parseObjectData(e,t,n,i){const{xScale:a,yScale:o}=e,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,f=new Array(i);let p,g,v,y;for(p=0,g=i;p<g;++p)v=p+n,y=t[v],f[p]={x:a.parse(Pl(y,c),v),y:o.parse(Pl(y,d),v)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,a=this._cachedMeta,o=t[e.axis],c={keys:Oy(i,!0),values:t._stacks[e.axis]._visualValues};return Nx(c,o,a.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const a=n[t.axis];let o=a===null?NaN:a;const c=i&&n._stacks[t.axis];i&&c&&(i.values=c,o=Nx(i,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const n=this._cachedMeta,i=n._parsed,a=n._sorted&&e===n.iScale,o=i.length,c=this._getOtherScale(e),d=C5(t,n,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:p,max:g}=E5(c);let v,y;function b(){y=i[v];const _=y[c.axis];return!Li(y[e.axis])||p>_||g<_}for(v=0;v<o&&!(!b()&&(this.updateRangeFromParsed(f,e,y,d),a));++v);if(a){for(v=o-1;v>=0;--v)if(!b()){this.updateRangeFromParsed(f,e,y,d);break}}return f}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,a,o;for(i=0,a=t.length;i<a;++i)o=t[i][e.axis],Li(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,a=this.getParsed(e);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:i?""+i.getLabelForValue(a[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=w5(Tt(this.options.clip,_5(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,i=n.data||[],a=t.chartArea,o=[],c=this._drawStart||0,d=this._drawCount||i.length-c,f=this.options.drawActiveElementsOnTop;let p;for(n.dataset&&n.dataset.draw(e,a,c,d),p=c;p<c+d;++p){const g=i[p];g.hidden||(g.active&&f?o.push(g):g.draw(e,a))}for(p=0;p<o.length;++p)o[p].draw(e,a)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=A5(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=i.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=T5(this.chart.getContext(),this.index)),a.dataset=i,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=n,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const i=t==="active",a=this._cachedDataOpts,o=e+"-"+t,c=a[o],d=this.enableOptionSharing&&Uu(n);if(c)return Dx(c,d);const f=this.chart.config,p=f.datasetElementScopeKeys(this._type,e),g=i?[`${e}Hover`,"hover",e,""]:[e,""],v=f.getOptionScopes(this.getDataset(),p),y=Object.keys(Qt.elements[e]),b=()=>this.getContext(n,i,t),_=f.resolveNamedOptions(v,y,b,g);return _.$shared&&(_.$shared=d,a[o]=Object.freeze(Dx(_,d))),_}_resolveAnimations(e,t,n){const i=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,c=a[o];if(c)return c;let d;if(i.options.animation!==!1){const p=this.chart.config,g=p.datasetAnimationScopeKeys(this._type,t),v=p.getOptionScopes(this.getDataset(),g);d=p.createResolver(v,this.getContext(e,n,t))}const f=new Dy(i,d&&d.animations);return d&&d._cacheable&&(a[o]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||uh(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),i=this._sharedOptions,a=this.getSharedOptions(n),o=this.includeOptions(t,a)||a!==i;return this.updateSharedOptions(a,t,n),{sharedOptions:a,includeOptions:o}}updateElement(e,t,n,i){uh(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!uh(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const a=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[c,d,f]of this._syncList)this[c](d,f);this._syncList=[];const i=n.length,a=t.length,o=Math.min(a,i);o&&this.parse(0,o),a>i?this._insertElements(i,a-i,e):a<i&&this._removeElements(a,i-a)}_insertElements(e,t,n=!0){const i=this._cachedMeta,a=i.data,o=e+t;let c;const d=f=>{for(f.length+=t,c=f.length-1;c>=o;c--)f[c]=f[c-t]};for(d(a),c=e;c<o;++c)a[c]=new this.dataElementType;this._parsing&&d(i._parsed),this.parse(e,t),n&&this.updateElements(a,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&Zo(n,i)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,i]=e;this[t](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function N5(r,e,t){let n=1,i=1,a=0,o=0;if(e<tr){const c=r,d=c+e,f=Math.cos(c),p=Math.sin(c),g=Math.cos(d),v=Math.sin(d),y=(T,P,z)=>Wu(T,c,d,!0)?1:Math.max(P,P*t,z,z*t),b=(T,P,z)=>Wu(T,c,d,!0)?-1:Math.min(P,P*t,z,z*t),_=y(0,f,g),S=y(dr,p,v),A=b(Lt,f,g),C=b(Lt+dr,p,v);n=(_-A)/2,i=(S-C)/2,a=-(_+A)/2,o=-(S+C)/2}return{ratioX:n,ratioY:i,offsetX:a,offsetY:o}}class F5 extends Py{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:i}}=e.legend.options;return t.labels.map((a,o)=>{const d=e.getDatasetMeta(0).controller.getStyle(o);return{text:a,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:i,lineWidth:d.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let a=d=>+n[d];if(yt(n[e])){const{key:d="value"}=this._parsing;a=f=>+Pl(n[f],d)}let o,c;for(o=e,c=e+t;o<c;++o)i._parsed[o]=a(o)}}_getRotation(){return Gs(this.options.rotation-90)}_getCircumference(){return Gs(this.options.circumference)}_getRotationExtents(){let e=tr,t=-tr;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,a=i._getRotation(),o=i._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,i=this._cachedMeta,a=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,c=Math.max((Math.min(n.width,n.height)-o)/2,0),d=Math.min(d3(this.options.cutout,c),1),f=this._getRingWeight(this.index),{circumference:p,rotation:g}=this._getRotationExtents(),{ratioX:v,ratioY:y,offsetX:b,offsetY:_}=N5(g,p,d),S=(n.width-o)/v,A=(n.height-o)/y,C=Math.max(Math.min(S,A)/2,0),T=gy(this.options.radius,C),P=Math.max(T*d,0),z=(T-P)/this._getVisibleDatasetWeightTotal();this.offsetX=b*T,this.offsetY=_*T,i.total=this.calculateTotal(),this.outerRadius=T-z*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-z*f,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const n=this.options,i=this._cachedMeta,a=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*a/tr)}updateElements(e,t,n,i){const a=i==="reset",o=this.chart,c=o.chartArea,f=o.options.animation,p=(c.left+c.right)/2,g=(c.top+c.bottom)/2,v=a&&f.animateScale,y=v?0:this.innerRadius,b=v?0:this.outerRadius,{sharedOptions:_,includeOptions:S}=this._getSharedOptions(t,i);let A=this._getRotation(),C;for(C=0;C<t;++C)A+=this._circumference(C,a);for(C=t;C<t+n;++C){const T=this._circumference(C,a),P=e[C],z={x:p+this.offsetX,y:g+this.offsetY,startAngle:A,endAngle:A+T,circumference:T,outerRadius:b,innerRadius:y};S&&(z.options=_||this.resolveDataElementOptions(C,P.active?"active":i)),A+=T,this.updateElement(P,C,z,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n=0,i;for(i=0;i<t.length;i++){const a=e._parsed[i];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(n+=Math.abs(a))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?tr*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],a=P3(t._parsed[e],n.options.locale);return{label:i[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const n=this.chart;let i,a,o,c,d;if(!e){for(i=0,a=n.data.datasets.length;i<a;++i)if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i),e=o.data,c=o.controller;break}}if(!e)return 0;for(i=0,a=e.length;i<a;++i)d=c.resolveDataElementOptions(i),d.borderAlign!=="inner"&&(t=Math.max(t,d.borderWidth||0,d.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const a=this.resolveDataElementOptions(n);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Tt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}function zs(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class S0{static override(e){Object.assign(S0.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return zs()}parse(){return zs()}format(){return zs()}add(){return zs()}diff(){return zs()}startOf(){return zs()}endOf(){return zs()}}var j5={_date:S0};function D5(r,e,t,n){const{controller:i,data:a,_sorted:o}=r,c=i._cachedMeta.iScale,d=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null;if(c&&e===c.axis&&e!=="r"&&o&&a.length){const f=c._reversePixels?S3:jh;if(n){if(i._sharedOptions){const p=a[0],g=typeof p.getRange=="function"&&p.getRange(e);if(g){const v=f(a,e,t-g),y=f(a,e,t+g);return{lo:v.lo,hi:y.hi}}}}else{const p=f(a,e,t);if(d){const{vScale:g}=i._cachedMeta,{_parsed:v}=r,y=v.slice(0,p.lo+1).reverse().findIndex(_=>!Lr(_[g.axis]));p.lo-=Math.max(0,y);const b=v.slice(p.hi).findIndex(_=>!Lr(_[g.axis]));p.hi+=Math.max(0,b)}return p}}return{lo:0,hi:a.length-1}}function id(r,e,t,n,i){const a=r.getSortedVisibleDatasetMetas(),o=t[e];for(let c=0,d=a.length;c<d;++c){const{index:f,data:p}=a[c],{lo:g,hi:v}=D5(a[c],e,o,i);for(let y=g;y<=v;++y){const b=p[y];b.skip||n(b,f,y)}}}function O5(r){const e=r.indexOf("x")!==-1,t=r.indexOf("y")!==-1;return function(n,i){const a=e?Math.abs(n.x-i.x):0,o=t?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function dh(r,e,t,n,i){const a=[];return!i&&!r.isPointInArea(e)||id(r,t,e,function(c,d,f){!i&&!ky(c,r.chartArea,0)||c.inRange(e.x,e.y,n)&&a.push({element:c,datasetIndex:d,index:f})},!0),a}function P5(r,e,t,n){let i=[];function a(o,c,d){const{startAngle:f,endAngle:p}=o.getProps(["startAngle","endAngle"],n),{angle:g}=vy(o,{x:e.x,y:e.y});Wu(g,f,p)&&i.push({element:o,datasetIndex:c,index:d})}return id(r,t,e,a),i}function R5(r,e,t,n,i,a){let o=[];const c=O5(t);let d=Number.POSITIVE_INFINITY;function f(p,g,v){const y=p.inRange(e.x,e.y,i);if(n&&!y)return;const b=p.getCenterPoint(i);if(!(!!a||r.isPointInArea(b))&&!y)return;const S=c(e,b);S<d?(o=[{element:p,datasetIndex:g,index:v}],d=S):S===d&&o.push({element:p,datasetIndex:g,index:v})}return id(r,t,e,f),o}function fh(r,e,t,n,i,a){return!a&&!r.isPointInArea(e)?[]:t==="r"&&!n?P5(r,e,t,i):R5(r,e,t,n,i,a)}function Ox(r,e,t,n,i){const a=[],o=t==="x"?"inXRange":"inYRange";let c=!1;return id(r,t,e,(d,f,p)=>{d[o]&&d[o](e[t],i)&&(a.push({element:d,datasetIndex:f,index:p}),c=c||d.inRange(e.x,e.y,i))}),n&&!c?[]:a}var I5={modes:{index(r,e,t,n){const i=Ws(e,r),a=t.axis||"x",o=t.includeInvisible||!1,c=t.intersect?dh(r,i,a,n,o):fh(r,i,a,!1,n,o),d=[];return c.length?(r.getSortedVisibleDatasetMetas().forEach(f=>{const p=c[0].index,g=f.data[p];g&&!g.skip&&d.push({element:g,datasetIndex:f.index,index:p})}),d):[]},dataset(r,e,t,n){const i=Ws(e,r),a=t.axis||"xy",o=t.includeInvisible||!1;let c=t.intersect?dh(r,i,a,n,o):fh(r,i,a,!1,n,o);if(c.length>0){const d=c[0].datasetIndex,f=r.getDatasetMeta(d).data;c=[];for(let p=0;p<f.length;++p)c.push({element:f[p],datasetIndex:d,index:p})}return c},point(r,e,t,n){const i=Ws(e,r),a=t.axis||"xy",o=t.includeInvisible||!1;return dh(r,i,a,n,o)},nearest(r,e,t,n){const i=Ws(e,r),a=t.axis||"xy",o=t.includeInvisible||!1;return fh(r,i,a,t.intersect,n,o)},x(r,e,t,n){const i=Ws(e,r);return Ox(r,i,"x",t.intersect,n)},y(r,e,t,n){const i=Ws(e,r);return Ox(r,i,"y",t.intersect,n)}}};const Ry=["left","top","right","bottom"];function el(r,e){return r.filter(t=>t.pos===e)}function Px(r,e){return r.filter(t=>Ry.indexOf(t.pos)===-1&&t.box.axis===e)}function tl(r,e){return r.sort((t,n)=>{const i=e?n:t,a=e?t:n;return i.weight===a.weight?i.index-a.index:i.weight-a.weight})}function L5(r){const e=[];let t,n,i,a,o,c;for(t=0,n=(r||[]).length;t<n;++t)i=r[t],{position:a,options:{stack:o,stackWeight:c=1}}=i,e.push({index:t,box:i,pos:a,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&a+o,stackWeight:c});return e}function M5(r){const e={};for(const t of r){const{stack:n,pos:i,stackWeight:a}=t;if(!n||!Ry.includes(i))continue;const o=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function B5(r,e){const t=M5(r),{vBoxMaxWidth:n,hBoxMaxHeight:i}=e;let a,o,c;for(a=0,o=r.length;a<o;++a){c=r[a];const{fullSize:d}=c.box,f=t[c.stack],p=f&&c.stackWeight/f.weight;c.horizontal?(c.width=p?p*n:d&&e.availableWidth,c.height=i):(c.width=n,c.height=p?p*i:d&&e.availableHeight)}return t}function U5(r){const e=L5(r),t=tl(e.filter(f=>f.box.fullSize),!0),n=tl(el(e,"left"),!0),i=tl(el(e,"right")),a=tl(el(e,"top"),!0),o=tl(el(e,"bottom")),c=Px(e,"x"),d=Px(e,"y");return{fullSize:t,leftAndTop:n.concat(a),rightAndBottom:i.concat(d).concat(o).concat(c),chartArea:el(e,"chartArea"),vertical:n.concat(i).concat(d),horizontal:a.concat(o).concat(c)}}function Rx(r,e,t,n){return Math.max(r[t],e[t])+Math.max(r[n],e[n])}function Iy(r,e){r.top=Math.max(r.top,e.top),r.left=Math.max(r.left,e.left),r.bottom=Math.max(r.bottom,e.bottom),r.right=Math.max(r.right,e.right)}function z5(r,e,t,n){const{pos:i,box:a}=t,o=r.maxPadding;if(!yt(i)){t.size&&(r[i]-=t.size);const g=n[t.stack]||{size:0,count:1};g.size=Math.max(g.size,t.horizontal?a.height:a.width),t.size=g.size/g.count,r[i]+=t.size}a.getPadding&&Iy(o,a.getPadding());const c=Math.max(0,e.outerWidth-Rx(o,r,"left","right")),d=Math.max(0,e.outerHeight-Rx(o,r,"top","bottom")),f=c!==r.w,p=d!==r.h;return r.w=c,r.h=d,t.horizontal?{same:f,other:p}:{same:p,other:f}}function $5(r){const e=r.maxPadding;function t(n){const i=Math.max(e[n]-r[n],0);return r[n]+=i,i}r.y+=t("top"),r.x+=t("left"),t("right"),t("bottom")}function W5(r,e){const t=e.maxPadding;function n(i){const a={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{a[o]=Math.max(e[o],t[o])}),a}return n(r?["left","right"]:["top","bottom"])}function cl(r,e,t,n){const i=[];let a,o,c,d,f,p;for(a=0,o=r.length,f=0;a<o;++a){c=r[a],d=c.box,d.update(c.width||e.w,c.height||e.h,W5(c.horizontal,e));const{same:g,other:v}=z5(e,t,c,n);f|=g&&i.length,p=p||v,d.fullSize||i.push(c)}return f&&cl(i,e,t,n)||p}function hu(r,e,t,n,i){r.top=t,r.left=e,r.right=e+n,r.bottom=t+i,r.width=n,r.height=i}function Ix(r,e,t,n){const i=t.padding;let{x:a,y:o}=e;for(const c of r){const d=c.box,f=n[c.stack]||{placed:0,weight:1},p=c.stackWeight/f.weight||1;if(c.horizontal){const g=e.w*p,v=f.size||d.height;Uu(f.start)&&(o=f.start),d.fullSize?hu(d,i.left,o,t.outerWidth-i.right-i.left,v):hu(d,e.left+f.placed,o,g,v),f.start=o,f.placed+=g,o=d.bottom}else{const g=e.h*p,v=f.size||d.width;Uu(f.start)&&(a=f.start),d.fullSize?hu(d,a,i.top,v,t.outerHeight-i.bottom-i.top):hu(d,a,e.top+f.placed,v,g),f.start=a,f.placed+=g,a=d.right}}e.x=a,e.y=o}var gs={addBox(r,e){r.boxes||(r.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},r.boxes.push(e)},removeBox(r,e){const t=r.boxes?r.boxes.indexOf(e):-1;t!==-1&&r.boxes.splice(t,1)},configure(r,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(r,e,t,n){if(!r)return;const i=Zn(r.options.layout.padding),a=Math.max(e-i.width,0),o=Math.max(t-i.height,0),c=U5(r.boxes),d=c.vertical,f=c.horizontal;kt(r.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});const p=d.reduce((_,S)=>S.box.options&&S.box.options.display===!1?_:_+1,0)||1,g=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/p,hBoxMaxHeight:o/2}),v=Object.assign({},i);Iy(v,Zn(n));const y=Object.assign({maxPadding:v,w:a,h:o,x:i.left,y:i.top},i),b=B5(d.concat(f),g);cl(c.fullSize,y,g,b),cl(d,y,g,b),cl(f,y,g,b)&&cl(d,y,g,b),$5(y),Ix(c.leftAndTop,y,g,b),y.x+=y.w,y.y+=y.h,Ix(c.rightAndBottom,y,g,b),r.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},kt(c.chartArea,_=>{const S=_.box;Object.assign(S,r.chartArea),S.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class Ly{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}updateConfig(e){}}class H5 extends Ly{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const yu="$chartjs",V5={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Lx=r=>r===null||r==="";function G5(r,e){const t=r.style,n=r.getAttribute("height"),i=r.getAttribute("width");if(r[yu]={initial:{height:n,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Lx(i)){const a=Tx(r,"width");a!==void 0&&(r.width=a)}if(Lx(n))if(r.style.height==="")r.height=r.width/(e||2);else{const a=Tx(r,"height");a!==void 0&&(r.height=a)}return r}const My=u5?{passive:!0}:!1;function K5(r,e,t){r&&r.addEventListener(e,t,My)}function q5(r,e,t){r&&r.canvas&&r.canvas.removeEventListener(e,t,My)}function X5(r,e){const t=V5[r.type]||r.type,{x:n,y:i}=Ws(r,e);return{type:t,chart:e,native:r,x:n!==void 0?n:null,y:i!==void 0?i:null}}function Gu(r,e){for(const t of r)if(t===e||t.contains(e))return!0}function Y5(r,e,t){const n=r.canvas,i=new MutationObserver(a=>{let o=!1;for(const c of a)o=o||Gu(c.addedNodes,n),o=o&&!Gu(c.removedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function J5(r,e,t){const n=r.canvas,i=new MutationObserver(a=>{let o=!1;for(const c of a)o=o||Gu(c.removedNodes,n),o=o&&!Gu(c.addedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const Rl=new Map;let Mx=0;function By(){const r=window.devicePixelRatio;r!==Mx&&(Mx=r,Rl.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function Q5(r,e){Rl.size||window.addEventListener("resize",By),Rl.set(r,e)}function Z5(r){Rl.delete(r),Rl.size||window.removeEventListener("resize",By)}function eF(r,e,t){const n=r.canvas,i=n&&b0(n);if(!i)return;const a=wy((c,d)=>{const f=i.clientWidth;t(c,d),f<i.clientWidth&&t()},window),o=new ResizeObserver(c=>{const d=c[0],f=d.contentRect.width,p=d.contentRect.height;f===0&&p===0||a(f,p)});return o.observe(i),Q5(r,a),o}function hh(r,e,t){t&&t.disconnect(),e==="resize"&&Z5(r)}function tF(r,e,t){const n=r.canvas,i=wy(a=>{r.ctx!==null&&t(X5(a,r))},r);return K5(n,e,i),i}class rF extends Ly{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(G5(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[yu])return!1;const n=t[yu].initial;["height","width"].forEach(a=>{const o=n[a];Lr(o)?t.removeAttribute(a):t.setAttribute(a,o)});const i=n.style||{};return Object.keys(i).forEach(a=>{t.style[a]=i[a]}),t.width=t.width,delete t[yu],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:Y5,detach:J5,resize:eF}[t]||tF;i[t]=o(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:hh,detach:hh,resize:hh}[t]||q5)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return c5(e,t,n,i)}isAttached(e){const t=e&&b0(e);return!!(t&&t.isConnected)}}function nF(r){return!w0()||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?H5:rF}class Vl{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return $u(this.x)&&$u(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const i={};return e.forEach(a=>{i[a]=n[a]&&n[a].active()?n[a]._to:this[a]}),i}}function iF(r,e){const t=r.options.ticks,n=sF(r),i=Math.min(t.maxTicksLimit||n,n),a=t.major.enabled?oF(e):[],o=a.length,c=a[0],d=a[o-1],f=[];if(o>i)return lF(e,f,a,o/i),f;const p=aF(a,e,i);if(o>0){let g,v;const y=o>1?Math.round((d-c)/(o-1)):null;for(pu(e,f,p,Lr(y)?0:c-y,c),g=0,v=o-1;g<v;g++)pu(e,f,p,a[g],a[g+1]);return pu(e,f,p,d,Lr(y)?e.length:d+y),f}return pu(e,f,p),f}function sF(r){const e=r.options.offset,t=r._tickSize(),n=r._length/t+(e?0:1),i=r._maxLength/t;return Math.floor(Math.min(n,i))}function aF(r,e,t){const n=cF(r),i=e.length/t;if(!n)return Math.max(i,1);const a=v3(n);for(let o=0,c=a.length-1;o<c;o++){const d=a[o];if(d>i)return d}return Math.max(i,1)}function oF(r){const e=[];let t,n;for(t=0,n=r.length;t<n;t++)r[t].major&&e.push(t);return e}function lF(r,e,t,n){let i=0,a=t[0],o;for(n=Math.ceil(n),o=0;o<r.length;o++)o===a&&(e.push(r[o]),i++,a=t[i*n])}function pu(r,e,t,n,i){const a=Tt(n,0),o=Math.min(Tt(i,r.length),r.length);let c=0,d,f,p;for(t=Math.ceil(t),i&&(d=i-n,t=d/Math.floor(d/t)),p=a;p<0;)c++,p=Math.round(a+c*t);for(f=Math.max(a,0);f<o;f++)f===p&&(e.push(r[f]),c++,p=Math.round(a+c*t))}function cF(r){const e=r.length;let t,n;if(e<2)return!1;for(n=r[0],t=1;t<e;++t)if(r[t]-r[t-1]!==n)return!1;return n}const uF=r=>r==="left"?"right":r==="right"?"left":r,Bx=(r,e,t)=>e==="top"||e==="left"?r[e]+t:r[e]-t,Ux=(r,e)=>Math.min(e||r,r);function zx(r,e){const t=[],n=r.length/e,i=r.length;let a=0;for(;a<i;a+=n)t.push(r[Math.floor(a)]);return t}function dF(r,e,t){const n=r.ticks.length,i=Math.min(e,n-1),a=r._startPixel,o=r._endPixel,c=1e-6;let d=r.getPixelForTick(i),f;if(!(t&&(n===1?f=Math.max(d-a,o-d):e===0?f=(r.getPixelForTick(1)-d)/2:f=(d-r.getPixelForTick(i-1))/2,d+=i<e?f:-f,d<a-c||d>o+c)))return d}function fF(r,e){kt(r,t=>{const n=t.gc,i=n.length/2;let a;if(i>e){for(a=0;a<i;++a)delete t.data[n[a]];n.splice(0,i)}})}function rl(r){return r.drawTicks?r.tickLength:0}function $x(r,e){if(!r.display)return 0;const t=Zr(r.font,e),n=Zn(r.padding);return(Tr(r.text)?r.text.length:1)*t.lineHeight+n.height}function hF(r,e){return mo(r,{scale:e,type:"scale"})}function pF(r,e,t){return mo(r,{tick:t,index:e,type:"tick"})}function mF(r,e,t){let n=by(r);return(t&&e!=="right"||!t&&e==="right")&&(n=uF(n)),n}function gF(r,e,t,n){const{top:i,left:a,bottom:o,right:c,chart:d}=r,{chartArea:f,scales:p}=d;let g=0,v,y,b;const _=o-i,S=c-a;if(r.isHorizontal()){if(y=cn(n,a,c),yt(t)){const A=Object.keys(t)[0],C=t[A];b=p[A].getPixelForValue(C)+_-e}else t==="center"?b=(f.bottom+f.top)/2+_-e:b=Bx(r,t,e);v=c-a}else{if(yt(t)){const A=Object.keys(t)[0],C=t[A];y=p[A].getPixelForValue(C)-S+e}else t==="center"?y=(f.left+f.right)/2-S+e:y=Bx(r,t,e);b=cn(n,o,i),g=t==="left"?-dr:dr}return{titleX:y,titleY:b,maxWidth:v,rotation:g}}class sd extends Vl{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=oi(e,Number.POSITIVE_INFINITY),t=oi(t,Number.NEGATIVE_INFINITY),n=oi(n,Number.POSITIVE_INFINITY),i=oi(i,Number.NEGATIVE_INFINITY),{min:oi(e,n),max:oi(t,i),minDefined:Li(e),maxDefined:Li(t)}}getMinMax(e){let{min:t,max:n,minDefined:i,maxDefined:a}=this.getUserBounds(),o;if(i&&a)return{min:t,max:n};const c=this.getMatchingVisibleMetas();for(let d=0,f=c.length;d<f;++d)o=c[d].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),a||(n=Math.max(n,o.max));return t=a&&t>n?n:t,n=i&&t>n?t:n,{min:oi(t,oi(n,t)),max:oi(n,oi(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){It(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:i,grace:a,ticks:o}=this.options,c=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=q3(this,a,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=c<this.ticks.length;this._convertTicksToLabels(d?zx(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=iF(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){It(this.options.afterUpdate,[this])}beforeSetDimensions(){It(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){It(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),It(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){It(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,i,a;for(n=0,i=e.length;n<i;n++)a=e[n],a.label=It(t.callback,[a.value,n,e],this)}afterTickToLabelConversion(){It(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){It(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=Ux(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,a=t.maxRotation;let o=i,c,d,f;if(!this._isVisible()||!t.display||i>=a||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const p=this._getLabelSizes(),g=p.widest.width,v=p.highest.height,y=jn(this.chart.width-g,0,this.maxWidth);c=e.offset?this.maxWidth/n:y/(n-1),g+6>c&&(c=y/(n-(e.offset?.5:1)),d=this.maxHeight-rl(e.grid)-t.padding-$x(e.title,this.chart.options.font),f=Math.sqrt(g*g+v*v),o=_3(Math.min(Math.asin(jn((p.highest.height+6)/c,-1,1)),Math.asin(jn(d/f,-1,1))-Math.asin(jn(v/f,-1,1)))),o=Math.max(i,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){It(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){It(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:i,grid:a}}=this,o=this._isVisible(),c=this.isHorizontal();if(o){const d=$x(i,t.options.font);if(c?(e.width=this.maxWidth,e.height=rl(a)+d):(e.height=this.maxHeight,e.width=rl(a)+d),n.display&&this.ticks.length){const{first:f,last:p,widest:g,highest:v}=this._getLabelSizes(),y=n.padding*2,b=Gs(this.labelRotation),_=Math.cos(b),S=Math.sin(b);if(c){const A=n.mirror?0:S*g.width+_*v.height;e.height=Math.min(this.maxHeight,e.height+A+y)}else{const A=n.mirror?0:_*g.width+S*v.height;e.width=Math.min(this.maxWidth,e.width+A+y)}this._calculatePadding(f,p,S,_)}}this._handleMargins(),c?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,i){const{ticks:{align:a,padding:o},position:c}=this.options,d=this.labelRotation!==0,f=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const p=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let v=0,y=0;d?f?(v=i*e.width,y=n*t.height):(v=n*e.height,y=i*t.width):a==="start"?y=t.width:a==="end"?v=e.width:a!=="inner"&&(v=e.width/2,y=t.width/2),this.paddingLeft=Math.max((v-p+o)*this.width/(this.width-p),0),this.paddingRight=Math.max((y-g+o)*this.width/(this.width-g),0)}else{let p=t.height/2,g=e.height/2;a==="start"?(p=0,g=e.height):a==="end"&&(p=t.height,g=0),this.paddingTop=p+o,this.paddingBottom=g+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){It(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)Lr(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=zx(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:i,_longestTextCache:a}=this,o=[],c=[],d=Math.floor(t/Ux(t,n));let f=0,p=0,g,v,y,b,_,S,A,C,T,P,z;for(g=0;g<t;g+=d){if(b=e[g].label,_=this._resolveTickFontOptions(g),i.font=S=_.string,A=a[S]=a[S]||{data:{},gc:[]},C=_.lineHeight,T=P=0,!Lr(b)&&!Tr(b))T=_x(i,A.data,A.gc,T,b),P=C;else if(Tr(b))for(v=0,y=b.length;v<y;++v)z=b[v],!Lr(z)&&!Tr(z)&&(T=_x(i,A.data,A.gc,T,z),P+=C);o.push(T),c.push(P),f=Math.max(T,f),p=Math.max(P,p)}fF(a,t);const G=o.indexOf(f),L=c.indexOf(p),V=q=>({width:o[q]||0,height:c[q]||0});return{first:V(0),last:V(t-1),widest:V(G),highest:V(L),widths:o,heights:c}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return b3(this._alignToPixels?Us(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=pF(this.getContext(),e,n))}return this.$context||(this.$context=hF(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Gs(this.labelRotation),n=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,c=a?a.widest.width+o:0,d=a?a.highest.height+o:0;return this.isHorizontal()?d*n>c*i?c/n:d/i:d*i<c*n?d/n:c/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,i=this.options,{grid:a,position:o,border:c}=i,d=a.offset,f=this.isHorizontal(),g=this.ticks.length+(d?1:0),v=rl(a),y=[],b=c.setContext(this.getContext()),_=b.display?b.width:0,S=_/2,A=function(Oe){return Us(n,Oe,_)};let C,T,P,z,G,L,V,q,O,ee,D,te;if(o==="top")C=A(this.bottom),L=this.bottom-v,q=C-S,ee=A(e.top)+S,te=e.bottom;else if(o==="bottom")C=A(this.top),ee=e.top,te=A(e.bottom)-S,L=C+S,q=this.top+v;else if(o==="left")C=A(this.right),G=this.right-v,V=C-S,O=A(e.left)+S,D=e.right;else if(o==="right")C=A(this.left),O=e.left,D=A(e.right)-S,G=C+S,V=this.left+v;else if(t==="x"){if(o==="center")C=A((e.top+e.bottom)/2+.5);else if(yt(o)){const Oe=Object.keys(o)[0],je=o[Oe];C=A(this.chart.scales[Oe].getPixelForValue(je))}ee=e.top,te=e.bottom,L=C+S,q=L+v}else if(t==="y"){if(o==="center")C=A((e.left+e.right)/2);else if(yt(o)){const Oe=Object.keys(o)[0],je=o[Oe];C=A(this.chart.scales[Oe].getPixelForValue(je))}G=C-S,V=G-v,O=e.left,D=e.right}const ve=Tt(i.ticks.maxTicksLimit,g),ye=Math.max(1,Math.ceil(g/ve));for(T=0;T<g;T+=ye){const Oe=this.getContext(T),je=a.setContext(Oe),fe=c.setContext(Oe),xe=je.lineWidth,me=je.color,K=fe.dash||[],N=fe.dashOffset,X=je.tickWidth,W=je.tickColor,B=je.tickBorderDash||[],J=je.tickBorderDashOffset;P=dF(this,T,d),P!==void 0&&(z=Us(n,P,xe),f?G=V=O=D=z:L=q=ee=te=z,y.push({tx1:G,ty1:L,tx2:V,ty2:q,x1:O,y1:ee,x2:D,y2:te,width:xe,color:me,borderDash:K,borderDashOffset:N,tickWidth:X,tickColor:W,tickBorderDash:B,tickBorderDashOffset:J}))}return this._ticksLength=g,this._borderValue=C,y}_computeLabelItems(e){const t=this.axis,n=this.options,{position:i,ticks:a}=n,o=this.isHorizontal(),c=this.ticks,{align:d,crossAlign:f,padding:p,mirror:g}=a,v=rl(n.grid),y=v+p,b=g?-p:y,_=-Gs(this.labelRotation),S=[];let A,C,T,P,z,G,L,V,q,O,ee,D,te="middle";if(i==="top")G=this.bottom-b,L=this._getXAxisLabelAlignment();else if(i==="bottom")G=this.top+b,L=this._getXAxisLabelAlignment();else if(i==="left"){const ye=this._getYAxisLabelAlignment(v);L=ye.textAlign,z=ye.x}else if(i==="right"){const ye=this._getYAxisLabelAlignment(v);L=ye.textAlign,z=ye.x}else if(t==="x"){if(i==="center")G=(e.top+e.bottom)/2+y;else if(yt(i)){const ye=Object.keys(i)[0],Oe=i[ye];G=this.chart.scales[ye].getPixelForValue(Oe)+y}L=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")z=(e.left+e.right)/2-y;else if(yt(i)){const ye=Object.keys(i)[0],Oe=i[ye];z=this.chart.scales[ye].getPixelForValue(Oe)}L=this._getYAxisLabelAlignment(v).textAlign}t==="y"&&(d==="start"?te="top":d==="end"&&(te="bottom"));const ve=this._getLabelSizes();for(A=0,C=c.length;A<C;++A){T=c[A],P=T.label;const ye=a.setContext(this.getContext(A));V=this.getPixelForTick(A)+a.labelOffset,q=this._resolveTickFontOptions(A),O=q.lineHeight,ee=Tr(P)?P.length:1;const Oe=ee/2,je=ye.color,fe=ye.textStrokeColor,xe=ye.textStrokeWidth;let me=L;o?(z=V,L==="inner"&&(A===C-1?me=this.options.reverse?"left":"right":A===0?me=this.options.reverse?"right":"left":me="center"),i==="top"?f==="near"||_!==0?D=-ee*O+O/2:f==="center"?D=-ve.highest.height/2-Oe*O+O:D=-ve.highest.height+O/2:f==="near"||_!==0?D=O/2:f==="center"?D=ve.highest.height/2-Oe*O:D=ve.highest.height-ee*O,g&&(D*=-1),_!==0&&!ye.showLabelBackdrop&&(z+=O/2*Math.sin(_))):(G=V,D=(1-ee)*O/2);let K;if(ye.showLabelBackdrop){const N=Zn(ye.backdropPadding),X=ve.heights[A],W=ve.widths[A];let B=D-N.top,J=0-N.left;switch(te){case"middle":B-=X/2;break;case"bottom":B-=X;break}switch(L){case"center":J-=W/2;break;case"right":J-=W;break;case"inner":A===C-1?J-=W:A>0&&(J-=W/2);break}K={left:J,top:B,width:W+N.width,height:X+N.height,color:ye.backdropColor}}S.push({label:P,font:q,textOffset:D,options:{rotation:_,color:je,strokeColor:fe,strokeWidth:xe,textAlign:me,textBaseline:te,translation:[z,G],backdrop:K}})}return S}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Gs(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:i,padding:a}}=this.options,o=this._getLabelSizes(),c=e+a,d=o.widest.width;let f,p;return t==="left"?i?(p=this.right+a,n==="near"?f="left":n==="center"?(f="center",p+=d/2):(f="right",p+=d)):(p=this.right-c,n==="near"?f="right":n==="center"?(f="center",p-=d/2):(f="left",p=this.left)):t==="right"?i?(p=this.left+a,n==="near"?f="right":n==="center"?(f="center",p-=d/2):(f="left",p-=d)):(p=this.left+c,n==="near"?f="left":n==="center"?(f="center",p+=d/2):(f="right",p=this.right)):f="right",{textAlign:f,x:p}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(a=>a.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const c=(d,f,p)=>{!p.width||!p.color||(n.save(),n.lineWidth=p.width,n.strokeStyle=p.color,n.setLineDash(p.borderDash||[]),n.lineDashOffset=p.borderDashOffset,n.beginPath(),n.moveTo(d.x,d.y),n.lineTo(f.x,f.y),n.stroke(),n.restore())};if(t.display)for(a=0,o=i.length;a<o;++a){const d=i[a];t.drawOnChartArea&&c({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),t.drawTicks&&c({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:i}}=this,a=n.setContext(this.getContext()),o=n.display?a.width:0;if(!o)return;const c=i.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let f,p,g,v;this.isHorizontal()?(f=Us(e,this.left,o)-o/2,p=Us(e,this.right,c)+c/2,g=v=d):(g=Us(e,this.top,o)-o/2,v=Us(e,this.bottom,c)+c/2,f=p=d),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(f,g),t.lineTo(p,v),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&m0(n,i);const a=this.getLabelItems(e);for(const o of a){const c=o.options,d=o.font,f=o.label,p=o.textOffset;Hu(n,f,0,p,d,c)}i&&g0(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const a=Zr(n.font),o=Zn(n.padding),c=n.align;let d=a.lineHeight/2;t==="bottom"||t==="center"||yt(t)?(d+=o.bottom,Tr(n.text)&&(d+=a.lineHeight*(n.text.length-1))):d+=o.top;const{titleX:f,titleY:p,maxWidth:g,rotation:v}=gF(this,d,t,c);Hu(e,n.text,0,0,a,{color:n.color,maxWidth:g,rotation:v,textAlign:mF(c,t,i),textBaseline:"middle",translation:[f,p]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=Tt(e.grid&&e.grid.z,-1),i=Tt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==sd.prototype.draw?[{z:t,draw:a=>{this.draw(a)}}]:[{z:n,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let a,o;for(a=0,o=t.length;a<o;++a){const c=t[a];c[n]===this.id&&(!e||c.type===e)&&i.push(c)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Zr(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class mu{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;yF(t)&&(n=this.register(t));const i=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in i||(i[a]=e,xF(e,o,n),this.override&&Qt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in Qt[i]&&(delete Qt[i][n],this.override&&delete Qs[n])}}function xF(r,e,t){const n=Ol(Object.create(null),[t?Qt.get(t):{},Qt.get(e),r.defaults]);Qt.set(e,n),r.defaultRoutes&&vF(e,r.defaultRoutes),r.descriptors&&Qt.describe(e,r.descriptors)}function vF(r,e){Object.keys(e).forEach(t=>{const n=t.split("."),i=n.pop(),a=[r].concat(n).join("."),o=e[t].split("."),c=o.pop(),d=o.join(".");Qt.route(a,i,d,c)})}function yF(r){return"id"in r&&"defaults"in r}class _F{constructor(){this.controllers=new mu(Py,"datasets",!0),this.elements=new mu(Vl,"elements"),this.plugins=new mu(Object,"plugins"),this.scales=new mu(sd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(i=>{const a=n||this._getRegistryForType(i);n||a.isForType(i)||a===this.plugins&&i.id?this._exec(e,a,i):kt(i,o=>{const c=n||this._getRegistryForType(o);this._exec(e,c,o)})})}_exec(e,t,n){const i=h0(e);It(n["before"+i],[],n),t[e](n),It(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var fi=new _F;class wF{constructor(){this._init=[]}notify(e,t,n,i){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const a=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(a,e,t,n);return t==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,n,i){i=i||{};for(const a of e){const o=a.plugin,c=o[n],d=[t,i,a.options];if(It(c,d,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Lr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=Tt(n.options&&n.options.plugins,{}),a=bF(n);return i===!1&&!t?[]:EF(e,a,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(a,o)=>a.filter(c=>!o.some(d=>c.plugin.id===d.plugin.id));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function bF(r){const e={},t=[],n=Object.keys(fi.plugins.items);for(let a=0;a<n.length;a++)t.push(fi.getPlugin(n[a]));const i=r.plugins||[];for(let a=0;a<i.length;a++){const o=i[a];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function SF(r,e){return!e&&r===!1?null:r===!0?{}:r}function EF(r,{plugins:e,localIds:t},n,i){const a=[],o=r.getContext();for(const c of e){const d=c.id,f=SF(n[d],i);f!==null&&a.push({plugin:c,options:kF(r.config,{plugin:c,local:t[d]},f,o)})}return a}function kF(r,{plugin:e,local:t},n,i){const a=r.pluginScopeKeys(e),o=r.getOptionScopes(n,a);return t&&e.defaults&&o.push(e.defaults),r.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ph(r,e){const t=Qt.datasets[r]||{};return((e.datasets||{})[r]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function TF(r,e){let t=r;return r==="_index_"?t=e:r==="_value_"&&(t=e==="x"?"y":"x"),t}function AF(r,e){return r===e?"_index_":"_value_"}function Wx(r){if(r==="x"||r==="y"||r==="r")return r}function CF(r){if(r==="top"||r==="bottom")return"x";if(r==="left"||r==="right")return"y"}function Rh(r,...e){if(Wx(r))return r;for(const t of e){const n=t.axis||CF(t.position)||r.length>1&&Wx(r[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${r}' axis. Please provide 'axis' or 'position' option.`)}function Hx(r,e,t){if(t[e+"AxisID"]===r)return{axis:e}}function NF(r,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===r||n.yAxisID===r);if(t.length)return Hx(r,"x",t[0])||Hx(r,"y",t[0])}return{}}function FF(r,e){const t=Qs[r.type]||{scales:{}},n=e.scales||{},i=Ph(r.type,e),a=Object.create(null);return Object.keys(n).forEach(o=>{const c=n[o];if(!yt(c))return console.error(`Invalid scale configuration for scale: ${o}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const d=Rh(o,c,NF(o,r),Qt.scales[c.type]),f=AF(d,i),p=t.scales||{};a[o]=_l(Object.create(null),[{axis:d},c,p[d],p[f]])}),r.data.datasets.forEach(o=>{const c=o.type||r.type,d=o.indexAxis||Ph(c,e),p=(Qs[c]||{}).scales||{};Object.keys(p).forEach(g=>{const v=TF(g,d),y=o[v+"AxisID"]||v;a[y]=a[y]||Object.create(null),_l(a[y],[{axis:v},n[y],p[g]])})}),Object.keys(a).forEach(o=>{const c=a[o];_l(c,[Qt.scales[c.type],Qt.scale])}),a}function Uy(r){const e=r.options||(r.options={});e.plugins=Tt(e.plugins,{}),e.scales=FF(r,e)}function zy(r){return r=r||{},r.datasets=r.datasets||[],r.labels=r.labels||[],r}function jF(r){return r=r||{},r.data=zy(r.data),Uy(r),r}const Vx=new Map,$y=new Set;function gu(r,e){let t=Vx.get(r);return t||(t=e(),Vx.set(r,t),$y.add(t)),t}const nl=(r,e,t)=>{const n=Pl(e,t);n!==void 0&&r.add(n)};class DF{constructor(e){this._config=jF(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=zy(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Uy(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return gu(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return gu(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return gu(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return gu(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return(!i||t)&&(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:a}=this,o=this._cachedScopes(e,n),c=o.get(t);if(c)return c;const d=new Set;t.forEach(p=>{e&&(d.add(e),p.forEach(g=>nl(d,e,g))),p.forEach(g=>nl(d,i,g)),p.forEach(g=>nl(d,Qs[a]||{},g)),p.forEach(g=>nl(d,Qt,g)),p.forEach(g=>nl(d,Dh,g))});const f=Array.from(d);return f.length===0&&f.push(Object.create(null)),$y.has(t)&&o.set(t,f),f}chartOptionScopes(){const{options:e,type:t}=this;return[e,Qs[t]||{},Qt.datasets[t]||{},{type:t},Qt,Dh]}resolveNamedOptions(e,t,n,i=[""]){const a={$shared:!0},{resolver:o,subPrefixes:c}=Gx(this._resolverCache,e,i);let d=o;if(PF(o,t)){a.$shared=!1,n=ws(n)?n():n;const f=this.createResolver(e,n,c);d=lo(o,n,f)}for(const f of t)a[f]=d[f];return a}createResolver(e,t,n=[""],i){const{resolver:a}=Gx(this._resolverCache,e,n);return yt(t)?lo(a,t,void 0,i):a}}function Gx(r,e,t){let n=r.get(e);n||(n=new Map,r.set(e,n));const i=t.join();let a=n.get(i);return a||(a={resolver:v0(e,t),subPrefixes:t.filter(c=>!c.toLowerCase().includes("hover"))},n.set(i,a)),a}const OF=r=>yt(r)&&Object.getOwnPropertyNames(r).some(e=>ws(r[e]));function PF(r,e){const{isScriptable:t,isIndexable:n}=Ty(r);for(const i of e){const a=t(i),o=n(i),c=(o||a)&&r[i];if(a&&(ws(c)||OF(c))||o&&Tr(c))return!0}return!1}var RF="4.5.0";const IF=["top","bottom","left","right","chartArea"];function Kx(r,e){return r==="top"||r==="bottom"||IF.indexOf(r)===-1&&e==="x"}function qx(r,e){return function(t,n){return t[r]===n[r]?t[e]-n[e]:t[r]-n[r]}}function Xx(r){const e=r.chart,t=e.options.animation;e.notifyPlugins("afterRender"),It(t&&t.onComplete,[r],e)}function LF(r){const e=r.chart,t=e.options.animation;It(t&&t.onProgress,[r],e)}function Wy(r){return w0()&&typeof r=="string"?r=document.getElementById(r):r&&r.length&&(r=r[0]),r&&r.canvas&&(r=r.canvas),r}const _u={},Yx=r=>{const e=Wy(r);return Object.values(_u).filter(t=>t.canvas===e).pop()};function MF(r,e,t){const n=Object.keys(r);for(const i of n){const a=+i;if(a>=e){const o=r[i];delete r[i],(t>0||a>e)&&(r[a+t]=o)}}}function BF(r,e,t,n){return!t||r.type==="mouseout"?null:n?e:r}let ad=class{static defaults=Qt;static instances=_u;static overrides=Qs;static registry=fi;static version=RF;static getChart=Yx;static register(...e){fi.add(...e),Jx()}static unregister(...e){fi.remove(...e),Jx()}constructor(e,t){const n=this.config=new DF(t),i=Wy(e),a=Yx(i);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||nF(i)),this.platform.updateConfig(n);const c=this.platform.acquireContext(i,o.aspectRatio),d=c&&c.canvas,f=d&&d.height,p=d&&d.width;if(this.id=u3(),this.ctx=c,this.canvas=d,this.width=p,this.height=f,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new wF,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=A3(g=>this.update(g),o.resizeDelay||0),this._dataChanges=[],_u[this.id]=this,!c||!d){console.error("Failed to create chart: can't acquire context from the given item");return}Ci.listen(this,"complete",Xx),Ci.listen(this,"progress",LF),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:a}=this;return Lr(e)?t&&a?a:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return fi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():kx(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return wx(this.canvas,this.ctx),this}stop(){return Ci.stop(this),this}resize(e,t){Ci.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,i=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,a),c=n.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,kx(this,c,!0)&&(this.notifyPlugins("resize",{size:o}),It(n.onResize,[this,o],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};kt(t,(n,i)=>{n.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,i=Object.keys(n).reduce((o,c)=>(o[c]=!1,o),{});let a=[];t&&(a=a.concat(Object.keys(t).map(o=>{const c=t[o],d=Rh(o,c),f=d==="r",p=d==="x";return{options:c,dposition:f?"chartArea":p?"bottom":"left",dtype:f?"radialLinear":p?"category":"linear"}}))),kt(a,o=>{const c=o.options,d=c.id,f=Rh(d,c),p=Tt(c.type,o.dtype);(c.position===void 0||Kx(c.position,f)!==Kx(o.dposition))&&(c.position=o.dposition),i[d]=!0;let g=null;if(d in n&&n[d].type===p)g=n[d];else{const v=fi.getScale(p);g=new v({id:d,type:p,ctx:this.ctx,chart:this}),n[g.id]=g}g.init(c,e)}),kt(i,(o,c)=>{o||delete n[c]}),kt(n,o=>{gs.configure(this,o,o.options),gs.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((i,a)=>i.index-a.index),n>t){for(let i=t;i<n;++i)this._destroyDatasetMeta(i);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(qx("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,i)=>{t.filter(a=>a===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=t.length;n<i;n++){const a=t[n];let o=this.getDatasetMeta(n);const c=a.type||this.config.type;if(o.type&&o.type!==c&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=c,o.indexAxis=a.indexAxis||Ph(c,this.options),o.order=a.order||0,o.index=n,o.label=""+a.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const d=fi.getController(c),{datasetElementType:f,dataElementType:p}=Qt.datasets[c];Object.assign(d,{dataElementType:fi.getElement(p),datasetElementType:f&&fi.getElement(f)}),o.controller=new d(this,n),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){kt(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let f=0,p=this.data.datasets.length;f<p;f++){const{controller:g}=this.getDatasetMeta(f),v=!i&&a.indexOf(g)===-1;g.buildOrUpdateElements(v),o=Math.max(+g.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),i||kt(a,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(qx("z","_idx"));const{_active:c,_lastEvent:d}=this;d?this._eventHandler(d,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){kt(this.scales,e=>{gs.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!fx(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:a}of t){const o=n==="_removeElements"?-a:a;MF(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=a=>new Set(e.filter(o=>o[0]===a).map((o,c)=>c+","+o.splice(1).join(","))),i=n(0);for(let a=1;a<t;a++)if(!fx(i,n(a)))return;return Array.from(i).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;gs.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],kt(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,a)=>{i._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,ws(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ci.has(this)?this.attached&&!Ci.running(this)&&Ci.start(this):(this.draw(),Xx({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,a;for(i=0,a=t.length;i<a;++i){const o=t[i];(!e||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=p5(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&m0(t,i),e.controller.draw(),i&&g0(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return ky(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,i){const a=I5.modes[t];return typeof a=="function"?a(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter(a=>a&&a._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=mo(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=n?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,i);Uu(t)?(a.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(a,{visible:n}),this.update(c=>c.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Ci.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),wx(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete _u[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(a,o)=>{t.addEventListener(this,a,o),e[a]=o},i=(a,o,c)=>{a.offsetX=o,a.offsetY=c,this._eventHandler(a)};kt(this.options.events,a=>n(a,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(d,f)=>{t.addEventListener(this,d,f),e[d]=f},i=(d,f)=>{e[d]&&(t.removeEventListener(this,d,f),delete e[d])},a=(d,f)=>{this.canvas&&this.resize(d,f)};let o;const c=()=>{i("attach",c),this.attached=!0,this.resize(),n("resize",a),n("detach",o)};o=()=>{this.attached=!1,i("resize",a),this._stop(),this._resize(0,0),n("attach",c)},t.isAttached(this.canvas)?c():o()}unbindEvents(){kt(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},kt(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let a,o,c,d;for(t==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+i+"DatasetHoverStyle"]()),c=0,d=e.length;c<d;++c){o=e[c];const f=o&&this.getDatasetMeta(o.datasetIndex).controller;f&&f[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:a,index:o})=>{const c=this.getDatasetMeta(a);if(!c)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:c.data[o],index:o}});!Mu(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const i=this.options.hover,a=(d,f)=>d.filter(p=>!f.some(g=>p.datasetIndex===g.datasetIndex&&p.index===g.index)),o=a(t,e),c=n?e:a(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),c.length&&i.mode&&this.updateHoverStyle(c,i.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const a=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(a||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:i=[],options:a}=this,o=t,c=this._getActiveElements(e,i,n,o),d=g3(e),f=BF(e,this._lastEvent,n,d);n&&(this._lastEvent=null,It(a.onHover,[e,c,this],this),d&&It(a.onClick,[e,c,this],this));const p=!Mu(c,i);return(p||t)&&(this._active=c,this._updateHoverStyles(c,i,t)),this._lastEvent=f,p}_getActiveElements(e,t,n,i){if(e.type==="mouseout")return[];if(!n)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,i)}};function Jx(){return kt(ad.instances,r=>r._plugins.invalidate())}function UF(r,e,t){const{startAngle:n,x:i,y:a,outerRadius:o,innerRadius:c,options:d}=e,{borderWidth:f,borderJoinStyle:p}=d,g=Math.min(f/o,hi(n-t));if(r.beginPath(),r.arc(i,a,o-f/2,n+g/2,t-g/2),c>0){const v=Math.min(f/c,hi(n-t));r.arc(i,a,c+f/2,t-v/2,n+v/2,!0)}else{const v=Math.min(f/2,o*hi(n-t));if(p==="round")r.arc(i,a,v,t-Lt/2,n+Lt/2,!0);else if(p==="bevel"){const y=2*v*v,b=-y*Math.cos(t+Lt/2)+i,_=-y*Math.sin(t+Lt/2)+a,S=y*Math.cos(n+Lt/2)+i,A=y*Math.sin(n+Lt/2)+a;r.lineTo(b,_),r.lineTo(S,A)}}r.closePath(),r.moveTo(0,0),r.rect(0,0,r.canvas.width,r.canvas.height),r.clip("evenodd")}function zF(r,e,t){const{startAngle:n,pixelMargin:i,x:a,y:o,outerRadius:c,innerRadius:d}=e;let f=i/c;r.beginPath(),r.arc(a,o,c,n-f,t+f),d>i?(f=i/d,r.arc(a,o,d,t+f,n-f,!0)):r.arc(a,o,i,t+dr,n-dr),r.closePath(),r.clip()}function $F(r){return x0(r,["outerStart","outerEnd","innerStart","innerEnd"])}function WF(r,e,t,n){const i=$F(r.options.borderRadius),a=(t-e)/2,o=Math.min(a,n*e/2),c=d=>{const f=(t-Math.min(a,d))*n/2;return jn(d,0,Math.min(a,f))};return{outerStart:c(i.outerStart),outerEnd:c(i.outerEnd),innerStart:jn(i.innerStart,0,o),innerEnd:jn(i.innerEnd,0,o)}}function Ya(r,e,t,n){return{x:t+r*Math.cos(e),y:n+r*Math.sin(e)}}function Ku(r,e,t,n,i,a){const{x:o,y:c,startAngle:d,pixelMargin:f,innerRadius:p}=e,g=Math.max(e.outerRadius+n+t-f,0),v=p>0?p+n+t+f:0;let y=0;const b=i-d;if(n){const ye=p>0?p-n:0,Oe=g>0?g-n:0,je=(ye+Oe)/2,fe=je!==0?b*je/(je+n):b;y=(b-fe)/2}const _=Math.max(.001,b*g-t/Lt)/g,S=(b-_)/2,A=d+S+y,C=i-S-y,{outerStart:T,outerEnd:P,innerStart:z,innerEnd:G}=WF(e,v,g,C-A),L=g-T,V=g-P,q=A+T/L,O=C-P/V,ee=v+z,D=v+G,te=A+z/ee,ve=C-G/D;if(r.beginPath(),a){const ye=(q+O)/2;if(r.arc(o,c,g,q,ye),r.arc(o,c,g,ye,O),P>0){const xe=Ya(V,O,o,c);r.arc(xe.x,xe.y,P,O,C+dr)}const Oe=Ya(D,C,o,c);if(r.lineTo(Oe.x,Oe.y),G>0){const xe=Ya(D,ve,o,c);r.arc(xe.x,xe.y,G,C+dr,ve+Math.PI)}const je=(C-G/v+(A+z/v))/2;if(r.arc(o,c,v,C-G/v,je,!0),r.arc(o,c,v,je,A+z/v,!0),z>0){const xe=Ya(ee,te,o,c);r.arc(xe.x,xe.y,z,te+Math.PI,A-dr)}const fe=Ya(L,A,o,c);if(r.lineTo(fe.x,fe.y),T>0){const xe=Ya(L,q,o,c);r.arc(xe.x,xe.y,T,A-dr,q)}}else{r.moveTo(o,c);const ye=Math.cos(q)*g+o,Oe=Math.sin(q)*g+c;r.lineTo(ye,Oe);const je=Math.cos(O)*g+o,fe=Math.sin(O)*g+c;r.lineTo(je,fe)}r.closePath()}function HF(r,e,t,n,i){const{fullCircles:a,startAngle:o,circumference:c}=e;let d=e.endAngle;if(a){Ku(r,e,t,n,d,i);for(let f=0;f<a;++f)r.fill();isNaN(c)||(d=o+(c%tr||tr))}return Ku(r,e,t,n,d,i),r.fill(),d}function VF(r,e,t,n,i){const{fullCircles:a,startAngle:o,circumference:c,options:d}=e,{borderWidth:f,borderJoinStyle:p,borderDash:g,borderDashOffset:v,borderRadius:y}=d,b=d.borderAlign==="inner";if(!f)return;r.setLineDash(g||[]),r.lineDashOffset=v,b?(r.lineWidth=f*2,r.lineJoin=p||"round"):(r.lineWidth=f,r.lineJoin=p||"bevel");let _=e.endAngle;if(a){Ku(r,e,t,n,_,i);for(let S=0;S<a;++S)r.stroke();isNaN(c)||(_=o+(c%tr||tr))}b&&zF(r,e,_),d.selfJoin&&_-o>=Lt&&y===0&&p!=="miter"&&UF(r,e,_),a||(Ku(r,e,t,n,_,i),r.stroke())}class GF extends Vl{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.getProps(["x","y"],n),{angle:a,distance:o}=vy(i,{x:e,y:t}),{startAngle:c,endAngle:d,innerRadius:f,outerRadius:p,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),v=(this.options.spacing+this.options.borderWidth)/2,y=Tt(g,d-c),b=Wu(a,c,d)&&c!==d,_=y>=tr||b,S=ll(o,f+v,p+v);return _&&S}getCenterPoint(e){const{x:t,y:n,startAngle:i,endAngle:a,innerRadius:o,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:d,spacing:f}=this.options,p=(i+a)/2,g=(o+c+f+d)/2;return{x:t+Math.cos(p)*g,y:n+Math.sin(p)*g}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,i=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=n>tr?Math.floor(n/tr):0,n===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const c=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(c)*i,Math.sin(c)*i);const d=1-Math.sin(Math.min(Lt,n||0)),f=i*d;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,HF(e,this,f,a,o),VF(e,this,f,a,o),e.restore()}}const Qx=(r,e)=>{let{boxHeight:t=e,boxWidth:n=e}=r;return r.usePointStyle&&(t=Math.min(t,e),n=r.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},KF=(r,e)=>r!==null&&e!==null&&r.datasetIndex===e.datasetIndex&&r.index===e.index;class Zx extends Vl{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=It(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,i)=>e.sort(n,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,i=Zr(n.font),a=i.size,o=this._computeTitleHeight(),{boxWidth:c,itemHeight:d}=Qx(n,a);let f,p;t.font=i.string,this.isHorizontal()?(f=this.maxWidth,p=this._fitRows(o,a,c,d)+10):(p=this.maxHeight,f=this._fitCols(o,i,c,d)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(p,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,i){const{ctx:a,maxWidth:o,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],f=this.lineWidths=[0],p=i+c;let g=e;a.textAlign="left",a.textBaseline="middle";let v=-1,y=-p;return this.legendItems.forEach((b,_)=>{const S=n+t/2+a.measureText(b.text).width;(_===0||f[f.length-1]+S+2*c>o)&&(g+=p,f[f.length-(_>0?0:1)]=0,y+=p,v++),d[_]={left:0,top:y,row:v,width:S,height:i},f[f.length-1]+=S+c}),g}_fitCols(e,t,n,i){const{ctx:a,maxHeight:o,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],f=this.columnSizes=[],p=o-e;let g=c,v=0,y=0,b=0,_=0;return this.legendItems.forEach((S,A)=>{const{itemWidth:C,itemHeight:T}=qF(n,t,a,S,i);A>0&&y+T+2*c>p&&(g+=v+c,f.push({width:v,height:y}),b+=v+c,_++,v=y=0),d[A]={left:b,top:y,col:_,width:C,height:T},v=Math.max(v,C),y+=T+c}),g+=v,f.push({width:v,height:y}),g}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:i},rtl:a}}=this,o=so(a,this.left,this.width);if(this.isHorizontal()){let c=0,d=cn(n,this.left+i,this.right-this.lineWidths[c]);for(const f of t)c!==f.row&&(c=f.row,d=cn(n,this.left+i,this.right-this.lineWidths[c])),f.top+=this.top+e+i,f.left=o.leftForLtr(o.x(d),f.width),d+=f.width+i}else{let c=0,d=cn(n,this.top+e+i,this.bottom-this.columnSizes[c].height);for(const f of t)f.col!==c&&(c=f.col,d=cn(n,this.top+e+i,this.bottom-this.columnSizes[c].height)),f.top=d,f.left+=this.left+i,f.left=o.leftForLtr(o.x(f.left),f.width),d+=f.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;m0(e,this),this._draw(),g0(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:i}=this,{align:a,labels:o}=e,c=Qt.color,d=so(e.rtl,this.left,this.width),f=Zr(o.font),{padding:p}=o,g=f.size,v=g/2;let y;this.drawTitle(),i.textAlign=d.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=f.string;const{boxWidth:b,boxHeight:_,itemHeight:S}=Qx(o,g),A=function(G,L,V){if(isNaN(b)||b<=0||isNaN(_)||_<0)return;i.save();const q=Tt(V.lineWidth,1);if(i.fillStyle=Tt(V.fillStyle,c),i.lineCap=Tt(V.lineCap,"butt"),i.lineDashOffset=Tt(V.lineDashOffset,0),i.lineJoin=Tt(V.lineJoin,"miter"),i.lineWidth=q,i.strokeStyle=Tt(V.strokeStyle,c),i.setLineDash(Tt(V.lineDash,[])),o.usePointStyle){const O={radius:_*Math.SQRT2/2,pointStyle:V.pointStyle,rotation:V.rotation,borderWidth:q},ee=d.xPlus(G,b/2),D=L+v;Ey(i,O,ee,D,o.pointStyleWidth&&b)}else{const O=L+Math.max((g-_)/2,0),ee=d.leftForLtr(G,b),D=Sl(V.borderRadius);i.beginPath(),Object.values(D).some(te=>te!==0)?Oh(i,{x:ee,y:O,w:b,h:_,radius:D}):i.rect(ee,O,b,_),i.fill(),q!==0&&i.stroke()}i.restore()},C=function(G,L,V){Hu(i,V.text,G,L+S/2,f,{strikethrough:V.hidden,textAlign:d.textAlign(V.textAlign)})},T=this.isHorizontal(),P=this._computeTitleHeight();T?y={x:cn(a,this.left+p,this.right-n[0]),y:this.top+p+P,line:0}:y={x:this.left+p,y:cn(a,this.top+P+p,this.bottom-t[0].height),line:0},Fy(this.ctx,e.textDirection);const z=S+p;this.legendItems.forEach((G,L)=>{i.strokeStyle=G.fontColor,i.fillStyle=G.fontColor;const V=i.measureText(G.text).width,q=d.textAlign(G.textAlign||(G.textAlign=o.textAlign)),O=b+v+V;let ee=y.x,D=y.y;d.setWidth(this.width),T?L>0&&ee+O+p>this.right&&(D=y.y+=z,y.line++,ee=y.x=cn(a,this.left+p,this.right-n[y.line])):L>0&&D+z>this.bottom&&(ee=y.x=ee+t[y.line].width+p,y.line++,D=y.y=cn(a,this.top+P+p,this.bottom-t[y.line].height));const te=d.x(ee);if(A(te,D,G),ee=C3(q,ee+b+v,T?ee+O:this.right,e.rtl),C(d.x(ee),D,G),T)y.x+=O+p;else if(typeof G.text!="string"){const ve=f.lineHeight;y.y+=Hy(G,ve)+p}else y.y+=z}),jy(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Zr(t.font),i=Zn(t.padding);if(!t.display)return;const a=so(e.rtl,this.left,this.width),o=this.ctx,c=t.position,d=n.size/2,f=i.top+d;let p,g=this.left,v=this.width;if(this.isHorizontal())v=Math.max(...this.lineWidths),p=this.top+f,g=cn(e.align,g,this.right-v);else{const b=this.columnSizes.reduce((_,S)=>Math.max(_,S.height),0);p=f+cn(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const y=cn(c,g,g+v);o.textAlign=a.textAlign(by(c)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,Hu(o,t.text,y,p,n)}_computeTitleHeight(){const e=this.options.title,t=Zr(e.font),n=Zn(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,i,a;if(ll(e,this.left,this.right)&&ll(t,this.top,this.bottom)){for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(i=a[n],ll(e,i.left,i.left+i.width)&&ll(t,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!JF(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,a=KF(i,n);i&&!a&&It(t.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!a&&It(t.onHover,[e,n,this],this)}else n&&It(t.onClick,[e,n,this],this)}}function qF(r,e,t,n,i){const a=XF(n,r,e,t),o=YF(i,n,e.lineHeight);return{itemWidth:a,itemHeight:o}}function XF(r,e,t,n){let i=r.text;return i&&typeof i!="string"&&(i=i.reduce((a,o)=>a.length>o.length?a:o)),e+t.size/2+n.measureText(i).width}function YF(r,e,t){let n=r;return typeof e.text!="string"&&(n=Hy(e,t)),n}function Hy(r,e){const t=r.text?r.text.length:0;return e*t}function JF(r,e){return!!((r==="mousemove"||r==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(r==="click"||r==="mouseup"))}var QF={id:"legend",_element:Zx,start(r,e,t){const n=r.legend=new Zx({ctx:r.ctx,options:t,chart:r});gs.configure(r,n,t),gs.addBox(r,n)},stop(r){gs.removeBox(r,r.legend),delete r.legend},beforeUpdate(r,e,t){const n=r.legend;gs.configure(r,n,t),n.options=t},afterUpdate(r){const e=r.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(r,e){e.replay||r.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(r,e,t){const n=e.datasetIndex,i=t.chart;i.isDatasetVisible(n)?(i.hide(n),e.hidden=!0):(i.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:r=>r.chart.options.color,boxWidth:40,padding:10,generateLabels(r){const e=r.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:i,color:a,useBorderRadius:o,borderRadius:c}}=r.legend.options;return r._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(t?0:void 0),p=Zn(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:a,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:f.borderColor,pointStyle:n||f.pointStyle,rotation:f.rotation,textAlign:i||f.textAlign,borderRadius:o&&(c||f.borderRadius),datasetIndex:d.index}},this)}},title:{color:r=>r.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:r=>!r.startsWith("on"),labels:{_scriptable:r=>!["generateLabels","filter","sort"].includes(r)}}};const ul={average(r){if(!r.length)return!1;let e,t,n=new Set,i=0,a=0;for(e=0,t=r.length;e<t;++e){const c=r[e].element;if(c&&c.hasValue()){const d=c.tooltipPosition();n.add(d.x),i+=d.y,++a}}return a===0||n.size===0?!1:{x:[...n].reduce((c,d)=>c+d)/n.size,y:i/a}},nearest(r,e){if(!r.length)return!1;let t=e.x,n=e.y,i=Number.POSITIVE_INFINITY,a,o,c;for(a=0,o=r.length;a<o;++a){const d=r[a].element;if(d&&d.hasValue()){const f=d.getCenterPoint(),p=w3(e,f);p<i&&(i=p,c=d)}}if(c){const d=c.tooltipPosition();t=d.x,n=d.y}return{x:t,y:n}}};function ui(r,e){return e&&(Tr(e)?Array.prototype.push.apply(r,e):r.push(e)),r}function Ni(r){return(typeof r=="string"||r instanceof String)&&r.indexOf(`
`)>-1?r.split(`
`):r}function ZF(r,e){const{element:t,datasetIndex:n,index:i}=e,a=r.getDatasetMeta(n).controller,{label:o,value:c}=a.getLabelAndValue(i);return{chart:r,label:o,parsed:a.getParsed(i),raw:r.data.datasets[n].data[i],formattedValue:c,dataset:a.getDataset(),dataIndex:i,datasetIndex:n,element:t}}function e1(r,e){const t=r.chart.ctx,{body:n,footer:i,title:a}=r,{boxWidth:o,boxHeight:c}=e,d=Zr(e.bodyFont),f=Zr(e.titleFont),p=Zr(e.footerFont),g=a.length,v=i.length,y=n.length,b=Zn(e.padding);let _=b.height,S=0,A=n.reduce((P,z)=>P+z.before.length+z.lines.length+z.after.length,0);if(A+=r.beforeBody.length+r.afterBody.length,g&&(_+=g*f.lineHeight+(g-1)*e.titleSpacing+e.titleMarginBottom),A){const P=e.displayColors?Math.max(c,d.lineHeight):d.lineHeight;_+=y*P+(A-y)*d.lineHeight+(A-1)*e.bodySpacing}v&&(_+=e.footerMarginTop+v*p.lineHeight+(v-1)*e.footerSpacing);let C=0;const T=function(P){S=Math.max(S,t.measureText(P).width+C)};return t.save(),t.font=f.string,kt(r.title,T),t.font=d.string,kt(r.beforeBody.concat(r.afterBody),T),C=e.displayColors?o+2+e.boxPadding:0,kt(n,P=>{kt(P.before,T),kt(P.lines,T),kt(P.after,T)}),C=0,t.font=p.string,kt(r.footer,T),t.restore(),S+=b.width,{width:S,height:_}}function ej(r,e){const{y:t,height:n}=e;return t<n/2?"top":t>r.height-n/2?"bottom":"center"}function tj(r,e,t,n){const{x:i,width:a}=n,o=t.caretSize+t.caretPadding;if(r==="left"&&i+a+o>e.width||r==="right"&&i-a-o<0)return!0}function rj(r,e,t,n){const{x:i,width:a}=t,{width:o,chartArea:{left:c,right:d}}=r;let f="center";return n==="center"?f=i<=(c+d)/2?"left":"right":i<=a/2?f="left":i>=o-a/2&&(f="right"),tj(f,r,e,t)&&(f="center"),f}function t1(r,e,t){const n=t.yAlign||e.yAlign||ej(r,t);return{xAlign:t.xAlign||e.xAlign||rj(r,e,t,n),yAlign:n}}function nj(r,e){let{x:t,width:n}=r;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function ij(r,e,t){let{y:n,height:i}=r;return e==="top"?n+=t:e==="bottom"?n-=i+t:n-=i/2,n}function r1(r,e,t,n){const{caretSize:i,caretPadding:a,cornerRadius:o}=r,{xAlign:c,yAlign:d}=t,f=i+a,{topLeft:p,topRight:g,bottomLeft:v,bottomRight:y}=Sl(o);let b=nj(e,c);const _=ij(e,d,f);return d==="center"?c==="left"?b+=f:c==="right"&&(b-=f):c==="left"?b-=Math.max(p,v)+i:c==="right"&&(b+=Math.max(g,y)+i),{x:jn(b,0,n.width-e.width),y:jn(_,0,n.height-e.height)}}function xu(r,e,t){const n=Zn(t.padding);return e==="center"?r.x+r.width/2:e==="right"?r.x+r.width-n.right:r.x+n.left}function n1(r){return ui([],Ni(r))}function sj(r,e,t){return mo(r,{tooltip:e,tooltipItems:t,type:"tooltip"})}function i1(r,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?r.override(t):r}const Vy={beforeTitle:Ti,title(r){if(r.length>0){const e=r[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:Ti,beforeBody:Ti,beforeLabel:Ti,label(r){if(this&&this.options&&this.options.mode==="dataset")return r.label+": "+r.formattedValue||r.formattedValue;let e=r.dataset.label||"";e&&(e+=": ");const t=r.formattedValue;return Lr(t)||(e+=t),e},labelColor(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Ti,afterBody:Ti,beforeFooter:Ti,footer:Ti,afterFooter:Ti};function Jr(r,e,t,n){const i=r[e].call(t,n);return typeof i>"u"?Vy[e].call(t,n):i}class s1 extends Vl{static positioners=ul;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&t.options.animation&&n.animations,a=new Dy(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=sj(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,i=Jr(n,"beforeTitle",this,e),a=Jr(n,"title",this,e),o=Jr(n,"afterTitle",this,e);let c=[];return c=ui(c,Ni(i)),c=ui(c,Ni(a)),c=ui(c,Ni(o)),c}getBeforeBody(e,t){return n1(Jr(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,i=[];return kt(e,a=>{const o={before:[],lines:[],after:[]},c=i1(n,a);ui(o.before,Ni(Jr(c,"beforeLabel",this,a))),ui(o.lines,Jr(c,"label",this,a)),ui(o.after,Ni(Jr(c,"afterLabel",this,a))),i.push(o)}),i}getAfterBody(e,t){return n1(Jr(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,i=Jr(n,"beforeFooter",this,e),a=Jr(n,"footer",this,e),o=Jr(n,"afterFooter",this,e);let c=[];return c=ui(c,Ni(i)),c=ui(c,Ni(a)),c=ui(c,Ni(o)),c}_createItems(e){const t=this._active,n=this.chart.data,i=[],a=[],o=[];let c=[],d,f;for(d=0,f=t.length;d<f;++d)c.push(ZF(this.chart,t[d]));return e.filter&&(c=c.filter((p,g,v)=>e.filter(p,g,v,n))),e.itemSort&&(c=c.sort((p,g)=>e.itemSort(p,g,n))),kt(c,p=>{const g=i1(e.callbacks,p);i.push(Jr(g,"labelColor",this,p)),a.push(Jr(g,"labelPointStyle",this,p)),o.push(Jr(g,"labelTextColor",this,p))}),this.labelColors=i,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=c,c}update(e,t){const n=this.options.setContext(this.getContext()),i=this._active;let a,o=[];if(!i.length)this.opacity!==0&&(a={opacity:0});else{const c=ul[n.position].call(this,i,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const d=this._size=e1(this,n),f=Object.assign({},c,d),p=t1(this.chart,n,f),g=r1(n,f,p,this.chart);this.xAlign=p.xAlign,this.yAlign=p.yAlign,a={opacity:1,x:g.x,y:g.y,width:d.width,height:d.height,caretX:c.x,caretY:c.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,i){const a=this.getCaretPosition(e,n,i);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:a}=this,{caretSize:o,cornerRadius:c}=n,{topLeft:d,topRight:f,bottomLeft:p,bottomRight:g}=Sl(c),{x:v,y}=e,{width:b,height:_}=t;let S,A,C,T,P,z;return a==="center"?(P=y+_/2,i==="left"?(S=v,A=S-o,T=P+o,z=P-o):(S=v+b,A=S+o,T=P-o,z=P+o),C=S):(i==="left"?A=v+Math.max(d,p)+o:i==="right"?A=v+b-Math.max(f,g)-o:A=this.caretX,a==="top"?(T=y,P=T-o,S=A-o,C=A+o):(T=y+_,P=T+o,S=A+o,C=A-o),z=T),{x1:S,x2:A,x3:C,y1:T,y2:P,y3:z}}drawTitle(e,t,n){const i=this.title,a=i.length;let o,c,d;if(a){const f=so(n.rtl,this.x,this.width);for(e.x=xu(this,n.titleAlign,n),t.textAlign=f.textAlign(n.titleAlign),t.textBaseline="middle",o=Zr(n.titleFont),c=n.titleSpacing,t.fillStyle=n.titleColor,t.font=o.string,d=0;d<a;++d)t.fillText(i[d],f.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+c,d+1===a&&(e.y+=n.titleMarginBottom-c)}}_drawColorBox(e,t,n,i,a){const o=this.labelColors[n],c=this.labelPointStyles[n],{boxHeight:d,boxWidth:f}=a,p=Zr(a.bodyFont),g=xu(this,"left",a),v=i.x(g),y=d<p.lineHeight?(p.lineHeight-d)/2:0,b=t.y+y;if(a.usePointStyle){const _={radius:Math.min(f,d)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},S=i.leftForLtr(v,f)+f/2,A=b+d/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,bx(e,_,S,A),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,bx(e,_,S,A)}else{e.lineWidth=yt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const _=i.leftForLtr(v,f),S=i.leftForLtr(i.xPlus(v,1),f-2),A=Sl(o.borderRadius);Object.values(A).some(C=>C!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Oh(e,{x:_,y:b,w:f,h:d,radius:A}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Oh(e,{x:S,y:b+1,w:f-2,h:d-2,radius:A}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(_,b,f,d),e.strokeRect(_,b,f,d),e.fillStyle=o.backgroundColor,e.fillRect(S,b+1,f-2,d-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:i}=this,{bodySpacing:a,bodyAlign:o,displayColors:c,boxHeight:d,boxWidth:f,boxPadding:p}=n,g=Zr(n.bodyFont);let v=g.lineHeight,y=0;const b=so(n.rtl,this.x,this.width),_=function(V){t.fillText(V,b.x(e.x+y),e.y+v/2),e.y+=v+a},S=b.textAlign(o);let A,C,T,P,z,G,L;for(t.textAlign=o,t.textBaseline="middle",t.font=g.string,e.x=xu(this,S,n),t.fillStyle=n.bodyColor,kt(this.beforeBody,_),y=c&&S!=="right"?o==="center"?f/2+p:f+2+p:0,P=0,G=i.length;P<G;++P){for(A=i[P],C=this.labelTextColors[P],t.fillStyle=C,kt(A.before,_),T=A.lines,c&&T.length&&(this._drawColorBox(t,e,P,b,n),v=Math.max(g.lineHeight,d)),z=0,L=T.length;z<L;++z)_(T[z]),v=g.lineHeight;kt(A.after,_)}y=0,v=g.lineHeight,kt(this.afterBody,_),e.y-=a}drawFooter(e,t,n){const i=this.footer,a=i.length;let o,c;if(a){const d=so(n.rtl,this.x,this.width);for(e.x=xu(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=d.textAlign(n.footerAlign),t.textBaseline="middle",o=Zr(n.footerFont),t.fillStyle=n.footerColor,t.font=o.string,c=0;c<a;++c)t.fillText(i[c],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:a,yAlign:o}=this,{x:c,y:d}=e,{width:f,height:p}=n,{topLeft:g,topRight:v,bottomLeft:y,bottomRight:b}=Sl(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(c+g,d),o==="top"&&this.drawCaret(e,t,n,i),t.lineTo(c+f-v,d),t.quadraticCurveTo(c+f,d,c+f,d+v),o==="center"&&a==="right"&&this.drawCaret(e,t,n,i),t.lineTo(c+f,d+p-b),t.quadraticCurveTo(c+f,d+p,c+f-b,d+p),o==="bottom"&&this.drawCaret(e,t,n,i),t.lineTo(c+y,d+p),t.quadraticCurveTo(c,d+p,c,d+p-y),o==="center"&&a==="left"&&this.drawCaret(e,t,n,i),t.lineTo(c,d+g),t.quadraticCurveTo(c,d,c+g,d),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,i=n&&n.x,a=n&&n.y;if(i||a){const o=ul[e.position].call(this,this._active,this._eventPosition);if(!o)return;const c=this._size=e1(this,e),d=Object.assign({},o,this._size),f=t1(t,e,d),p=r1(e,d,f,t);(i._to!==p.x||a._to!==p.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=c.width,this.height=c.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,p))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Zn(t.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&c&&(e.save(),e.globalAlpha=n,this.drawBackground(a,e,i,t),Fy(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),jy(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,i=e.map(({datasetIndex:c,index:d})=>{const f=this.chart.getDatasetMeta(c);if(!f)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:f.data[d],index:d}}),a=!Mu(n,i),o=this._positionChanged(i,t);(a||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,n),c=this._positionChanged(o,e),d=t||!Mu(o,a)||c;return d&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),d}_getActiveElements(e,t,n,i){const a=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,n);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:n,caretY:i,options:a}=this,o=ul[a.position].call(this,e,t);return o!==!1&&(n!==o.x||i!==o.y)}}var aj={id:"tooltip",_element:s1,positioners:ul,afterInit(r,e,t){t&&(r.tooltip=new s1({chart:r,options:t}))},beforeUpdate(r,e,t){r.tooltip&&r.tooltip.initialize(t)},reset(r,e,t){r.tooltip&&r.tooltip.initialize(t)},afterDraw(r){const e=r.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(r.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(r.ctx),r.notifyPlugins("afterTooltipDraw",t)}},afterEvent(r,e){if(r.tooltip){const t=e.replay;r.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(r,e)=>e.bodyFont.size,boxWidth:(r,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Vy},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:r=>r!=="filter"&&r!=="itemSort"&&r!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const od={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Qr=Object.keys(od);function a1(r,e){return r-e}function o1(r,e){if(Lr(e))return null;const t=r._adapter,{parser:n,round:i,isoWeekday:a}=r._parseOpts;let o=e;return typeof n=="function"&&(o=n(o)),Li(o)||(o=typeof n=="string"?t.parse(o,n):t.parse(o)),o===null?null:(i&&(o=i==="week"&&($u(a)||a===!0)?t.startOf(o,"isoWeek",a):t.startOf(o,i)),+o)}function l1(r,e,t,n){const i=Qr.length;for(let a=Qr.indexOf(r);a<i-1;++a){const o=od[Qr[a]],c=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(c*o.size))<=n)return Qr[a]}return Qr[i-1]}function oj(r,e,t,n,i){for(let a=Qr.length-1;a>=Qr.indexOf(t);a--){const o=Qr[a];if(od[o].common&&r._adapter.diff(i,n,o)>=e-1)return o}return Qr[t?Qr.indexOf(t):0]}function lj(r){for(let e=Qr.indexOf(r)+1,t=Qr.length;e<t;++e)if(od[Qr[e]].common)return Qr[e]}function c1(r,e,t){if(!t)r[e]=!0;else if(t.length){const{lo:n,hi:i}=p0(t,e),a=t[n]>=e?t[n]:t[i];r[a]=!0}}function cj(r,e,t,n){const i=r._adapter,a=+i.startOf(e[0].value,n),o=e[e.length-1].value;let c,d;for(c=a;c<=o;c=+i.add(c,1,n))d=t[c],d>=0&&(e[d].major=!0);return e}function u1(r,e,t){const n=[],i={},a=e.length;let o,c;for(o=0;o<a;++o)c=e[o],i[c]=o,n.push({value:c,major:!1});return a===0||!t?n:cj(r,n,i,t)}class d1 extends sd{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),i=this._adapter=new j5._date(e.adapters.date);i.init(t),_l(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:o1(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:i,max:a,minDefined:o,maxDefined:c}=this.getUserBounds();function d(f){!o&&!isNaN(f.min)&&(i=Math.min(i,f.min)),!c&&!isNaN(f.max)&&(a=Math.max(a,f.max))}(!o||!c)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),i=Li(i)&&!isNaN(i)?i:+t.startOf(Date.now(),n),a=Li(a)&&!isNaN(a)?a:+t.endOf(Date.now(),n)+1,this.min=Math.min(i,a-1),this.max=Math.max(i+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const a=this.min,o=this.max,c=E3(i,a,o);return this._unit=t.unit||(n.autoSkip?l1(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):oj(this,c.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:lj(this._unit),this.initOffsets(i),e.reverse&&c.reverse(),u1(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,i,a;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?n=a:n=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=jn(t,0,o),n=jn(n,0,o),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,i=this.options,a=i.time,o=a.unit||l1(a.minUnit,t,n,this._getLabelCapacity(t)),c=Tt(i.ticks.stepSize,1),d=o==="week"?a.isoWeekday:!1,f=$u(d)||d===!0,p={};let g=t,v,y;if(f&&(g=+e.startOf(g,"isoWeek",d)),g=+e.startOf(g,f?"day":o),e.diff(n,t,o)>1e5*c)throw new Error(t+" and "+n+" are too far apart with stepSize of "+c+" "+o);const b=i.ticks.source==="data"&&this.getDataTimestamps();for(v=g,y=0;v<n;v=+e.add(v,c,o),y++)c1(p,v,b);return(v===n||i.bounds==="ticks"||y===1)&&c1(p,v,b),Object.keys(p).sort(a1).map(_=>+_)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,a=this._unit,o=t||i[a];return this._adapter.format(e,o)}_tickFormatFunction(e,t,n,i){const a=this.options,o=a.ticks.callback;if(o)return It(o,[e,t,n],this);const c=a.time.displayFormats,d=this._unit,f=this._majorUnit,p=d&&c[d],g=f&&c[f],v=n[t],y=f&&g&&v&&v.major;return this._adapter.format(e,i||(y?g:p))}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,i=Gs(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(i),o=Math.sin(i),c=this._resolveTickFontOptions(0).size;return{w:n*a+c*o,h:n*o+c*a}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,i=n[t.unit]||n.millisecond,a=this._tickFormatFunction(e,0,u1(this,[e],this._majorUnit),i),o=this._getLabelSize(a),c=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,n=i.length;t<n;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const i=this.getLabels();for(t=0,n=i.length;t<n;++t)e.push(o1(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return T3(e.sort(a1))}}function vu(r,e,t){let n=0,i=r.length-1,a,o,c,d;t?(e>=r[n].pos&&e<=r[i].pos&&({lo:n,hi:i}=jh(r,"pos",e)),{pos:a,time:c}=r[n],{pos:o,time:d}=r[i]):(e>=r[n].time&&e<=r[i].time&&({lo:n,hi:i}=jh(r,"time",e)),{time:a,pos:c}=r[n],{time:o,pos:d}=r[i]);const f=o-a;return f?c+(d-c)*(e-a)/f:c}class Ej extends d1{static id="timeseries";static defaults=d1.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=vu(t,this.min),this._tableRange=vu(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,i=[],a=[];let o,c,d,f,p;for(o=0,c=e.length;o<c;++o)f=e[o],f>=t&&f<=n&&i.push(f);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(o=0,c=i.length;o<c;++o)p=i[o+1],d=i[o-1],f=i[o],Math.round((p+d)/2)!==f&&a.push({time:f,pos:o/(c-1)});return a}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((i,a)=>i-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(vu(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return vu(this._table,n*this._tableRange+this._minPos,!0)}}const Gy="label";function f1(r,e){typeof r=="function"?r(e):r&&(r.current=e)}function uj(r,e){const t=r.options;t&&e&&Object.assign(t,e)}function Ky(r,e){r.labels=e}function qy(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gy;const n=[];r.datasets=e.map(i=>{const a=r.datasets.find(o=>o[t]===i[t]);return!a||!i.data||n.includes(a)?{...i}:(n.push(a),Object.assign(a,i),a)})}function dj(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gy;const t={labels:[],datasets:[]};return Ky(t,r.labels),qy(t,r.datasets,e),t}function fj(r,e){const{height:t=150,width:n=300,redraw:i=!1,datasetIdKey:a,type:o,data:c,options:d,plugins:f=[],fallbackContent:p,updateMode:g,...v}=r,y=re.useRef(null),b=re.useRef(null),_=()=>{y.current&&(b.current=new ad(y.current,{type:o,data:dj(c,a),options:d&&{...d},plugins:f}),f1(e,b.current))},S=()=>{f1(e,null),b.current&&(b.current.destroy(),b.current=null)};return re.useEffect(()=>{!i&&b.current&&d&&uj(b.current,d)},[i,d]),re.useEffect(()=>{!i&&b.current&&Ky(b.current.config.data,c.labels)},[i,c.labels]),re.useEffect(()=>{!i&&b.current&&c.datasets&&qy(b.current.config.data,c.datasets,a)},[i,c.datasets]),re.useEffect(()=>{b.current&&(i?(S(),setTimeout(_)):b.current.update(g))},[i,d,c.labels,c.datasets,g]),re.useEffect(()=>{b.current&&(S(),setTimeout(_))},[o]),re.useEffect(()=>(_(),()=>S()),[]),p1.createElement("canvas",{ref:y,role:"img",height:t,width:n,...v},p)}const hj=re.forwardRef(fj);function pj(r,e){return ad.register(e),re.forwardRef((t,n)=>p1.createElement(hj,{...t,ref:n,type:r}))}const h1=pj("doughnut",F5);ad.register(GF,aj,QF);const il={resumen:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 0a2.25 2.25 0 0 0 2.25 2.25h12.75a2.25 2.25 0 0 0 2.25-2.25M3.75 12a2.25 2.25 0 0 1 2.25-2.25h12.75a2.25 2.25 0 0 1 2.25 2.25m-16.5 0v2.25a2.25 2.25 0 0 0 2.25 2.25h12.75a2.25 2.25 0 0 0 2.25-2.25V12"})}),graficos:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM15.75 6h-6M1.5 12h16.5m-16.5 0a2.25 2.25 0 0 0 2.25 2.25h12.75a2.25 2.25 0 0 0 2.25-2.25M1.5 12a2.25 2.25 0 0 1 2.25-2.25h12.75a2.25 2.25 0 0 1 2.25 2.25m-16.5 0v2.25a2.25 2.25 0 0 0 2.25 2.25h12.75a2.25 2.25 0 0 0 2.25-2.25V12"})}),tenencia:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v2.25a2.25 2.25 0 0 1-2.25 2.25H6.75a2.25 2.25 0 0 1-2.25-2.25V14.25m15 0a3 3 0 0 0-3-3H8.25a3 3 0 0 0-3 3m15 0v-3a3 3 0 0 0-3-3h-9a3 3 0 0 0-3 3v3m15 0-3-3-3 3"})}),transacciones:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.28-8.28Z"})}),brokers:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 21h19.5m-1.5-18L19.5 21M5.25 3h13.5m-3-6H8.25m-3.75 3h13.5M9 6v15M15 6v15"})})};function mj({portfolioId:r,user:e,setCurrentView:t,selectedCurrency:n}){const[i,a]=re.useState(null),[o,c]=re.useState([]),[d,f]=re.useState([]),[p,g]=re.useState([]),[v,y]=re.useState([]),[b,_]=re.useState(!0),[S,A]=re.useState(null),[C,T]=re.useState("resumen"),[P,z]=re.useState(!1),[G,L]=re.useState(null),[V,q]=re.useState({activo_id:"",tipo_operacion:"compra",cantidad:"",precio_unitario:"",fecha:new Date().toISOString().split("T")[0],moneda:"ARS",broker_id:""}),[O,ee]=re.useState(n||"ARS"),[D,te]=re.useState(n||"ARS"),[ve,ye]=re.useState(!1),[Oe,je]=re.useState(!1),[fe,xe]=re.useState({key:"fecha",direction:"descending"}),[me,K]=re.useState({key:null,direction:"ascending"}),[N,X]=re.useState(!1),[W,B]=re.useState(!1),[J,be]=re.useState(null),[ie,ne]=re.useState(null),[se,Z]=re.useState({nombre:"",descripcion:"",cuenta_comitente:""}),[pe,Ce]=re.useState(""),[Fe,We]=re.useState("todos"),[Be,ke]=re.useState("todos"),[jt,Bt]=re.useState([]),[Ht,gt]=re.useState(0),[qt,Mr]=re.useState(!1),[et,at]=re.useState(null),[_t,nn]=re.useState(r),[fr,sa]=re.useState([]),[Nr,xn]=re.useState({valor:null,variacion:null,porcentaje:null,tendencia:null}),[go,aa]=re.useState(!1),[oa,xo]=re.useState(!1);re.useEffect(()=>{const H=document.createElement("script");return H.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js",H.onload=()=>ye(!0),H.onerror=()=>{console.error("Error al cargar la librería de Excel."),alert("Error al cargar la librería de Excel. Por favor, recarga la página.")},document.head.appendChild(H),()=>document.head.removeChild(H)},[]),re.useEffect(()=>{e&&_t&&(On(),zi(),Pn(),vn())},[e,_t]),re.useEffect(()=>{e&&(Es(),Bi())},[e]),re.useEffect(()=>{if(d.length>0){const H=Mn(d).holdings,le=Object.values(H).filter(Ee=>Ee.cantidad>0).map(Ee=>Ee.activoInfo.submarket).filter(Boolean);Bt([...new Set(le)].sort())}else Bt([])},[d,v]),re.useEffect(()=>{ee(n),te(n)},[n]);const Bi=async()=>{try{const{data:H,error:le}=await Me.from("tipos_cambio").select("fecha, tasa").order("fecha",{ascending:!1}).limit(2);if(le)throw le;if(H&&H.length>=2){const Ee=H[0].tasa,Se=H[1].tasa,Ve=Ee-Se,tt=Ve/Se*100;xn({valor:Ee,variacion:Ve,porcentaje:tt,tendencia:Ve>=0?"subida":"bajada"})}else console.warn("No hay suficientes datos para calcular la variación del dólar MEP."),xn({valor:null,variacion:null,porcentaje:null,tendencia:null})}catch(H){console.error("Error fetching MEP price:",H.message),xn({valor:null,variacion:null,porcentaje:null,tendencia:null})}},Es=async()=>{try{const{data:H,error:le}=await Me.from("portfolios").select("*").eq("user_id",e.id);if(le)throw le;c(H||[])}catch(H){console.error("Error fetching all portfolios:",H.message)}},Ui=async()=>{Mr(!0);try{at({type:"info",text:"Iniciando actualización completa..."}),at({type:"info",text:"Actualizando la información del tipo de cambio Mep..."});const{error:H}=await Me.functions.invoke("actualizar-tipo-cambio",{body:{user_id:e.id}});if(H)throw H;await new Promise(it=>setTimeout(it,1e3)),at({type:"info",text:"Actualizando valores contables y el precios de los activos en cartera..."});const{data:le,error:Ee}=await Me.from("tipos_cambio").select("fecha, tasa").eq("usuario_id",e.id);if(Ee)throw Ee;const Se=le.reduce((it,st)=>(it[st.fecha]=st.tasa,it),{}),{data:Ve,error:tt}=await Me.from("entradas_contables").select("id, fecha, importe_ars, importe_usd, moneda").eq("usuario_id",e.id);if(tt)throw tt;const ut=Ve.map(it=>{const st=Se[it.fecha];if(!st||st<=0)return null;let pt=!1,Xt={};if(it.moneda==="ARS"){const Yt=parseFloat((it.importe_ars/st).toFixed(2));Yt!==it.importe_usd&&(pt=!0,Xt={importe_usd:Yt})}else if(it.moneda==="USD"){const Yt=parseFloat((it.importe_usd*st).toFixed(2));Yt!==it.importe_ars&&(pt=!0,Xt={importe_ars:Yt})}return pt?Me.from("entradas_contables").update(Xt).eq("id",it.id).eq("usuario_id",e.id):null}).filter(Boolean);if(ut.length>0&&(await Promise.all(ut)).filter(pt=>pt.error).length>0)throw new Error("Algunos registros contables no se pudieron actualizar.");await Me.functions.invoke("actualizar-precios-docta",{body:{user_id:e.id}}),at({type:"success",text:"¡Actualización completa! Los precios han sido sincronizados."})}catch(H){console.error("Error en la actualización completa:",H),at({type:"error",text:H.message||"Error en la actualización. Por favor, intenta de nuevo."})}finally{On(),Pn(),Bi(),Mr(!1),setTimeout(()=>at(null),5e3)}},On=async()=>{try{_(!0),A(null);const{data:H,error:le}=await Me.from("portfolios").select("*").eq("id",_t).eq("user_id",e.id).single();if(le)throw le;if(!H)throw new Error("No se encontró el portafolio.");a(H);const{data:Ee,error:Se}=await Me.from("transacciones").select("*, activos(id, simbolo, nombre, moneda, tipo, ultimo_precio, ultimo_precio_ars, submarket), brokers(nombre, cuenta_comitente)").eq("portafolio_id",_t);if(Se)throw Se;f(Array.isArray(Ee)?Ee:[])}catch(H){console.error("Error fetching portfolio details:",H.message),A(H.message||"Error al cargar los detalles del portafolio. Inténtalo de nuevo.")}finally{_(!1)}},zi=async()=>{try{const{data:H,error:le}=await Me.from("activos").select("id, nombre, simbolo, tipo, moneda, ultimo_precio, ultimo_precio_ars, submarket").order("simbolo",{ascending:!0});if(le)throw le;sa(Array.isArray(H)?H:[])}catch(H){console.error("Error fetching activos:",H.message)}},vn=async()=>{try{const{data:H,error:le}=await Me.from("brokers").select("id, nombre, descripcion, cuenta_comitente").eq("user_id",e.id).order("nombre",{ascending:!0});if(le)throw le;y(H||[])}catch(H){console.error("Error fetching brokers:",H.message)}},Pn=async()=>{try{const{data:H,error:le}=await Me.from("tipos_cambio").select("fecha, tasa").order("fecha",{ascending:!0});if(le)throw le;g(Array.isArray(H)?H:[])}catch(H){console.error("Error fetching tipos de cambio:",H.message)}},ei=H=>{L(null),q({activo_id:"",tipo_operacion:H,cantidad:"",precio_unitario:"",fecha:new Date().toISOString().split("T")[0],moneda:"ARS",broker_id:""}),gt(0),z(!0)},Rn=H=>{const{name:le,value:Ee}=H.target;q(Se=>({...Se,[le]:Ee}))},la=H=>{L(H),q({activo_id:H.activo_id,tipo_operacion:H.tipo_operacion,cantidad:H.cantidad,precio_unitario:H.precio_unitario,fecha:H.fecha,moneda:H.moneda,broker_id:H.broker_id||""});const Ee=Mn(d,Fe,Be).holdings[H.activo_id]?.brokers[H.broker_id]?.cantidad||0;gt(Ee),z(!0)},ca=async H=>{H.preventDefault();try{if(!V.activo_id||!V.cantidad||!V.precio_unitario||!V.broker_id){alert("Por favor, completa todos los campos obligatorios, incluyendo el bróker.");return}if(V.tipo_operacion==="venta"){const tt=Mn(d,Fe,Be).holdings[V.activo_id]?.brokers[V.broker_id]?.cantidad||0;if(parseFloat(V.cantidad)>tt){alert("No puedes vender una cantidad mayor a la que posees en este bróker.");return}}if((V.moneda!=="ARS"||D==="ARS")&&V.fecha&&Ln(V.fecha)===0){alert("No se puede guardar la transacción. No hay tipo de cambio cargado para la fecha seleccionada. Por favor, elige otra fecha o carga el tipo de cambio para esa fecha.");return}const Ee={activo_id:V.activo_id,tipo_operacion:V.tipo_operacion,cantidad:parseFloat(V.cantidad),precio_unitario:parseFloat(V.precio_unitario),fecha:V.fecha,moneda:V.moneda,portafolio_id:_t,broker_id:V.broker_id};let Se=null;if(G){const{error:Ve}=await Me.from("transacciones").update(Ee).eq("id",G.id);Se=Ve}else{const{error:Ve}=await Me.from("transacciones").insert([Ee]);Se=Ve}if(Se)throw Se;z(!1),L(null),q({activo_id:"",tipo_operacion:"compra",cantidad:"",precio_unitario:"",fecha:new Date().toISOString().split("T")[0],moneda:"ARS",broker_id:""}),On()}catch(le){console.error("Error al guardar la transacción:",le.message),alert("Error al guardar la transacción: "+le.message)}},ua=async H=>{if(window.confirm("¿Estás seguro de que quieres eliminar esta transacción?"))try{const{error:le}=await Me.from("transacciones").delete().eq("id",H);if(le)throw le;On()}catch(le){console.error("Error deleting transaction:",le.message),alert("Error al eliminar la transacción.")}},In=H=>{T(H)},Ln=H=>{const le=p.find(Ee=>Ee.fecha===H);return le?le.tasa:0},yn=(H,le,Ee,Se)=>{if(le===Ee)return H;const Ve=Ln(Se);return Ve===0?0:le==="ARS"&&Ee==="USD"?H/Ve:le==="USD"&&Ee==="ARS"?H*Ve:H},Mn=(H,le="todos",Ee="todos")=>{const Se=H.filter(ht=>{const Je=le==="todos"||ht.broker_id===le,ir=Ee==="todos"||ht.activos&&ht.activos.submarket===Ee;return Je&&ir}),Ve={};Se.sort((ht,Je)=>new Date(ht.fecha)-new Date(Je.fecha)),Se.forEach(ht=>{const Je=ht.activo_id;Ve[Je]||(Ve[Je]={cantidad:0,costo_total_ars:0,costo_total_usd:0,activoInfo:ht.activos,brokers:{},compras:[]});const ir=parseFloat(ht.cantidad),gi=parseFloat(ht.precio_unitario),da=ir*gi,sr=ht.activos?.tipo?.toLowerCase()==="bono",lt=yn(da,ht.moneda,"ARS",ht.fecha),vo=yn(da,ht.moneda,"USD",ht.fecha),fa=ht.broker_id;if(Ve[Je].brokers[fa]||(Ve[Je].brokers[fa]={cantidad:0,costo_total_ars:0,costo_total_usd:0}),ht.tipo_operacion==="compra"){const xi=sr?lt/100/ir:lt/ir,Wi=sr?vo/100/ir:vo/ir;Ve[Je].compras.push({id:ht.id,cantidad_restante:ir,costo_unitario_ars:xi,costo_unitario_usd:Wi,broker_id:fa})}else if(ht.tipo_operacion==="venta"){let xi=ir;for(let Wi=0;Wi<Ve[Je].compras.length&&xi>0;Wi++){const ha=Ve[Je].compras[Wi];if(ha.cantidad_restante>0){const yo=Math.min(xi,ha.cantidad_restante);ha.cantidad_restante-=yo,xi-=yo}}}});for(const ht in Ve){const Je=Ve[ht];Je.cantidad=0,Je.costo_total_ars=0,Je.costo_total_usd=0;for(const sr in Je.brokers)Je.brokers[sr].cantidad=0,Je.brokers[sr].costo_total_ars=0,Je.brokers[sr].costo_total_usd=0;Je.compras.forEach(sr=>{const lt=sr.cantidad_restante;lt>0&&(Je.cantidad+=lt,Je.brokers[sr.broker_id].cantidad+=lt,Je.costo_total_ars+=lt*sr.costo_unitario_ars,Je.costo_total_usd+=lt*sr.costo_unitario_usd,Je.brokers[sr.broker_id].costo_total_ars+=lt*sr.costo_unitario_ars,Je.brokers[sr.broker_id].costo_total_usd+=lt*sr.costo_unitario_usd)});const ir=Je.activoInfo?.tipo?.toLowerCase()==="bono",gi=Je.cantidad>0?ir?Je.cantidad*Je.activoInfo.ultimo_precio_ars/100:Je.cantidad*Je.activoInfo.ultimo_precio_ars:0,da=Je.cantidad>0?ir?Je.cantidad*Je.activoInfo.ultimo_precio/100:Je.cantidad*Je.activoInfo.ultimo_precio:0;Je.valor_actual_ars=gi,Je.valor_actual_usd=da}let tt=0,ut=0,it=0,st=0;for(const ht in Ve){const Je=Ve[ht];tt+=Je.valor_actual_ars,ut+=Je.valor_actual_usd,it+=Je.costo_total_ars,st+=Je.costo_total_usd}const pt=tt-it,Xt=it>0?pt/it*100:0,Yt=ut-st,_n=st>0?Yt/st*100:0;return{valorActualArs:tt,valorActualUsd:ut,costoTotalArs:it,costoTotalUsd:st,rendimientoMontoArs:pt,rendimientoPorcentajeArs:Xt,rendimientoMontoUsd:Yt,rendimientoPorcentajeUsd:_n,holdings:Ve}},Fr=(H,le)=>{const Ee=H.activos?.tipo?.toLowerCase()==="bono";let Se=H.cantidad*H.precio_unitario;return Ee&&(Se=Se/100),yn(Se,H.moneda,le,H.fecha)},Bn=(H,le)=>{const Ee=H.activos?.tipo?.toLowerCase()==="bono";let Se=H.precio_unitario;return Ee&&(Se=Se/100),yn(Se,H.moneda,le,H.fecha)},ti=H=>{if(!H)return"";const[le,Ee,Se]=H.split("-");return`${Se}/${Ee}/${le}`},$i=H=>{const le=v.find(Ee=>Ee.id===H);return le?le.nombre:"N/A"},k=Mn(d,Fe,Be),R=async()=>{if(!ve){alert("La librería de exportación a Excel aún no ha cargado.");return}const H=d.filter(le=>le.tipo_operacion==="compra").sort((le,Ee)=>new Date(le.fecha)-new Date(Ee.fecha));if(H.length===0){alert("No hay transacciones de compra para exportar.");return}je(!0);try{const le=["Activo","Bróker","Fecha","Nominales",`Precio de Compra (${O})`,`Precio Actual (${O})`,`Costo Total (${O})`,`Valor Actual Total (${O})`,`Rendimiento (${O})`,"Rendimiento (%)"],Ee=H.map(ut=>{const it=Fr(ut,O),st=ut.activos?.tipo?.toLowerCase()==="bono",pt=O==="ARS"?ut.activos.ultimo_precio_ars:ut.activos.ultimo_precio,Xt=(st?pt/100:pt)*ut.cantidad,Yt=Xt-it,_n=it>0?Xt/it-1:0,ht=Bn(ut,O),Je=st?pt/100:pt;return[{v:`${ut.activos.nombre} (${ut.activos.simbolo})`,t:"s"},{v:$i(ut.broker_id),t:"s"},{v:ut.fecha,t:"s"},{v:parseFloat(ut.cantidad),t:"n"},{v:parseFloat(ht),t:"n",z:O==="USD"?"#,##0.0000":"#,##0.00"},{v:parseFloat(Je),t:"n",z:O==="USD"?"#,##0.0000":"#,##0.00"},{v:parseFloat(it),t:"n",z:"#,##0.00"},{v:parseFloat(Xt),t:"n",z:"#,##0.00"},{v:parseFloat(Yt),t:"n",z:"#,##0.00"},{v:parseFloat(_n),t:"n"}]}),Se=un.aoa_to_sheet([]);un.sheet_add_aoa(Se,[le]),un.sheet_add_aoa(Se,Ee,{origin:"A2"}),Se["!cols"]=[{wch:25},{wch:20},{wch:12},{wch:15},{wch:25},{wch:25},{wch:20},{wch:20},{wch:20},{wch:20}];const Ve=un.book_new();un.book_append_sheet(Ve,Se,"Detalle de Compras");const tt=`Detalle_Tenencia_${i.name.replace(/\s/g,"_")}.xlsx`;Nh(Ve,tt)}catch(le){console.error("Error al exportar a Excel:",le),alert("Error al exportar a Excel. Inténtalo de nuevo.")}finally{await new Promise(le=>setTimeout(le,100)),je(!1)}},F=async()=>{if(!ve){alert("La librería de exportación a Excel aún no ha cargado.");return}if(d.length===0){alert("No hay transacciones para exportar.");return}je(!0);try{const H=["Activo","Bróker","Fecha","Tipo","Nominales","Moneda de Origen","Tipo de Cambio",`Precio Unitario (${D})`,`Costo Total (${D})`],le=ce.map(tt=>{const ut=Bn(tt,D),it=Fr(tt,D);return[{v:`${tt.activos.nombre} (${tt.activos.simbolo})`,t:"s"},{v:tt.brokers?.nombre||"-",t:"s"},{v:tt.fecha,t:"s"},{v:tt.tipo_operacion.toUpperCase(),t:"s"},{v:parseFloat(tt.cantidad),t:"n"},{v:tt.moneda,t:"s"},{v:Ln(tt.fecha)>0?Ln(tt.fecha):"-",t:"n"},{v:parseFloat(ut),t:"n",z:"#,##0.00"},{v:parseFloat(it),t:"n",z:"#,##0.00"}]}),Ee=un.aoa_to_sheet([]);un.sheet_add_aoa(Ee,[H]),un.sheet_add_aoa(Ee,le,{origin:"A2"}),Ee["!cols"]=[{wch:25},{wch:20},{wch:12},{wch:10},{wch:15},{wch:15},{wch:15},{wch:20},{wch:20}];const Se=un.book_new();un.book_append_sheet(Se,Ee,"Detalle de Transacciones");const Ve=`Detalle_Transacciones_${i.name.replace(/\s/g,"_")}.xlsx`;Nh(Se,Ve)}catch(H){console.error("Error al exportar a Excel:",H),alert("Error al exportar a Excel. Inténtalo de nuevo.")}finally{await new Promise(H=>setTimeout(H,100)),je(!1)}};[...d].sort((H,le)=>{const Ee=H.activos.simbolo.toLowerCase(),Se=le.activos.simbolo.toLowerCase();if(Ee<Se)return-1;if(Ee>Se)return 1;const Ve=new Date(H.fecha);return new Date(le.fecha)-Ve});const j=H=>{let le="ascending";fe.key===H&&fe.direction==="ascending"&&(le="descending"),xe({key:H,direction:le})},I=H=>{let le="ascending";me.key===H&&me.direction==="ascending"&&(le="descending"),K({key:H,direction:le})},ce=(()=>{const H=[...d];return fe.key!==null&&H.sort((le,Ee)=>{let Se,Ve;return fe.key==="activo"?(Se=le.activos.simbolo.toLowerCase(),Ve=Ee.activos.simbolo.toLowerCase()):fe.key==="fecha"?(Se=new Date(le.fecha),Ve=new Date(Ee.fecha)):fe.key==="tipo_operacion"?(Se=le.tipo_operacion.toLowerCase(),Ve=Ee.tipo_operacion.toLowerCase()):fe.key==="cantidad"?(Se=parseFloat(le.cantidad),Ve=parseFloat(Ee.cantidad)):fe.key==="moneda"?(Se=le.moneda.toLowerCase(),Ve=Ee.moneda.toLowerCase()):fe.key==="precio_unitario"?(Se=Bn(le,D),Ve=Bn(Ee,D)):fe.key==="costo_total"&&(Se=Fr(le,D),Ve=Fr(Ee,D)),Se<Ve?fe.direction==="ascending"?-1:1:Se>Ve?fe.direction==="ascending"?1:-1:0}),H})(),oe=(()=>{const le=Object.values(Mn(d,Fe,Be).holdings).filter(Ee=>Ee.cantidad>0);return me.key!==null&&le.sort((Ee,Se)=>{let Ve,tt;switch(me.key){case"activo":Ve=Ee.activoInfo.simbolo.toLowerCase(),tt=Se.activoInfo.simbolo.toLowerCase();break;case"cantidad":Ve=parseFloat(Ee.cantidad),tt=parseFloat(Se.cantidad);break;case"costo_total":Ve=O==="ARS"?Ee.costo_total_ars:Ee.costo_total_usd,tt=O==="ARS"?Se.costo_total_ars:Se.costo_total_usd;break;case"valor_actual":const ut=Ee.activoInfo?.tipo?.toLowerCase()==="bono",it=Se.activoInfo?.tipo?.toLowerCase()==="bono";Ve=O==="ARS"?Ee.activoInfo.ultimo_precio_ars*Ee.cantidad/(ut?100:1):(ut?Ee.activoInfo.ultimo_precio/100:Ee.activoInfo.ultimo_precio)*Ee.cantidad,tt=O==="ARS"?Se.activoInfo.ultimo_precio_ars*Se.cantidad/(it?100:1):(it?Se.activoInfo.ultimo_precio/100:Se.activoInfo.ultimo_precio)*Se.cantidad;break;case"rendimiento":const st=O==="ARS"?Ee.costo_total_ars:Ee.costo_total_usd,pt=O==="ARS"?Se.costo_total_ars:Se.costo_total_usd,Xt=O==="ARS"?(Ee.activoInfo?.tipo?.toLowerCase()==="bono",Ee.activoInfo.ultimo_precio_ars*Ee.cantidad/(Ee.activoInfo?.tipo?.toLowerCase()==="bono"?100:1)):(Ee.activoInfo?.tipo?.toLowerCase()==="bono"?Ee.activoInfo.ultimo_precio/100:Ee.activoInfo.ultimo_precio)*Ee.cantidad,Yt=O==="ARS"?(Se.activoInfo?.tipo?.toLowerCase()==="bono",Se.activoInfo.ultimo_precio_ars*Se.cantidad/(Se.activoInfo?.tipo?.toLowerCase()==="bono"?100:1)):(Se.activoInfo?.tipo?.toLowerCase()==="bono"?Se.activoInfo.ultimo_precio/100:Se.activoInfo.ultimo_precio)*Se.cantidad;Ve=Xt-st,tt=Yt-pt;break;default:return 0}return Ve<tt?me.direction==="ascending"?-1:1:Ve>tt?me.direction==="ascending"?1:-1:0}),le})(),de=(H=null)=>{H?(ne(H),Z({nombre:H.nombre,descripcion:H.descripcion||"",cuenta_comitente:H.cuenta_comitente||""})):(ne(null),Z({nombre:"",descripcion:"",cuenta_comitente:""})),Ce(""),X(!0)},he=()=>{X(!1),ne(null),Z({nombre:"",descripcion:"",cuenta_comitente:""}),Ce("")},De=H=>{be(H),B(!0)},Ue=()=>{be(null),B(!1)},He=H=>{Z({...se,[H.target.name]:H.target.value})},Ie=async H=>{if(H.preventDefault(),!se.nombre){Ce("El nombre del bróker es obligatorio.");return}try{let le=null;if(ie){const{error:Ee}=await Me.from("brokers").update({nombre:se.nombre,descripcion:se.descripcion,cuenta_comitente:se.cuenta_comitente}).eq("id",ie.id).eq("user_id",e.id);le=Ee}else{const{error:Ee}=await Me.from("brokers").insert({user_id:e.id,nombre:se.nombre,descripcion:se.descripcion,cuenta_comitente:se.cuenta_comitente});le=Ee}if(le)throw le;await vn(),he()}catch(le){console.error("Error al guardar:",le.message),Ce("Error al guardar: "+le.message)}},Re=async()=>{if(J)try{const{data:H,error:le}=await Me.from("transacciones").select("id").eq("broker_id",J.id);if(le)throw le;if(H.length>0){alert("No se puede eliminar este bróker porque tiene transacciones asociadas. Elimina las transacciones primero."),Ue();return}const{error:Ee}=await Me.from("brokers").delete().eq("id",J.id).eq("user_id",e.id);if(Ee)throw Ee;await vn(),Ue()}catch(H){console.error("Error al eliminar:",H.message),A("Error al eliminar: "+H.message),Ue()}},rt={labels:oe.map(H=>`${H.activoInfo.simbolo} (${H.activoInfo.nombre})`),datasets:[{label:"Distribución por Activo",data:oe.map(H=>{const le=H.activoInfo?.tipo?.toLowerCase()==="bono";return O==="ARS"?le?H.cantidad*H.activoInfo.ultimo_precio_ars/100:H.cantidad*H.activoInfo.ultimo_precio_ars:le?H.cantidad*H.activoInfo.ultimo_precio/100:H.cantidad*H.activoInfo.ultimo_precio}),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED","#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED","#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED","#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED"],hoverOffset:4}]},bt=oe.reduce((H,le)=>{const Ee=le.activoInfo.submarket||"Sin submercado",Se=le.activoInfo?.tipo?.toLowerCase()==="bono",Ve=O==="ARS"?Se?le.cantidad*le.activoInfo.ultimo_precio_ars/100:le.cantidad*le.activoInfo.ultimo_precio_ars:Se?le.cantidad*le.activoInfo.ultimo_precio/100:le.cantidad*le.activoInfo.ultimo_precio;return H[Ee]?H[Ee]+=Ve:H[Ee]=Ve,H},{}),Nt={labels:Object.keys(bt),datasets:[{label:"Distribución por Submercado",data:Object.values(bt),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED","#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED","#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED","#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E7E9ED"],hoverOffset:4}]},Ut={id:"centerText",beforeDraw(H){const{ctx:le,chartArea:Ee}=H;le.restore();const Se=O==="ARS"?k.valorActualArs:k.valorActualUsd;let Ve;Math.abs(Se)>=1e3?Ve=`${(Se/1e3).toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})} K`:Ve=Se.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2});const tt=`${O} Total`,ut=Ve,it={x:Ee.left+Ee.width/2,y:Ee.top+Ee.height/2};le.textAlign="center",le.textBaseline="middle";const st="16px sans-serif",pt="22px sans-serif";le.font=st;const Xt=le.measureText(tt),Yt=Xt.actualBoundingBoxAscent+Xt.actualBoundingBoxDescent;le.font=pt;const _n=le.measureText(ut),ht=_n.actualBoundingBoxAscent+_n.actualBoundingBoxDescent,Je=Yt+8+ht,ir=it.y-Je/2;le.font=st,le.fillStyle="#6b7280",le.fillText(tt,it.x,ir+Yt/2),le.font=pt,le.fillStyle="#1f2937",le.fillText(ut,it.x,ir+Yt+8+ht/2),le.save()}},mi={cutout:"70%",plugins:{legend:{position:"right",labels:{boxWidth:12}},tooltip:{callbacks:{label:function(H){const le=H.label||"",Ee=H.parsed||0,Se=H.dataset.data.reduce((tt,ut)=>tt+ut,0),Ve=Se>0?(Ee/Se*100).toFixed(2)+"%":"0.00%";return`${le}: ${Ee.toLocaleString("es-AR",{style:"currency",currency:O})} (${Ve})`}}}}},ri={cutout:"70%",plugins:{legend:{position:"right",labels:{boxWidth:12}},tooltip:{callbacks:{label:function(H){const le=H.label||"",Ee=H.parsed||0,Se=H.dataset.data.reduce((tt,ut)=>tt+ut,0),Ve=Se>0?(Ee/Se*100).toFixed(2)+"%":"0.00%";return`${le}: ${Ee.toLocaleString("es-AR",{style:"currency",currency:O})} (${Ve})`}}}}};return b?h.jsxs(h.Fragment,{children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:"Detalle del Portafolio"})]}),h.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:h.jsx("div",{className:"flex items-center justify-center h-64",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"})})})]}):S||!i?h.jsxs(h.Fragment,{children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:"Detalle del Portafolio"})]}),h.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:h.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md shadow-sm",children:[h.jsx("p",{className:"font-semibold mb-1",children:"Error al cargar el portafolio"}),h.jsxs("p",{className:"text-sm",children:["Detalles: ",h.jsx("span",{className:"font-mono text-red-800",children:S?.message||S||"No se encontró el portafolio."})]})]})})]}):h.jsxs(h.Fragment,{children:[h.jsxs("header",{className:"bg-white shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("img",{src:mn,alt:"Gestión Patrimonial Icono",className:"h-8 w-8 object-contain"}),h.jsx("span",{className:"text-xl font-bold text-indigo-600",children:"Gestión Patrimonial"})]}),Nr.valor&&h.jsxs("div",{className:"flex items-center space-x-2 py-2 px-4 bg-white rounded-lg shadow-sm border border-gray-200 text-sm font-semibold",children:[h.jsx("span",{className:"text-gray-600",children:"Dólar MEP:"}),h.jsxs("span",{className:"text-gray-800",children:["$",Nr.valor.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),Nr.variacion!==null&&h.jsxs("span",{className:`font-medium flex items-center ${Nr.tendencia==="subida"?"text-green-600":"text-red-600"}`,children:[Nr.tendencia==="subida"?"▲":"▼",Math.abs(Nr.variacion).toFixed(2)," (",Nr.porcentaje.toFixed(2),"%)"]})]})]}),h.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:[h.jsx("label",{htmlFor:"portfolio-selector",className:"sr-only",children:"Seleccionar Cartera"}),h.jsx("select",{id:"portfolio-selector",value:_t,onChange:H=>nn(H.target.value),className:"text-2xl font-semibold text-gray-800 bg-white border border-gray-300 rounded-lg py-2 px-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",children:o.map(H=>h.jsx("option",{value:H.id,children:H.name},H.id))}),h.jsxs("span",{className:"text-lg text-gray-500 ml-4",children:["(",i.description,")"]})]})]}),et&&h.jsxs("div",{className:`fixed top-0 left-0 right-0 z-50 flex items-center justify-between px-6 py-4 shadow-lg transition-all duration-300 ${et.type==="success"?"bg-green-100 text-green-700 border-b border-green-200":"bg-red-100 text-red-700 border-b border-red-200"}`,children:[h.jsx("p",{className:"text-sm font-medium",children:et.text}),h.jsx("button",{onClick:()=>at(null),className:"text-gray-500 hover:text-gray-700",children:"×"})]}),h.jsxs("main",{className:"flex-1 overflow-y-auto p-6",children:[h.jsx("div",{className:"flex justify-start items-center mb-6 sticky top-0 bg-white z-20",children:h.jsxs("div",{className:"flex space-x-4 border-b border-gray-200",children:[h.jsxs("button",{onClick:()=>In("resumen"),className:`py-2 px-4 font-medium transition-colors duration-200 flex items-center space-x-2 ${C==="resumen"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx("span",{className:`text-gray-500 ${C==="resumen"?"text-indigo-600":"group-hover:text-gray-700"}`,children:il.resumen}),h.jsx("span",{children:"Resumen"})]}),h.jsxs("button",{onClick:()=>In("graficos"),className:`py-2 px-4 font-medium transition-colors duration-200 flex items-center space-x-2 ${C==="graficos"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx("span",{className:`text-gray-500 ${C==="graficos"?"text-indigo-600":"group-hover:text-gray-700"}`,children:il.graficos}),h.jsx("span",{children:"Gráficos"})]}),h.jsxs("button",{onClick:()=>In("tenencia"),className:`py-2 px-4 font-medium transition-colors duration-200 flex items-center space-x-2 ${C==="tenencia"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx("span",{className:`text-gray-500 ${C==="tenencia"?"text-indigo-600":"group-hover:text-gray-700"}`,children:il.tenencia}),h.jsx("span",{children:"Tenencia"})]}),h.jsxs("button",{onClick:()=>In("transacciones"),className:`py-2 px-4 font-medium transition-colors duration-200 flex items-center space-x-2 ${C==="transacciones"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx("span",{className:`text-gray-500 ${C==="transacciones"?"text-indigo-600":"group-hover:text-gray-700"}`,children:il.transacciones}),h.jsx("span",{children:"Transacciones"})]}),h.jsxs("button",{onClick:()=>In("brokers"),className:`py-2 px-4 font-medium transition-colors duration-200 flex items-center space-x-2 ${C==="brokers"?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:[h.jsx("span",{className:`text-gray-500 ${C==="brokers"?"text-indigo-600":"group-hover:text-gray-700"}`,children:il.brokers}),h.jsx("span",{children:"Brókers"})]})]})}),C==="resumen"&&h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Resumen del Portafolio"}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("button",{onClick:Ui,disabled:qt,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2 ${qt?"bg-gray-400 cursor-not-allowed text-gray-200":"bg-gray-600 hover:bg-gray-700 text-white"}`,children:[qt?h.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.962l2-2.671z"})]}):h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.03M4.032 9.417l2.687-2.685m-2.687 2.685a8.25 8.25 0 0113.803-3.03L21.03 3.485c.036.002.071.006.106.01L2.985 19.644z"})}),h.jsx("span",{children:"Actualizar precios"})]}),h.jsxs("div",{className:"bg-gray-200 rounded-full p-1 flex items-center",children:[h.jsx("button",{onClick:()=>ee("ARS"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${O==="ARS"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"ARS"}),h.jsx("button",{onClick:()=>ee("USD"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${O==="USD"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"USD"})]})]})]}),h.jsx("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-6 items-end justify-between",children:h.jsxs("div",{className:"flex space-x-4 w-full md:w-auto",children:[h.jsxs("div",{className:"w-1/2 md:w-auto",children:[h.jsx("label",{htmlFor:"broker-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bróker"}),h.jsxs("select",{id:"broker-filter",value:Fe,onChange:H=>We(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[h.jsx("option",{value:"todos",children:"Todos"}),v.map(H=>h.jsx("option",{value:H.id,children:H.nombre},H.id))]})]}),h.jsxs("div",{className:"w-1/2 md:w-auto",children:[h.jsx("label",{htmlFor:"submarket-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Submercado"}),h.jsxs("select",{id:"submarket-filter",value:Be,onChange:H=>ke(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[h.jsx("option",{value:"todos",children:"Todos"}),jt.map(H=>h.jsx("option",{value:H,children:H},H))]})]})]})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Valor Actual"}),h.jsx("p",{className:"text-xl font-bold text-gray-800",children:O==="ARS"?`$${k.valorActualArs.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`$${k.valorActualUsd.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`})]}),h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Costo Total"}),h.jsx("p",{className:"text-xl font-bold text-gray-800",children:O==="ARS"?`$${k.costoTotalArs.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`$${k.costoTotalUsd.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`})]}),h.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Rendimiento"}),h.jsx("p",{className:`text-xl font-bold ${O==="ARS"?k.rendimientoMontoArs>=0?"text-green-600":"text-red-600":k.rendimientoMontoUsd>=0?"text-green-600":"text-red-600"}`,children:O==="ARS"?`$${k.rendimientoMontoArs.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`$${k.rendimientoMontoUsd.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}),h.jsx("p",{className:`text-sm font-medium ${O==="ARS"?k.rendimientoMontoArs>=0?"text-green-600":"text-red-600":k.rendimientoMontoUsd>=0?"text-green-600":"text-red-600"}`,children:O==="ARS"?`${k.rendimientoPorcentajeArs.toFixed(2)}%`:`${k.rendimientoPorcentajeUsd.toFixed(2)}%`})]})]}),h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-8 mb-4",children:"Desempeño por Activo"}),h.jsx("div",{className:"overflow-y-auto max-h-[500px]",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0 z-30",children:h.jsxs("tr",{children:[h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("activo"),children:["Activo",me.key==="activo"&&h.jsx("span",{className:"ml-1",children:me.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("cantidad"),children:["Cantidad",me.key==="cantidad"&&h.jsx("span",{className:"ml-1",children:me.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("costo_total"),children:["Costo Total",me.key==="costo_total"&&h.jsx("span",{className:"ml-1",children:me.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("valor_actual"),children:["Valor Actual",me.key==="valor_actual"&&h.jsx("span",{className:"ml-1",children:me.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>I("rendimiento"),children:["Rendimiento",me.key==="rendimiento"&&h.jsx("span",{className:"ml-1",children:me.direction==="ascending"?"▲":"▼"})]})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:oe.map((H,le)=>{const Ee=O==="ARS"?H.costo_total_ars:H.costo_total_usd;H.cantidad;const Se=H.activoInfo,Ve=Se?.tipo?.toLowerCase()==="bono",tt=Ve?H.cantidad*Se.ultimo_precio_ars/100:H.cantidad*Se.ultimo_precio_ars,ut=Ve?H.cantidad*Se.ultimo_precio/100:H.cantidad*Se.ultimo_precio,it=O==="ARS"?tt:ut,st=it-Ee,pt=Ee>0?(it/Ee-1)*100:0;return H.cantidad===0?null:h.jsxs("tr",{children:[h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:[H.activoInfo.nombre," (",H.activoInfo.simbolo,")"]}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:H.cantidad.toLocaleString("es-AR")}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:Ee.toLocaleString("es-AR",{style:"currency",currency:O})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:it.toLocaleString("es-AR",{style:"currency",currency:O})}),h.jsxs("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-semibold text-right ${st>=0?"text-green-600":"text-red-600"}`,children:[st.toLocaleString("es-AR",{style:"currency",currency:O}),h.jsxs("p",{className:"text-xs font-medium",children:[pt.toFixed(2),"%"]})]})]},le)})})]})})]}),C==="graficos"&&h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Gráficos del Portafolio"}),h.jsxs("div",{className:"bg-gray-200 rounded-full p-1 flex items-center",children:[h.jsx("button",{onClick:()=>ee("ARS"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${O==="ARS"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"ARS"}),h.jsx("button",{onClick:()=>ee("USD"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${O==="USD"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"USD"})]})]}),h.jsxs("div",{className:"flex flex-col md:flex-row space-y-8 md:space-y-0 md:space-x-8",children:[h.jsxs("div",{className:"flex-1 bg-gray-50 p-6 rounded-lg shadow-inner flex flex-col items-center relative",children:[h.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Distribución por Activo (",O,")"]}),h.jsx("div",{className:"w-full max-w-lg relative",children:h.jsx(h1,{data:rt,options:mi,plugins:[Ut]})},`asset-chart-${O}`)]}),h.jsxs("div",{className:"flex-1 bg-gray-50 p-6 rounded-lg shadow-inner flex flex-col items-center relative",children:[h.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Distribución por Submercado (",O,")"]}),h.jsx("div",{className:"w-full max-w-lg relative",children:h.jsx(h1,{data:Nt,options:ri,plugins:[Ut]})},`submarket-chart-${O}`)]})]}),oe.length===0&&h.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg mt-6",children:h.jsxs("div",{className:"flex",children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:h.jsx("path",{fillRule:"evenodd",d:"M8.257 3.518A8.96 8.96 0 0112 2.25c3.07 0 5.825 1.488 7.5 3.75a8.96 8.96 0 01-3.75 5.25c-.274-.294-.582-.55-.916-.77A5.992 5.992 0 0012 8.25a5.992 5.992 0 00-4.043 1.455c-.334.22-.642.476-.916.77a8.96 8.96 0 01-3.75-5.25c1.675-2.262 4.43-3.75 7.5-3.75zm1.53 10.96a6.75 6.75 0 100 13.5 6.75 6.75 0 000-13.5zm0 10.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z",clipRule:"evenodd"})})}),h.jsxs("div",{className:"ml-3",children:[h.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"No hay datos para mostrar"}),h.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:h.jsx("p",{children:"Para ver la distribución de tu portafolio, necesitas tener activos con un valor actual mayor a cero."})})]})]})})]}),C==="tenencia"&&h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Detalle de Tenencia"}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsxs("div",{className:"bg-gray-200 rounded-full p-1 flex items-center",children:[h.jsx("button",{onClick:()=>ee("ARS"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${O==="ARS"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"ARS"}),h.jsx("button",{onClick:()=>ee("USD"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${O==="USD"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"USD"})]}),h.jsx("button",{onClick:R,disabled:Oe||!ve||d.length===0,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2 ${Oe||!ve||d.length===0?"bg-gray-400 cursor-not-allowed text-gray-200":"bg-indigo-600 hover:bg-indigo-700 text-white"}`,children:Oe?h.jsxs(h.Fragment,{children:[h.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.962l2-2.671z"})]}),h.jsx("span",{children:"Generando Excel..."})]}):h.jsxs(h.Fragment,{children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),h.jsx("span",{children:"Exportar a Excel"})]})})]})]}),h.jsx("div",{className:"overflow-y-auto max-h-[500px]",children:Object.values(k.holdings).map(H=>{if(H.cantidad<=0)return null;const le=H.activoInfo,Ee=d.filter(st=>st.activo_id===le.id&&st.tipo_operacion==="compra").sort((st,pt)=>new Date(st.fecha)-new Date(pt.fecha));if(Ee.length===0)return null;const Se=O==="ARS"?H.costo_total_ars:H.costo_total_usd,Ve=le?.tipo?.toLowerCase()==="bono",tt=O==="ARS"?le.ultimo_precio_ars*H.cantidad/(Ve?100:1):(Ve?le.ultimo_precio/100:le.ultimo_precio)*H.cantidad,ut=tt-Se,it=Se>0?(tt/Se-1)*100:0;return h.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h4",{className:"text-md font-semibold text-gray-800",children:[le.nombre," (",le.simbolo,")"]}),h.jsxs("p",{className:"text-sm text-gray-600",children:["Cantidad Total: ",H.cantidad.toLocaleString("es-AR")]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[h.jsxs("div",{className:"bg-white rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Costo Total"}),h.jsx("p",{className:"text-lg font-bold text-gray-800",children:Se.toLocaleString("es-AR",{style:"currency",currency:O})})]}),h.jsxs("div",{className:"bg-white rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Valor Actual"}),h.jsx("p",{className:"text-lg font-bold text-gray-800",children:tt.toLocaleString("es-AR",{style:"currency",currency:O})})]}),h.jsxs("div",{className:"bg-white rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-gray-500",children:"Rendimiento"}),h.jsx("p",{className:`text-lg font-bold ${ut>=0?"text-green-600":"text-red-600"}`,children:ut.toLocaleString("es-AR",{style:"currency",currency:O})}),h.jsxs("p",{className:`text-xs font-medium ${ut>=0?"text-green-600":"text-red-600"}`,children:[it.toFixed(2),"%"]})]})]}),h.jsx("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Detalle de Compras:"}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-100 sticky top-0",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),h.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nominales"}),h.jsxs("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:["Precio Unitario (",O,")"]}),h.jsxs("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:["Costo Total (",O,")"]}),h.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Actual"}),h.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rendimiento"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ee.map(st=>{const pt=Fr(st,O),Xt=st.activos?.tipo?.toLowerCase()==="bono",Yt=O==="ARS"?st.activos.ultimo_precio_ars:st.activos.ultimo_precio,_n=(Xt?Yt/100:Yt)*st.cantidad,ht=_n-pt,Je=pt>0?(_n/pt-1)*100:0;return h.jsxs("tr",{children:[h.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-600",children:ti(st.fecha)}),h.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-600 text-right",children:st.cantidad.toLocaleString("es-AR")}),h.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-800 text-right",children:O==="USD"?`$${Bn(st,O).toLocaleString("en-US",{minimumFractionDigits:4,maximumFractionDigits:4})}`:`$${Bn(st,O).toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}`}),h.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-800 text-right",children:pt.toLocaleString("es-AR",{style:"currency",currency:O})}),h.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-800 text-right",children:_n.toLocaleString("es-AR",{style:"currency",currency:O})}),h.jsxs("td",{className:`px-4 py-2 whitespace-nowrap text-sm font-semibold text-right ${ht>=0?"text-green-600":"text-red-600"}`,children:[ht.toLocaleString("es-AR",{style:"currency",currency:O}),h.jsxs("p",{className:"text-xs font-medium",children:[Je.toFixed(2),"%"]})]})]},st.id)})})]})})]},le.id)})})]}),C==="transacciones"&&h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Transacciones"}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsxs("div",{className:"bg-gray-200 rounded-full p-1 flex items-center",children:[h.jsx("button",{onClick:()=>te("ARS"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${D==="ARS"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"ARS"}),h.jsx("button",{onClick:()=>te("USD"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors duration-200 ${D==="USD"?"bg-white text-gray-800 shadow-sm":"text-gray-500"}`,children:"USD"})]}),h.jsx("button",{onClick:F,disabled:Oe||!ve||d.length===0,className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center space-x-2 ${Oe||!ve||d.length===0?"bg-gray-400 cursor-not-allowed text-gray-200":"bg-indigo-600 hover:bg-indigo-700 text-white"}`,children:Oe?h.jsxs(h.Fragment,{children:[h.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[h.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),h.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.962l2-2.671z"})]}),h.jsx("span",{children:"Generando Excel..."})]}):h.jsxs(h.Fragment,{children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),h.jsx("span",{children:"Exportar a Excel"})]})}),h.jsx("button",{onClick:()=>ei("compra"),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"+ Añadir Compra"}),h.jsx("button",{onClick:()=>ei("venta"),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",children:"+ Añadir Venta"})]})]}),d.length>0?h.jsx("div",{className:"overflow-y-auto max-h-[500px]",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0 z-30",children:h.jsxs("tr",{children:[h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("activo"),children:["Activo",fe.key==="activo"&&h.jsx("span",{className:"ml-1",children:fe.direction==="ascending"?"▲":"▼"})]}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bróker"}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("fecha"),children:["Fecha",fe.key==="fecha"&&h.jsx("span",{className:"ml-1",children:fe.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("tipo_operacion"),children:["Tipo",fe.key==="tipo_operacion"&&h.jsx("span",{className:"ml-1",children:fe.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("cantidad"),children:["Nominales",fe.key==="cantidad"&&h.jsx("span",{className:"ml-1",children:fe.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("moneda"),children:["Moneda de Origen",fe.key==="moneda"&&h.jsx("span",{className:"ml-1",children:fe.direction==="ascending"?"▲":"▼"})]}),h.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo de Cambio"}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("precio_unitario"),children:["Precio Unitario (",D,")",fe.key==="precio_unitario"&&h.jsx("span",{className:"ml-1",children:fe.direction==="ascending"?"▲":"▼"})]}),h.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("costo_total"),children:["Costo Total (",D,")",fe.key==="costo_total"&&h.jsx("span",{className:"ml-1",children:fe.direction==="ascending"?"▲":"▼"})]}),h.jsx("th",{className:"relative px-6 py-3",children:h.jsx("span",{className:"sr-only",children:"Acciones"})})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ce.map(H=>h.jsxs("tr",{children:[h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:[H.activos.nombre," (",H.activos.simbolo,")"]}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:H.brokers?.nombre||"-"}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:ti(H.fecha)}),h.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${H.tipo_operacion==="compra"?"text-green-600":"text-red-600"}`,children:H.tipo_operacion.toUpperCase()}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:H.cantidad.toLocaleString("es-AR")}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:H.moneda}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:Ln(H.fecha)>0?Ln(H.fecha).toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:Bn(H,D).toLocaleString("es-AR",{style:"currency",currency:D})}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 text-right",children:Fr(H,D).toLocaleString("es-AR",{style:"currency",currency:D})}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[h.jsx("button",{onClick:()=>la(H),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Editar"}),h.jsx("button",{onClick:()=>ua(H.id),className:"text-red-600 hover:text-red-900",children:"Eliminar"})]})]},H.id))})]})}):h.jsx("p",{className:"text-center text-gray-500",children:"Aún no hay transacciones para este portafolio."})]}),C==="brokers"&&h.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 border border-gray-200 flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Registros de Brókers"}),h.jsxs("button",{onClick:()=>de(),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center space-x-2",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),h.jsx("span",{children:"Nuevo Bróker"})]})]}),h.jsx("div",{className:"overflow-y-auto max-h-[500px]",children:h.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[h.jsx("thead",{className:"bg-gray-50 sticky top-0",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cuenta Comitente"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descripción"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),h.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length>0?v.map(H=>h.jsxs("tr",{children:[h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:H.nombre}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:H.cuenta_comitente}),h.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:H.descripcion}),h.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[h.jsx("button",{onClick:()=>de(H),className:"text-indigo-600 hover:text-indigo-800 mr-4 transition-colors duration-150",children:"Editar"}),h.jsx("button",{onClick:()=>De(H),className:"text-red-600 hover:text-red-800 transition-colors duration-150",children:"Eliminar"})]})]},H.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500",children:"No hay brókers registrados."})})})]})})]})]}),P&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:G?"Editar Transacción":V.tipo_operacion==="compra"?"Añadir Nueva Compra":"Añadir Nueva Venta"}),h.jsxs("form",{onSubmit:ca,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activo"}),h.jsxs("select",{name:"activo_id",value:V.activo_id,onChange:Rn,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[h.jsx("option",{value:"",children:"Selecciona un activo"}),fr.map(H=>h.jsx("option",{value:H.id,children:H.simbolo},H.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bróker"}),h.jsxs("select",{name:"broker_id",value:V.broker_id,onChange:Rn,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[h.jsx("option",{value:"",children:"Selecciona un bróker"}),v.map(H=>h.jsx("option",{value:H.id,children:H.nombre},H.id))]})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center mb-1",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cantidad"}),V.tipo_operacion==="venta"&&V.activo_id&&V.broker_id&&h.jsxs("span",{className:"text-xs text-gray-500",children:["Disponible: ",Ht.toLocaleString("es-AR")]})]}),h.jsx("input",{type:"number",name:"cantidad",value:V.cantidad,onChange:Rn,placeholder:"Ej: 100",step:"any",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Unitario"}),h.jsx("input",{type:"number",name:"precio_unitario",value:V.precio_unitario,onChange:Rn,placeholder:"Ej: 15000",step:"0.01",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha"}),h.jsx("input",{type:"date",name:"fecha",value:V.fecha,onChange:Rn,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Moneda"}),h.jsxs("select",{name:"moneda",value:V.moneda,onChange:Rn,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[h.jsx("option",{value:"ARS",children:"ARS"}),h.jsx("option",{value:"USD",children:"USD"})]})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:()=>{z(!1),L(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors",children:G?"Guardar Cambios":"Guardar"})]})]})]})}),N&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-auto",children:[h.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:ie?"Editar Bróker":"Nuevo Bróker"}),pe&&h.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4 text-sm",children:pe}),h.jsxs("form",{onSubmit:Ie,children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),h.jsx("input",{type:"text",name:"nombre",value:se.nombre,onChange:He,placeholder:"Ej: Brubank",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cuenta Comitente"}),h.jsx("input",{type:"text",name:"cuenta_comitente",value:se.cuenta_comitente,onChange:He,placeholder:"Ej: 12345678",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción (Opcional)"}),h.jsx("input",{type:"text",name:"descripcion",value:se.descripcion,onChange:He,placeholder:"Ej: Bróker principal",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),h.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[h.jsx("button",{type:"button",onClick:he,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 transition-colors duration-150",children:ie?"Actualizar":"Guardar"})]})]})]})}),W&&h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-auto",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Confirmar Eliminación"}),h.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["¿Estás seguro de que deseas eliminar el bróker ",h.jsx("span",{className:"font-semibold",children:J?.nombre}),"? Esta acción no se puede deshacer y fallará si hay transacciones asociadas."]}),h.jsxs("div",{className:"flex justify-end space-x-3",children:[h.jsx("button",{type:"button",onClick:Ue,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors duration-150",children:"Cancelar"}),h.jsx("button",{type:"button",onClick:Re,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-150",children:"Eliminar"})]})]})})]})}const Cn={dashboard:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 0a2.25 2.25 0 0 0 2.25 2.25h12.75a2.25 2.25 0 0 0 2.25-2.25M3.75 12a2.25 2.25 0 0 1 2.25-2.25h12.75a2.25 2.25 0 0 1 2.25 2.25m-16.5 0v2.25a2.25 2.25 0 0 0 2.25 2.25h12.75a2.25 2.25 0 0 0 2.25-2.25V12"})}),financialStatements:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125a7.5 7.5 0 0 1 15 0m-12.75-3.75h1.5a2.25 2.25 0 0 0 0-4.5h-.75"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 12.75v6.75a3 3 0 0 1-3 3h-.75a3 3 0 0 1-3-3v-6.75h-.75a3.75 3.75 0 0 0-3.75 3.75v1.5c0 2.07 1.68 3.75 3.75 3.75h.75a3.75 3.75 0 0 0 3.75-3.75v-1.5c0-2.07-1.68-3.75-3.75-3.75h-.75a.75.75 0 0 0-.75.75v1.5h.75"})]}),tipoCambio:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 9.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 15.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})}),rubrosManager:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5l6-6 6 6m6 0h-6V3.75A2.25 2.25 0 0 0 16.5 1.5h-.75a.75.75 0 0 0-.75.75v1.5m-6 3.75L3 18.75m0 0l6-6-6 6h18v-6h-6m-12 0v-2.25a2.25 2.25 0 0 0-2.25-2.25h-.75a.75.75 0 0 0-.75.75v1.5m12 3.75L21 9.75M9.75 1.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM15.75 1.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"})}),conceptsManager:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM15.75 6h-6m1.5 6h6.75M12 12a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM15.75 12h-6M10.5 18h9.75M10.5 18a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM15.75 18h-6"})}),entradasContables:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.28-8.28Z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.28-8.28Zm-3.75-2.25a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75a.75.75 0 0 0 .75.75h.75a.75.75 0 0 0 .75-.75v-.75Z"})]}),newDay:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),excelExport:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),activos:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"}),h.jsx("circle",{cx:"12",cy:"12",r:"9"})]}),portfolios:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 0 0-2.25-2.25H15a3 3 0 1 1-6 0H5.25A2.25 2.25 0 0 0 3 12m18 0v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6m18 0V9a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 9v3m18 0v3m-3-3h-3"})}),collapse:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),expand:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})})};function gj({currentView:r,setCurrentView:e,user:t}){const[n,i]=re.useState(!0),a=async()=>{try{const{error:c}=await Me.auth.signOut();if(c)throw c;window.location.reload()}catch(c){console.error("Error al cerrar sesión:",c.message)}},o=[{name:"Dashboard",view:"dashboard",icon:Cn.dashboard},{name:"Estados Financieros",view:"estados-financieros",icon:Cn.financialStatements},{name:"Tipo de Cambio",view:"tipo-cambio",icon:Cn.tipoCambio},{name:"Gestionar Rubros",view:"rubros",icon:Cn.rubrosManager},{name:"Gestionar Conceptos",view:"conceptos",icon:Cn.conceptsManager},{name:"Editar Registro Diario",view:"entradas-contables",icon:Cn.entradasContables},{name:"Registrar Nuevo Día",view:"crear-nuevo-dia",icon:Cn.newDay},{name:"Exportar a Excel",view:"exportar-excel",icon:Cn.excelExport},{name:"Precios",view:"activos",icon:Cn.activos},{name:"Portfolios",view:"portfolios",icon:Cn.portfolios}];return h.jsxs("div",{className:`transition-all duration-300 ease-in-out bg-white shadow-lg flex flex-col h-full border-r border-gray-200 ${n?"w-20":"w-64"}`,children:[h.jsx("div",{className:`p-4 flex items-center ${n?"justify-center":"justify-between"}`,children:h.jsx("button",{onClick:()=>i(!n),className:"p-2 rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors duration-150",children:n?Cn.expand:Cn.collapse})}),h.jsx("nav",{className:"flex-1 px-3 py-4 space-y-2 overflow-y-auto",children:o.map(c=>h.jsxs("div",{className:`
              px-3 py-2 rounded-md transition-colors duration-150 ease-in-out cursor-pointer
              flex items-center space-x-3
              ${r===c.view?"bg-indigo-100 text-indigo-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-700"}
            `,onClick:()=>e(c.view),children:[h.jsx("div",{className:`flex-shrink-0 ${r===c.view?"text-indigo-600":"text-gray-500"}`,children:c.icon}),!n&&h.jsx("span",{className:"text-sm font-medium",children:c.name})]},c.view))}),h.jsx("div",{className:`p-4 border-t border-gray-200 ${n?"justify-center":""}`,children:h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"w-9 h-9 rounded-full bg-indigo-500 flex items-center justify-center text-white text-base font-medium flex-shrink-0",children:t?.email?.[0]?.toUpperCase()||"U"}),!n&&h.jsxs("div",{className:"ml-3 overflow-hidden",children:[h.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:t?.email}),h.jsx("button",{onClick:a,className:"text-xs text-gray-500 hover:text-gray-700 transition-colors duration-150 ease-in-out",children:"Cerrar sesión"})]})]})})]})}function xj(){const[r,e]=re.useState(null),[t,n]=re.useState({type:"dashboard"}),[i,a]=re.useState(!0),[o,c]=re.useState(null),[d,f]=re.useState({});re.useEffect(()=>{async function v(){const{data:{session:b}}=await Me.auth.getSession();e(b?.user||null),a(!1)}v();const{data:y}=Me.auth.onAuthStateChange((b,_)=>{e(_?.user||null)});return()=>{y?.unsubscribe()}},[]);const p=(v,y=null,b=null)=>{n({type:v,portfolioId:y,selectedCurrency:b})};if(i)return h.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:h.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Cargando..."})});if(!r)return h.jsx(Wb,{});let g;switch(t.type){case"dashboard":g=h.jsx(_g,{user:r,setCurrentView:p});break;case"estados-financieros":g=h.jsx(Hb,{user:r,setCurrentView:p});break;case"tipo-cambio":g=h.jsx(Vb,{user:r,setCurrentView:p});break;case"rubros":g=h.jsx(Gb,{user:r,setCurrentView:p});break;case"conceptos-contables":g=h.jsx(Kb,{user:r,setCurrentView:p});break;case"entradas-contables":g=h.jsx(qb,{user:r,setCurrentView:p});break;case"crear-nuevo-dia":g=h.jsx(Xb,{user:r,setCurrentView:p});break;case"exportar-excel":g=h.jsx(MN,{user:r,setCurrentView:p});break;case"activos":g=h.jsx(BN,{user:r,setCurrentView:p,updateMessage:o,setUpdateMessage:c});break;case"portfolios":g=h.jsx(UN,{user:r,setCurrentView:p,updateMessage:o,setUpdateMessage:c,portfolioCurrencies:d,setPortfolioCurrencies:f});break;case"portfolio-detail":g=h.jsx(mj,{user:r,setCurrentView:p,portfolioId:t.portfolioId,selectedCurrency:t.selectedCurrency});break;default:g=h.jsx(_g,{user:r,setCurrentView:p})}return h.jsxs("div",{className:"flex h-screen bg-gray-100 font-sans",children:[h.jsx(gj,{currentView:t.type,setCurrentView:p,user:r}),h.jsx("div",{className:"flex-1 flex flex-col",children:g})]})}Lw.createRoot(document.getElementById("root")).render(h.jsx(xj,{}));
